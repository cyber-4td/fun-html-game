(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
Array.prototype.includes || Object.defineProperty(Array.prototype, "includes", {
  value: function(r, e) {
    if (null == this) throw new TypeError('"this" is null or not defined');
    var t = Object(this),
      n = t.length >>> 0;
    if (0 == n) return !1;
    for (var i, o, a = 0 | e, u = Math.max(0 <= a ? a : n - Math.abs(a), 0); u < n;) {
      if ((i = t[u]) === (o = r) || "number" == typeof i && "number" == typeof o && isNaN(i) && isNaN(o)) return !0;
      u++
    }
    return !1
  }
});
},{}],2:[function(require,module,exports){
function _arrayLikeToArray(r, a) {
  (null == a || a > r.length) && (a = r.length);
  for (var e = 0, n = new Array(a); e < a; e++) n[e] = r[e];
  return n
}
module.exports = _arrayLikeToArray;
},{}],3:[function(require,module,exports){
function _arrayWithHoles(r) {
  if (Array.isArray(r)) return r
}
module.exports = _arrayWithHoles;
},{}],4:[function(require,module,exports){
var arrayLikeToArray = require("./arrayLikeToArray");

function _arrayWithoutHoles(r) {
  if (Array.isArray(r)) return arrayLikeToArray(r)
}
module.exports = _arrayWithoutHoles;
},{"./arrayLikeToArray":2}],5:[function(require,module,exports){
function _assertThisInitialized(e) {
  if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return e
}
module.exports = _assertThisInitialized;
},{}],6:[function(require,module,exports){
function asyncGeneratorStep(n, e, r, t, o, a, c) {
  try {
    var i = n[a](c),
      u = i.value
  } catch (n) {
    return void r(n)
  }
  i.done ? e(u) : Promise.resolve(u).then(t, o)
}

function _asyncToGenerator(n) {
  return function() {
    var e = this,
      r = arguments;
    return new Promise((function(t, o) {
      var a = n.apply(e, r);

      function c(n) {
        asyncGeneratorStep(a, t, o, c, i, "next", n)
      }

      function i(n) {
        asyncGeneratorStep(a, t, o, c, i, "throw", n)
      }
      c(void 0)
    }))
  }
}
module.exports = _asyncToGenerator;
},{}],7:[function(require,module,exports){
function _classCallCheck(a, l) {
  if (!(a instanceof l)) throw new TypeError("Cannot call a class as a function")
}
module.exports = _classCallCheck;
},{}],8:[function(require,module,exports){
var toPropertyKey = require("./toPropertyKey");

function _defineProperties(e, r) {
  for (var t = 0; t < r.length; t++) {
    var o = r[t];
    o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o)
  }
}

function _createClass(e, r, t) {
  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, "prototype", {
    writable: !1
  }), e
}
module.exports = _createClass;
},{"./toPropertyKey":29}],9:[function(require,module,exports){
var unsupportedIterableToArray = require("./unsupportedIterableToArray");

function _createForOfIteratorHelper(r, e) {
  var t = "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"];
  if (!t) {
    if (Array.isArray(r) || (t = unsupportedIterableToArray(r)) || e && r && "number" == typeof r.length) {
      t && (r = t);
      var n = 0,
        o = function() {};
      return {
        s: o,
        n: function() {
          return n >= r.length ? {
            done: !0
          } : {
            done: !1,
            value: r[n++]
          }
        },
        e: function(r) {
          throw r
        },
        f: o
      }
    }
    throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
  }
  var a, u = !0,
    i = !1;
  return {
    s: function() {
      t = t.call(r)
    },
    n: function() {
      var r = t.next();
      return u = r.done, r
    },
    e: function(r) {
      i = !0, a = r
    },
    f: function() {
      try {
        u || null == t.return || t.return()
      } finally {
        if (i) throw a
      }
    }
  }
}
module.exports = _createForOfIteratorHelper;
},{"./unsupportedIterableToArray":31}],10:[function(require,module,exports){
var getPrototypeOf = require("./getPrototypeOf"),
  isNativeReflectConstruct = require("./isNativeReflectConstruct"),
  possibleConstructorReturn = require("./possibleConstructorReturn");

function _createSuper(t) {
  var e = isNativeReflectConstruct();
  return function() {
    var r, o = getPrototypeOf(t);
    if (e) {
      var s = getPrototypeOf(this).constructor;
      r = Reflect.construct(o, arguments, s)
    } else r = o.apply(this, arguments);
    return possibleConstructorReturn(this, r)
  }
}
module.exports = _createSuper;
},{"./getPrototypeOf":13,"./isNativeReflectConstruct":15,"./possibleConstructorReturn":21}],11:[function(require,module,exports){
var toPropertyKey = require("./toPropertyKey");

function _defineProperty(e, r, t) {
  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {
    value: t,
    enumerable: !0,
    configurable: !0,
    writable: !0
  }) : e[r] = t, e
}
module.exports = _defineProperty;
},{"./toPropertyKey":29}],12:[function(require,module,exports){
var superPropBase = require("./superPropBase");

function _get() {
  return "undefined" != typeof Reflect && Reflect.get ? module.exports = _get = Reflect.get.bind() : module.exports = _get = function(e, t, r) {
    var o = superPropBase(e, t);
    if (o) {
      var p = Object.getOwnPropertyDescriptor(o, t);
      return p.get ? p.get.call(arguments.length < 3 ? e : r) : p.value
    }
  }, _get.apply(this, arguments)
}
module.exports = _get;
},{"./superPropBase":25}],13:[function(require,module,exports){
function _getPrototypeOf(t) {
  return module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(t) {
    return t.__proto__ || Object.getPrototypeOf(t)
  }, _getPrototypeOf(t)
}
module.exports = _getPrototypeOf;
},{}],14:[function(require,module,exports){
var setPrototypeOf = require("./setPrototypeOf");

function _inherits(e, t) {
  if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");
  e.prototype = Object.create(t && t.prototype, {
    constructor: {
      value: e,
      writable: !0,
      configurable: !0
    }
  }), Object.defineProperty(e, "prototype", {
    writable: !1
  }), t && setPrototypeOf(e, t)
}
module.exports = _inherits;
},{"./setPrototypeOf":23}],15:[function(require,module,exports){
function _isNativeReflectConstruct() {
  if ("undefined" == typeof Reflect || !Reflect.construct) return !1;
  if (Reflect.construct.sham) return !1;
  if ("function" == typeof Proxy) return !0;
  try {
    return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], (function() {}))), !0
  } catch (t) {
    return !1
  }
}
module.exports = _isNativeReflectConstruct;
},{}],16:[function(require,module,exports){
function _iterableToArray(r) {
  if ("undefined" != typeof Symbol && null != r[Symbol.iterator] || null != r["@@iterator"]) return Array.from(r)
}
module.exports = _iterableToArray;
},{}],17:[function(require,module,exports){
function _iterableToArrayLimit(r, e) {
  var l = null == r ? null : "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"];
  if (null != l) {
    var t, n, i, a, u = [],
      o = !0,
      f = !1;
    try {
      if (i = (l = l.call(r)).next, 0 === e) {
        if (Object(l) !== l) return;
        o = !1
      } else
        for (; !(o = (t = i.call(l)).done) && (u.push(t.value), u.length !== e); o = !0);
    } catch (r) {
      f = !0, n = r
    } finally {
      try {
        if (!o && null != l.return && (a = l.return(), Object(a) !== a)) return
      } finally {
        if (f) throw n
      }
    }
    return u
  }
}
module.exports = _iterableToArrayLimit;
},{}],18:[function(require,module,exports){
function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
}
module.exports = _nonIterableRest;
},{}],19:[function(require,module,exports){
function _nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
}
module.exports = _nonIterableSpread;
},{}],20:[function(require,module,exports){
var defineProperty = require("./defineProperty");

function ownKeys(e, r) {
  var t = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var o = Object.getOwnPropertySymbols(e);
    r && (o = o.filter((function(r) {
      return Object.getOwnPropertyDescriptor(e, r).enumerable
    }))), t.push.apply(t, o)
  }
  return t
}

function _objectSpread2(e) {
  for (var r = 1; r < arguments.length; r++) {
    var t = null != arguments[r] ? arguments[r] : {};
    r % 2 ? ownKeys(Object(t), !0).forEach((function(r) {
      defineProperty(e, r, t[r])
    })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach((function(r) {
      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r))
    }))
  }
  return e
}
module.exports = _objectSpread2;
},{"./defineProperty":11}],21:[function(require,module,exports){
var _typeof = require("./typeof"),
  assertThisInitialized = require("./assertThisInitialized");

function _possibleConstructorReturn(e, r) {
  if (r && ("object" === _typeof(r) || "function" == typeof r)) return r;
  if (void 0 !== r) throw new TypeError("Derived constructors may only return object or undefined");
  return assertThisInitialized(e)
}
module.exports = _possibleConstructorReturn;
},{"./assertThisInitialized":5,"./typeof":30}],22:[function(require,module,exports){
var t = require("./typeof");

function r() {
  module.exports = r = function() {
    return e
  }, module.exports.__esModule = !0, module.exports.default = module.exports;
  var e = {},
    n = Object.prototype,
    o = n.hasOwnProperty,
    i = Object.defineProperty || function(t, r, e) {
      t[r] = e.value
    },
    a = "function" == typeof Symbol ? Symbol : {},
    c = a.iterator || "@@iterator",
    u = a.asyncIterator || "@@asyncIterator",
    l = a.toStringTag || "@@toStringTag";

  function h(t, r, e) {
    return Object.defineProperty(t, r, {
      value: e,
      enumerable: !0,
      configurable: !0,
      writable: !0
    }), t[r]
  }
  try {
    h({}, "")
  } catch (t) {
    h = function(t, r, e) {
      return t[r] = e
    }
  }

  function f(t, r, e, n) {
    var o = r && r.prototype instanceof d ? r : d,
      a = Object.create(o.prototype),
      c = new k(n || []);
    return i(a, "_invoke", {
      value: E(t, e, c)
    }), a
  }

  function s(t, r, e) {
    try {
      return {
        type: "normal",
        arg: t.call(r, e)
      }
    } catch (t) {
      return {
        type: "throw",
        arg: t
      }
    }
  }
  e.wrap = f;
  var p = {};

  function d() {}

  function v() {}

  function y() {}
  var g = {};
  h(g, c, (function() {
    return this
  }));
  var m = Object.getPrototypeOf,
    w = m && m(m(G([])));
  w && w !== n && o.call(w, c) && (g = w);
  var x = y.prototype = d.prototype = Object.create(g);

  function L(t) {
    ["next", "throw", "return"].forEach((function(r) {
      h(t, r, (function(t) {
        return this._invoke(r, t)
      }))
    }))
  }

  function b(r, e) {
    function n(i, a, c, u) {
      var l = s(r[i], r, a);
      if ("throw" !== l.type) {
        var h = l.arg,
          f = h.value;
        return f && "object" == t(f) && o.call(f, "__await") ? e.resolve(f.__await).then((function(t) {
          n("next", t, c, u)
        }), (function(t) {
          n("throw", t, c, u)
        })) : e.resolve(f).then((function(t) {
          h.value = t, c(h)
        }), (function(t) {
          return n("throw", t, c, u)
        }))
      }
      u(l.arg)
    }
    var a;
    i(this, "_invoke", {
      value: function(t, r) {
        function o() {
          return new e((function(e, o) {
            n(t, r, e, o)
          }))
        }
        return a = a ? a.then(o, o) : o()
      }
    })
  }

  function E(t, r, e) {
    var n = "suspendedStart";
    return function(o, i) {
      if ("executing" === n) throw new Error("Generator is already running");
      if ("completed" === n) {
        if ("throw" === o) throw i;
        return N()
      }
      for (e.method = o, e.arg = i;;) {
        var a = e.delegate;
        if (a) {
          var c = _(a, e);
          if (c) {
            if (c === p) continue;
            return c
          }
        }
        if ("next" === e.method) e.sent = e._sent = e.arg;
        else if ("throw" === e.method) {
          if ("suspendedStart" === n) throw n = "completed", e.arg;
          e.dispatchException(e.arg)
        } else "return" === e.method && e.abrupt("return", e.arg);
        n = "executing";
        var u = s(t, r, e);
        if ("normal" === u.type) {
          if (n = e.done ? "completed" : "suspendedYield", u.arg === p) continue;
          return {
            value: u.arg,
            done: e.done
          }
        }
        "throw" === u.type && (n = "completed", e.method = "throw", e.arg = u.arg)
      }
    }
  }

  function _(t, r) {
    var e = r.method,
      n = t.iterator[e];
    if (void 0 === n) return r.delegate = null, "throw" === e && t.iterator.return && (r.method = "return", r.arg = void 0, _(t, r), "throw" === r.method) || "return" !== e && (r.method = "throw", r.arg = new TypeError("The iterator does not provide a '" + e + "' method")), p;
    var o = s(n, t.iterator, r.arg);
    if ("throw" === o.type) return r.method = "throw", r.arg = o.arg, r.delegate = null, p;
    var i = o.arg;
    return i ? i.done ? (r[t.resultName] = i.value, r.next = t.nextLoc, "return" !== r.method && (r.method = "next", r.arg = void 0), r.delegate = null, p) : i : (r.method = "throw", r.arg = new TypeError("iterator result is not an object"), r.delegate = null, p)
  }

  function O(t) {
    var r = {
      tryLoc: t[0]
    };
    1 in t && (r.catchLoc = t[1]), 2 in t && (r.finallyLoc = t[2], r.afterLoc = t[3]), this.tryEntries.push(r)
  }

  function j(t) {
    var r = t.completion || {};
    r.type = "normal", delete r.arg, t.completion = r
  }

  function k(t) {
    this.tryEntries = [{
      tryLoc: "root"
    }], t.forEach(O, this), this.reset(!0)
  }

  function G(t) {
    if (t) {
      var r = t[c];
      if (r) return r.call(t);
      if ("function" == typeof t.next) return t;
      if (!isNaN(t.length)) {
        var e = -1,
          n = function r() {
            for (; ++e < t.length;)
              if (o.call(t, e)) return r.value = t[e], r.done = !1, r;
            return r.value = void 0, r.done = !0, r
          };
        return n.next = n
      }
    }
    return {
      next: N
    }
  }

  function N() {
    return {
      value: void 0,
      done: !0
    }
  }
  return v.prototype = y, i(x, "constructor", {
    value: y,
    configurable: !0
  }), i(y, "constructor", {
    value: v,
    configurable: !0
  }), v.displayName = h(y, l, "GeneratorFunction"), e.isGeneratorFunction = function(t) {
    var r = "function" == typeof t && t.constructor;
    return !!r && (r === v || "GeneratorFunction" === (r.displayName || r.name))
  }, e.mark = function(t) {
    return Object.setPrototypeOf ? Object.setPrototypeOf(t, y) : (t.__proto__ = y, h(t, l, "GeneratorFunction")), t.prototype = Object.create(x), t
  }, e.awrap = function(t) {
    return {
      __await: t
    }
  }, L(b.prototype), h(b.prototype, u, (function() {
    return this
  })), e.AsyncIterator = b, e.async = function(t, r, n, o, i) {
    void 0 === i && (i = Promise);
    var a = new b(f(t, r, n, o), i);
    return e.isGeneratorFunction(r) ? a : a.next().then((function(t) {
      return t.done ? t.value : a.next()
    }))
  }, L(x), h(x, l, "Generator"), h(x, c, (function() {
    return this
  })), h(x, "toString", (function() {
    return "[object Generator]"
  })), e.keys = function(t) {
    var r = Object(t),
      e = [];
    for (var n in r) e.push(n);
    return e.reverse(),
      function t() {
        for (; e.length;) {
          var n = e.pop();
          if (n in r) return t.value = n, t.done = !1, t
        }
        return t.done = !0, t
      }
  }, e.values = G, k.prototype = {
    constructor: k,
    reset: function(t) {
      if (this.prev = 0, this.next = 0, this.sent = this._sent = void 0, this.done = !1, this.delegate = null, this.method = "next", this.arg = void 0, this.tryEntries.forEach(j), !t)
        for (var r in this) "t" === r.charAt(0) && o.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = void 0)
    },
    stop: function() {
      this.done = !0;
      var t = this.tryEntries[0].completion;
      if ("throw" === t.type) throw t.arg;
      return this.rval
    },
    dispatchException: function(t) {
      if (this.done) throw t;
      var r = this;

      function e(e, n) {
        return a.type = "throw", a.arg = t, r.next = e, n && (r.method = "next", r.arg = void 0), !!n
      }
      for (var n = this.tryEntries.length - 1; n >= 0; --n) {
        var i = this.tryEntries[n],
          a = i.completion;
        if ("root" === i.tryLoc) return e("end");
        if (i.tryLoc <= this.prev) {
          var c = o.call(i, "catchLoc"),
            u = o.call(i, "finallyLoc");
          if (c && u) {
            if (this.prev < i.catchLoc) return e(i.catchLoc, !0);
            if (this.prev < i.finallyLoc) return e(i.finallyLoc)
          } else if (c) {
            if (this.prev < i.catchLoc) return e(i.catchLoc, !0)
          } else {
            if (!u) throw new Error("try statement without catch or finally");
            if (this.prev < i.finallyLoc) return e(i.finallyLoc)
          }
        }
      }
    },
    abrupt: function(t, r) {
      for (var e = this.tryEntries.length - 1; e >= 0; --e) {
        var n = this.tryEntries[e];
        if (n.tryLoc <= this.prev && o.call(n, "finallyLoc") && this.prev < n.finallyLoc) {
          var i = n;
          break
        }
      }
      i && ("break" === t || "continue" === t) && i.tryLoc <= r && r <= i.finallyLoc && (i = null);
      var a = i ? i.completion : {};
      return a.type = t, a.arg = r, i ? (this.method = "next", this.next = i.finallyLoc, p) : this.complete(a)
    },
    complete: function(t, r) {
      if ("throw" === t.type) throw t.arg;
      return "break" === t.type || "continue" === t.type ? this.next = t.arg : "return" === t.type ? (this.rval = this.arg = t.arg, this.method = "return", this.next = "end") : "normal" === t.type && r && (this.next = r), p
    },
    finish: function(t) {
      for (var r = this.tryEntries.length - 1; r >= 0; --r) {
        var e = this.tryEntries[r];
        if (e.finallyLoc === t) return this.complete(e.completion, e.afterLoc), j(e), p
      }
    },
    catch: function(t) {
      for (var r = this.tryEntries.length - 1; r >= 0; --r) {
        var e = this.tryEntries[r];
        if (e.tryLoc === t) {
          var n = e.completion;
          if ("throw" === n.type) {
            var o = n.arg;
            j(e)
          }
          return o
        }
      }
      throw new Error("illegal catch attempt")
    },
    delegateYield: function(t, r, e) {
      return this.delegate = {
        iterator: G(t),
        resultName: r,
        nextLoc: e
      }, "next" === this.method && (this.arg = void 0), p
    }
  }, e
}
module.exports = r, module.exports.__esModule = !0, module.exports.default = module.exports;
},{"./typeof":30}],23:[function(require,module,exports){
function _setPrototypeOf(t, e) {
  return module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(t, e) {
    return t.__proto__ = e, t
  }, _setPrototypeOf(t, e)
}
module.exports = _setPrototypeOf;
},{}],24:[function(require,module,exports){
var arrayWithHoles = require("./arrayWithHoles"),
  iterableToArrayLimit = require("./iterableToArrayLimit"),
  unsupportedIterableToArray = require("./unsupportedIterableToArray"),
  nonIterableRest = require("./nonIterableRest");

function _slicedToArray(r, e) {
  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest()
}
module.exports = _slicedToArray;
},{"./arrayWithHoles":3,"./iterableToArrayLimit":17,"./nonIterableRest":18,"./unsupportedIterableToArray":31}],25:[function(require,module,exports){
var getPrototypeOf = require("./getPrototypeOf");

function _superPropBase(e, r) {
  for (; !Object.prototype.hasOwnProperty.call(e, r) && null !== (e = getPrototypeOf(e)););
  return e
}
module.exports = _superPropBase;
},{"./getPrototypeOf":13}],26:[function(require,module,exports){
var arrayWithHoles = require("./arrayWithHoles"),
  iterableToArray = require("./iterableToArray"),
  unsupportedIterableToArray = require("./unsupportedIterableToArray"),
  nonIterableRest = require("./nonIterableRest");

function _toArray(r) {
  return arrayWithHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableRest()
}
module.exports = _toArray;
},{"./arrayWithHoles":3,"./iterableToArray":16,"./nonIterableRest":18,"./unsupportedIterableToArray":31}],27:[function(require,module,exports){
var arrayWithoutHoles = require("./arrayWithoutHoles"),
  iterableToArray = require("./iterableToArray"),
  unsupportedIterableToArray = require("./unsupportedIterableToArray"),
  nonIterableSpread = require("./nonIterableSpread");

function _toConsumableArray(r) {
  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread()
}
module.exports = _toConsumableArray;
},{"./arrayWithoutHoles":4,"./iterableToArray":16,"./nonIterableSpread":19,"./unsupportedIterableToArray":31}],28:[function(require,module,exports){
var _typeof = require("./typeof");

function _toPrimitive(r, t) {
  if ("object" !== _typeof(r) || null === r) return r;
  var e = r[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(r, t || "default");
    if ("object" !== _typeof(i)) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.")
  }
  return ("string" === t ? String : Number)(r)
}
module.exports = _toPrimitive;
},{"./typeof":30}],29:[function(require,module,exports){
var _typeof = require("./typeof"),
  toPrimitive = require("./toPrimitive");

function _toPropertyKey(r) {
  var t = toPrimitive(r, "string");
  return "symbol" === _typeof(t) ? t : String(t)
}
module.exports = _toPropertyKey;
},{"./toPrimitive":28,"./typeof":30}],30:[function(require,module,exports){
/*
* 为了解决 TypeError: _typeofX is not a function 问题， 使用了注入该段代码， 这样只能解决部分问题
* 但是默认有一劳永逸解决的方法，如果你遇到这该类型报错
* 请按操作执行:  右上角点击“详情”=>“本地设置”=>“将JS编译成ES5”=>取消勾选
* */

function _typeof2(o) {
  return (_typeof2 = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) {
    return typeof o;
  } : function (o) {
    return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o;
  })(o);
}

function _typeof(o) {
  return "function" == typeof Symbol && "symbol" === _typeof2(Symbol.iterator) ? module.exports = _typeof = function (o) {
    return _typeof2(o);
  } : module.exports = _typeof = function (o) {
    return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : _typeof2(o);
  }, _typeof(o);
}

module.exports = _typeof;
},{}],31:[function(require,module,exports){
var arrayLikeToArray = require("./arrayLikeToArray");

function _unsupportedIterableToArray(r, e) {
  if (r) {
    if ("string" == typeof r) return arrayLikeToArray(r, e);
    var t = Object.prototype.toString.call(r).slice(8, -1);
    return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, e) : void 0
  }
}
module.exports = _unsupportedIterableToArray;
},{"./arrayLikeToArray":2}],32:[function(require,module,exports){
require("./js/index.js");
},{"./js/index.js":64}],33:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../@babel/runtime/helpers/classCallCheck"),
  t = require("../@babel/runtime/helpers/createClass"),
  i = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = h(t);
    if (i && i.has(e)) return i.get(e);
    var s = {},
      a = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var o in e)
      if ("default" !== o && Object.prototype.hasOwnProperty.call(e, o)) {
        var r = a ? Object.getOwnPropertyDescriptor(e, o) : null;
        r && (r.get || r.set) ? Object.defineProperty(s, o, r) : s[o] = e[o]
      } s.default = e, i && i.set(e, s);
    return s
  }(require("./lib/three")),
  s = require("./config"),
  a = require("./lib/animation"),
  o = require("./random");

function h(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (h = function(e) {
    return e ? i : t
  })(e)
}
var r = 6393958,
  n = 15658734,
  l = 10395294,
  d = 7171437,
  m = 13355979,
  c = 125084537,
  u = 12303291,
  p = 8947848,
  y = new i.MeshBasicMaterial({
    map: s.loader.load("res/cylinder_shadow.png"),
    transparent: !0,
    alphaTest: .01
  }),
  w = new i.MeshBasicMaterial({
    map: s.loader.load("res/desk_shadow.png"),
    transparent: !0,
    alphaTest: .01
  }),
  g = new i.MeshBasicMaterial({
    map: s.loader.load("res/shadow.png"),
    transparent: !0,
    alphaTest: .01
  }),
  M = new i.MeshLambertMaterial({
    map: s.loader.load("res/gray.png")
  }),
  B = new i.MeshLambertMaterial({
    map: s.loader.load("res/number.png"),
    alphaTest: .6
  }),
  O = new i.BoxGeometry(2 * s.BLOCK.radius + .02, s.BLOCK.height + .04, 2 * s.BLOCK.radius + .02),
  L = new i.BoxGeometry(2 * s.BLOCK.radius, s.BLOCK.height, 2 * s.BLOCK.radius),
  b = new i.PlaneGeometry(11, 11),
  C = new i.MeshBasicMaterial({
    map: s.loader.load("res/stripe.png")
  }),
  x = s.GAME.canShadow ? i.MeshLambertMaterial : i.MeshBasicMaterial,
  v = function() {
    function h(t, o) {
      var d = this;
      if (e(this, h), this.radius = s.BLOCK.radius, this.status = "stop", this.scale = 1, this.type = "green", this.types = ["green", "black", "gray"], this.radiusScale = 1, this.obj = new i.Object3D, this.obj.name = "block", this.body = new i.Object3D, (t <= 8 || 27 == t) && (this.greenMaterial = new i.MeshLambertMaterial({
          color: r
        }), this.whiteMaterial = new i.MeshLambertMaterial({
          color: n
        })), 32 != t && 33 != t && 34 != t && 35 != t || (this.greenMaterial = new i.MeshLambertMaterial({
          color: n
        }), this.whiteMaterial = new i.MeshLambertMaterial({
          color: l
        })), this.shadowWidth = 11, 2 == t || 7 == t ? (this.shadow = new i.Mesh(b, w), this.shadow.position.set(0, -s.BLOCK.height / 2 - .001 * t, -4.5), this.shadow.scale.y = 1.2) : 3 == t || 21 == t || 27 == t || 28 == t || 29 == t ? (this.shadow = new i.Mesh(b, y), this.shadow.position.set(-.1, -s.BLOCK.height / 2 - .001 * t, -2.8), this.shadow.scale.y = 1.4, this.shadow.scale.x = 1) : (this.shadow = new i.Mesh(b, g), this.shadow.position.set(-.74, -s.BLOCK.height / 2 - .001 * t, -2.73), this.shadow.scale.y = 1.4), this.shadow.rotation.x = -Math.PI / 2, this.order = t, this.radiusSegments = 4, this.height = s.BLOCK.height, this.canChange = !0, 0 == t) {
        var m = [this.greenMaterial, this.whiteMaterial],
          u = new i.Geometry,
          p = 3,
          v = (s.BLOCK.height - p) / 2,
          K = new i.BoxGeometry(2 * s.BLOCK.radius, v, 2 * s.BLOCK.radius);
        this.geometry = K;
        var f = new i.BoxGeometry(2 * s.BLOCK.radius, p, 2 * s.BLOCK.radius);
        this.merge(u, K, 0, [{
          x: 0,
          y: -p / 2 - v / 2,
          z: 0
        }, {
          x: 0,
          y: p / 2 + v / 2,
          z: 0
        }]), this.merge(u, f, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (1 == t) {
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry;
        var G = s.BLOCK.height / 5,
          z = new i.BoxGeometry(2 * s.BLOCK.radius, G, 2 * s.BLOCK.radius);
        this.geometry = z, this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }, {
          x: 0,
          y: -2 * G,
          z: 0
        }, {
          x: 0,
          y: 2 * G,
          z: 0
        }]), this.merge(u, z, 1, [{
          x: 0,
          y: -G,
          z: 0
        }, {
          x: 0,
          y: G,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (2 == t) {
        this.radiusSegments = 50, this.height = s.BLOCK.height / 21 * 1.5;
        G = s.BLOCK.height / 21 * 19.5;
        var j = s.BLOCK.height - G,
          P = new i.CylinderGeometry(s.BLOCK.radius - 4, s.BLOCK.radius - 2, G, 50),
          I = new i.CylinderGeometry(s.BLOCK.radius, s.BLOCK.radius, j, 50),
          _ = new i.Mesh(I, this.greenMaterial);
        (k = new i.Mesh(P, this.whiteMaterial)).position.y = -s.BLOCK.height / 21 * 10.5, this.body.add(k), this.hitObj = _
      } else if (3 == t) {
        this.radiusSegments = 50, this.middleLightGreenMaterial = new i.MeshLambertMaterial({
          color: c
        });
        m = [this.greenMaterial, this.whiteMaterial, this.middleLightGreenMaterial], u = new i.Geometry, G = 5, j = s.BLOCK.height - G, P = new i.CylinderGeometry(s.BLOCK.radius, s.BLOCK.radius, G, 50), I = new i.CylinderGeometry(s.BLOCK.radius, s.BLOCK.radius, j, 50);
        this.geometry = I, (U = new i.RingGeometry(.6 * s.BLOCK.radius, .8 * s.BLOCK.radius, 30)).rotateX(-Math.PI / 2), this.merge(u, P, 1, [{
          x: 0,
          y: -(s.BLOCK.height - G) / 2,
          z: 0
        }]), this.merge(u, I, 0, [{
          x: 0,
          y: G + j / 2 - s.BLOCK.height / 2,
          z: 0
        }]), this.merge(u, U, 2, [{
          x: 0,
          y: s.BLOCK.height / 2 + .01,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (4 == t) {
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, z = L;
        this.geometry = z, this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]);
        var U = new i.RingGeometry(1, 2, 30, 1);
        this.merge(u, U, 1, [{
          x: 0,
          y: 0,
          z: s.BLOCK.radius + .01
        }]), U.rotateY(-Math.PI / 2), this.merge(u, U, 1, [{
          x: -s.BLOCK.radius - .01,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (5 == t) {
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, p = 3, v = (s.BLOCK.height - p) / 2, K = new i.BoxGeometry(2 * s.BLOCK.radius, v, 2 * s.BLOCK.radius), f = new i.BoxGeometry(2 * s.BLOCK.radius, p, 2 * s.BLOCK.radius);
        this.merge(u, K, 0, [{
          x: 0,
          y: -p / 2 - v / 2,
          z: 0
        }, {
          x: 0,
          y: p / 2 + v / 2,
          z: 0
        }]), this.merge(u, f, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (6 == t) {
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, p = 3, v = (s.BLOCK.height - p) / 2, K = new i.BoxGeometry(2 * s.BLOCK.radius, v, 2 * s.BLOCK.radius), f = new i.BoxGeometry(2 * s.BLOCK.radius, p, 2 * s.BLOCK.radius);
        this.merge(u, K, 0, [{
          x: 0,
          y: -p / 2 - v / 2,
          z: 0
        }, {
          x: 0,
          y: p / 2 + v / 2,
          z: 0
        }]), this.merge(u, f, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (7 == t) {
        this.radiusSegments = 50, this.height = s.BLOCK.height / 21 * 1.5;
        var k;
        G = s.BLOCK.height / 21 * 19.5, j = s.BLOCK.height - G, P = new i.CylinderGeometry(s.BLOCK.radius - 4, s.BLOCK.radius - 2, G, 50), I = new i.CylinderGeometry(s.BLOCK.radius, s.BLOCK.radius, j, 50), _ = new i.Mesh(I, this.greenMaterial);
        (k = new i.Mesh(P, this.whiteMaterial)).position.y = -s.BLOCK.height / 21 * 10.5, this.body.add(k), this.hitObj = _
      } else if (8 == t) {
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, G = s.BLOCK.height / 5, z = new i.BoxGeometry(2 * s.BLOCK.radius, G, 2 * s.BLOCK.radius);
        this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }, {
          x: 0,
          y: -2 * G,
          z: 0
        }, {
          x: 0,
          y: 2 * G,
          z: 0
        }]), this.merge(u, z, 1, [{
          x: 0,
          y: -G,
          z: 0
        }, {
          x: 0,
          y: G,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (9 == t) {
        var A = new i.MeshLambertMaterial({
          color: 15563832
        });
        m = [A, E = new i.MeshBasicMaterial({
          map: s.loader.load("res/game.png"),
          transparent: !0
        })], u = new i.Geometry, z = L;
        this.geometry = z, this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, new i.PlaneGeometry(5, 5), 1, [{
          x: 0,
          y: .1,
          z: s.BLOCK.radius + .01
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (10 == t) {
        var T = new i.MeshLambertMaterial({
            color: 16508510
          }),
          S = (m = [T, E = new i.MeshBasicMaterial({
            map: s.loader.load("res/emotion.png"),
            transparent: !0
          })], u = new i.Geometry, z = L, new i.CylinderGeometry(2, 2, 1, 50)),
          D = new i.PlaneGeometry(1.5, 1.5);
        this.geometry = z, this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), S.rotateX(Math.PI / 2), this.merge(u, S, 0, [{
          x: 0,
          y: 0,
          z: s.BLOCK.radius + .51
        }]), S.rotateZ(Math.PI / 2), S.rotateY(Math.PI / 2), this.merge(u, S, 0, [{
          x: -s.BLOCK.radius - .51,
          y: 0,
          z: 0
        }]), this.merge(u, D, 1, [{
          x: 0,
          y: 0,
          z: s.BLOCK.radius + 1.02
        }]), D.rotateY(-Math.PI / 2), this.merge(u, D, 1, [{
          x: -s.BLOCK.radius - 1.02,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (11 == t) {
        z = L;
        var Y = new i.BoxGeometry(3, 2, 4);
        this.geometry = z;
        var H = new i.MeshLambertMaterial({
            color: 11855938
          }),
          E = new i.MeshBasicMaterial({
            map: s.loader.load("res/green_face.png"),
            transparent: !0
          });
        D = new i.PlaneGeometry(6, 3), m = [H, E], u = new i.Geometry;
        this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, D, 1, [{
          x: .5,
          y: -1,
          z: s.BLOCK.radius + .01
        }]), Y.rotateZ(Math.PI / 5), this.merge(u, Y, 0, [{
          x: -s.BLOCK.radius - 1,
          y: 1,
          z: 2.5
        }]), Y.rotateZ(-2 * Math.PI / 5), this.merge(u, Y, 0, [{
          x: s.BLOCK.radius,
          y: 1,
          z: 2.5
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (12 == t) {
        z = L, Y = new i.BoxGeometry(3, 2, 4);
        this.geometry = z;
        H = new i.MeshLambertMaterial({
          color: 15921906
        }), E = new i.MeshLambertMaterial({
          map: s.loader.load("res/white_face.png")
        }), D = new i.PlaneGeometry(6, 3), m = [H, E], u = new i.Geometry;
        this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, D, 1, [{
          x: .5,
          y: -1,
          z: s.BLOCK.radius + .01
        }]), Y.rotateZ(Math.PI / 5), this.merge(u, Y, 0, [{
          x: -s.BLOCK.radius - 1,
          y: 1,
          z: 2.5
        }]), Y.rotateZ(-2 * Math.PI / 5), this.merge(u, Y, 0, [{
          x: s.BLOCK.radius,
          y: 1,
          z: 2.5
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (13 == t) {
        z = L;
        this.geometry = z;
        E = new i.MeshLambertMaterial({
          map: s.loader.load("res/money.png")
        }), D = new i.PlaneGeometry(3, 3), m = [E], u = new i.Geometry;
        this.mapUv(64, 64, z, 1, 2, 2, 4, 4), this.mapUv(64, 64, z, 2, 2, 2, 4, 4), this.mapUv(64, 64, z, 4, 2, 2, 4, 4), this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, D, 0, [{
          x: 0,
          y: 0,
          z: s.BLOCK.radius + .01
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (14 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius);
        this.geometry = z;
        var R = new i.MeshLambertMaterial({
          map: s.loader.load("res/tit.png")
        });
        this.mapUv(310, 310, z, 1, 0, 0, 200, 110), this.mapUv(310, 310, z, 2, 0, 110, 200, 310), this.mapUv(310, 310, z, 4, 200, 110, 310, 310), this.hitObj = new i.Mesh(z, R)
      } else if (15 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius);
        this.map = s.loader.load("res/bag.png");
        R = new i.MeshLambertMaterial({
          map: this.map
        });
        this.glowMap = s.loader.load("res/glow_bag.png"), this.hitObj = new i.Mesh(z, R), this.whenSucceed = this.glow, this.beforePopup = this.hideGlow, this.score = 20
      } else if (16 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius), R = new i.MeshLambertMaterial({
          map: s.loader.load("res/dict.png")
        });
        this.mapUv(428, 428, z, 1, 0, 148, 280, 0), this.mapUv(428, 428, z, 2, 0, 148, 280, 428), this.mapUv(428, 428, z, 4, 280, 148, 428, 428), this.hitObj = new i.Mesh(z, R)
      } else if (17 == t) {
        this.height /= 3;
        var Z = new i.MeshLambertMaterial({
            map: s.loader.load("res/box_top.png")
          }),
          F = new i.MeshLambertMaterial({
            map: s.loader.load("res/box_bottom.png")
          });
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius);
        this.geometry = z;
        var W = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius);
        m = [Z, F], u = new i.Geometry;
        this.mapUv(198, 198, z, 1, 0, 0, 148, 50), this.mapUv(198, 198, z, 2, 0, 50, 148, 198), this.mapUv(198, 198, z, 4, 148, 50, 198, 198), this.mapUv(444, 50, W, 4, 148, 0, 296, 50, !0), this.mapUv(444, 50, W, 1, 0, 0, 148, 50), this.mapUv(444, 50, W, 2, 0, 0, 1, 1), this.mapUv(444, 50, W, 0, 296, 50, 444, 0), this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, W, 1, [{
          x: 0,
          y: -2 * this.height,
          z: 0
        }]);
        var X = new i.MeshLambertMaterial({
          map: s.loader.load("res/box_middle.png")
        });
        this.middle = new i.Mesh(W, X), this.middle.position.y = -this.height, this.body.add(this.middle), this.hitObj = new i.Mesh(u, m), this.succeedTimer = this.rotateBox, this.score = 10
      } else if (18 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius), R = new i.MeshLambertMaterial({
          map: s.loader.load("res/express.png")
        });
        this.mapUv(428, 428, z, 1, 0, 0, 280, 148), this.mapUv(428, 428, z, 2, 0, 148, 280, 428), this.mapUv(428, 428, z, 4, 280, 148, 428, 428), this.hitObj = new i.Mesh(z, R)
      } else if (19 == t) {
        this.min = .9, this.height = s.BLOCK.height / 21 * 4;
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height + .1, 2 * s.BLOCK.radius);
        this.geometry = z;
        R = new i.MeshLambertMaterial({
          color: 16777215,
          transparent: !0,
          opacity: .3
        }), P = new i.BoxGeometry(2.05 * s.BLOCK.radius, s.BLOCK.height / 21 * 17, 2.05 * s.BLOCK.radius), m = [R, F = new i.MeshBasicMaterial({
          map: s.loader.load("res/sing.png")
        })], u = new i.Geometry;
        this.mapUv(416, 416, P, 1, 0, 0, 256, 160), this.mapUv(416, 416, P, 2, 0, 160, 256, 416), this.mapUv(416, 416, P, 4, 256, 160, 416, 416), this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, P, 1, [{
          x: 0,
          y: -s.BLOCK.height / 21 * 10.5,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m), this.record = new i.Object3D, this.record.add(new i.Mesh(new i.CylinderGeometry(.9 * s.BLOCK.radius, .9 * s.BLOCK.radius, .4, 50), new i.MeshBasicMaterial({
          color: 2894892
        })));
        D = new i.CircleGeometry(.9 * s.BLOCK.radius, 40), E = new i.MeshBasicMaterial({
          map: s.loader.load("res/record.png")
        });
        (Ce = new i.Mesh(D, E)).rotation.x = -Math.PI / 2, Ce.position.y = .26, this.record.add(Ce), this.body.add(this.record);
        D = new i.PlaneGeometry(2, 2);
        this.musicIcon = new i.Mesh(D, new i.MeshBasicMaterial({
          map: s.loader.load("res/music_icon.png"),
          transparent: !0
        })), this.musicIcon.position.set(0, 0, 0), this.musicIcon.rotation.y = -Math.PI / 4, this.musicIcon.rotation.x = -Math.PI / 5, this.musicIcon.rotation.z = -Math.PI / 5, this.musicIcon.visible = !1, this.secondMusicIcon = new i.Mesh(D, new i.MeshBasicMaterial({
          map: s.loader.load("res/music_icon_two.png"),
          transparent: !0
        })), this.secondMusicIcon.rotation.y = -Math.PI / 4, this.secondMusicIcon.rotation.x = -Math.PI / 5, this.secondMusicIcon.rotation.z = -Math.PI / 5, this.secondMusicIcon.visible = !1, this.icons = [], this.icons.push(this.musicIcon, this.secondMusicIcon);
        for (var q = 0; q < 2; ++q) this.body.add(this.icons[q]);
        this.succeedTimer = this.playMusic, this.score = 30, this.music姓th = "sing", this.perFrame = function() {
          d.record.rotation.y += .01
        }, this.whenLeave = function() {
          d.stopMusic()
        }
      } else if (20 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius / 38 * 48);
        this.geometry = z, this.shadow.scale.set(1, 61 / 38, 48 / 38);
        R = new i.MeshLambertMaterial({
          map: s.loader.load("res/disk.png")
        });
        var N = new i.MeshBasicMaterial({
          map: s.loader.load("res/disk_dark.png"),
          transparent: !0
        });
        D = new i.PlaneGeometry(3, 3), m = [N, R], u = new i.Geometry;
        this.mapUv(236, 300, z, 1, 0, 250, 10, 260), this.mapUv(236, 300, z, 2, 0, 300, 236, 0), this.mapUv(236, 300, z, 4, 0, 250, 10, 260), this.merge(u, z, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, D, 0, [{
          x: 3.5,
          y: .5,
          z: s.BLOCK.radius / 38 * 48 + .01
        }]), this.hitObj = new i.Mesh(u, m), this.plane = new i.Mesh(D, new i.MeshBasicMaterial({
          map: s.loader.load("res/disk_light.png"),
          transparent: !0
        })), this.plane.position.set(3.5, .5, s.BLOCK.radius / 38 * 48 + .03), this.plane.updateMatrix(), this.plane.matrixAutoUpdate = !1, this.body.add(this.plane), this.timer = setInterval((function() {
          d.plane.visible = !d.plane.visible
        }), 1e3)
      } else if (21 == t) {
        this.radiusSegments = 50, this.min = .8, this.height = s.BLOCK.height / 21 * 4;
        z = new i.CylinderGeometry(.7 * s.BLOCK.radius, .8 * s.BLOCK.radius, this.height, 50);
        this.geometry = z;
        D = new i.CircleGeometry(.7 * s.BLOCK.radius, 50), P = new i.CylinderGeometry(.7 * s.BLOCK.radius, .5 * s.BLOCK.radius, s.BLOCK.height / 21 * 17, 50), R = new i.MeshBasicMaterial({
          color: 5066061
        }), E = new i.MeshLambertMaterial({
          map: s.loader.load("res/westore_desk.png")
        }), F = new i.MeshBasicMaterial({
          map: s.loader.load("res/westore.png")
        });
        this.shadow.scale.set(.55, .9, .7);
        m = [R, F, E], u = new i.Geometry;
        this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), P.rotateY(2.3), this.merge(u, P, 1, [{
          x: 0,
          y: -s.BLOCK.height / 21 * 10.5,
          z: 0
        }]), D.rotateX(-Math.PI / 2), D.rotateY(-.7), this.merge(u, D, 2, [{
          x: 0,
          y: this.height / 2 + .01,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (22 == t) {
        this.height = s.BLOCK.height / 21 * 6;
        z = new i.BoxGeometry(2.1 * s.BLOCK.radius, this.height, 2.1 * s.BLOCK.radius);
        this.geometry = z;
        R = new i.MeshLambertMaterial({
          map: s.loader.load("res/gift.png")
        }), P = new i.BoxGeometry(2 * s.BLOCK.radius, s.BLOCK.height / 21 * 15, 2 * s.BLOCK.radius), F = new i.MeshLambertMaterial({
          color: 11637749
        });
        this.mapUv(300, 370, z, 1, 0, 0, 300, 70), this.mapUv(300, 370, z, 2, 0, 70, 300, 370), this.mapUv(300, 370, z, 4, 0, 0, 300, 70, !0);
        m = [R, F], u = new i.Geometry;
        this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.merge(u, P, 1, [{
          x: 0,
          y: -s.BLOCK.height / 21 * 10.5,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (23 == t) {
        this.height = s.BLOCK.height / 21 * 5;
        z = new i.Geometry;
        var V = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius / 38 * 40);
        z.merge(V), this.shadow.scale.set(1, 48 / 38, 48 / 38);
        var J = new i.BoxGeometry(1.5, 3.5, 1.5);
        J.rotateZ(-.3), J.vertices[7].y -= .4, J.vertices[6].y -= .4, J.translate(-4, -3, -3.5), z.merge(J), J.vertices[6].y += .5, J.translate(0, 0, 7), J.rotateX(-.2), z.merge(J), J.vertices[7].y += .4, J.translate(5, -1, 0), J.rotateZ(.4), z.merge(J);
        R = new i.MeshLambertMaterial({
          map: s.loader.load("res/stool.png")
        });
        this.hitObj = new i.Mesh(z, R), this.shadow = new i.Mesh(new i.PlaneGeometry(this.shadowWidth, this.shadowWidth), new i.MeshBasicMaterial({
          map: s.loader.load("res/stool_shadow.png"),
          transparent: !0,
          alphaTest: .01
        })), this.shadow.position.set(-.76, -s.BLOCK.height / 2 - .001 * t, -3.6), this.shadow.scale.y = 1.4, this.shadow.scale.x = .9, this.shadow.rotation.x = -Math.PI / 2
      } else if (24 == t) {
        this.height = s.BLOCK.height / 21 * 6;
        z = new i.BoxGeometry(2 * s.BLOCK.radius / 38 * 45, this.height, 2 * s.BLOCK.radius / 38 * 45);
        this.geometry = z;
        P = new i.BoxGeometry(2 * s.BLOCK.radius / 38 * 40, s.BLOCK.height / 21 * 15, 2 * s.BLOCK.radius / 38 * 40);
        this.shadow.scale.set(40 / 38, 1.4, 1);
        m = [R = new i.MeshLambertMaterial({
          map: s.loader.load("res/store_top.png")
        }), F = new i.MeshBasicMaterial({
          map: s.loader.load("res/store_bottom.png"),
          transparent: !0
        }), E = new i.MeshBasicMaterial({
          map: s.loader.load("res/indoor.png"),
          transparent: !0
        })], D = new i.PlaneGeometry(3.1, 3.1), u = new i.Geometry;
        this.mapUv(340, 340, z, 1, 0, 0, 280, 60), this.mapUv(340, 340, z, 2, 0, 60, 280, 340), this.mapUv(340, 340, z, 4, 280, 60, 340, 340), this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.mapUv(434, 164, P, 1, 0, 0, 217, 164), this.mapUv(434, 164, P, 4, 217, 0, 434, 164, !0), this.merge(u, P, 1, [{
          x: 0,
          y: -s.BLOCK.height / 21 * 10.5,
          z: 0
        }]), D.rotateY(-Math.PI / 2), this.merge(u, D, 2, [{
          x: -s.BLOCK.radius / 38 * 40 - .01,
          y: -3.3,
          z: -2.5
        }]), this.hitObj = new i.Mesh(u, m);
        var Q = new i.PlaneGeometry(1.55, 3.1);
        this.door = new i.Mesh(Q, new i.MeshBasicMaterial({
          map: s.loader.load("res/door.png"),
          transparent: !0
        })), this.door.rotation.y = -Math.PI / 2, this.door.position.set(-s.BLOCK.radius / 38 * 40 - .02, -3.3, -3.3), this.body.add(this.door), this.secondDoor = new i.Mesh(Q, new i.MeshBasicMaterial({
          map: s.loader.load("res/second_door.png"),
          transparent: !0
        })), this.secondDoor.rotation.y = -Math.PI / 2, this.secondDoor.position.set(-s.BLOCK.radius / 38 * 40 - .02, -3.3, -1.7), this.body.add(this.secondDoor), this.score = 15
      } else if (25 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius);
        this.geometry = z;
        R = new i.MeshLambertMaterial({
          map: s.loader.load("res/clock.png")
        });
        this.mapUv(320, 200, z, 1, 0, 0, 5, 5), this.mapUv(320, 200, z, 2, 0, 0, 5, 5), this.mapUv(320, 200, z, 4, 0, 200, 320, 0, !0);
        var $ = C,
          ee = new i.CylinderGeometry(1, 1, 1, 30);
        m = [R, $], u = new i.Geometry;
        this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), ee.rotateZ(Math.PI / 2), this.merge(u, ee, 1, [{
          x: -s.BLOCK.radius - .5,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m), this.plane = new i.Mesh(new i.PlaneGeometry(3, 3), new i.MeshBasicMaterial({
          map: s.loader.load("res/point.png"),
          transparent: !0
        })), this.plane.position.set(0, 0, s.BLOCK.radius + .04), this.body.add(this.plane), this.timer = setInterval((function() {
          d.plane.visible = !d.plane.visible
        }), 1e3), this.numbers = [];
        var te = new i.PlaneGeometry(3, 3);
        for (q = 0; q < 10; ++q) {
          for (var ie = new i.MeshBasicMaterial({
              map: s.loader.load("res/" + q + ".png"),
              alphaTest: .5
            }), se = [], ae = 0; ae < 4; ++ae) {
            var oe = new i.Mesh(te, ie);
            oe.position.z = s.BLOCK.radius + .01, oe.visible = !1, se.push(oe), this.body.add(oe)
          }
          this.numbers.push(se)
        }
        var he = new Date,
          re = ("0" + he.getHours()).slice(-2),
          ne = ("0" + he.getMinutes()).slice(-2);
        this.numbers[re[0]][0].position.x = -3.2 * this.radiusScale, this.numbers[re[0]][0].visible = !0, this.numbers[re[1]][1].position.x = -1.3 * this.radiusScale, this.numbers[re[1]][1].visible = !0, this.numbers[ne[0]][2].position.x = 1.3 * this.radiusScale, this.numbers[ne[0]][2].visible = !0, this.numbers[ne[1]][3].position.x = 3.2 * this.radiusScale, this.numbers[ne[1]][3].visible = !0
      } else if (26 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius), R = new i.MeshLambertMaterial({
          map: s.loader.load("res/well.png")
        });
        this.mapUv(280, 428, z, 1, 0, 0, 280, 148), this.mapUv(280, 428, z, 2, 0, 148, 280, 428), this.mapUv(280, 428, z, 4, 0, 0, 280, 148, !0), this.hitObj = new i.Mesh(z, R), this.score = 5
      } else if (27 == t) {
        this.radiusSegments = 50;
        z = new i.CylinderGeometry(2 * s.BLOCK.radius / 38 * 25, 2 * s.BLOCK.radius / 38 * 25, this.height, 50);
        this.geometry = z, this.shadow.scale.set(50 / 38, 50 / 38, 50 / 38);
        R = new i.MeshBasicMaterial({
          map: s.loader.load("res/golf_bottom.png")
        }), D = new i.CircleGeometry(2 * s.BLOCK.radius / 38 * 25 + .01, 30), E = new x({
          map: s.loader.load("res/golf_top.png")
        }), u = new i.Geometry, m = [R, E];
        z.rotateY(3), this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), D.rotateX(-Math.PI / 2), D.rotateY(-.7), this.merge(u, D, 1, [{
          x: 0,
          y: this.height / 2 + .01,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m), this.sphere = new i.Mesh(new i.SphereGeometry(.6, 10, 10), this.whiteMaterial), this.sphere.position.set(-8, -1, -1.5), this.obj.add(this.sphere);
        var le = new i.Mesh(new i.PlaneGeometry(2, 5), new i.MeshBasicMaterial({
          map: s.loader.load("res/flag.png"),
          transparent: !0
        }));
        this.body.add(le), le.position.set(-4.4, 5, -4.3), le.rotation.y = -Math.PI / 4, le.rotation.x = -.928, le.rotation.z = -Math.PI / 5
      } else if (28 == t) {
        this.radiusSegments = 50;
        z = new i.CylinderGeometry(2 * s.BLOCK.radius / 38 * 15, 2 * s.BLOCK.radius / 38 * 15, this.height, 50);
        this.geometry = z, this.shadow.scale.set(30 / 38, 30 / 38, 30 / 38);
        R = new i.MeshBasicMaterial({
          map: s.loader.load("res/paper_bottom.png")
        }), D = new i.CircleGeometry(2 * s.BLOCK.radius / 38 * 15 + .01, 30), E = new x({
          map: s.loader.load("res/paper_top.png")
        }), u = new i.Geometry, m = [R, E];
        z.rotateY(4), this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), D.rotateX(-Math.PI / 2), D.rotateY(-.7), this.merge(u, D, 1, [{
          x: 0,
          y: this.height / 2 + .01,
          z: 0
        }]), this.shadow.scale.y = 1.1, this.hitObj = new i.Mesh(u, m)
      } else if (29 == t) {
        this.radiusSegments = 50, this.min = .8, this.height = s.BLOCK.height / 21 * 4;
        z = new i.CylinderGeometry(.4 * s.BLOCK.radius, .4 * s.BLOCK.radius, this.height, 50);
        this.geometry = z;
        R = C, D = new i.CircleGeometry(.4 * s.BLOCK.radius, 50), E = new i.MeshBasicMaterial({
          color: 16777215
        }), W = new i.CylinderGeometry(.4 * s.BLOCK.radius, .5 * s.BLOCK.radius, s.BLOCK.height / 21 * 1, 50), P = new i.CylinderGeometry(.5 * s.BLOCK.radius, .5 * s.BLOCK.radius, s.BLOCK.height / 21 * 16, 50), F = new i.MeshBasicMaterial({
          map: s.loader.load("res/medicine.png")
        }), u = new i.Geometry, m = [R, E, F];
        this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), D.rotateX(-Math.PI / 2), this.merge(u, D, 1, [{
          x: 0,
          y: this.height / 2 + .01,
          z: 0
        }]), this.merge(u, W, 1, [{
          x: 0,
          y: -s.BLOCK.height / 21 * 2.5,
          z: 0
        }]), P.rotateY(2.3), this.merge(u, P, 2, [{
          x: 0,
          y: -s.BLOCK.height / 21 * 11,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m), this.shadow.scale.set(.55, .9, .7)
      } else if (30 == t) {
        z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius);
        this.geometry = z;
        R = new i.MeshLambertMaterial({
          map: s.loader.load("res/luban.png")
        });
        this.mapUv(338, 338, z, 1, 0, 128, 208, 0), this.mapUv(338, 338, z, 2, 0, 128, 210, 338), this.mapUv(338, 338, z, 4, 210, 129, 337, 338);
        var de = new i.MeshLambertMaterial({
            color: 2199e3
          }),
          me = new i.Mesh(new i.BoxGeometry(10, .4, 1.5), de),
          ce = new i.MeshLambertMaterial({
            color: 4531468
          }),
          ue = new i.MeshLambertMaterial({
            color: 8037621
          });
        this.earBlack = new i.Mesh(new i.BoxGeometry(1.2, 3.5, 3.5), ce), this.earBlue = new i.Mesh(new i.BoxGeometry(1, 2.5, 2.5), ue), me.position.set(0, .8, 5.75), this.body.add(me), this.earBlack.position.set(-5.4, 0, 0), this.earBlue.position.set(-6, 0, 0), this.body.add(this.earBlue), this.body.add(this.earBlack), this.hitObj = new i.Mesh(z, R), this.music姓th = "luban", this.score = 20;
        D = new i.PlaneGeometry(2, 2);
        this.icons = [];
        var pe = s.loader.load("res/music_icon_two.png");
        for (q = 0; q < 4; ++q) this.icons[q] = new i.Mesh(D, new i.MeshBasicMaterial({
          map: pe,
          transparent: !0
        })), this.icons[q].rotation.y = -Math.PI / 4, this.icons[q].rotation.x = -Math.PI / 5, this.icons[q].rotation.z = -Math.PI / 5, this.body.add(this.icons[q]), this.icons[q].scale.set(.6, .6, .6);
        this.succeedTimer = this.playLubanMusic, this.whenLeave = this.stopLubanMusic
      } else if (31 == t) {
        this.canChange = !1, this.height = s.BLOCK.height / 21 * 7;
        z = new i.BoxGeometry(2 * s.BLOCK.radius / 38 * 45, this.height, 2 * s.BLOCK.radius / 38 * 45);
        this.geometry = z;
        P = new i.BoxGeometry(2 * s.BLOCK.radius / 38 * 40, s.BLOCK.height / 21 * 14, 2 * s.BLOCK.radius / 38 * 40);
        this.shadow.scale.set(40 / 38, 1.4, 1), this.map = s.loader.load("res/wechat_close.png"), this.topMap = s.loader.load("res/wechat_top.png");
        m = [R = new i.MeshLambertMaterial({
          map: this.topMap
        }), F = new i.MeshBasicMaterial({
          map: this.map,
          transparent: !0
        })], u = new i.Geometry;
        this.mapUv(340, 340, z, 1, 0, 0, 280, 60), this.mapUv(340, 340, z, 2, 0, 60, 280, 340), this.mapUv(340, 340, z, 4, 280, 60, 340, 340), this.merge(u, z, 0, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.mapUv(434, 164, P, 1, 0, 0, 217, 164), this.mapUv(434, 164, P, 4, 217, 0, 434, 164, !0), this.merge(u, P, 1, [{
          x: 0,
          y: -s.BLOCK.height / 21 * 10.5,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m);
        Q = new i.PlaneGeometry(2.5, 3.34);
        this.door = new i.Mesh(Q, new i.MeshBasicMaterial({
          map: s.loader.load("res/wechat_door.png"),
          transparent: !0
        })), this.door.rotation.y = -Math.PI / 2, this.door.position.set(-s.BLOCK.radius / 38 * 40 - .05, -2.9, 1.2), this.door.visible = !1, this.body.add(this.door), this.secondDoor = new i.Mesh(Q, new i.MeshBasicMaterial({
          map: s.loader.load("res/wechat_second_door.png"),
          transparent: !0
        })), this.secondDoor.visible = !1, this.secondDoor.rotation.y = -Math.PI / 2, this.secondDoor.position.set(-s.BLOCK.radius / 38 * 40 - .05, -2.9, -1.2), this.body.add(this.secondDoor), this.glowMap = s.loader.load("res/wechat_open.png"), this.glowTopMap = s.loader.load("res/wechat_glow_top.png"), this.succeedTimer = function() {
          5 != this.score && (this.hitObj.material[1].map = this.glowMap, this.hitObj.material[0].map = this.glowTopMap, this.logo.visible = !1, this.glowLogo.visible = !0, this.door.visible = !0, this.secondDoor.visible = !0)
        }, this.glowLogo = new i.Object3D, this.logo = new i.Object3D;
        W = new i.CylinderGeometry(1.8, 1.8, .5, 30);
        var ye = new i.MeshLambertMaterial({
            color: 3457369
          }),
          we = (N = new i.MeshLambertMaterial({
            color: 5879160
          }), new i.Mesh(W, N)),
          ge = new i.Mesh(W, ye);
        (D = new i.CircleGeometry(1.8, 30)).rotateX(Math.PI / 2), D.rotateY(-Math.PI / 2);
        E = new i.MeshBasicMaterial({
          map: s.loader.load("res/wechat_logo.png")
        });
        var Me = new i.MeshBasicMaterial({
            map: s.loader.load("res/wechat_glow_logo.png")
          }),
          Be = new i.Mesh(D, E),
          Oe = new i.Mesh(D, Me);
        this.logo.add(we), Be.position.y = -.251, this.logo.add(Be), this.logo.position.x = -6.5, this.logo.rotation.z = -Math.PI / 2, this.body.add(this.logo), Oe.position.y = -.251, this.glowLogo.add(Oe), this.glowLogo.add(ge), this.glowLogo.position.x = -6.5, this.glowLogo.rotation.z = -Math.PI / 2, this.glowLogo.visible = !1, this.body.add(this.glowLogo), this.music姓th = "pay", this.registerAudio = function() {
          5 != d.score && (a.customAnimation.to(d.door.position, 1, {
            z: 2.2
          }), a.customAnimation.to(d.secondDoor.position, 1, {
            z: -1.9
          }))
        }, this.registerEndAudio = function() {
          5 != d.score && (a.customAnimation.to(d.door.position, 1, {
            z: 1.2
          }), a.customAnimation.to(d.secondDoor.position, 1, {
            z: -1.2
          }))
        }, this.beforePopup = function() {
          d.hitObj.material[1].map = d.map, d.hitObj.material[0].map = d.topMap, d.logo.visible = !0, d.glowLogo.visible = !1, d.door.visible = !1, d.secondDoor.visible = !1
        }, this.score = 20
      } else if (32 == t) {
        this.canChange = !1;
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, p = 3, v = (s.BLOCK.height - p) / 2, K = new i.BoxGeometry(2 * s.BLOCK.radius, v, 2 * s.BLOCK.radius);
        this.geometry = K;
        f = new i.BoxGeometry(2 * s.BLOCK.radius, p, 2 * s.BLOCK.radius);
        this.merge(u, K, 0, [{
          x: 0,
          y: -p / 2 - v / 2,
          z: 0
        }, {
          x: 0,
          y: p / 2 + v / 2,
          z: 0
        }]), this.merge(u, f, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m);
        W = new i.CylinderGeometry(1.5, 1.5, .4, 30);
        var Le = new i.Mesh(W, new i.MeshLambertMaterial({
          color: 9099465
        }));
        (D = new i.CircleGeometry(1.5, 30)).rotateX(Math.PI / 2), D.rotateY(-Math.PI / 2);
        E = new i.MeshBasicMaterial({
          map: s.loader.load("res/relax_back.png")
        });
        var be = new i.MeshBasicMaterial({
            map: s.loader.load("res/relax_front.png"),
            side: i.DoubleSide
          }),
          Ce = new i.Mesh(D, E),
          xe = new i.Mesh(D, be);
        this.board = new i.Object3D, Ce.position.y = -.21, xe.position.y = .21, this.board.add(Ce), this.board.add(xe), this.board.add(Le), this.board.rotation.z = -Math.PI / 2, this.board.position.set(6.7, 3.5, 6.7), this.obj.add(this.board);
        var ve = new i.Mesh(W, this.greenMaterial),
          Ke = new i.Mesh(W, this.greenMaterial);
        Ke.scale.set(1, 1, 1), Ke.position.set(6.7, -2, 6.7), this.obj.add(Ke), ve.scale.set(.7, .7, .7), ve.position.set(6.7, -1.5, 6.7), this.obj.add(ve);
        var fe = ve.clone();
        fe.scale.set(.1, 11, .1), fe.position.set(6.7, 0, 6.7), this.obj.add(fe), this.perFrame = function() {
          d.board.rotation.y += .01
        }, this.score = -20, this.music姓th = "relax"
      } else if (33 == t) {
        this.canChange = !1;
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, p = 3, v = (s.BLOCK.height - p) / 2, K = new i.BoxGeometry(2 * s.BLOCK.radius, v, 2 * s.BLOCK.radius);
        this.geometry = K;
        f = new i.BoxGeometry(2 * s.BLOCK.radius, p, 2 * s.BLOCK.radius);
        this.merge(u, K, 0, [{
          x: 0,
          y: -p / 2 - v / 2,
          z: 0
        }, {
          x: 0,
          y: p / 2 + v / 2,
          z: 0
        }]), this.merge(u, f, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (34 == t) {
        this.canChange = !1;
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, p = 3, v = (s.BLOCK.height - p) / 2, K = new i.BoxGeometry(2 * s.BLOCK.radius, v, 2 * s.BLOCK.radius);
        this.geometry = K;
        f = new i.BoxGeometry(2 * s.BLOCK.radius, p, 2 * s.BLOCK.radius);
        this.merge(u, K, 0, [{
          x: 0,
          y: -p / 2 - v / 2,
          z: 0
        }, {
          x: 0,
          y: p / 2 + v / 2,
          z: 0
        }]), this.merge(u, f, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (35 == t) {
        this.canChange = !1;
        m = [this.greenMaterial, this.whiteMaterial], u = new i.Geometry, p = 3, v = (s.BLOCK.height - p) / 2, K = new i.BoxGeometry(2 * s.BLOCK.radius, v, 2 * s.BLOCK.radius);
        this.geometry = K;
        f = new i.BoxGeometry(2 * s.BLOCK.radius, p, 2 * s.BLOCK.radius);
        this.merge(u, K, 0, [{
          x: 0,
          y: -p / 2 - v / 2,
          z: 0
        }, {
          x: 0,
          y: p / 2 + v / 2,
          z: 0
        }]), this.merge(u, f, 1, [{
          x: 0,
          y: 0,
          z: 0
        }]), this.hitObj = new i.Mesh(u, m)
      } else if (-1 == t) {
        var Ge = [15622240, 14980702, 15712087, 9089870, 7451844, 6519997, 10772948];
        z = O, R = new i.MeshLambertMaterial({
          color: Ge[o],
          transparent: !0
        });
        this.hitObj = new i.Mesh(z, R);
        var ze = new i.BoxGeometry(2 * s.BLOCK.radius, s.BLOCK.height, 2 * s.BLOCK.radius);
        this.mapUv(100, 88, ze, 2, 0, 0, 5, 5);
        var je = new i.Mesh(ze, M);
        0 == o && (je.receiveShadow = !0), this.body.add(je);
        var Pe, Ie, _e, Ue;
        D = new i.PlaneGeometry(4, 8);
        _e = (Pe = o % 4 * 64) + 64, Ue = (Ie = 128 * parseInt(o / 4)) + 128, this.mapUv(256, 256, D, 0, Pe, Ue, _e, Ie), (Ce = new i.Mesh(D, B)).rotation.x = -Math.PI / 2, Ce.rotation.z = -Math.PI / 2, Ce.position.y = s.BLOCK.height / 2 + .05, this.body.add(Ce), this.obj.scale.set(.7, 1, .7)
      } else {
        var ke = arguments[1];
        if (1 == ke.block_type) {
          z = new i.BoxGeometry(2 * s.BLOCK.radius, this.height, 2 * s.BLOCK.radius), R = new i.MeshLambertMaterial({
            map: s.loader.load("".concat(wx.env.USER_DATA_PATH, "/").concat(ke.block_res_list[0].path))
          });
          this.mapUv(428, 428, z, 1, 0, 0, 280, 148), this.mapUv(428, 428, z, 2, 0, 148, 280, 428), this.mapUv(428, 428, z, 4, 280, 148, 428, 428), this.hitObj = new i.Mesh(z, R), this.shadow.position.set(0, -s.BLOCK.height / 2 - .001, -4.5)
        } else if (2 == ke.block_type) {
          this.radiusSegments = 50;
          z = new i.CylinderGeometry(s.BLOCK.radius, s.BLOCK.radius, this.height, 50);
          this.geometry = z;
          R = new i.MeshBasicMaterial({
            map: s.loader.load("".concat(wx.env.USER_DATA_PATH, "/").concat(ke.block_res_list[0].path))
          }), D = new i.CircleGeometry(s.BLOCK.radius + .01, 30), E = new x({
            map: s.loader.load("".concat(wx.env.USER_DATA_PATH, "/").concat(ke.block_res_list[1].path))
          }), u = new i.Geometry, m = [R, E];
          z.rotateY(3), this.merge(u, z, 0, [{
            x: 0,
            y: 0,
            z: 0
          }]), D.rotateX(-Math.PI / 2), D.rotateY(-.7), this.merge(u, D, 1, [{
            x: 0,
            y: this.height / 2 + .01,
            z: 0
          }]), this.hitObj = new i.Mesh(u, m), this.shadow = new i.Mesh(b, y), this.shadow.position.set(-.1, -s.BLOCK.height / 2 - .001, -2.8), this.shadow.scale.y = 1.4, this.shadow.scale.x = 1, this.shadow.rotation.x = -Math.PI / 2
        }
        ke.ad && (this.isAd = !0, this.trademark_url = "block_".concat(ke.id, "/trade"), this.ad_url = ke.ad.activity_url), this.score = ke.score
      }
      this.shadow.initZ = this.shadow.position.z, this.hitObj.receiveShadow = !0, this.hitObj.name = "hitObj", this.body.add(this.hitObj), this.hitObj.matrixAutoUpdate = !1, this.shadow.initScale = this.shadow.scale.y, this.body.position.y = s.BLOCK.height / 2 - this.height / 2, this.obj.add(this.shadow), this.obj.add(this.body)
    }
    return t(h, [{
      key: "merge",
      value: function(e, t, s, a) {
        for (var o = 0, h = t.faces.length; o < h; ++o) t.faces[o].materialIndex = 0;
        var r = new i.Mesh(t);
        for (o = 0, h = a.length; o < h; ++o) r.position.set(a[o].x, a[o].y, a[o].z), r.updateMatrix(), e.merge(r.geometry, r.matrix, s)
      }
    }, {
      key: "_mapUv",
      value: function(e, t, s, a, o, h, r, n, l) {
        var d = 1 / e,
          m = 1 / t;
        if (s.faces[a] instanceof i.Face3) {
          var c = s.faceVertexUvs[0][2 * a];
          4 == a && !l || 2 == a && l ? (c[0].x = o * d, c[0].y = h * m, c[2].x = o * d, c[2].y = n * m, c[1].x = r * d, c[1].y = h * m) : (c[0].x = o * d, c[0].y = h * m, c[1].x = o * d, c[1].y = n * m, c[2].x = r * d, c[2].y = h * m);
          c = s.faceVertexUvs[0][2 * a + 1];
          4 == a && !l || 2 == a && l ? (c[2].x = o * d, c[2].y = n * m, c[1].x = r * d, c[1].y = n * m, c[0].x = r * d, c[0].y = h * m) : (c[0].x = o * d, c[0].y = n * m, c[1].x = r * d, c[1].y = n * m, c[2].x = r * d, c[2].y = h * m)
        }
      }
    }, {
      key: "mapUv",
      value: function(e, t, i, s, a, o, h, r, n) {
        if (s.length)
          for (var l = 0; l < s.length; ++l) this._mapUv(e, t, i, s[l], a, o, h, r, n);
        else this._mapUv(e, t, i, s, a, o, h, r, n)
      }
    }, {
      key: "showLight",
      value: function(e) {
        var t = this;
        this.light.visible = !0, this.light.material.opacity = 0, this.light.position.set(e.x - this.obj.position.x, 5.6, e.z - this.obj.position.z), this.light.scale.set(1 / this.radiusScale, 1, 1 / this.radiusScale), a.customAnimation.to(this.light.material, 1, {
          opacity: 1
        }), setTimeout((function() {
          t.hideLight()
        }), 1500)
      }
    }, {
      key: "hideLight",
      value: function() {
        var e = this;
        a.customAnimation.to(this.light.material, .5, {
          opacity: 0,
          onComplete: function() {
            e.light.visible = !1
          }
        })
      }
    }, {
      key: "hideLightImediate",
      value: function() {
        this.light.visible = !1
      }
    }, {
      key: "getBox",
      value: function() {
        return this.boundingBox || (this.boundingBox = (new i.Box3).setFromObject(this.body)), this.boundingBox
      }
    }, {
      key: "glow",
      value: function() {
        this.hitObj.material.map = this.glowMap
      }
    }, {
      key: "wechatGlow",
      value: function() {}
    }, {
      key: "openDoor",
      value: function() {
        a.customAnimation.to(this.door.position, 1, {
          z: -4.5
        }), a.customAnimation.to(this.secondDoor.position, 1, {
          z: -.5
        })
      }
    }, {
      key: "closeDoor",
      value: function() {
        a.customAnimation.to(this.door.position, 1, {
          z: -3.3
        }), a.customAnimation.to(this.secondDoor.position, 1, {
          z: -1.7
        })
      }
    }, {
      key: "rotateBox",
      value: function() {
        a.customAnimation.to(this.middle.rotation, .5, {
          y: -Math.PI / 2
        })
      }
    }, {
      key: "playLubanMusic",
      value: function() {
        var e = this,
          t = function() {
            e.icons[0].position.set(1, 7, -1), e.icons[1].position.set(-1, 7, -1), e.icons[2].position.set(1, 7, 1), e.icons[3].position.set(-1, 7, 1);
            for (var t = 0, i = e.icons.length; t < i; ++t) e.icons[t].material.opacity = 0, a.customAnimation.to(e.icons[t].position, .7, {
              y: 12,
              ease: "Cubic.easeIn",
              delay: .1 * t
            }), a.customAnimation.to(e.icons[t].position, .7, {
              x: 0 == t || 2 == t ? 3 : -3,
              delay: .1 * t
            }), a.customAnimation.to(e.icons[t].material, .7, {
              opacity: 1,
              delay: .1 * t
            }), a.customAnimation.to(e.icons[t].position, .7, {
              y: 17,
              ease: "Cubic.easeOut",
              delay: .1 * t + .7
            }), a.customAnimation.to(e.icons[t].position, .7, {
              x: 0 == t || 2 == t ? 1 : -1,
              delay: .1 * t + .7
            }), a.customAnimation.to(e.icons[t].material, .7, {
              opacity: 0,
              delay: .1 * t + .7
            })
          };
        setTimeout((function() {
          t()
        }), 1e3), this.lubanMusicTimer = setInterval((function() {
          t()
        }), 3e3);
        var i = function() {
          for (var t = 0; t < 15; ++t) a.customAnimation.to(e.earBlack.scale, .2, {
            y: 1.3,
            z: 1.3,
            delay: .4 * t
          }), a.customAnimation.to(e.earBlue.scale, .2, {
            y: 1.3,
            z: 1.3,
            delay: .4 * t
          }), a.customAnimation.to(e.earBlack.scale, .2, {
            y: 1,
            z: 1,
            delay: .4 * t + .2
          }), a.customAnimation.to(e.earBlue.scale, .2, {
            y: 1,
            z: 1,
            delay: .4 * t + .2
          })
        };
        i(), this.earTimer = setInterval((function() {
          i()
        }), 9e3)
      }
    }, {
      key: "raceAnim",
      value: function(e, t) {
        for (var i = this, s = [{
            x: .8,
            y: 3,
            z: 0
          }, {
            x: 3,
            y: 1.5,
            z: 3
          }, {
            x: -3,
            y: 2.5,
            z: -2.5
          }, {
            x: 3,
            y: 0,
            z: 3
          }], o = 0; o < 4; ++o) this.icons[o].material.opacity = 0, this.icons[o].position.x = t.x - this.obj.position.x + .2, this.icons[o].position.y = 9, this.icons[o].position.z = t.z - this.obj.position.z - .2, setTimeout(function(e) {
          a.customAnimation.to(this.icons[e].material, .9, {
            opacity: 1
          }), a.customAnimation.to(this.icons[e].material, .6, {
            opacity: 0,
            delay: 1
          }), a.customAnimation.to(this.icons[e].position, 1.6, {
            x: this.icons[e].position.x + s[e].x,
            y: this.icons[e].position.y + s[e].y,
            z: this.icons[e].position.z + s[e].z
          })
        }.bind(this, o), 300 * o);
        this.raceAnimTimer = setTimeout((function() {
          i.raceAnim(e, t)
        }), 4e3)
      }
    }, {
      key: "stopRaceAnim",
      value: function() {
        this.raceAnimTimer && (clearTimeout(this.raceAnimTimer), this.raceAnimTimer = null)
      }
    }, {
      key: "stopLubanMusic",
      value: function() {
        this.earTimer && (clearTimeout(this.earTimer), this.earTimer = null), this.lubanMusicTimer && (clearTimeout(this.lubanMusicTimer), this.lubanMusicTimer = null)
      }
    }, {
      key: "playMusic",
      value: function() {
        for (var e = this, t = 0; t < 2; ++t) setTimeout(function(e) {
          return function() {
            e.visible = !0, e.position.set(0, 0, 0), e.material.opacity = 1, a.customAnimation.to(e.position, 2, {
              x: 5 * (1 - 2 * Math.random()),
              y: 15,
              z: 5 * (1 - 2 * Math.random())
            }), a.customAnimation.to(e.material, 2, {
              opacity: 0
            })
          }
        }(this.icons[t]), 1e3 * t);
        this.musicTimer = setTimeout((function() {
          e.playMusic()
        }), 2500)
      }
    }, {
      key: "stopMusic",
      value: function() {
        this.musicTimer && (clearTimeout(this.musicTimer), this.musicTimer = null)
      }
    }, {
      key: "change",
      value: function(e, t, i) {
        if (this.canChange) {
          if (this.order >= 9) {
            var a = this.order >= 13 ? .7 : .6;
            return this.radiusScale = i || Math.max((0, o.random)() * (s.BLOCK.maxRadiusScale - s.BLOCK.minRadiusScale) + s.BLOCK.minRadiusScale, this.min || a), this.radiusScale = +this.radiusScale.toFixed(2), this.radius = e || this.radiusScale * s.BLOCK.radius, this.radius = +this.radius.toFixed(2), void this.obj.scale.set(this.radiusScale, 1, this.radiusScale)
          }
          this.radiusScale = i || (0, o.random)() * (s.BLOCK.maxRadiusScale - s.BLOCK.minRadiusScale) + s.BLOCK.minRadiusScale, this.radiusScale = +this.radiusScale.toFixed(2), this.radius = e || this.radiusScale * s.BLOCK.radius, this.radius = +this.radius.toFixed(2), this.obj.scale.set(this.radiusScale, 1, this.radiusScale), this.changeColor(t)
        }
      }
    }, {
      key: "changeColor",
      value: function(e) {
        var t = e || this.types[Math.floor(3 * Math.random())];
        this.type != t && (this.type = t, "green" == t ? (this.greenMaterial.color.setHex(r), this.whiteMaterial.color.setHex(n), this.middleLightGreenMaterial && this.middleLightGreenMaterial.color.setHex(c)) : "gray" == t ? (this.greenMaterial.color.setHex(n), this.whiteMaterial.color.setHex(l), this.middleLightGreenMaterial && this.middleLightGreenMaterial.color.setHex(u)) : "black" == t && (this.greenMaterial.color.setHex(d), this.whiteMaterial.color.setHex(m), this.middleLightGreenMaterial && this.middleLightGreenMaterial.color.setHex(p)))
      }
    }, {
      key: "getVertices",
      value: function() {
        var e = this,
          t = [],
          i = this.geometry || this.hitObj.geometry;
        if (this.obj.updateMatrixWorld(), 4 === this.radiusSegments)[0, 1, 4, 5].forEach((function(s) {
          var a = i.vertices[s].clone().applyMatrix4(e.hitObj.matrixWorld);
          t.push([a.x, a.z])
        }));
        else
          for (var s = 0; s < this.radiusSegments; ++s) {
            var a = i.vertices[s].clone().applyMatrix4(this.hitObj.matrixWorld);
            t.push([a.x, a.z])
          }
        return t
      }
    }, {
      key: "relayLimitTime",
      value: function(e) {
        this.limitTime = e
      }
    }, {
      key: "shrink",
      value: function() {
        this.status = "shrink", this.prepareTime = 0
      }
    }, {
      key: "_shrink",
      value: function(e) {
        if (!(void 0 !== this.limitTime && this.prepareTime > this.limitTime))
          if (this.scale -= s.BLOCK.reduction, this.scale = Math.max(s.BLOCK.minScale, this.scale), this.scale <= s.BLOCK.minScale) this.status = "stop";
          else {
            this.body.scale.y = this.scale, this.shadow.scale.y -= s.BLOCK.reduction / 2, this.shadow.position.z += s.BLOCK.reduction / 4 * this.shadowWidth;
            var t = s.BLOCK.reduction / 2 * s.BLOCK.height * (s.BLOCK.height - this.height / 2) / s.BLOCK.height * 2;
            this.body.position.y -= t, this.prepareTime += e
          }
      }
    }, {
      key: "showup",
      value: function(e) {
        var t = this.shadow.position.z;
        this.body.position.set(0, 20, 0), this.shadow.position.z = -15, this.obj.visible = !0, 3 == e || 4 == e || 6 == e ? this.obj.position.set(7.5 * (6 == e ? 5 : 3), 0, 3.8 * (3 == e || 6 == e ? -1 : 1)) : 5 == e ? this.obj.position.set(30, 0, 0) : this.obj.position.set(7.5 * e, 0, 0), (0, a.TweenAnimation)(this.body.position.y, s.BLOCK.height / 2 - this.height / 2, 500, "Bounce.easeOut", function(e, t) {
          this.body.position.y = e
        }.bind(this)), (0, a.TweenAnimation)(this.shadow.position.z, t, 500, "Bounce.easeOut", function(e, t) {
          this.shadow.position.z = e
        }.bind(this))
      }
    }, {
      key: "hideGlow",
      value: function() {
        this.hitObj.material.map = this.map
      }
    }, {
      key: "popup",
      value: function() {
        var e = this;
        if (this.beforePopup && this.beforePopup(), 25 == this.order) {
          for (var t = 0; t < 10; ++t)
            for (var i = 0; i < 4; ++i) this.numbers[t][i].visible = !1;
          var o = new Date,
            h = ("0" + o.getHours()).slice(-2),
            r = ("0" + o.getMinutes()).slice(-2);
          this.numbers[h[0]][0].position.x = -3.1 * this.radiusScale, this.numbers[h[0]][0].visible = !0, this.numbers[h[1]][1].position.x = -1.2 * this.radiusScale, this.numbers[h[1]][1].visible = !0, this.numbers[r[0]][2].position.x = 1.2 * this.radiusScale, this.numbers[r[0]][2].visible = !0, this.numbers[r[1]][3].position.x = 3.1 * this.radiusScale, this.numbers[r[1]][3].visible = !0
        } else 17 == this.order && (this.middle.rotation.y = 0);
        var n = this.shadow.position.z;
        this.body.position.y = 20, this.shadow.position.z = -15, this.obj.visible = !0, this.boundingBox = null, a.customAnimation.to(this.body.position, .5, {
          y: s.BLOCK.height / 2 - this.height / 2,
          ease: "Bounce.easeOut",
          onEnded: function() {
            e.body.position.y = s.BLOCK.height / 2 - e.height / 2
          }
        }), a.customAnimation.to(this.shadow.position, .5, {
          z: n,
          ease: "Bounce.easeOut",
          onEnded: function() {
            e.shadow.position.z = n
          }
        })
      }
    }, {
      key: "reset",
      value: function() {
        this.status = "stop", this.scale = 1, this.obj.scale.y = 1, this.body.scale.y = 1, this.obj.position.y = 0, this.body.position.y = s.BLOCK.height / 2 - this.height / 2, this.shadow.scale.y = this.shadow.initScale, this.shadow.position.z = this.shadow.initZ, this.boundingBox = null, this.limitTime = void 0
      }
    }, {
      key: "rebound",
      value: function() {
        this.limitTime = void 0, this.status = "stop", this.scale = 1, a.customAnimation.to(this.body.scale, .5, {
          ease: "Elastic.easeOut",
          y: 1
        }), a.customAnimation.to(this.body.position, .5, {
          ease: "Elastic.easeOut",
          y: s.BLOCK.height / 2 - this.height / 2
        }), a.customAnimation.to(this.shadow.scale, .5, {
          ease: "Elastic.easeOut",
          y: this.shadow.initScale
        }), a.customAnimation.to(this.shadow.position, .5, {
          ease: "Elastic.easeOut",
          z: this.shadow.initZ
        })
      }
    }, {
      key: "update",
      value: function(e) {
        this.perFrame && this.perFrame(), "stop" !== this.status && ("shrink" === this.status ? this._shrink(e) : this.status)
      }
    }]), h
  }();
exports.default = v;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./config":37,"./lib/animation":66,"./lib/three":70,"./random":118}],34:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../@babel/runtime/helpers/createClass"),
  i = require("../@babel/runtime/helpers/classCallCheck"),
  e = function(t, i) {
    if (!i && t && t.__esModule) return t;
    if (null === t || "object" != typeof t && "function" != typeof t) return {
      default: t
    };
    var e = r(i);
    if (e && e.has(t)) return e.get(t);
    var o = {},
      s = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var a in t)
      if ("default" !== a && Object.prototype.hasOwnProperty.call(t, a)) {
        var n = s ? Object.getOwnPropertyDescriptor(t, a) : null;
        n && (n.get || n.set) ? Object.defineProperty(o, a, n) : o[a] = t[a]
      } o.default = t, e && e.set(t, o);
    return o
  }(require("./lib/three")),
  o = require("./lib/animation"),
  s = require("./config"),
  a = h(require("./lib/mue/eventcenter")),
  n = h(require("./text"));

function h(t) {
  return t && t.__esModule ? t : {
    default: t
  }
}

function r(t) {
  if ("function" != typeof WeakMap) return null;
  var i = new WeakMap,
    e = new WeakMap;
  return (r = function(t) {
    return t ? e : i
  })(t)
}
var l = t((function t() {
    i(this, t);
    var o = new e.CylinderGeometry(.8, .8, .5, 15, 1, !0),
      s = new e.CylinderGeometry(.65, .65, .5, 15, 1, !0),
      a = new e.RingGeometry(.65, .8, 10);
    this.obj = new e.Object3D;
    var n = new e.MeshLambertMaterial({
        color: 14110276,
        side: e.DoubleSide
      }),
      h = new e.Mesh(o, n),
      r = new e.Mesh(s, n),
      l = new e.Mesh(a, n);
    this.obj.add(h), this.obj.add(r), l.rotation.x = -Math.PI / 2, l.position.y = .25, this.obj.add(l);
    var c = new e.BoxGeometry(1, .25, .5);
    c.vertices[1].y -= .2, c.vertices[0].y -= .2;
    var u = new e.Mesh(c, new e.MeshLambertMaterial({
      color: 13059648
    }));
    u.position.set(-1, -.2, 0), u.rotation.z = .5, this.obj.scale.set(.9, .9, .9), this.obj.add(u)
  })),
  c = t((function t() {
    i(this, t);
    var o = new e.CylinderGeometry(.73, .68, 1, 20),
      s = new e.CylinderGeometry(1.5, 1.5, .2, 20),
      a = new e.CylinderGeometry(.68, .65, .3, 15);
    this.obj = new e.Object3D;
    var n = new e.MeshLambertMaterial({
        color: 4605510
      }),
      h = new e.Mesh(s, n),
      r = new e.Mesh(a, new e.MeshLambertMaterial({
        color: 14110276
      })),
      l = new e.Mesh(o, n);
    r.position.y = .25, l.position.y = .9, this.obj.add(h), this.obj.add(r), this.obj.add(l)
  })),
  u = function() {
    function h() {
      var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
        o = t.getSelectedBottleSkinResourceSync,
        a = void 0 === o ? function() {} : o;
      i(this, h), this.getSelectedBottleSkinResourceSync = a, this.obj = new e.Object3D, this.obj.name = "bottle", this.trail = null, this.bottle = new e.Object3D, this.maps = {}, this.scarf = new l, this.scarf.obj.position.y = -1.5, this.scarf.obj.visible = !1, this.hat = new c, this.hat.obj.position.y = 1, this.hat.obj.scale.set(.8, .8, .8), this.hat.obj.visible = !1, this.checkSkin();
      var r = 2.1 * .45;
      this.human = new e.Object3D, this.head = new e.Mesh(new e.SphereGeometry(r, 17, 17), this.headMaterial), this.head.castShadow = !0, this.bottom = new e.Mesh(new e.CylinderGeometry(.88 * r, 1.27 * r, 2.68 * r, 20), this.bottomMaterial), this.bottom.rotation.y = 4.7, this.bottom.castShadow = !0;
      var u = new e.CylinderGeometry(r, .88 * r, 1.2 * r, 15),
        d = [this.middleMaterial, this.middleTopMaterial],
        m = new e.Geometry;
      u.rotateY(4.7), this.merge(m, u, 0, [{
        x: 0,
        y: this.bottom.position.y + 1.94 * r,
        z: 0
      }]);
      var p = new e.SphereGeometry(r, 17, 17);
      p.scale(1, .54, 1), this.merge(m, p, 1, [{
        x: 0,
        y: this.bottom.position.y + 2.54 * r,
        z: 0
      }]), this.middle = new e.Mesh(m, d), this.middle.castShadow = !0, this.body = new e.Object3D, this.body.add(this.bottom), this.body.add(this.middle), this.human.add(this.body), this.head.position.y = 4.725, this.human.add(this.head), this.bottle.add(this.human), this.bottle.position.y = s.BOTTLE.bodyHeight / 2 - .25, this.obj.add(this.bottle), this.head.add(this.scarf.obj), this.head.add(this.hat.obj), this.status = "stop", this.scale = 1, this.double = 1, this.velocity = {}, this.flyingTime = 0, this.direction = "straight", this.jumpStatus = "init", this.particles = [];
      for (var y = new e.MeshBasicMaterial({
          map: s.loader.load("res/white.png"),
          alphaTest: .5
        }), b = new e.MeshBasicMaterial({
          map: s.loader.load("res/green.png"),
          alphaTest: .5
        }), f = new e.PlaneGeometry(1, 1), v = 0; v < 15; ++v) {
        (M = new e.Mesh(f, y)).rotation.y = -Math.PI / 4, M.rotation.x = -Math.PI / 5, M.rotation.z = -Math.PI / 5, this.particles.push(M), this.obj.add(M)
      }
      for (v = 0; v < 5; ++v) {
        var M;
        (M = new e.Mesh(f, b)).rotation.y = -Math.PI / 4, M.rotation.x = -Math.PI / 5, M.rotation.z = -Math.PI / 5, this.particles.push(M), this.obj.add(M)
      }
      this.scoreText = new n.default("0", {
        fillStyle: 2434341,
        textAlign: "center",
        plus本次得分: !0
      }), this.scoreText.obj.visible = !1, this.scoreText.obj.rotation.y = -Math.PI / 4, this.scoreText.obj.scale.set(.5, .5, .5), this.obj.add(this.scoreText.obj)
    }
    return t(h, [{
      key: "merge",
      value: function(t, i, o, s) {
        for (var a = 0, n = i.faces.length; a < n; ++a) i.faces[a].materialIndex = 0;
        var h = new e.Mesh(i);
        for (a = 0, n = s.length; a < n; ++a) h.position.set(s[a].x, s[a].y, s[a].z), h.updateMatrix(), t.merge(h.geometry, h.matrix, o)
      }
    }, {
      key: "showAdd本次得分",
      value: function(t, i, e, a) {
        a || (i ? 1 === this.double ? this.double = 2 : this.double += 2 : this.double = 1, e && this.double <= 2 && (this.double *= 2), this.double = Math.min(32, this.double), t *= this.double), this.scoreText.set本次得分(t.toString()), this.scoreText.obj.visible = !0, this.scoreText.obj.position.y = 3, this.scoreText.material.opacity = 1, (0, o.TweenAnimation)(this.scoreText.obj.position.y, s.BOTTLE.bodyHeight + 6, 700, function(t) {
          void 0 !== t && (this.scoreText.obj.position.y = t)
        }.bind(this)), (0, o.TweenAnimation)(this.scoreText.material.opacity, 0, 700, function(t, i, e) {
          void 0 !== t && (this.scoreText.material.opacity = t, e && (this.scoreText.obj.visible = !1))
        }.bind(this))
      }
    }, {
      key: "change本次得分Pos",
      value: function(t) {
        this.scoreText.obj.position.z = t
      }
    }, {
      key: "resetParticles",
      value: function() {
        this.gatherTimer && clearTimeout(this.gatherTimer), this.gatherTimer = null;
        for (var t = 0, i = this.particles.length; t < i; ++t) this.particles[t].gathering = !1, this.particles[t].visible = !1, this.particles[t].scattering = !1
      }
    }, {
      key: "scatterParticles",
      value: function() {
        for (var t = 0; t < 10; ++t) this.particles[t].scattering = !0, this.particles[t].gathering = !1, this._scatterParticles(this.particles[t])
      }
    }, {
      key: "_scatterParticles",
      value: function(t) {
        var i = s.BOTTLE.bodyWidth / 2,
          e = (i + Math.random() * (2 - i)) * (1 - 2 * Math.random()),
          a = (i + Math.random() * (2 - i)) * (1 - 2 * Math.random());
        t.scale.set(1, 1, 1), t.visible = !1, t.position.x = e, t.position.y = -.5, t.position.z = a, setTimeout(function(t) {
          return function() {
            if (t.scattering) {
              t.visible = !0;
              var i = .3 + .2 * Math.random();
              o.customAnimation.to(t.scale, i, {
                x: .2,
                y: .2,
                z: .2
              }), o.customAnimation.to(t.position, i, {
                x: 2 * e,
                y: 2.5 * Math.random() + 2,
                z: 2 * a,
                onComplete: function() {
                  t.scattering = !1, t.visible = !1
                }
              })
            }
          }
        }(t), 0)
      }
    }, {
      key: "gatherParticles",
      value: function() {
        for (var t = this, i = 10; i < 20; ++i) this.particles[i].gathering = !0, this.particles[i].scattering = !1, this._gatherParticles(this.particles[i]);
        this.gatherTimer = setTimeout((function() {
          for (var i = 0; i < 10; ++i) t.particles[i].gathering = !0, t.particles[i].scattering = !1, t._gatherParticles(t.particles[i])
        }), 500 + 1e3 * Math.random())
      }
    }, {
      key: "_gatherParticles",
      value: function(t) {
        var i = this;
        t.scale.set(1, 1, 1), t.visible = !1;
        var e = Math.random() > .5 ? 1 : -1,
          s = Math.random() > .5 ? 1 : -1;
        t.position.x = (1 + 7 * Math.random()) * e, t.position.y = 1 + 7 * Math.random(), t.position.z = (1 + 7 * Math.random()) * s, setTimeout(function(t) {
          return function() {
            if (t.gathering) {
              t.visible = !0;
              var a = .5 + .4 * Math.random();
              (0, o.TweenAnimation)(t.scale.x, .8 + Math.random(), 1e3 * a, (function(i) {
                void 0 !== i && (t.scale.x = i)
              })), (0, o.TweenAnimation)(t.scale.y, .8 + Math.random(), 1e3 * a, (function(i) {
                void 0 !== i && (t.scale.y = i)
              })), (0, o.TweenAnimation)(t.scale.z, .8 + Math.random(), 1e3 * a, (function(i) {
                void 0 !== i && (t.scale.z = i)
              })), (0, o.TweenAnimation)(t.position.x, Math.random() * e, 1e3 * a, (function(i) {
                void 0 !== i && (t.position.x = i)
              })), (0, o.TweenAnimation)(t.position.y, 2.5 * Math.random(), 1e3 * a, (function(i) {
                void 0 !== i && (t.position.y = i)
              })), (0, o.TweenAnimation)(t.position.z, Math.random() * s, 1e3 * a, (function(e, o) {
                void 0 !== e && (t.position.z = e, o && t.gathering && i._gatherParticles(t))
              }))
            }
          }
        }(t), 500 * Math.random())
      }
    }, {
      key: "update",
      value: function(t) {
        "stop" != this.status && ("prepare" == this.status ? this._prepare(t) : "jump" == this.status ? this._jump(t) : "turn" == this.status && this.turn())
      }
    }, {
      key: "lookAt",
      value: function(t, i) {
        t !== this.direction && ("straight" === t ? (this.turnAngle = -Math.PI / 2, this.angle = 0) : (this.turnAngle = Math.PI / 2, this.angle = Math.PI / 2), this.direction = t)
      }
    }, {
      key: "turn",
      value: function() {
        var t = this.turnAngle > 0 ? .2 : -.2;
        this.bottle.rotation.y += t, this.turnAngle -= t, this.turnAngle >= -.2 && this.turnAngle <= .2 && (this.bottle.rotation.y = this.angle, this.status = "stop")
      }
    }, {
      key: "fall",
      value: function() {
        var t = this;
        this.stop(), setTimeout((function() {
          t.status = "fall", (0, o.TweenAnimation)(t.obj.position.y, -s.BLOCK.height / 2 - .3, 400, function(t) {
            void 0 !== t && (this.obj.position.y = t)
          }.bind(t))
        }), 0)
      }
    }, {
      key: "forerake",
      value: function() {
        var t = this;
        this.stop(), this.status = "forerake", setTimeout((function() {
          "straight" === t.direction ? (0, o.TweenAnimation)(t.obj.rotation.z, -Math.PI / 2, 1e3, function(t) {
            void 0 !== t && (this.obj.rotation.z = t)
          }.bind(t)) : (0, o.TweenAnimation)(t.obj.rotation.x, -Math.PI / 2, 1e3, function(t) {
            void 0 !== t && (this.obj.rotation.x = t)
          }.bind(t)), setTimeout((function() {
            "suspend" != t.status ? ((0, o.TweenAnimation)(t.obj.position.y, -s.BLOCK.height / 2 + 1.2, 400, function(t, i) {
              void 0 !== t && (this.obj.position.y = t)
            }.bind(t)), o.customAnimation.to(t.head.position, .2, {
              x: -1.125
            }), o.customAnimation.to(t.head.position, .2, {
              x: 0,
              delay: .2
            })) : t.status = "stop"
          }), 200)
        }), 200)
      }
    }, {
      key: "hypsokinesis",
      value: function() {
        var t = this;
        this.stop(), this.status = "hypsokinesis", setTimeout((function() {
          "straight" === t.direction ? (0, o.TweenAnimation)(t.obj.rotation.z, Math.PI / 2, 800, function(t) {
            void 0 !== t && (this.obj.rotation.z = t)
          }.bind(t)) : (0, o.TweenAnimation)(t.obj.rotation.x, Math.PI / 2, 800, function(t) {
            void 0 !== t && (this.obj.rotation.x = t)
          }.bind(t)), setTimeout((function() {
            "suspend" != t.status ? ((0, o.TweenAnimation)(t.obj.position.y, -s.BLOCK.height / 2 + 1.2, 400, function(t, i) {
              void 0 !== t && (this.obj.position.y = t)
            }.bind(t)), o.customAnimation.to(t.head.position, .2, {
              x: 1.125
            }), o.customAnimation.to(t.head.position, .2, {
              x: 0,
              delay: .2
            })) : t.status = "stop"
          }), 350)
        }), 200)
      }
    }, {
      key: "_jump",
      value: function(t) {
        var i = new e.Vector3(0, 0, 0);
        i.z = this.velocity.vz * t, i.y = this.velocity.vy * t - s.GAME.gravity / 2 * t * t - s.GAME.gravity * this.flyingTime * t, this.flyingTime += t, this.obj.translateY(i.y), this.obj.translateOnAxis(this.axis, i.z)
      }
    }, {
      key: "squeeze",
      value: function() {
        this.obj.position.y = s.BLOCK.height / 2, this.head.position.x = 0, o.customAnimation.to(this.body.scale, .15, {
          y: .9,
          x: 1.07,
          z: 1.07
        }), o.customAnimation.to(this.body.scale, .15, {
          y: 1,
          x: 1,
          z: 1,
          delay: .15
        }), o.customAnimation.to(this.head.position, .15, {
          y: 4.725,
          delay: .15
        })
      }
    }, {
      key: "stop",
      value: function() {
        this.status = "stop", this.flyingTime = 0, this.scale = 1, this.velocity = {}, this.jumpStatus = "init"
      }
    }, {
      key: "suspend",
      value: function() {
        this.status = "suspend", o.TweenAnimation.killAll()
      }
    }, {
      key: "rotate",
      value: function() {
        var t;
        (o.TweenAnimation.killAll(), "straight" === this.direction) ? ((0, o.TweenAnimation)(this.obj.rotation.z, 0, 300, function(t) {
          void 0 !== t && (this.obj.rotation.z = t)
        }.bind(this)), t = this.status.indexOf("forerake") >= 0 ? 2 : -2, (0, o.TweenAnimation)(this.obj.position.x, this.obj.position.x + t, 300, function(t) {
          void 0 !== t && (this.obj.position.x = t)
        }.bind(this))) : ((0, o.TweenAnimation)(this.obj.rotation.x, 0, 300, function(t) {
          void 0 !== t && (this.obj.rotation.x = t)
        }.bind(this)), t = this.status.indexOf("forerake") >= 0 ? -2 : 2, (0, o.TweenAnimation)(this.obj.position.z, this.obj.position.z + t, 300, function(t) {
          void 0 !== t && (this.obj.position.z = t)
        }.bind(this)));
        (0, o.TweenAnimation)(this.head.position.x, 0, 100, function(t) {
          void 0 !== t && (this.head.position.x = t)
        }.bind(this)), (0, o.TweenAnimation)(this.obj.position.y, -s.BLOCK.height / 2, 300, function(t, i) {
          void 0 !== t && (this.obj.position.y = t, i && (this.status = "stop"))
        }.bind(this)), this.status = "rotate"
      }
    }, {
      key: "_prepare",
      value: function(t) {
        if (!(void 0 !== this.limitTime && this.prepareTime > this.limitTime || (this.scale -= s.BOTTLE.reduction, this.scale = Math.max(s.BOTTLE.minScale, this.scale), this.scale <= s.BOTTLE.minScale))) {
          this.body.scale.y = this.scale, this.body.scale.x += .007, this.body.scale.z += .007, this.head.position.y -= .018;
          this.obj.position.y -= s.BLOCK.reduction / 2 * s.BLOCK.height / 2 + .027, this.prepareTime += t, this.prepareTime - this.lastPrepareTime >= .1 && (this.lastPrepareTime = this.prepareTime, a.default.emit(s.EVENT.SEND_REALTIME_MSG_TO_CTRL, {
            time: this.prepareTime
          }))
        }
      }
    }, {
      key: "prepare",
      value: function() {
        this.lastPrepareTime = 0, this.prepareTime = 0, this.status = "prepare", this.gatherParticles()
      }
    }, {
      key: "relayLimitTime",
      value: function(t) {
        this.limitTime = t
      }
    }, {
      key: "jump",
      value: function(t) {
        this.resetParticles(), this.status = "jump", this.axis = t, o.customAnimation.to(this.body.scale, .25, {
          x: 1,
          y: 1,
          z: 1
        }), this.head.position.y = 4.725, this.scale = 1, this.limitTime = void 0;
        var i = Math.min(Math.max(this.velocity.vz / 35, 1.2), 1.4);
        this.human.rotation.z = this.human.rotation.x = 0, "straight" === this.direction ? (o.customAnimation.to(this.human.rotation, .14, {
          z: this.human.rotation.z - Math.PI
        }), o.customAnimation.to(this.human.rotation, .18, {
          z: this.human.rotation.z - 2 * Math.PI,
          delay: .14
        }), o.customAnimation.to(this.head.position, .1, {
          y: this.head.position.y + .9 * i,
          x: this.head.position.x + .45 * i
        }), o.customAnimation.to(this.head.position, .1, {
          y: this.head.position.y - .9 * i,
          x: this.head.position.x - .45 * i,
          delay: .1
        }), o.customAnimation.to(this.head.position, .15, {
          y: 4.725,
          x: 0,
          delay: .25
        }), o.customAnimation.to(this.body.scale, .1, {
          y: Math.max(i, 1),
          x: Math.max(Math.min(1 / i, 1), .7),
          z: Math.max(Math.min(1 / i, 1), .7)
        }), o.customAnimation.to(this.body.scale, .1, {
          y: Math.min(.9 / i, .7),
          x: Math.max(i, 1.2),
          z: Math.max(i, 1.2),
          delay: .1
        }), o.customAnimation.to(this.body.scale, .3, {
          y: 1,
          x: 1,
          z: 1,
          delay: .2
        })) : (o.customAnimation.to(this.human.rotation, .14, {
          x: this.human.rotation.x - Math.PI
        }), o.customAnimation.to(this.human.rotation, .18, {
          x: this.human.rotation.x - 2 * Math.PI,
          delay: .14
        }), o.customAnimation.to(this.head.position, .1, {
          y: this.head.position.y + .9 * i,
          z: this.head.position.z - .45 * i
        }), o.customAnimation.to(this.head.position, .1, {
          z: this.head.position.z + .45 * i,
          y: this.head.position.y - .9 * i,
          delay: .1
        }), o.customAnimation.to(this.head.position, .15, {
          y: 4.725,
          z: 0,
          delay: .25
        }), o.customAnimation.to(this.body.scale, .05, {
          y: Math.max(i, 1),
          x: Math.max(Math.min(1 / i, 1), .7),
          z: Math.max(Math.min(1 / i, 1), .7)
        }), o.customAnimation.to(this.body.scale, .05, {
          y: Math.min(.9 / i, .7),
          x: Math.max(i, 1.2),
          z: Math.max(i, 1.2),
          delay: .1
        }), o.customAnimation.to(this.body.scale, .2, {
          y: 1,
          x: 1,
          z: 1,
          delay: .2
        }))
      }
    }, {
      key: "showup",
      value: function() {
        this.status = "showup", this.obj.position.y = 25, this.human.rotation.x = this.human.rotation.z = 0, (0, o.TweenAnimation)(this.obj.position.y, s.BLOCK.height / 2, 500, "Bounce.easeOut", function(t, i) {
          void 0 !== t && (this.obj.position.y = t, i && (this.status = "stop"))
        }.bind(this))
      }
    }, {
      key: "stopPrepare",
      value: function() {
        this.obj.position.y = s.BLOCK.height / 2, this.stop(), this.body.scale.set(1, 1, 1), this.head.position.y = 4.725, this.head.position.x = 0, this.resetParticles()
      }
    }, {
      key: "getBox",
      value: function() {
        return [(new e.Box3).setFromObject(this.head), (new e.Box3).setFromObject(this.middle), (new e.Box3).setFromObject(this.bottom)]
      }
    }, {
      key: "resetToDefaultSkin",
      value: function() {
        this.changeBottleMaterial(["res/head.png", "res/head.png", "res/middle.png", "res/bottom.png"]), this.scarf.obj.visible = !1, this.hat.obj.visible = !1
      }
    }, {
      key: "changeSkin",
      value: function(t) {
        t ? (this.skinId = t.id || null, 1 == t.type ? (this.scarf.obj.visible = !1, this.hat.obj.visible = !1, this.skin = t.property.images.join(""), this.changeBottleMaterial(t.property.images)) : 2 == t.type && (this.resetToDefaultSkin(), this.scarf.obj.visible = !0)) : (this.skinId = null, this.resetToDefaultSkin())
      }
    }, {
      key: "changeBottleMaterial",
      value: function(t) {
        for (var i = 0; i < 4; ++i) this.maps[t[i]] || (this.maps[t[i]] = s.loader.load(t[i]));
        this.headMaterial && this.bottomMaterial && this.middleTopMaterial && this.middleMaterial ? (this.headMaterial.map = this.maps[t[0]], this.middleTopMaterial.map = this.maps[t[1]], this.middleMaterial.map = this.maps[t[2]], this.bottomMaterial.map = this.maps[t[3]]) : (this.headMaterial = new e.MeshBasicMaterial({
          map: this.maps[t[0]]
        }), this.middleTopMaterial = new e.MeshBasicMaterial({
          map: this.maps[t[1]]
        }), this.middleMaterial = new e.MeshBasicMaterial({
          map: this.maps[t[2]]
        }), this.bottomMaterial = new e.MeshBasicMaterial({
          map: this.maps[t[3]]
        }))
      }
    }, {
      key: "checkSkin",
      value: function(t) {
        if (t && t.bottleSkin) this.changeSkin(t.bottleSkin);
        else if (t && null === t.bottleSkin) this.changeSkin();
        else {
          var i = this.getSelectedBottleSkinResourceSync();
          i ? this.changeSkin(i) : this.changeSkin()
        }
      }
    }, {
      key: "reset",
      value: function(t) {
        this.resetPosition(t), this.checkSkin(t)
      }
    }, {
      key: "resetPosition",
      value: function(t) {
        this.stop(), this.obj.position.y = s.BLOCK.height / 2, this.obj.position.x = this.obj.position.z = 0, this.obj.rotation.z = 0, this.obj.rotation.y = 0, this.obj.rotation.x = 0, this.bottle.rotation.y = 0, this.bottle.rotation.z = 0, this.bottle.rotation.x = 0, this.body && this.head && (this.body.scale.set(1, 1, 1), this.body.rotation.z = this.body.rotation.x = this.body.rotation.y = 0, this.head.position.y = 4.725, this.head.position.x = 0, this.human.rotation.y = this.human.rotation.z = this.human.rotation.x = 0), t && t.preserveDirection || (this.direction = "straight"), this.jumpStatus = "init", this.double = 1, this.resetParticles(), this.scoreText.obj.visible = !1, this.destination = []
      }
    }]), h
  }();
exports.default = u;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./config":37,"./lib/animation":66,"./lib/mue/eventcenter":67,"./lib/three":70,"./text":130}],35:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.hideMiniGameCenter = function() {
  GameGlobal.minigameCenter && GameGlobal.minigameCenter.hide()
}, exports.showMiniGameCenter = function() {
  GameGlobal.minigameCenter && GameGlobal.minigameCenter.show()
};
},{}],36:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.getChatToolInfo = function(e) {
  return a.apply(this, arguments)
}, exports.getGroupEnterInfo = function(e) {
  return c.apply(this, arguments)
}, exports.showVersionTip = r;
var e, t = require("../@babel/runtime/helpers/regeneratorRuntime"),
  n = require("../@babel/runtime/helpers/asyncToGenerator"),
  o = (e = require("./network/network")) && e.__esModule ? e : {
    default: e
  };

function r() {
  wx.showModal({
    content: "请更新微信版本",
    show取消: !1,
    confirmColor: "#02BB00"
  }), wx.hide加载中()
}

function s(e) {
  wx.isChatTool ? wx.isChatTool() ? wx.exitChatTool({
    success: function() {
      wx.openChatTool(e)
    },
    fail: function(e) {
      console.error("!!! exitChatTool fail: ", e)
    }
  }) : wx.openChatTool(e) : r()
}

function a() {
  return (a = n(t().mark((function e(n) {
    var r, a, c, u, i, l = arguments;
    return t().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          return r = l.length > 1 && void 0 !== l[1] ? l[1] : 1, a = l.length > 2 ? l[2] : void 0, c = l.length > 3 ? l[3] : void 0, e.prev = 3, e.next = 6, new Promise((function(e, t) {
            s({
              success: function(t) {
                a && a(t), e(t)
              },
              fail: function(e) {
                c && c(e), t(e)
              }
            })
          }));
        case 6:
          return e.next = 8, new Promise((function(e, t) {
            wx.getChatToolInfo({
              success: function(t) {
                console.log("!!! wx.getChatToolInfo success", t), e(t)
              },
              fail: function(e) {
                console.log("!!! wx.getChatToolInfo fail", e), t(e)
              }
            })
          }));
        case 8:
          return u = e.sent, e.next = 11, o.default.getActivityId({
            encryptedData: u.encryptedData,
            data: {
              room_id: n,
              business_type: r
            }
          });
        case 11:
          return i = e.sent, console.log("!!! getChatToolInfo res", i), e.abrupt("return", i);
        case 16:
          throw e.prev = 16, e.t0 = e.catch(3), console.error("主动获取聊天工具活动ID失败:", e.t0), e.t0;
        case 20:
        case "end":
          return e.stop()
      }
    }), e, null, [
      [3, 16]
    ])
  })))).apply(this, arguments)
}

function c() {
  return (c = n(t().mark((function e(n) {
    var r, s, a, c = arguments;
    return t().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          return r = c.length > 1 && void 0 !== c[1] ? c[1] : 1, e.prev = 1, e.next = 4, new Promise((function(e, t) {
            wx.getGroupEnterInfo({
              allowSingleChat: !0,
              needGroupOpenID: !0,
              success: function(t) {
                console.log("!!! getGroupEnterInfo success", t), e(t)
              },
              fail: function(e) {
                console.log("!!! getGroupEnterInfo fail", e), t(e)
              }
            })
          }));
        case 4:
          return s = e.sent, e.next = 7, o.default.getActivityId({
            encryptedData: s.encryptedData,
            data: {
              room_id: n,
              business_type: r
            }
          });
        case 7:
          return a = e.sent, console.log("!!! getGroupEnterInfo res", a), e.abrupt("return", a);
        case 12:
          throw e.prev = 12, e.t0 = e.catch(1), console.warn("群聊进入获取活动ID与群聊信息失败:", e.t0), e.t0;
        case 16:
        case "end":
          return e.stop()
      }
    }), e, null, [
      [1, 12]
    ])
  })))).apply(this, arguments)
}
},{"../@babel/runtime/helpers/asyncToGenerator":6,"../@babel/runtime/helpers/regeneratorRuntime":22,"./network/network":73}],37:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.getPK本次得分Pos = exports.WAVE = exports.VERSION = exports.USING_PROP = exports.USEWANGZHEBASE = exports.USEMMPAYBASE = exports.SYNC_DEBONCE_TIME = exports.SUBVERSION = exports.SUBSCRIPTION_SETTING_TYPE = exports.ROOM_LIMIT = exports.REWARD_SCORE = exports.REWARD_CHALLENGE_TEXT = exports.REPORTERTIMEOUT = exports.RELAY_SCORE_POS = exports.RANK_SCORE_KEY = exports.PROP_BOARD = exports.PK_TEXT_POS = exports.PK_SUBSCRIPTION_TEMPLATE_ID = exports.PARTICLE = exports.OBSERVE_SCORE_POS = exports.LOCALBLOCK = exports.GAME_SCORE_POS = exports.GAME = exports.FRUSTUMWIDTH = exports.FRUSTUMSIZE = exports.FRUSTUMHEIGHT = exports.EVENT = exports.DESIGN_WIDTH = exports.DESIGN_HEIGHT = exports.COLORS = exports.CAN_USE_REWARD_CHALLENGE = exports.CAMERA = exports.BOTTLE = exports.BLOCK = exports.BASE_TRADE_MARK_RUL = exports.AUDIO = exports.AD_BOARD = void 0, exports.getSetting = function() {
  return B.apply(this, arguments)
}, exports.getSystemInfo = y, exports.gtVersion = s, exports.loader = void 0;
var e, E = require("../@babel/runtime/helpers/regeneratorRuntime"),
  r = require("../@babel/runtime/helpers/asyncToGenerator"),
  t = function(e, E) {
    if (!E && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var r = R(E);
    if (r && r.has(e)) return r.get(e);
    var t = {},
      o = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var s in e)
      if ("default" !== s && Object.prototype.hasOwnProperty.call(e, s)) {
        var n = o ? Object.getOwnPropertyDescriptor(e, s) : null;
        n && (n.get || n.set) ? Object.defineProperty(t, s, n) : t[s] = e[s]
      } t.default = e, r && r.set(e, t);
    return t
  }(require("./lib/three")),
  o = (e = require("./lib/mue/eventcenter")) && e.__esModule ? e : {
    default: e
  };

function R(e) {
  if ("function" != typeof WeakMap) return null;
  var E = new WeakMap,
    r = new WeakMap;
  return (R = function(e) {
    return e ? r : E
  })(e)
}

function s(e) {
  try {
    var E = y().SDKVersion;
    e = e.split("."), E = E.split(".");
    for (var r = Math.min(e.length, E.length), t = 0; t < r; t++) {
      if (parseInt(e[t]) > parseInt(E[t])) return !1;
      if (parseInt(e[t]) < parseInt(E[t])) return !0
    }
    return !0
  } catch (e) {
    return !1
  }
}
exports.DESIGN_WIDTH = 414;
exports.DESIGN_HEIGHT = 736;
exports.FRUSTUMHEIGHT = 60;
exports.FRUSTUMWIDTH = 33.75;
exports.COLORS = {
  red: 13387325,
  pureRed: 16711680,
  white: 14209233,
  brown: 5845806,
  pink: 15964855,
  brownDark: 2300175,
  blue: 40951,
  yellow: 16760320,
  pureWhite: 16777215,
  orange: 16231020,
  orangeDark: 16747520,
  black: 0,
  cream: 16119285,
  green: 2924391,
  lightBlue: 13758190,
  cyan: 9692366,
  yellowBrown: 16764811,
  purple: 9083606
};
var n = {
  headRadius: .945,
  bodyWidth: 2.34,
  bodyDepth: 2.34,
  bodyHeight: 3.2,
  reduction: .005,
  minScale: .5,
  velocityYIncrement: 15,
  velocityY: 135,
  velocityZIncrement: 70
};
exports.BOTTLE = n;
exports.PARTICLE = {
  radius: .3,
  detail: 2
};
var _ = {
  BOTTOMBOUND: -55,
  TOPBOUND: 41,
  gravity: 720,
  touchmoveTolerance: 20,
  LEFTBOUND: -140,
  topTrackZ: -30,
  rightBound: 90,
  HEIGHT: window.innerHeight || 736,
  WIDTH: window.innerWidth || 414,
  canShadow: !0
};
exports.GAME = _;
exports.WAVE = {
  innerRadius: 2.2,
  outerRadius: 3,
  thetaSeg: 25
};
exports.CAMERA = {
  fov: 60
};
exports.AUDIO = {
  success: "res/success.mp3",
  perfect: "res/perfect.mp3",
  scale_loop: "res/scale_loop.mp3",
  scale_intro: "res/scale_intro.mp3",
  restart: "res/start.mp3",
  fall: "res/fall.mp3",
  fall_2: "res/fall_2.mp3",
  combo1: "res/combo1.mp3",
  combo2: "res/combo2.mp3",
  combo3: "res/combo3.mp3",
  combo4: "res/combo4.mp3",
  combo5: "res/combo5.mp3",
  combo6: "res/combo6.mp3",
  combo7: "res/combo7.mp3",
  combo8: "res/combo8.mp3",
  icon: "res/icon.mp3",
  pop: "res/pop.mp3",
  sing: "res/sing.mp3",
  store: "res/store.mp3",
  water: "res/water.mp3",
  pay: "res/wechat_pay.mp3",
  luban: "res/luban.mp3",
  relax: "res/relax.mp3"
};
var A = {
  radius: 5,
  width: 10,
  minRadiusScale: .8,
  maxRadiusScale: 1,
  height: 5.5,
  radiusSegments: [4, 50],
  floatHeight: 0,
  minDistance: 1,
  maxDistance: 17,
  minScale: n.minScale,
  reduction: n.reduction,
  moveDownVelocity: .07,
  fullHeight: 5.5 / 21 * 40
};
exports.BLOCK = A;
var S = _.HEIGHT / _.WIDTH / 736 * 414 * 60;
exports.FRUSTUMSIZE = S, console.log(S, "FRUSTUMSIZE");
var p = new t.TextureLoader;
exports.loader = p;
exports.REPORTERTIMEOUT = 60001;
exports.VERSION = 4;
exports.SUBVERSION = "4.0.6";
exports.USEWANGZHEBASE = 1;
exports.USEMMPAYBASE = 1;
exports.ROOM_LIMIT = "10";
exports.SUBSCRIPTION_SETTING_TYPE = {
  ACCEPT: "accept",
  REJECT: "reject",
  ACCEPT_WITH_FORCE_PUSH: "acceptWithForcePush",
  BAN: "ban"
};
var T = {
  INIT_SETTING_COMPLETE: "INIT_SETTING_SUCCESS",
  LIVESTATECHANGE: "LIVESTATECHANGE",
  RELAYCREATEROOM: "relayCreateRoom",
  JOINRELAYROOM: "JOINRELAYROOM",
  PEOPLECOME: "PEOPLECOME",
  PEOPLEOUT: "PEOPLEOUT",
  RELAYSTART: "RELAYSTART",
  NOWPLAYERJUMP: "NOWPLAYERJUMP",
  CHECKUSER: "CHECKUSER",
  RELAYCHECKUSER: "RELAYCHECKUSER",
  RUNGAME: "RUNGAME",
  ENDGAME: "ENDGAME",
  PLAYERDIED: "PLAYERDIED",
  NOWPLAYEROVER: "NOWPLAYEROVER",
  RECEIVEMINICODE: "RECEIVEMINICODE",
  GOSTARTPAGE: "GOSTARTPAGE",
  GOTOSINGLESTARTPAGE: "GOTOSINGLESTARTPAGE",
  REPLAYAGAIN: "REPLAYAGAIN",
  SYNCMSGSEQ: "SYNCMSGSEQ",
  RELAYMODEDESTROY: "RELAYMODEDESTROY",
  SYNCSCENE: "SYNCSCENE",
  WATCHRELAY: "WATCHRELAY",
  CHECK_GAME: "CHECK_GAME",
  SEND_CHECK_GAME: "SEND_CHECK_GAME",
  PROGRESSOVER: "PROGRESSOVER",
  CHANGEGAMELEVEL: "CHANGEGAMELEVEL",
  RECEIVEGAMELEVELCHANGE: "RECEIVEGAMELEVELCHANGE",
  SHOW_RELAY_GUIDE: "SHOW_RELAY_GUIDE",
  SKIP_RELAY_GUIDE: "SKIP_RELAY_GUIDE",
  CREATE_RELAY_ROOM_FAIL: "CREATE_RELAY_ROOM_FAIL",
  RP_JOIN_RELAY_ROOM_AGAIN: "RP_JOIN_RELAY_ROOM_AGAIN",
  RP_JOIN_RELAY_ROOM: "RP_JOIN_RELAY_ROOM",
  RP_RELAY_START: "RP_RELAY_START",
  ORDERRUNGAME: "ORDERRUNGAME",
  RP_RELAY_GAME_END: "RP_RELAY_GAME_END",
  GETRELAYQR: "GETRELAYQR",
  GETRELAYCHECKUSERERROR: "GETRELAYCHECKUSERERROR",
  INITRESPONSE: "INITRESPONSE",
  TRIGGER_EGG: "TRIGGER_EGG",
  CLOSE_HIGHEST_MODEL: "CLOSE_HIGHEST_MODEL",
  TRIGGER_AD_JUMP: "TRIGGER_AD_JUMP",
  AFTER_SHOWN_START_PAGE: "AFTER_SHOWN_START_PAGE",
  TRIGGER_PROP: "TRIGGER_PROP",
  RECEIVE_REALTIME_MSG: "RECEIVE_REALTIME_MSG",
  SEND_REALTIME_MSG: "SEND_REALTIME_MSG",
  SEND_REALTIME_MSG_TO_CTRL: "SEND_REALTIME_MSG_TO_CTRL",
  JUMP_AD: "JUMP_AD",
  JUMP_AD_GG: "JUMP_AD_GG",
  CHALLENGE_START: "CHALLENGE_START"
};
exports.EVENT = T;
exports.LOCALBLOCK = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35];
exports.BASE_TRADE_MARK_RUL = "res/wechat_logo.png";
var i = {
  x: 9.5,
  y: 4 + (S < 60 ? S / 2 - 9 : 21)
};
exports.PK_TEXT_POS = i;
exports.getPK本次得分Pos = function(e) {
  console.log("!!! getPK本次得分Pos score", e);
  for (var E = 13, r = e; r >= 10;) r /= 10, E -= 2.5;
  return console.log("!!! getPK本次得分Pos x", E), {
    x: E,
    y: S < 60 ? S / 2 - 9 : 21
  }
};
var O = {
  x: -13,
  y: S < 60 ? S / 2 - 9 : 21
};
exports.GAME_SCORE_POS = O;
var I = {
  x: 0,
  y: S < 60 ? ~~(11 * S / 60) : 11
};
exports.OBSERVE_SCORE_POS = I;
var a = {
  x: -13.8,
  y: S < 60 ? 19 : 26
};
exports.RELAY_SCORE_POS = a;
var c, G, x, L, l, u, P, C, N, M, D, U, H, g = {
  p: (c = {
    designX: 207,
    designY: 694,
    desighW: 45,
    designH: 45
  }, G = c.designX, x = c.designY, L = c.designH, l = c.desighW, u = f(G), P = Y(x) - (S - 60) / 2, C = d(l / 2), N = d(l), M = d(L), D = _.WIDTH / 414, U = G * D, H = _.WIDTH / 33.75 * (S / 2 - P), {
    RADIUS: C,
    WIDTH: N,
    HEIGHT: M,
    x: u,
    y: P,
    UI_x: U,
    UI_y: H,
    UI_left: U - l / 2 * D,
    UI_right: U + l / 2 * D,
    UI_top: H - L / 2 * D,
    UI_bottom: H + L / 2 * D
  }),
  skin: {
    s1: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJBaI5ibAEtVLs2DLAVwl4u2xxutYHQRRMiaQVlZdyIWVWSf0IBo797QCiah7lGicrHELRg/0?wx_fmt=png"
  },
  skinTexture: {}
};
exports.PROP_BOARD = g;
exports.USING_PROP = 1;
var m = function(e) {
  var E = e.designX,
    r = e.designY,
    t = e.designH,
    o = e.desighW,
    R = f(E),
    s = Y(r),
    n = d(o / 2),
    A = d(o),
    S = d(t),
    p = _.WIDTH / 414,
    T = E * p,
    i = r * p + (_.HEIGHT - 736 * p) / 2;
  return {
    RADIUS: n,
    WIDTH: A,
    HEIGHT: S,
    x: R,
    y: s,
    UI_x: T,
    UI_y: i,
    UI_left: T - o / 2 * p,
    UI_right: T + o / 2 * p,
    UI_top: i - t / 2 * p,
    UI_bottom: i + t / 2 * p
  }
}({
  designX: 367,
  designY: 98.126,
  designH: 44,
  desighW: 44
});
exports.AD_BOARD = m;
exports.SYNC_DEBONCE_TIME = 5e3;

function d(e) {
  return (33.75 / 414 * e).toFixed(2)
}

function f(e) {
  return (e / 414 * 33.75 - 16.875).toFixed(2)
}

function Y(e) {
  return (e / 414 * -33.75 + 30).toFixed(2)
}
exports.PK_SUBSCRIPTION_TEMPLATE_ID = "Pijb7-2pKuuhnQNHC_qkSNGW8lER43b2fpcFww3_C8E";
var b = s("3.10.1") && ("ios" === y().platform || "android" === y().platform);
exports.CAN_USE_REWARD_CHALLENGE = b;
exports.RANK_SCORE_KEY = "test_score1";
exports.REWARD_SCORE = 100;
var W = b ? "达到".concat(100, "分可发起有奖擂台赛，得皮肤和道具") : "";
exports.REWARD_CHALLENGE_TEXT = W;
var h = null;

function y() {
  return h || (wx.getSystemInfoSync && (h = wx.getSystemInfoSync(), console.log("!!! getSystemInfoSync", h)), h || {})
}
var v = null,
  w = !0;

function B() {
  return (B = r(E().mark((function e() {
    var r, t = arguments;
    return E().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          if (r = t.length > 0 && void 0 !== t[0] && t[0], console.log("!!! getSetting", r), !v || r) {
            e.next = 4;
            break
          }
          return e.abrupt("return", v);
        case 4:
          if (e.prev = 4, !wx.getSetting) {
            e.next = 9;
            break
          }
          return e.next = 8, new Promise((function(e, E) {
            wx.getSetting({
              withSubscriptions: !0,
              success: function(E) {
                console.log("!!! getSetting success", E), e(E)
              },
              fail: function(e) {
                console.error("!!! getSetting fail", e), E(e)
              }
            })
          }));
        case 8:
          v = e.sent;
        case 9:
          e.next = 14;
          break;
        case 11:
          e.prev = 11, e.t0 = e.catch(4), console.error("!!! 获取用户设置失败", e.t0);
        case 14:
          return w && (w = !1, o.default.emitSync(T.INIT_SETTING_COMPLETE, v)), e.abrupt("return", v);
        case 16:
        case "end":
          return e.stop()
      }
    }), e, null, [
      [4, 11]
    ])
  })))).apply(this, arguments)
}
},{"../@babel/runtime/helpers/asyncToGenerator":6,"../@babel/runtime/helpers/regeneratorRuntime":22,"./lib/mue/eventcenter":67,"./lib/three":70}],38:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0, require("../../@babel/runtime/helpers/Arrayincludes");
var e = require("../../@babel/runtime/helpers/regeneratorRuntime"),
  t = require("../../@babel/runtime/helpers/asyncToGenerator"),
  a = require("../../@babel/runtime/helpers/classCallCheck"),
  o = require("../../@babel/runtime/helpers/createClass"),
  i = h(require("../pages/battle/battlePkPage")),
  r = h(require("../pages/battle/battleGamePage")),
  l = h(require("../network/network")),
  s = require("../chattool"),
  n = h(require("../store/session"));

function h(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var c = function() {
  function h(e, t) {
    a(this, h), this.name = "battle", this.game = e, this.gameCtrl = this.game.gameCtrl, this.model = this.game.gameModel, this.view = this.game.gameView, this.modeCtrl = t, this.netWorkCtrl = this.gameCtrl.netWorkCtrl, this.currentPage = null, this.pkPage = new i.default(e), this.gamePage = new r.default(e), this.shareTicket = "", this.pkId = "", this.shareInfoTimeout = null, this.battle本次得分 = void 0
  }
  var c;
  return o(h, [{
    key: "init",
    value: function(e) {
      var t = this.model.getSessionId();
      this.shareTicket = e.shareTicket, this.pkId = e.query.pkId, n.default.setPkId(this.pkId), this.model.setStage(""), wx.show加载中(), t ? this.afterLogin(!0) : this.netWorkCtrl.netWorkLogin(this.afterLogin.bind(this))
    }
  }, {
    key: "afterLogin",
    value: function(e) {
      var t = this;
      console.log("!!! battleCtrl afterLogin", e), e ? (this.set分享InfoTimeout(), wx.getGroupEnterInfo({
        allowSingleChat: !0,
        needGroupOpenID: !0,
        success: function(e) {
          console.log("!!! wx.getGroupEnterInfo success", e), null != t.shareInfoTimeout ? (console.log("没有触发定时器"), t.clear分享InfoTimeout(), t.model.set分享Ticket(e.encryptedData), t.gotoBattlePage(), t.gameCtrl.loginBattle(1)) : console.log("已经触发定时器")
        },
        fail: function(e) {
          console.error("!!! wx.getGroupEnterInfo fail", e), null != t.shareInfoTimeout ? (t.clear分享InfoTimeout(), console.log("没有触发定时器"), t.gotoBattlePage(), t.gameCtrl.loginBattle(0)) : console.log("已经触发定时器")
        }
      })) : this.goToBattleFail()
    }
  }, {
    key: "gotoBattlePage",
    value: (c = t(e().mark((function t() {
      var a, o, i, r;
      return e().wrap((function(e) {
        for (;;) switch (e.prev = e.next) {
          case 0:
            if (console.log("!!! battleCtrl gotoBattlePage", this.pkId), this.pkId) {
              e.next = 5;
              break
            }
            return console.error("!!! battleCtrl gotoBattlePage pkId is null"), this.goToBattleFail(), e.abrupt("return");
          case 5:
            return e.prev = 5, e.next = 8, (0, s.getGroupEnterInfo)(this.pkId);
          case 8:
            a = e.sent, o = a.activity_id, i = a.group_openid, this.model.chatToolActivityId = o, this.model.groupOpenid = i, e.next = 18;
            break;
          case 15:
            e.prev = 15, e.t0 = e.catch(5), null !== e.t0 && void 0 !== e.t0 && null !== (r = e.t0.errMsg) && void 0 !== r && r.includes("fail invalid scene") ? console.log("擂主创建后进入擂台赛，没有群聊信息") : console.error("!!! battleCtrl gotoBattlePage getGroupEnterInfo fail", e.t0);
          case 18:
            l.default.getBattleData(this.gotoBattlePageAfterHaveData.bind(this), this.pkId);
          case 19:
          case "end":
            return e.stop()
        }
      }), t, this, [
        [5, 15]
      ])
    }))), function() {
      return c.apply(this, arguments)
    })
  }, {
    key: "gotoBattlePageAfterHaveData",
    value: function(e, t) {
      if (console.log("!!! battleCtrl gotoBattlePageAfterHaveData", e, t), wx.hide加载中(), e) {
        var a = [];
        t.data.challenger.length && t.data.challenger.forEach((function(e) {
          a.push({
            headimg: e.headimg,
            is_self: e.is_self ? 1 : 0,
            nickname: e.nickname,
            score_info: [{
              score: e.score
            }]
          })
        }), this), a.sort((function(e, t) {
          return t.score_info[0].score - e.score_info[0].score
        })), this.model.champion本次得分 = t.data.owner.score;
        var o = {
          organizerInfo: {
            headimg: t.data.owner.headimg,
            nickname: t.data.owner.nickname,
            score_info: [{
              score: t.data.owner.score
            }],
            left_time: t.data.left_time,
            is_self: t.data.is_owner ? 1 : 0
          },
          pkListInfo: a,
          gg_score: this.battle本次得分
        };
        this.currentPage && this.currentPage.hide(), this.pkPage.show(o), this.model.setStage(this.pkPage.name), this.currentPage = this.pkPage, this.gameCtrl.showPkPage(t.data.owner.score), this.model.chatToolActivityId ? t.data.left_time <= 0 && l.default.sendChatToolMsg({
          data: {
            activity_id: this.model.chatToolActivityId,
            target_state: 3,
            room_id: this.pkId
          }
        }).catch((function(e) {
          console.error("!!! 未发送聊天模式消息：", e)
        })) : console.warn("!!! gotoBattlePageAfterHaveData chatToolActivityId is null")
      } else this.goToBattleFail()
    }
  }, {
    key: "goToBattleFail",
    value: function() {
      console.log("!!! battleCtrl goToBattleFail"), this.view.showGoToBattleFail(), this.modeCtrl.changeMode("singleCtrl")
    }
  }, {
    key: "set分享InfoTimeout",
    value: function() {
      this.shareInfoTimeout = setTimeout(this.handle分享InfoTimeout.bind(this), 1e4)
    }
  }, {
    key: "clear分享InfoTimeout",
    value: function() {
      null != this.shareInfoTimeout && (clearTimeout(this.shareInfoTimeout), this.shareInfoTimeout = null)
    }
  }, {
    key: "handle分享InfoTimeout",
    value: function() {
      console.log("!!! battleCtrl handle分享InfoTimeout"), this.clear分享InfoTimeout(), this.goToBattleFail()
    }
  }, {
    key: "destroy",
    value: function() {
      this.currentPage && this.currentPage.hide(), this.model.setStage(""), wx.hide加载中(), this.shareTicket = "", this.pkId = "", this.clear分享InfoTimeout(), this.model.clear分享Ticket(), this.game.resetScene(), this.battle本次得分 = void 0
    }
  }, {
    key: "battlePlay",
    value: function(e) {
      console.log("!!! battleCtrl battlePlay", e, this.model), e ? (this.currentPage && this.currentPage.hide(), this.gamePage.show(), this.game.replayGame(), this.model.setStage(this.gamePage.name), this.currentPage = this.gamePage) : (this.modeCtrl.directPlaySingleGame(), this.gameCtrl.battleToSingle())
    }
  }, {
    key: "showGameOverPage",
    value: function() {
      this.currentPage && this.currentPage.hide(), this.model.setStage(""), this.currentPage = null;
      var e = this.model.current本次得分;
      this.battle本次得分 = e, wx.show加载中(), l.default.updatepkinfo(this.gotoBattlePageAgain.bind(this), this.pkId, e), this.model.chatToolActivityId && this.model.groupOpenid ? l.default.sendChatToolMsg({
        data: {
          activity_id: this.model.chatToolActivityId,
          target_state: 1,
          participator_info_list: [{
            group_openid: this.model.groupOpenid,
            state: 1
          }],
          room_id: this.pkId
        }
      }).catch((function(e) {
        console.error("!!! 未发送聊天模式消息：", e)
      })) : console.warn("!!! battleCtrl showGameOverPage chatToolActivityId or groupOpenid is null")
    }
  }, {
    key: "gotoBattlePageAgain",
    value: function(e) {
      e || this.view.showUploadPk本次得分Fail(), this.gotoBattlePage()
    }
  }, {
    key: "wxOnhide",
    value: function() {}
  }]), h
}();
exports.default = c;
},{"../../@babel/runtime/helpers/Arrayincludes":1,"../../@babel/runtime/helpers/asyncToGenerator":6,"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/regeneratorRuntime":22,"../chattool":36,"../network/network":73,"../pages/battle/battleGamePage":77,"../pages/battle/battlePkPage":78,"../store/session":127}],39:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0, require("../../@babel/runtime/helpers/Arrayincludes");
var e = require("../../@babel/runtime/helpers/typeof"),
  t = require("../../@babel/runtime/helpers/classCallCheck"),
  n = require("../../@babel/runtime/helpers/createClass"),
  i = r(require("../store/storage")),
  o = require("../util/util"),
  l = r(require("../network/network"));

function r(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var u = function() {
  function r() {
    t(this, r)
  }
  return n(r, null, [{
    key: "getBottleSkinResource",
    value: function(e) {
      return new Promise((function(t, n) {
        var o = i.default.getCan使用BottleSkinIdList(),
          l = i.default.getSkinResources(),
          u = i.default.getBottleSkinData(e);
        u && o.includes(e) ? void 0 !== l[e] ? t(l[e]) : ("string" == typeof u.property && (u.property = JSON.parse(u.property)), r.downloadBottleSkin(u.property, u.id).then((function(n) {
          u.property = n, l[e] = u, i.default.setSkinResources(l), t(u)
        }), (function(e) {
          n()
        }))) : n()
      }))
    }
  }, {
    key: "getBottleSkinResourceBySkinData",
    value: function(e) {
      return new Promise((function(t, n) {
        var o = i.default.getSkinResources();
        e && e.id ? void 0 !== o[e.id] ? t(o[e.id]) : ("string" == typeof e.property && (e.property = JSON.parse(e.property)), r.downloadBottleSkin(e.property, e.id).then((function(n) {
          e.property = n, o[e.id] = e, i.default.setSkinResources(o), t(e)
        }), (function() {
          n()
        }))) : n()
      }))
    }
  }, {
    key: "downloadBottleSkin",
    value: function(t, n) {
      return new Promise((function(i, l) {
        if ("object" == e(t)) {
          var r = Object.assign(t);
          if (Array.isArray(t.images) && t.images.length > 0) {
            var u = [],
              a = [];
            t.images.forEach((function(e) {
              u.push(function(e) {
                return new Promise((function(t, n) {
                  wx.downloadFile({
                    url: e,
                    success: function(e) {
                      t(e.tempFilePath)
                    },
                    fail: function(e) {
                      n(e)
                    }
                  })
                }))
              }(e))
            })), Promise.all(u).then((function(e) {
              e.forEach((function(e, t) {
                var i, l, r;
                a.push((i = e, l = "bottle_".concat(n, "_").concat(t), r = "bottleSkin/".concat(l), new Promise((function(e, t) {
                  o.Util.saveFile({
                    tempFilePath: i,
                    filePath: r,
                    success: function(t) {
                      e("".concat(wx.env.USER_DATA_PATH, "/").concat(r))
                    },
                    fail: function(e) {
                      t()
                    }
                  })
                }))))
              })), Promise.all(a).then((function(e) {
                r.images = e, i(r)
              }), (function(e) {
                l()
              }))
            }), (function(e) {
              l()
            }))
          } else i(t)
        } else l()
      }))
    }
  }, {
    key: "selectAndDownloadBottleSkin",
    value: function(e) {
      r.getBottleSkinResource(e.id).then((function() {
        i.default.setSelectBottleSkinId(e.id)
      }), (function() {
        wx.showToast({
          title: "下载皮肤失败"
        })
      }))
    }
  }, {
    key: "getSelectedBottleSkinResource",
    value: function() {
      return new Promise((function(e, t) {
        var n = r.getSelectedSkinId();
        r.getBottleSkinResource(n).then((function(t) {
          e(t)
        }), t)
      }))
    }
  }, {
    key: "getSelectedBottleSkinResourceSync",
    value: function() {
      var e = r.getSelectedSkinId(),
        t = i.default.getCan使用BottleSkinIdList(),
        n = i.default.getSkinResources();
      if (!e) return !1;
      if (t.includes(e) && void 0 !== n[e]) {
        if (r.checkSkinExpire(e)) return n[e];
        i.default.setSelectBottleSkinId(0)
      }
    }
  }, {
    key: "getSelectedBottleSkinDisplayInfoSync",
    value: function() {
      var e = i.default.getSelectBottleSkinId(),
        t = i.default.getBottleSkinShopList() || [];
      if (e && t.length > 0) {
        var n = t.find((function(t) {
          return t.id == e
        }));
        return !(!n || !n.display_info) && n.display_info
      }
      return !1
    }
  }, {
    key: "getSelectedBottleSkinDataSync",
    value: function(e) {
      var t = i.default.getBottleSkinShopList() || [];
      if (e && t.length > 0) {
        var n = t.find((function(t) {
          return t.id == e
        }));
        return n || !1
      }
      return !1
    }
  }, {
    key: "checkSkinExpire",
    value: function(e) {
      var t = i.default.getBottleSkinShopList(),
        n = Math.floor(Date.now() / 1e3),
        o = t.find((function(t) {
          return t.id == e
        }));
      return !!o && (o.expire_time > n || 0 === o.expire_time || (r.setRankDataTolocalStorage({}), !1))
    }
  }, {
    key: "getSelectedSkinId",
    value: function() {
      var e = i.default.getSelectBottleSkinId();
      return r.checkSkinExpire(e) ? e : (i.default.setSelectBottleSkinId(0), 0)
    }
  }, {
    key: "updateSkinExpire",
    value: function(e, t) {
      var n = i.default.getBottleSkinShopList() || [],
        o = Math.floor(Date.now() / 1e3),
        l = i.default.getCan使用BottleSkinIdList(),
        r = n.find((function(t) {
          return t.id == e
        }));
      r && (r.expire_time = t, t > o || 0 === t ? (r.use_status = 1, l.includes(e) || l.push(e)) : (r.use_status = 0, l.includes(e) && (l = l.filter((function(t) {
        return t != e
      })))), i.default.setCan使用BottleSkinIdList(l))
    }
  }, {
    key: "setRankDataTolocalStorage",
    value: function(e) {
      try {
        var t = Object.assign({}, i.default.getMy使用rInfo() || {}),
          n = {};
        if (console.log("-----------------------------"), console.log(t), console.log(e), e) {
          e.playback_id && (n.playback_id = e.playback_id);
          var o = r.getSelectedBottleSkinDisplayInfoSync();
          n.bottle_skin = !!o && o.poster_min, i.default.saveMy使用rInfo(Object.assign(t, n))
        }
      } catch (e) {
        console.log("-----------------------------"), console.log("-----------------------------"), console.log("-----------------------------"), console.log(e)
      }
    }
  }, {
    key: "updateSkinExpireByPropertyList",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [],
        t = {};
      for (var n in e.map((function(e) {
          (t[e.item_id] && t[e.item_id] < e.expire_time || !t[e.item_id] || 0 === e.expire_time) && (t[e.item_id] = e.expire_time)
        })), t) r.updateSkinExpire(n, t[n])
    }
  }, {
    key: "syncSelectBottleSkin",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0],
        t = r.getSelectedSkinId(),
        n = i.default.getSyncBottleSkinFailFlag();
      (n || e) && l.default.syncSelectedBottleSkin(t).then((function() {
        i.default.setSyncBottleSkinFailFlag(0)
      }), (function() {
        i.default.setSyncBottleSkinFailFlag(1)
      }))
    }
  }, {
    key: "getBottleSkinShopData",
    value: function() {
      return l.default.getBottleSkinShopData().then((function(e) {
        return i.default.setCan使用BottleSkinIdList(e.can使用SkinIdList), i.default.setBottleSkinShopList(e.bottleSkinShopList), Promise.resolve(e)
      }), (function(e) {
        return Promise.reject(e)
      }))
    }
  }]), r
}();
exports.default = u;
},{"../../@babel/runtime/helpers/Arrayincludes":1,"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/typeof":30,"../network/network":73,"../store/storage":128,"../util/util":140}],40:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  o = (a(require("../network/network")), a(require("../pages/bottleShop/bottleShop"))),
  n = a(require("../control/bottleSkinBaseCtrl")),
  i = a(require("../store/storage"));

function a(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var l = function() {
  function a(t) {
    var o = t.game,
      n = t.onReturn;
    e(this, a), this.game = o, this.gameCtrl = o.gameCtrl, this.onReturn = n
  }
  return t(a, [{
    key: "init",
    value: function() {
      var e, t, a = this;
      this.bottleShopPage = new o.default({
        game: this.game,
        onClick使用: function(t) {
          n.default.getSelectedSkinId() != t.id && t.use_status && (t.id ? (e = setTimeout((function() {
            wx.show加载中({
              title: "下载中...",
              mask: !0
            })
          }), 100), n.default.getBottleSkinResource(t.id).then((function(o) {
            e && (clearTimeout(e), e = !1), wx.hide加载中(), i.default.setSelectBottleSkinId(t.id), a.bottleShopPage.setSelectSkin(t.id), n.default.syncSelectBottleSkin(!0), a.changeSkin(a.game), n.default.setRankDataTolocalStorage({})
          }), (function(t) {
            e && (clearTimeout(e), e = !1), wx.hide加载中(), wx.showToast({
              title: "获取皮肤失败",
              icon: "none"
            })
          }))) : (i.default.setSelectBottleSkinId(0), n.default.syncSelectBottleSkin(!0), a.bottleShopPage.setSelectSkin(t.id), a.changeSkin(a.game), n.default.setRankDataTolocalStorage({})))
        },
        onReturn: function() {
          a.onReturn()
        }
      }), t = setTimeout((function() {
        wx.show加载中({
          title: "加载中...",
          mask: !0
        })
      }), 300), n.default.getBottleSkinShopData().then((function(e) {
        t && (clearTimeout(t), t = !1), wx.hide加载中();
        var o = n.default.getSelectedSkinId();
        a.bottleShopPage.show(e.bottleSkinShopList, o || 0)
      }), (function() {
        t && (clearTimeout(t), t = !1), wx.hide加载中();
        var e = i.default.getBottleSkinShopList(e),
          o = n.default.getSelectedSkinId();
        a.bottleShopPage.show(e, o || 0), wx.hide加载中(), wx.showToast({
          title: "加载失败",
          icon: "none"
        })
      }))
    }
  }, {
    key: "changeSkin",
    value: function(e) {
      var t = n.default.getSelectedBottleSkinResourceSync();
      t ? this.game.bottle && this.game.bottle.changeSkin && this.game.bottle.changeSkin(t) : this.game.bottle.changeSkin()
    }
  }, {
    key: "destroy",
    value: function() {}
  }]), a
}();
exports.default = l;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../control/bottleSkinBaseCtrl":39,"../network/network":73,"../pages/bottleShop/bottleShop":80,"../store/storage":128}],41:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = (s(require("../pages/gift/getGiftPage")), s(require("../store/session")), s(require("../network/network"))),
  n = s(require("../control/propertyCtrl"));

function s(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var o = function() {
  function s(t, i) {
    e(this, s), this.name = "getGiftPage", this.game = t, this.gameCtrl = this.game.gameCtrl, this.model = this.game.gameModel, this.view = this.game.gameView, this.modeCtrl = i, this.netWorkCtrl = this.gameCtrl.netWorkCtrl
  }
  return t(s, [{
    key: "init",
    value: function(e) {
      var t = this.model.getSessionId();
      console.log("options", e), this.giftId = e.query.id, wx.show加载中(), t ? this.afterLogin(!0) : this.netWorkCtrl.netWorkLogin(this.afterLogin.bind(this))
    }
  }, {
    key: "afterLogin",
    value: function(e) {
      var t = this;
      console.log("susususususuususuusususus", this.giftId), e ? i.default.getGiftData(this.giftId).then((function(e) {
        wx.hide加载中(), e ? (t.updateProperty(e.gift_list), t.game.full2D.show分享Skin({
          headimg: e.headimg,
          nickname: e.nickname,
          total_gift: e.gift_count,
          gift_list: e.gift_list,
          onReturn: function() {
            t.modeCtrl.changeMode("singleCtrl")
          }
        })) : t.modeCtrl.changeMode("singleCtrl")
      })).catch((function() {
        wx.hide加载中(), wx.showModal({
          title: "提示",
          content: "网络异常，拉取礼物失败",
          show取消: !1
        }), t.modeCtrl.changeMode("singleCtrl")
      })) : (wx.hide加载中(), wx.showModal({
        title: "提示",
        content: "网络异常，拉取礼物失败",
        show取消: !1
      }), this.modeCtrl.changeMode("singleCtrl"))
    }
  }, {
    key: "updateProperty",
    value: function() {
      var e, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
      t.map((function(t) {
        t.received && (e = !0)
      })), e && setTimeout((function() {
        n.default.getProps()
      }), 1e3)
    }
  }, {
    key: "destroy",
    value: function() {
      this.currentPage && this.currentPage.hide(), this.model.setStage(""), wx.hide加载中(), this.shareTicket = "", this.giftId = null, this.game.resetScene()
    }
  }, {
    key: "wxOnhide",
    value: function() {}
  }]), s
}();
exports.default = o;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../control/propertyCtrl":51,"../network/network":73,"../pages/gift/getGiftPage":82,"../store/session":127}],42:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = a(require("../pages/group/groupPage")),
  o = a(require("../network/network")),
  r = require("../network/getAuth");

function a(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var n = function() {
  function a(t, o) {
    e(this, a), this.name = "group分享", this.game = t, this.gameCtrl = this.game.gameCtrl, this.model = this.game.gameModel, this.view = this.game.gameView, this.netWorkCtrl = this.gameCtrl.netWorkCtrl, this.modeCtrl = o, this.groupPage = new i.default(t), this.shareTicket = "", this.shareInfoTimeout = null
  }
  return t(a, [{
    key: "init",
    value: function(e) {
      var t = this.model.getServerConfig();
      if (t && !t.group_score_switch) return this.view.showServeConfigForbiddenGroup分享(), void this.modeCtrl.changeMode("singleCtrl");
      this.model.setStage("");
      var i = this.model.getSessionId();
      this.shareTicket = e.shareTicket, wx.show加载中(), i ? this.afterLogin(!0) : this.netWorkCtrl.netWorkLogin(this.afterLogin.bind(this))
    }
  }, {
    key: "afterLogin",
    value: function(e) {
      var t = this;
      e ? (this.set分享InfoTimeout(), wx.get分享Info({
        shareTicket: this.shareTicket,
        success: function(e) {
          null != t.shareInfoTimeout && (t.clear分享InfoTimeout(), t.model.set分享Ticket(e.rawData || e.encryptedData), o.default.getGroup本次得分((function(e, i) {
            e ? (0, r.getAuthWxFriendInteraction)().then((function() {
              var e = i.data.user_info || [],
                o = i.data.my_user_info || {};
              t.model.setStage(e, o), t.showGroupRankPage(e, o)
            })).catch((function() {
              t.goToGroup分享Fail("朋友关系授权失败")
            })) : t.goToGroup分享Fail(), wx.hide加载中()
          })))
        },
        fail: function(e) {
          null != t.shareInfoTimeout && (t.clear分享InfoTimeout(), wx.hide加载中(), t.goToGroup分享Fail("群里的群分享才有效哦~"))
        }
      })) : (wx.hide加载中(), this.goToGroup分享Fail())
    }
  }, {
    key: "set分享InfoTimeout",
    value: function() {
      this.shareInfoTimeout = setTimeout(this.handle分享InfoTimeout.bind(this), 5e3)
    }
  }, {
    key: "clear分享InfoTimeout",
    value: function() {
      null != this.shareInfoTimeout && (clearTimeout(this.shareInfoTimeout), this.shareInfoTimeout = null)
    }
  }, {
    key: "handle分享InfoTimeout",
    value: function() {
      this.clear分享InfoTimeout(), this.goToGroup分享Fail()
    }
  }, {
    key: "goToGroup分享Fail",
    value: function(e) {
      console.log("!!! goToGroup分享Fail", e), this.view.showGroup分享Fail(e), this.modeCtrl.changeMode("singleCtrl")
    }
  }, {
    key: "showGroupRankPage",
    value: function(e, t) {
      var i, o, r = this.model.getGroupRankData();
      if (r && (i = r.list, o = r.userInfo), void 0 !== e && void 0 !== t) this.model.setGroupRankData(e, t);
      else {
        if (void 0 === i || void 0 === o) throw new Error("showGroupRankPage。调用没有list，my使用rInfo数据");
        e = i, t = o
      }
      this.groupPage.show(e.concat([]), t), this.model.setStage(this.groupPage.name), this.currentPage = this.groupPage
    }
  }, {
    key: "destroy",
    value: function() {
      wx.hide加载中(), this.currentPage && this.currentPage.hide(), this.model.setStage(""), this.shareTicket = "", this.model.clear分享Ticket(), this.clear分享InfoTimeout(), this.game.resetScene()
    }
  }, {
    key: "groupPlayGame",
    value: function() {
      this.modeCtrl.directPlaySingleGame()
    }
  }, {
    key: "wxOnhide",
    value: function() {}
  }]), a
}();
exports.default = n;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../network/getAuth":72,"../network/network":73,"../pages/group/groupPage":83}],43:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../../@babel/runtime/helpers/classCallCheck"),
  e = require("../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(e) {
      t(this, i), this.game = e, this.commandList = [], this.isRunning = !1, this.icTimeout = null, this.cmdHandler = function() {}, this.gameId = 0, this.seq = 0, this.currentSeq = null, this.waited = !1
    }
    return e(i, [{
      key: "onReceiveCommand",
      value: function(t, e) {
        t._seq = e, this.gameId != this.game.gameCtrl.modeCtrl.observeCtrl.gameId && (this.gameId = this.game.gameCtrl.modeCtrl.observeCtrl.gameId, this.seq = e - 1);
        var i, s = e - this.seq;
        1 != s && (s > 1 && (i = 0), s < 1 && (i = 1), this.game.sendServerError(i), this.game.socketFirstSync = !0);
        this.seq = e, (!this.currentSeq || e > this.currentSeq) && (this.commandList.push(t), this.commandList.sort((function(t, e) {
          return t._seq - e._seq
        })), this.checkRunningState())
      }
    }, {
      key: "checkRunningState",
      value: function() {
        this.isRunning || this.runCommand()
      }
    }, {
      key: "runCommand",
      value: function() {
        var t = this,
          e = this.commandList[0];
        if (e)
          if (this.isRunning = !0, !this.currentSeq || this.currentSeq && e._seq - this.currentSeq == 1) this.waited = !1, this.currentSeq = e._seq, this.commandList.shift(), this.cmdHandler(e);
          else if (e._seq - this.currentSeq > 1) {
          if (this.waited) return this.waited = !1, this.currentSeq = e._seq, this.commandList.shift(), void this.cmdHandler(e);
          this.waited = !0, this.timer = setTimeout((function() {
            t.runCommand()
          }), 100)
        }
      }
    }, {
      key: "bindCmdHandler",
      value: function(t) {
        this.cmdHandler = t
      }
    }, {
      key: "onCmdComplete",
      value: function() {
        this.commandList.length ? this.runCommand() : this.isRunning = !1
      }
    }, {
      key: "destroy",
      value: function() {
        this.timer && (clearTimeout(this.timer), this.timer = null), this.commandList = [], this.gameId = 0, this.seq = 0, this.currentSeq = null, this.waited = !1, this.icTimeout && clearTimeout(this.icTimeout), this.icTimeout = null, this.isRunning = !1
      }
    }]), i
  }();
exports.default = i;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8}],44:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../../@babel/runtime/helpers/classCallCheck"),
  r = require("../../@babel/runtime/helpers/createClass"),
  e = g(require("./singleCtrl")),
  l = g(require("./groupShareCtrl")),
  n = g(require("./battleCtrl")),
  i = g(require("./observeCtrl")),
  s = g(require("./playerCtrl")),
  a = g(require("./relayCtrl")),
  u = g(require("./reviewPageCtrl")),
  h = g(require("./getGiftPageCtrl")),
  c = g(require("../lib/mue/eventcenter")),
  o = require("../config"),
  C = require("../network/getAuth");

function g(t) {
  return t && t.__esModule ? t : {
    default: t
  }
}
var y = function() {
  function g(r) {
    var y, k, d = this;
    t(this, g), this.game = r, this.singleCtrl = new e.default(r, this), this.groupShareCtrl = new l.default(r, this), this.battleCtrl = new n.default(r, this), this.observeCtrl = new i.default(r, this), this.playerCtrl = new s.default(r, this), this.relayCtrl = new a.default(r, this), this.reviewPageCtrl = new u.default(r, this), this.getGiftPageCtrl = new h.default(r, this), this.model = r.gameModel, this.gameCtrl = r.gameCtrl, this.currentCtrl = null, this.rankGameChallenging = !1, c.default.on(o.EVENT.GOSTARTPAGE, this.goToSingleStartPage.bind(this)), null === (y = (k = wx).getRankManager) || void 0 === y || y.call(k).onChallengeStart((function(t) {
      (0, C.getAuthWxFriendInteraction)().then((function() {
        console.log("!!! rankManager.onChallengeStart", t), clearTimeout(d.game.deadTimeout), d.game.deadTimeout = null, d.changeMode("singleCtrl"), d.singleCtrl.clickStart(), d.model.setMode("rankGameChallenge"), c.default.emit(o.EVENT.CHALLENGE_START), d.rankGameChallenging = !0
      })).catch((function() {
        var r, e;
        console.log("!!! rankManager.abort", t), null === (r = (e = wx).getRankManager) || void 0 === r || r.call(e).abort()
      }))
    }))
  }
  return r(g, [{
    key: "initFirstPage",
    value: function(t) {
      var r = this.model.getMode();
      switch (console.log("init???", t, r), r) {
        case "single":
        case "rankGameChallenge":
          this.currentCtrl = this.singleCtrl, this.singleCtrl.init(t), this.gameCtrl.netWorkLogin();
          break;
        case "group分享":
          this.currentCtrl = this.groupShareCtrl, this.groupShareCtrl.init(t);
          break;
        case "battle":
          this.currentCtrl = this.battleCtrl, this.battleCtrl.init(t);
          break;
        case "observe":
          this.currentCtrl = this.observeCtrl, this.observeCtrl.init(t);
          break;
        case "relay":
          this.currentCtrl = this.relayCtrl, this.currentCtrl.init(t);
          break;
        case "reviewPage":
          this.currentCtrl = this.reviewPageCtrl, this.currentCtrl.init(t);
          break;
        case "getGiftPage":
          this.currentCtrl = this.getGiftPageCtrl, console.log("getGiftPage", this.getGiftPageCtrl), this.currentCtrl.init(t);
          break;
        default:
          this.currentCtrl = this.singleCtrl, this.model.setMode("single"), this.singleCtrl.init(t), this.gameCtrl.netWorkLogin()
      }
    }
  }, {
    key: "reInitFirstPage",
    value: function(t) {
      var r = this;
      this.currentCtrl && (this.currentCtrl.destroy(), this.gameCtrl.reviewCtrl.destroy(), this.currentCtrl = null), this.gameCtrl.queryCtrl.identifyMode(t), setTimeout((function() {
        r.initFirstPage(t)
      }), 500)
    }
  }, {
    key: "clickStart",
    value: function() {
      this.currentCtrl && this.currentCtrl.clickStart && this.currentCtrl.clickStart()
    }
  }, {
    key: "showGameOverPage",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.showGameOverPage && this.currentCtrl.showGameOverPage(t)
    }
  }, {
    key: "gameOverClickReplay",
    value: function() {
      this.currentCtrl && (this.currentCtrl.gameOverClickReplay ? this.currentCtrl.gameOverClickReplay() : this.game.handleWxOnError({
        message: "cannot Find this.currentCtrl.gameOverClickReplay",
        stack: this.game.mode + "" + this.game.stage
      }))
    }
  }, {
    key: "showFriendRank",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.showFriend第&& this.currentCtrl.showFriendRank(t)
    }
  }, {
    key: "showStartPage",
    value: function() {
      this.currentCtrl && this.currentCtrl.showStartPage && this.currentCtrl.showStartPage()
    }
  }, {
    key: "friendRankReturn",
    value: function() {
      this.currentCtrl && this.currentCtrl.friendRankReturn && this.currentCtrl.friendRankReturn()
    }
  }, {
    key: "shareGroupRank",
    value: function() {
      this.currentCtrl && this.currentCtrl.shareGroup第&& this.currentCtrl.shareGroupRank()
    }
  }, {
    key: "showGroupRankPage",
    value: function() {
      this.currentCtrl && this.currentCtrl.showGroupRankPage && this.currentCtrl.showGroupRankPage()
    }
  }, {
    key: "clickRank",
    value: function() {
      this.currentCtrl && this.currentCtrl.click第&& this.currentCtrl.clickRank()
    }
  }, {
    key: "showPkRule",
    value: function() {
      console.log("!!! modeCtrl showPkRulePage", this.currentCtrl), this.currentCtrl && this.currentCtrl.showPkRule && this.currentCtrl.showPkRule()
    }
  }, {
    key: "closePkRule",
    value: function() {
      console.log("!!! modeCtrl closePkRule", this.currentCtrl), this.currentCtrl && this.currentCtrl.closePkRule && this.currentCtrl.closePkRule()
    }
  }, {
    key: "setPkDuration",
    value: function() {
      console.log("!!! modeCtrl setPkDuration", this.currentCtrl), this.currentCtrl && this.currentCtrl.setPkDuration && this.currentCtrl.setPkDuration()
    }
  }, {
    key: "changeMode",
    value: function(t, r) {
      console.log("!!! modeCtrl changeMode", t, r), this.currentCtrl && this.currentCtrl.destroy && (this.currentCtrl.destroy(), this.gameCtrl.reviewCtrl.destroy()), this.model.setMode(this[t].name), console.log("!!! modeCtrl changeMode setMode", this.model.mode), this.currentCtrl = this[t], "singleCtrl" === t && c.default.emitSync(o.EVENT.GOTOSINGLESTARTPAGE, {}), this[t].init(r)
    }
  }, {
    key: "singleChangeToPlayer",
    value: function() {
      this.model.setMode(this.playerCtrl.name), this.currentCtrl = this.playerCtrl, this.playerCtrl.init()
    }
  }, {
    key: "groupPlayGame",
    value: function() {
      this.currentCtrl && this.currentCtrl.groupPlayGame && this.currentCtrl.groupPlayGame()
    }
  }, {
    key: "directPlaySingleGame",
    value: function() {
      this.currentCtrl && this.currentCtrl.destroy(), this.model.setMode(this.singleCtrl.name), this.currentCtrl = this.singleCtrl, this.singleCtrl.clickStart()
    }
  }, {
    key: "battlePlay",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.battlePlay && this.currentCtrl.battlePlay(t)
    }
  }, {
    key: "shareObservCard",
    value: function() {
      console.log("!!! modeCtrl shareObservCard", this.currentCtrl), this.currentCtrl && this.currentCtrl.shareObservCard && this.currentCtrl.shareObservCard()
    }
  }, {
    key: "socketJoinSuccess",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.socketJoinSuccess && this.currentCtrl.socketJoinSuccess(t)
    }
  }, {
    key: "showPlayerGG",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.showPlayerGG && this.currentCtrl.showPlayerGG(t)
    }
  }, {
    key: "showPlayerWaiting",
    value: function() {
      this.currentCtrl && this.currentCtrl.showPlayerWaiting && this.currentCtrl.showPlayerWaiting()
    }
  }, {
    key: "onPlayerOut",
    value: function() {
      this.currentCtrl && (this.currentCtrl.onPlayerOut ? this.currentCtrl.onPlayerOut() : this.game.handleWxOnError({
        message: "cannot Find this.currentCtrl.onPlayerOut",
        stack: this.game.mode + "" + this.game.stage
      }))
    }
  }, {
    key: "onViewerStart",
    value: function() {
      this.currentCtrl && this.currentCtrl.onViewerStart && this.currentCtrl.onViewerStart()
    }
  }, {
    key: "appealNotify",
    value: function() {
      this.currentCtrl && this.currentCtrl.appealNotify && this.currentCtrl.appealNotify()
    }
  }, {
    key: "onSocketOpen",
    value: function() {
      this.currentCtrl && this.currentCtrl.onSocketOpen && this.currentCtrl.onSocketOpen()
    }
  }, {
    key: "gotoRelayMode",
    value: function() {
      this.currentCtrl && this.currentCtrl.gotoRelayMode && this.currentCtrl.gotoRelayMode()
    }
  }, {
    key: "outRelay1",
    value: function() {
      this.currentCtrl && this.currentCtrl.outRelay1 && this.currentCtrl.outRelay1()
    }
  }, {
    key: "outRelay2",
    value: function() {
      this.currentCtrl && this.currentCtrl.outRelay2 && this.currentCtrl.outRelay2()
    }
  }, {
    key: "startRelay",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.startRelay && this.currentCtrl.startRelay(t)
    }
  }, {
    key: "watchRelay",
    value: function() {
      this.currentCtrl && this.currentCtrl.watchRelay && this.currentCtrl.watchRelay()
    }
  }, {
    key: "replayRelay",
    value: function() {
      this.currentCtrl && this.currentCtrl.replayRelay && this.currentCtrl.replayRelay()
    }
  }, {
    key: "shareRelay",
    value: function() {
      this.currentCtrl && this.currentCtrl.shareRelay && this.currentCtrl.shareRelay()
    }
  }, {
    key: "shareRelayLive",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.shareRelayLive && this.currentCtrl.shareRelayLive(t)
    }
  }, {
    key: "onSocketCloseErr",
    value: function() {
      this.currentCtrl && this.currentCtrl.onSocketCloseErr && this.currentCtrl.onSocketCloseErr()
    }
  }, {
    key: "touchProp",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.touchProp && this.currentCtrl.touchProp(t)
    }
  }, {
    key: "goToSingleStartPage",
    value: function(t) {
      console.log("!!! modeCtrl goToSingleStartPage", this.currentCtrl), this.currentCtrl == this.singleCtrl && this.game.reporter.singleBackStart(), this.changeMode("singleCtrl")
    }
  }, {
    key: "skipRelayBeginner",
    value: function() {
      this.currentCtrl && this.currentCtrl.skipRelayBeginner && this.currentCtrl.skipRelayBeginner()
    }
  }, {
    key: "handleAd",
    value: function(t) {
      this.currentCtrl && this.currentCtrl.handleAd && this.currentCtrl.handleAd(t)
    }
  }, {
    key: "afterShownStartPage",
    value: function() {
      this.currentCtrl && this.currentCtrl.afterShownStartPage && this.currentCtrl.afterShownStartPage()
    }
  }, {
    key: "wxOnShow",
    value: function() {
      this.currentCtrl && this.currentCtrl.wxOnShow && this.currentCtrl.wxOnShow()
    }
  }, {
    key: "wxOnhide",
    value: function() {
      this.currentCtrl && this.currentCtrl.wxOnhide && this.currentCtrl.wxOnhide()
    }
  }]), g
}();
exports.default = y;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/mue/eventcenter":67,"../network/getAuth":72,"./battleCtrl":38,"./getGiftPageCtrl":41,"./groupShareCtrl":42,"./observeCtrl":47,"./playerCtrl":49,"./relayCtrl":53,"./reviewPageCtrl":56,"./singleCtrl":57}],45:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/objectSpread2"),
  t = require("../../@babel/runtime/helpers/classCallCheck"),
  a = require("../../@babel/runtime/helpers/createClass"),
  o = n(require("../network/network")),
  i = n(require("../store/storage"));

function n(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var s = function() {
  function n(e) {
    var a = e.game,
      o = e.onReturn,
      i = e.onGoSkin,
      s = e.onGoProfile,
      r = e.onGoMyProfile;
    t(this, n), this.game = a, this.onReturn = o, this.onGoSkin = i, this.onGoProfile = s, this.onGoMyProfile = r, this.page_index = 1, this.page_count = 100, this.oldData = []
  }
  return a(n, [{
    key: "init",
    value: function() {
      var e = this,
        t = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
      if (this.arriveLastPage = !1, t) {
        wx.show加载中({
          mask: !0
        }), this.page_index = 1;
        var a = o.default.requestMsg({
          type: 1,
          page_index: 1,
          page_count: this.page_count
        });
        a.then((function(t) {
          if (wx.hide加载中(), !t || !t.msg_list || !t.msg_list.length) return e.arriveLastPage = !0, e.oldData = [], void e.showPage([]);
          t.msg_list.length < e.page_count && (e.arriveLastPage = !0);
          var a = e.handleServerData(t);
          e.oldData = a, e.showPage(a)
        }), (function(e) {
          console.log("request fail", e), wx.hide加载中(), wx.showToast({
            icon: "none",
            mask: !1,
            title: "网络繁忙",
            duration: 800
          })
        }))
      } else {
        var i = this.oldData || [];
        this.showPage(i)
      }
    }
  }, {
    key: "handleServerData",
    value: function() {
      var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {
          msg_list: []
        },
        a = [];
      return t.msg_list && t.ctx_info ? (t.msg_list.forEach((function(t) {
        a.push(e({
          timestamp: t.timestamp,
          sub_type: t.body.sub_type
        }, t.body.base_info))
      })), this.ctx_info = t.ctx_info) : this.ctx_info = {}, a
    }
  }, {
    key: "showPage",
    value: function(e) {
      var t = this;
      this.game.full2D.showMsgBox({
        msg_list: e,
        onReturn: function() {
          t.onReturn()
        },
        onGoSkin: function() {
          t.onGoSkin()
        },
        onGoProfile: function(e) {
          t.onGoProfile(e)
        },
        onGoMyProfile: function() {
          t.onGoMyProfile()
        },
        onGoMsgDetail5: function(e) {
          t.showDetailPage(e)
        },
        onEnd: function() {
          t.get下1步Page()
        }
      })
    }
  }, {
    key: "showDetailPage",
    value: function(t) {
      var a = this;
      this.game.full2D.showMsgDetailType5(e(e({}, t), {}, {
        onReturn: function() {
          a.showPage(a.oldData)
        }
      }))
    }
  }, {
    key: "getOldData",
    value: function() {
      var e = [];
      if (Array.isArray(this.oldData)) e = this.oldData;
      else {
        var t = i.default.getMsgBoxData();
        t && t.datalist && (e = t.datalist)
      }
      return e
    }
  }, {
    key: "saveOldData",
    value: function(e, t) {
      this.oldData = e, i.default.saveMsgBoxData({
        datalist: e,
        ctx_info: t
      })
    }
  }, {
    key: "get下1步Page",
    value: function() {
      var e = this;
      this.arriveLastPage || (wx.show加载中({
        mask: !0
      }), o.default.requestMsg({
        type: 1,
        page_index: this.page_index + 1,
        page_count: this.page_count,
        ctx_info: this.ctx_info
      }).then((function(t) {
        if (wx.hide加载中(), t && t.msg_list && t.msg_list.length) {
          e.page_index += 1, t.msg_list.length < e.page_count && (e.arriveLastPage = !0);
          var a = e.handleServerData(t);
          Array.isArray(e.oldData) && (e.oldData = e.oldData.concat(a)), e.game.full2D.updateMsgBox(a)
        } else e.arriveLastPage = !0
      }), (function() {
        wx.hide加载中(), wx.showToast({
          icon: "none",
          mask: !1,
          title: "网络繁忙",
          duration: 800
        })
      })))
    }
  }, {
    key: "destroy",
    value: function() {}
  }]), n
}();
exports.default = s;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/objectSpread2":20,"../network/network":73,"../store/storage":128}],46:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/slicedToArray"),
  t = require("../../@babel/runtime/helpers/typeof"),
  r = require("../../@babel/runtime/helpers/classCallCheck"),
  n = require("../../@babel/runtime/helpers/createClass"),
  i = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var r = c(t);
    if (r && r.has(e)) return r.get(e);
    var n = {},
      i = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var o in e)
      if ("default" !== o && Object.prototype.hasOwnProperty.call(e, o)) {
        var a = i ? Object.getOwnPropertyDescriptor(e, o) : null;
        a && (a.get || a.set) ? Object.defineProperty(n, o, a) : n[o] = e[o]
      } n.default = e, r && r.set(e, n);
    return n
  }(require("../network/network")),
  o = f(require("../store/storage")),
  a = f(require("../control/bottleSkinBaseCtrl")),
  u = require("../network/getAuth"),
  s = f(require("../lib/mue/eventcenter")),
  l = require("../config");

function f(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

function c(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    r = new WeakMap;
  return (c = function(e) {
    return e ? r : t
  })(e)
}
var d = function() {
  function f(e) {
    r(this, f), this.game = e, this.gameCtrl = e.gameCtrl, this.model = e.gameModel, this.loginCb = null, this.serverConfigInterval = null, this.historyTimes = this.game.historyTimes
  }
  return n(f, [{
    key: "netWorkLogin",
    value: function(e) {
      e && (this.loginCb = e), i.default.requestLogin(this.afterRequestLogin.bind(this))
    }
  }, {
    key: "afterRequestLogin",
    value: function(r) {
      var n = this;
      this.loginCb && this.loginCb(r);
      var o = i.default.get使用rInfo(this.afterGet使用rInfo.bind(this));
      o.then((function(e) {}), (function(e) {
        e && Math.random() < .1 && ("object" == t(e) && (e = JSON.stringify(e)), i.default.badReport("$$get使用rInfoFail;unknownError;".concat(e, ";"))), i.default.sendServerError(6)
      }));
      var f = wx.getLaunchOptionsSync(),
        c = function() {
          Promise.all([o, i.default.requestFriends本次得分(n.updateFriends本次得分.bind(n))]).then((function(t) {
            var r = e(t, 2),
              n = (r[0], r[1]);
            (0, u.requirePrivacyAuthorize)().then((function() {
              (0, u.getAuthWxFriendInteraction)().then((function() {
                console.warn("同意好友授权")
              })).catch((function() {
                console.warn("不同意好友授权")
              }))
            })), n && n.my_user_info && n.my_user_info.playback_id && a.default.setRankDataTolocalStorage(n.my_user_info)
          }), (function() {})), n.requestMmpayTimeout(), n.requestServerInit(), n.gameCtrl.onLoginSuccess()
        };
      r && !f.query.wxgamechallengeid ? c() : r && f.query.wxgamechallengeid && s.default.on(l.EVENT.CHALLENGE_START, (function() {
        c()
      }))
    }
  }, {
    key: "afterGet使用rInfo",
    value: function(e) {
      e.appeal_notify && this.gameCtrl.appealNotify()
    }
  }, {
    key: "requestServerInit",
    value: function() {
      i.default.requestInit(), this.serverConfigInterval = setInterval(i.default.requestInit.bind(i.default), 6e4)
    }
  }, {
    key: "requestMmpayTimeout",
    value: function() {
      var e = this;
      this.clearMmpayTimeout();
      var t = o.default.getMmpayBonusStatus();

      function r() {
        i.default.requestMmpayBonus((function(t, r) {
          t && r.data.svr_time ? 0 == r.data.pay_status.status ? (r.data.pay_status.expire_time < 120 && (r.data.pay_status.expire_time = 120), o.default.setMmpayBonusStatus(r.data.pay_status, r.data.svr_time), e.mmpayTimeout = setTimeout(e.requestMmpayTimeout.bind(e), 1e3 * r.data.pay_status.expire_time)) : 1 == r.data.pay_status.status && o.default.setMmpayBonusStatus(r.data.pay_status, r.data.svr_time) : e.mmpayTimeout = setTimeout(e.requestMmpayTimeout.bind(e), 12e4)
        }))
      }
      t ? 1 == t.status || 0 == t.status && r() : r()
    }
  }, {
    key: "clearMmpayTimeout",
    value: function() {
      this.mmpayTimeout && (clearTimeout(this.mmpayTimeout), this.mmpayTimeout = null)
    }
  }, {
    key: "clearServerInit",
    value: function() {
      this.serverConfigInterval && clearInterval(this.serverConfigInterval)
    }
  }, {
    key: "upDateFriends本次得分List",
    value: function() {
      var e = this;
      this.model.getSessionId() && i.default.requestFriends本次得分((function() {
        e.updateFriends本次得分2.bind(e).apply(void 0, arguments)
      })).then((function() {}), (function() {}))
    }
  }, {
    key: "update使用rInfo",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {},
        r = o.default.getMy使用rInfo();
      "object" == t(r) && r.open_id || i.default.get使用rInfo(e.bind(this)).then((function() {}), (function(e) {
        e && Math.random() < .1 && ("object" == t(e) && (e = JSON.stringify(e)), i.default.badReport("$$get使用rInfoFail;unknownError;".concat(e, ";"))), i.default.sendServerError(6)
      }))
    }
  }, {
    key: "updateFriends本次得分",
    value: function(e, t) {
      if (e && (t.user_info.sort((function(e, t) {
          return -(e.week_best_score || 0) + (t.week_best_score || 0)
        })), this.model.saveFriends本次得分(t.user_info), t.my_user_info)) {
        var r = t.my_user_info.history_best_score || 0;
        this.model.saveHeighest本次得分(r);
        var n = t.my_user_info.week_best_score || 0;
        this.model.weekBest本次得分 = n, this.model.saveWeekBest本次得分(n);
        var i = t.my_user_info.times;
        this.historyTimes.verify本次得分(i), t && t.my_user_info && a.default.setRankDataTolocalStorage(t.my_user_info)
      }
    }
  }, {
    key: "updateFriends本次得分2",
    value: function(e, t) {
      e && (t.user_info.sort((function(e, t) {
        return -(e.week_best_score || 0) + (t.week_best_score || 0)
      })), this.model.saveFriends本次得分(t.user_info), t.my_user_info && a.default.setRankDataTolocalStorage(t.my_user_info))
    }
  }, {
    key: "upload本次得分",
    value: function(e) {
      i.default.requestSettlement(e)
    }
  }, {
    key: "requestSettlement",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0,
        t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,
        r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : function() {},
        n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {};
      i.default.requestSettlement(e, t, r, n)
    }
  }, {
    key: "requestLogin",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
      i.default.requestLogin(e)
    }
  }, {
    key: "sendServerError",
    value: function() {
      i.default.sendServerError(2)
    }
  }, {
    key: "createRouterId",
    value: function(e) {
      i.default.createRouterId(e)
    }
  }], [{
    key: "getPropperty",
    value: function() {
      return i.default.getproperty().then((function(e) {
        return a.default.updateSkinExpireByPropertyList(e.property_list), Promise.resolve(e)
      }), (function(e) {
        return Promise.reject(e)
      }))
    }
  }]), f
}();
exports.default = d;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/slicedToArray":24,"../../@babel/runtime/helpers/typeof":30,"../config":37,"../control/bottleSkinBaseCtrl":39,"../lib/mue/eventcenter":67,"../network/getAuth":72,"../network/network":73,"../store/storage":128}],47:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/slicedToArray"),
  t = require("../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../@babel/runtime/helpers/createClass"),
  a = h(require("../pages/observe/observeWaiting")),
  n = h(require("../pages/observe/observeGg")),
  s = h(require("../pages/observe/observeOut")),
  o = h(require("../network/network")),
  r = require("../util/forceUpdate"),
  l = h(require("./bottleSkinBaseCtrl"));

function h(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var u = function() {
  function h(e, i) {
    t(this, h), this.game = e, this.name = "observe", this.gameCtrl = this.game.gameCtrl, this.model = this.game.gameModel, this.view = this.game.gameView, this.modeCtrl = i, this.netWorkCtrl = this.gameCtrl.netWorkCtrl, this.gameSocket = this.game.gameSocket, this.currentPage = null, this.waitingPage = new a.default(e), this.ggPage = new n.default(e), this.outPage = new s.default(e), this.gameId = "", this.longTimeout = null
  }
  return i(h, [{
    key: "init",
    value: function(e) {
      var t = this,
        i = this.model.getServerConfig();
      if (i && !i.audience_mode_switch) return this.view.showServeConfigForbiddenObserveMode(), void this.modeCtrl.changeMode("singleCtrl");
      if (e.query.version) {
        console.log("options.query.version", e.query.version);
        var a = e.query.version;
        1 == (0, r.compareMyVersion)(a) ? (0, r.forceUpdate)((function() {
          t.modeCtrl.changeMode("singleCtrl")
        }), "点击确定，进行版本更新后重试") : this.go(e)
      } else this.go(e)
    }
  }, {
    key: "go",
    value: function(e) {
      var t = this;
      this.model.setStage("");
      var i = this.model.getSessionId();
      this.gameId = e.query.gameId, this.model.setObserveInfo({
        headimg: e.query.headimg,
        nick姓th: e.query.nick姓th
      }), this.model.setGameId(this.gameId), wx.show加载中(), i ? this.afterLogin(!0, e) : this.netWorkCtrl.netWorkLogin((function(i) {
        t.afterLogin(i, e)
      }))
    }
  }, {
    key: "afterLogin",
    value: function(t, i) {
      var a = this;
      if (t) {
        var n, s, o = i.query.skin_id || "",
          r = i.query.skin_sn || "",
          h = i.query.bottle_skin_id || "";
        n = o && r ? this.game.skinManager.loadSkinForOtherMode(o, r).then((function() {
          return o
        }), (function(e) {
          return console.log("----observeCtrl---- ekili", e), Promise.reject(null)
        })) : Promise.resolve(null), s = h && 0 != h ? new Promise((function(e, t) {
          l.default.getBottleSkinShopData().then((function(i) {
            var a = null,
              n = i.bottleSkinShopList || [],
              s = n.findIndex((function(e) {
                return e.id == h
              }));
            s < 0 ? e(null) : (a = n[s], l.default.getBottleSkinResourceBySkinData(a).then((function() {
              e(a)
            }), (function(e) {
              t(e)
            })))
          }), (function(e) {
            t(e)
          }))
        })) : Promise.resolve(null), Promise.all([n, s]).then((function(t) {
          var i = e(t, 2),
            n = i[0],
            s = void 0 === n ? null : n,
            o = i[1];
          a.game.resetScene(null, {
            skinId: s,
            bottleSkin: o
          }), a.go2()
        }), (function(e) {
          console.log("GO observe fail", e), a.goToObserveStateFail()
        }))
      } else this.goToObserveStateFail()
    }
  }, {
    key: "go2",
    value: function() {
      this.setLongTimeHandle(), this.gameSocket.connectSocket(), this.model.setStage("")
    }
  }, {
    key: "socketJoinSuccess",
    value: function(e) {
      this.clearLongTimeHandle(), wx.hide加载中(), e ? (this.waitingPage.show(), this.model.setStage(this.waitingPage.name), this.currentPage = this.waitingPage, this.game.UI.set本次得分(0), this.checkPlayerTimeout = setInterval(this.checkPlayerState.bind(this), 1e4)) : this.showPlayerDead()
    }
  }, {
    key: "goToObserveStateFail",
    value: function() {
      this.view.showObserveStateFail(), this.modeCtrl.changeMode("singleCtrl")
    }
  }, {
    key: "setLongTimeHandle",
    value: function() {
      this.longTimeout = setTimeout(this.handleLongTime.bind(this), 9e3)
    }
  }, {
    key: "handleLongTime",
    value: function() {
      this.goToObserveStateFail()
    }
  }, {
    key: "clearLongTimeHandle",
    value: function() {
      null != this.longTimeout && (clearTimeout(this.longTimeout), this.longTimeout = null)
    }
  }, {
    key: "showPlayerDead",
    value: function() {
      this.gameSocket.close(), this.clearCheckPlayerTimeout(), this.currentPage && this.currentPage.hide(), this.outPage.show(), this.model.setStage(this.outPage.name), this.currentPage = this.outPage
    }
  }, {
    key: "checkPlayerState",
    value: function() {
      o.default.syncop(this.judgePlayerState.bind(this))
    }
  }, {
    key: "judgePlayerState",
    value: function(e, t) {
      e ? 0 != t.data.state && (this.clearCheckPlayerTimeout(), this.showPlayerDead()) : this.handleSyncopErr()
    }
  }, {
    key: "handleSyncopErr",
    value: function() {
      this.view.showSyncopErr(), this.goToObserveStateFail()
    }
  }, {
    key: "clearCheckPlayerTimeout",
    value: function() {
      null != this.checkPlayerTimeout && (clearInterval(this.checkPlayerTimeout), this.checkPlayerTimeout = null)
    }
  }, {
    key: "destroy",
    value: function() {
      this.currentPage && this.currentPage.hide(), this.currentPage = null, this.model.setStage(""), this.model.clearGameId(), this.clearLongTimeHandle(), this.clearCheckPlayerTimeout(), wx.hide加载中(), this.gameSocket.alive && this.gameSocket.close(), this.model.clearObserveInfo(), this.game.instructionCtrl.destroy(), this.game.deadTimeout && (clearTimeout(this.game.deadTimeout), this.game.deadTimeout = null), this.game.pendingReset = !1, this.game.resetScene()
    }
  }, {
    key: "showPlayerWaiting",
    value: function() {
      this.currentPage != this.waitingPage && (null != this.currentPage && this.currentPage.hide(), this.waitingPage.show(), this.model.setStage(this.waitingPage.name), this.currentPage = this.waitingPage)
    }
  }, {
    key: "showPlayerGG",
    value: function(e) {
      null != this.currentPage && this.currentPage.hide(), this.ggPage.show(e), this.model.setStage(this.ggPage.name), this.currentPage = this.ggPage
    }
  }, {
    key: "onPlayerOut",
    value: function() {
      this.showPlayerDead()
    }
  }, {
    key: "onViewerStart",
    value: function() {
      this.gameSocket.quitObserve(), this.game.instructionCtrl.destroy(), this.modeCtrl.directPlaySingleGame()
    }
  }, {
    key: "showGameOverPage",
    value: function() {}
  }, {
    key: "wxOnhide",
    value: function() {
      this.clearCheckPlayerTimeout(), this.gameSocket.quitObserve(), this.gameSocket.close(), this.game.resetScene()
    }
  }, {
    key: "wxOnshow",
    value: function() {}
  }]), h
}();
exports.default = u;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/slicedToArray":24,"../network/network":73,"../pages/observe/observeGg":86,"../pages/observe/observeOut":87,"../pages/observe/observeWaiting":88,"../util/forceUpdate":138,"./bottleSkinBaseCtrl":39}],48:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  a = s(require("../lib/mue/eventcenter")),
  i = s(require("../pages/headimgAnimation")),
  n = require("../config"),
  o = require("../lib/animation");

function s(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var m = function() {
  function s(t, a) {
    e(this, s), this.game = t, this.camera = a, this.waitingList = [], this.playerOver = !0, this.bindEvent()
  }
  return t(s, [{
    key: "isDied",
    value: function() {
      if (this.data)
        for (var e = 0, t = this.data.playerlist.length; e < t; ++e)
          if (this.data.playerlist[e].seat_no == this.data.my_seat_no) return this.data.playerlist[e].rank > 0
    }
  }, {
    key: "bindEvent",
    value: function() {
      var e = this;
      a.default.on(n.EVENT.RELAYSTART, (function(t, a) {
        e.game.resetScene(a.room_seed, {
          bottleShowupAnimation: !0,
          gameLevel: a.game_level,
          bottleSkin: null
        }), console.log("resetScene", a.room_seed, {
          gameLevel: a.game_level
        }), e.data = a, e.game.myTurn = a.my_seat_no == a.now_player_seat_no, e.game.myTurn && (e.playerOver = !1), console.log(" EVENT.RELAYSTART this.game.myTurn", e.game.myTurn, a.my_seat_no, a.now_player_seat_no)
      })), a.default.on(n.EVENT.ENDGAME, (function(t, a) {
        e.over = !0
      })), a.default.on(n.EVENT.RECEIVE_REALTIME_MSG, (function(t, a) {
        console.log("RECEIVE_REALTIME_MSG", a), e.waitingList.length > 0 || e.game.myTurn ? console.log("return waityinglist length > 0") : "-1" == a.realtime_msg.msginfo ? e.game.handleInterrupt() : (e.game.touchStartAnim(), e.game.bottle.relayLimitTime(parseFloat(a.realtime_msg.msginfo)), e.game.currentBlock.relayLimitTime(parseFloat(a.realtime_msg.msginfo)))
      })), a.default.on(n.EVENT.SEND_REALTIME_MSG_TO_CTRL, (function(t, i) {
        e.game.myTurn && a.default.emit(n.EVENT.SEND_REALTIME_MSG, {
          time: i.time
        })
      })), a.default.on(n.EVENT.RELAYCHECKUSER, (function(t, a) {
        console.log("relayCheck使用r", a), a.my_seat_no != a.now_player_seat_no ? (console.log("in relayCheck使用r"), a.msg_info.msginfo = JSON.parse(a.msg_info.msginfo), console.log("xxxx RELAYCHECKUSER", a.my_seat_no, a.now_player_seat_no, a.msg_info.msg_seq, a.msg_info.msg_id), !e.playerOver || e.waitingList.length > 0 ? (a.myType = "checkuser", console.log("push checkuser to waitingList"), e.waitingList.push(a)) : e._play(a)) : e.nowPlayerJump = !1
      })), a.default.on(n.EVENT.RUNGAME, (function(t, i) {
        if (console.log("ddddddddddd RUNGAME", i.my_seat_no, i.now_player_seat_no, e.playerOver), e.nowPlayerJump) return console.log("RUNGAME check user EORROR", i.my_seat_no, i.now_player_seat_no, e.playerOver), void a.default.emitSync(n.EVENT.GETRELAYCHECKUSERERROR);
        e.playerOver && e.waitingList.length <= 0 ? (e.game.myTurn = i.my_seat_no == i.now_player_seat_no, e.game.clicked = !1, e.data = i, e.game.myTurn && (e.playerOver = !1), a.default.emit(n.EVENT.ORDERRUNGAME, i)) : (i.myType = "rungame", console.log("push rungame to waitingList"), e.waitingList.push(i)), console.log("回合推进EVENT.RUNGAME，是否轮到我:", e.game.myTurn, "我的座位号：", i.my_seat_no, "当前玩的人座位号", i.now_player_seat_no)
      })), a.default.on(n.EVENT.NOWPLAYEROVER, (function(t, i) {
        if (e.playerOver = !0, console.log("in NOWPLAYEROVER data", i), 1 != i.hit && 7 != i.hit && 2 != i.hit && !e.over && e.data && 0 != e.data.my_seat_no && (i.fromProgressOver && !e.game.myTurn || a.default.emitSync(n.EVENT.PLAYERDIED, {
            player_rank: e.data.playerlist.length - e.data.failer_count,
            player_count: e.data.playerlist.length,
            my_seat_no: e.data.my_seat_no,
            playerlist: e.data.playerlist,
            now_player_seat_no: e.data.now_player_seat_no
          })), 0 !== i.hit && 3 !== i.hit && 4 !== i.hit && 5 !== i.hit && 6 !== i.hit || (e.waitingList.length > 0 ? e.game.relayBottleReset({
            noAnimation: !0
          }) : e.game.relayBottleReset()), e.game.myTurn || e.over || 0 == i.my_seat_no || i.fromProgressOver || e.isDied() || !e.data || a.default.emitSync(n.EVENT.CHECKUSER, {
            jump_succ: 1 == i.hit || 7 == i.hit || 2 == i.hit ? 1 : 0,
            msgid: e.data.msg_info.msgid,
            msg_seq: e.data.msg_info.msg_seq
          }), e.waitingList.length > 1)
          for (o.TweenAnimation.killAll(), e.game.camera.position.x = e.game.camera.destination[0] || e.game.camera.position.x, e.game.camera.position.z = e.game.camera.destination[1] || e.game.camera.position.z, e.game.camera.destination = [null, null], e.game.bottle.obj.position.x = e.game.bottle.destination[0] || e.game.bottle.obj.position.x, e.game.bottle.obj.position.z = e.game.bottle.destination[1] || e.game.bottle.obj.position.z; e.waitingList.length > 0;) {
            if ("checkuser" == (s = e.waitingList.shift()).myType) e.speedUpPlay(s, {
              fromWaitingList: !0
            });
            else if ("rungame" == s.myType) {
              if (!(m = s)) continue;
              e.game.myTurn = m.my_seat_no == m.now_player_seat_no, e.game.clicked = !1, e.data = m, e.game.myTurn && (e.playerOver = !1), a.default.emitSync(n.EVENT.ORDERRUNGAME, m)
            }
          } else if (1 == e.waitingList.length) {
            var s;
            if ("checkuser" == (s = e.waitingList.shift()).myType) e._play(s);
            else if ("rungame" == s.myType) {
              var m;
              if (!(m = s)) return;
              e.game.myTurn = m.my_seat_no == m.now_player_seat_no, e.game.clicked = !1, e.data = m, e.game.myTurn && (e.playerOver = !1), a.default.emitSync(n.EVENT.ORDERRUNGAME, m)
            }
          }
      })), a.default.on(n.EVENT.NOWPLAYERJUMP, (function() {
        e.nowPlayerJump = !0
      })), a.default.on(n.EVENT.SYNCSCENE, (function(t, a) {
        if (console.log("SYNCSCENE"), a && a.serverData) {
          e.destroy();
          var i = 0 == a.serverData.my_seat_no;
          if (e.game.isObserver = i, console.log("syncsene", a.now_msg_seq), console.log("zset", a.serverData.room_seed, a.serverData.game_level), e.game.resetScene(a.serverData.room_seed, {
              gameLevel: a.serverData.game_level,
              bottleSkin: null
            }), a.serverData.msg_list && a.serverData.msg_list.msg_list)
            for (var n = 0, o = a.serverData.msg_list.msg_list.length; n < o; ++n) a.serverData.msg_list.msg_list[n].msginfo = JSON.parse(a.serverData.msg_list.msg_list[n].msginfo), e.speedUpPlay(a.serverData.msg_list.msg_list[n])
        }
      })), a.default.on(n.EVENT.SHOW_RELAY_GUIDE, (function(t, a) {
        console.log("SHOW_RELAY_GUIDE");
        e.headimgAnimation = new i.default, e.headimgAnimation.set([{
          headimg: "res/2d/dog1.jpg",
          seat_no: 1
        }, {
          headimg: "res/2d/dog2.jpg",
          seat_no: 2
        }, {
          headimg: "res/2d/dog3.jpg",
          seat_no: 3
        }, {
          headimg: "res/2d/dog4.jpg",
          seat_no: 4
        }, {
          headimg: "res/2d/dog5.jpg",
          seat_no: 5
        }], {
          noEmit: !0
        }), e.headimgAnimation.obj.position.x = -8.8, e.headimgAnimation.obj.position.y = 20, e.camera.add(e.headimgAnimation.obj), e.headimgTimer = setInterval((function() {
          e.headimgAnimation.next()
        }), 4e3), e.game.resetScene(void 0, {
          bottleSkin: null
        }), setTimeout((function() {
          e.game.animating = !0, e.game.loopAnimate()
        }), 3500)
      })), a.default.on(n.EVENT.RELAYMODEDESTROY, (function() {
        e.destroy()
      })), a.default.on(n.EVENT.SKIP_RELAY_GUIDE, (function() {
        e.game.resetScene(void 0, {
          bottleSkin: null
        }), e.headimgTimer && (clearInterval(e.headimgTimer), e.headimgTimer = null), e.camera.remove(e.headimgAnimation.obj)
      })), a.default.on(n.EVENT.PROGRESSOVER, (function() {
        "jump" != e.game.bottle.status && (e.game.myTurn && (e.game.clicked = !0, e.game.handleInterrupt()), a.default.emitSync(n.EVENT.NOWPLAYEROVER, {
          fromProgressOver: !0
        }))
      }))
    }
  }, {
    key: "speedUpPlay",
    value: function(e, t) {
      if (!this.over) {
        var a, i;
        this.data = e, t && t.fromWaitingList ? (console.log("from waitingList", e, e.msg_info.msginfo.initY, e.msg_info.msginfo.duration), a = e.msg_info.msginfo.initY, i = e.msg_info.msginfo.duration) : (a = e.msginfo.initY, i = e.msginfo.duration);
        var n = this.game.touchEndAnim(i, a, null, null, {
          noAnimation: !0
        });
        1 == n || 7 == n ? (this.game.succeed({
          noAnimation: !0
        }), 1 === n ? (++this.game.doubleHit, this.game.UI.add本次得分(1, !0, !1)) : (this.game.doubleHit = 0, this.game.UI.add本次得分(1, !1, !1))) : 2 == n ? (this.game.bottle.obj.position.x = this.game.bottle.destination[0], this.game.bottle.obj.position.z = this.game.bottle.destination[1]) : this.game.relayBottleReset({
          noAnimation: !0
        })
      }
    }
  }, {
    key: "_play",
    value: function(e, t) {
      var a = this;
      if (this.over) console.log("疑问播放帧：", e, e.msg_seq);
      else {
        console.log("确认播放帧：", e, e.msg_seq), this.data = e, this.playerOver = !1;
        var i = e.msg_info.msginfo.initY,
          n = e.msg_info.msginfo.duration;
        this.game.touchStartAnim(t);
        var o = Math.max(n - this.game.bottle.prepareTime, 0);
        this.jumpTimer = setTimeout((function() {
          a.hit = a.game.touchEndAnim(n, i, null, null)
        }), 1e3 * o)
      }
    }
  }, {
    key: "destroy",
    value: function() {
      console.log("destroy relay"), this.over = !1, this.data = null, this.waitingList = [], this.nowPlayerJump = !1, this.playerOver = !0, this.game.clicked = !1, this.game.isObserver = !1, this.jumpTimer && (clearTimeout(this.jumpTimer), this.jumpTimer = null), this.deadTimer && (clearTimeout(this.deadTimer), this.deadTimer = null), this.headimgTimer && (clearInterval(this.headimgTimer), this.headimgTimer = null), this.headimgAnimation && this.camera.remove(this.headimgAnimation.obj)
    }
  }]), s
}();
exports.default = m;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/animation":66,"../lib/mue/eventcenter":67,"../pages/headimgAnimation":84}],49:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  a = require("../../@babel/runtime/helpers/get"),
  r = require("../../@babel/runtime/helpers/getPrototypeOf"),
  s = require("../../@babel/runtime/helpers/inherits"),
  i = require("../../@babel/runtime/helpers/createSuper"),
  l = u(require("./singleCtrl")),
  n = require("../shareApp"),
  h = u(require("../pages/player/playerGamePage")),
  o = u(require("../network/network")),
  g = u(require("./bottleSkinBaseCtrl"));

function u(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var m = function(l) {
  s(m, l);
  var u = i(m);

  function m(t, a) {
    var r;
    return e(this, m), (r = u.call(this, t, a)).name = "player", r.currentPage = null, r.gamePage = new h.default(t), r
  }
  return t(m, [{
    key: "init",
    value: function() {
      switch (this.model.stage) {
        case "game":
          this.currentPage = this.gamePage, this.currentPage.show();
          break;
        case "singleSettlementPgae":
          this.currentPage = this.gameOverPage;
          break;
        default:
          this.model.setStage(this.gamePage.name), this.currentPage = this.gamePage, this.currentPage.show()
      }
    }
  }, {
    key: "showGameOverPage",
    value: function(e) {
      this.game.seq++, this.gameSocket.sendCommand(this.game.seq, {
        type: -1,
        s: this.game.current本次得分
      }), a(r(m.prototype), "showGameOverPage", this).call(this, e)
    }
  }, {
    key: "shareObservCard",
    value: function() {
      console.log("!!! playerCtrl shareObservCard"), this.shareObservCardA()
    }
  }, {
    key: "shareObservCardA",
    value: function() {
      this.shareObservCardB()
    }
  }, {
    key: "shareObservCardB",
    value: function() {
      var e = this;
      this.model.setStage("loading");
      var t = g.default.getSelectedSkinId();
      (0, n.shareObserve)({
        bottle_skin_id: t,
        skin_id: this.game.skin_id,
        skin_sn: this.game.skin_sn,
        cb: function(t, a) {
          t && e.gameCtrl.after分享ObserveCard(a)
        }
      })
    }
  }, {
    key: "gameOverClickReplay",
    value: function() {
      a(r(m.prototype), "gameOverClickReplay", this).call(this), this.game.seq++, this.gameSocket.sendCommand(this.game.seq, {
        type: 0,
        seed: this.game.randomSeed
      }), this.game.reporter.rpPlayerClickPlayAgain()
    }
  }, {
    key: "destroy",
    value: function() {
      this.currentPage && this.currentPage.hide(), this.currentPage = null, this.model.setStage(""), this.gameSocket.alive && (o.default.quitGame(), this.gameSocket.close()), this.model.clearGameId(), this.model.clearGameTicket(), this.game.viewer.reset(), this.game.deadTimeout && (clearTimeout(this.game.deadTimeout), this.game.deadTimeout = null), this.game.pendingReset = !1, this.model.adInfo = {
        canShowAd: !this.model.getAdTagInLS(),
        advertisingInfo: {}
      }, this.game.resetScene()
    }
  }, {
    key: "wxOnhide",
    value: function() {
      var e = this;
      "loading" != this.model.stage && "singleSettlementPgae" != this.model.stage && "friendRankList" != this.model.stage && (o.default.quitGame(), this.gameSocket.cleanHeartBeat(), this.gameSocket.close(), setTimeout((function() {
        e.modeCtrl.changeMode("singleCtrl")
      }), 100))
    }
  }, {
    key: "wxOnShow",
    value: function() {
      "loading" == this.model.stage && this.model.setStage("game")
    }
  }]), m
}(l.default);
exports.default = m;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/createSuper":10,"../../@babel/runtime/helpers/get":12,"../../@babel/runtime/helpers/getPrototypeOf":13,"../../@babel/runtime/helpers/inherits":14,"../network/network":73,"../pages/player/playerGamePage":103,"../shareApp":124,"./bottleSkinBaseCtrl":39,"./singleCtrl":57}],50:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/toArray"),
  r = require("../../@babel/runtime/helpers/slicedToArray"),
  a = require("../../@babel/runtime/helpers/objectSpread2"),
  t = require("../../@babel/runtime/helpers/classCallCheck"),
  o = require("../../@babel/runtime/helpers/createClass"),
  i = (l(require("../store/storage")), l(require("../network/network"))),
  s = l(require("../pages/profile/profile")),
  n = l(require("../control/propertyCtrl"));

function l(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var u = function() {
  function l(e) {
    var r = this,
      o = e.game,
      n = e.onReturn,
      u = e.onGoRecord,
      d = e.scene,
      p = e.user_data;
    t(this, l);
    var _ = this;
    this.game = o, this.onReturn = n, this.onGoRecord = u, this.scene = d, this.user_data = p, this.profilePage = new s.default({
      game: o,
      onGoRecord: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
        r.onGoRecord && r.onGoRecord(a(a({}, r.profileData), {}, {
          playback_id: r.user_data.playback_id,
          routesArr: e
        }))
      },
      onLike: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
        _.data && !_.data.praise_info.is_already_praise && (_.data.praise_info.is_already_praise = 1, i.default.sendLikeTo(_.user_data.playback_id).then((function() {
          _.profilePage.updateProfilePraiseStatus(1), _.game.reporter.rpLike({
            open_user_id: _.user_data.playback_id
          })
        }), (function() {
          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
          _.data.praise_info.is_already_praise = 0, _.game.reporter.rpLike({
            open_user_id: _.user_data.playback_id,
            result: 1,
            praise_over_limit: 1 == e.overLimit ? 0 : 1
          }), wx.showToast({
            title: "点赞失败",
            icon: "none"
          })
        })));
        for (var r = e.length, a = r - 1; a >= 0; a--) {
          if ("start" == e[a]) {
            _.game.reporter.rpStartPageFriendInfoLike();
            break
          }
          if ("gameOver" == e[a]) {
            _.game.reporter.rpGameOverOnlike();
            break
          }
        }
      },
      onReturn: function() {
        r.destory && r.destory(), r.onReturn && r.onReturn()
      }
    })
  }
  return o(l, [{
    key: "init",
    value: function() {
      var t, o = this,
        s = this;
      if (!s.user_data.playback_id && !s.user_data.open_user_id) return console.log("-----------------------------"), console.log("-----------------------------"), console.log("-----------------------------"), console.log("-----------------------------"), console.log("-----------------------------"), console.log("-----------------------------"), void console.log(s.user_data);

      function l(e) {
        s.profilePage.show(e);
        var r = !!e.is_self;
        s.game && s.game.reporter && s.game.reporter.rpClickProfile(r)
      }
      s.user_data.open_user_id && (s.user_data.playback_id = s.user_data.open_user_id), wx.show加载中(), t = function(e) {
        var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
        s.data = a(a({}, e), {}, {
          propsData: r,
          is_self: o.user_data.is_self
        }), l(o.data)
      }, Promise.all([s.user_data.is_self ? n.default.getProps() : Promise.resolve(), i.default.get使用rProfile(s.user_data.playback_id)]).then((function(a) {
        var o = r(a, 2),
          i = o[0],
          n = void 0 === i ? [] : i,
          l = o[1];
        if (n && Array.isArray(n.property_list)) {
          var u = e(n.property_list).slice(0);
          n.property_list = u.filter((function(e) {
            return 1 == e.item_id
          }))
        }
        wx.hide加载中(), s.profileData = l, t(l, n)
      }), (function(e) {
        wx.hide加载中(), wx.showToast({
          title: "获取数据失败",
          icon: "none"
        }), s.destory()
      }))
    }
  }, {
    key: "showPage",
    value: function() {
      this.profilePage.show(this.data);
      var e = !!this.data.is_self;
      this.game && this.game.reporter && this.game.reporter.rpClickProfile(e)
    }
  }, {
    key: "destory",
    value: function() {}
  }]), l
}();
exports.default = u;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/objectSpread2":20,"../../@babel/runtime/helpers/slicedToArray":24,"../../@babel/runtime/helpers/toArray":26,"../control/propertyCtrl":51,"../network/network":73,"../pages/profile/profile":104,"../store/storage":128}],51:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/toConsumableArray"),
  r = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = p(require("../network/network")),
  n = p(require("../control/networkCtrl")),
  o = (p(require("../lib/mue/eventcenter")), require("../config"));

function p(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var s = {
    propArray: [],
    item_list: []
  },
  u = function() {
    function p() {
      r(this, p)
    }
    return t(p, null, [{
      key: "getProps",
      value: function() {
        var e = this,
          r = n.default.getPropperty();
        return r.then((function(r) {
          s.propArray = r.property_list, s.item_list = r.item_list, e.prepareAllIcon()
        }), (function() {})), r
      }
    }, {
      key: "getPropsData",
      value: function() {
        return e(s.propArray)
      }
    }, {
      key: "getSuccPropList",
      value: function() {
        var r = s.succ_property_list || [];
        return e(r)
      }
    }, {
      key: "can使用Prop",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1,
          r = !1,
          t = this.getFirstPropByClass(e);
        return r = t > -1, this.resetUsingList(), r
      }
    }, {
      key: "confirmUsingProp",
      value: function(e) {
        var r = this,
          t = e.id,
          n = e.game,
          o = e.seed,
          p = new Promise((function(e, n) {
            var p = r.getFirstPropByClass(t);
            if (p > -1) {
              var u = s.propArray[p].property_id;
              i.default.useproperty({
                property_id: u,
                seed: o
              }).then((function() {
                e(u)
              }), (function() {
                n({
                  type: 1,
                  errMsg: "property_id confirm fail",
                  property_id: u,
                  item_id: t
                })
              }))
            } else n({
              type: 0,
              errMsg: "can not find any props"
            })
          }));
        return p.then((function(e) {
          r.usingProp(t, e, n)
        }), (function(e) {
          console.log(e), e.property_id && e.item_id && r.addFail(e.item_id, e.property_id)
        })), p
      }
    }, {
      key: "usingProp",
      value: function(e, r, t) {
        if (Array.isArray(s.propArray)) {
          var i = s.propArray.findIndex((function(e) {
            return e.property_id == r
          }));
          i > -1 && (s.propArray.splice(i, 1), this.gameUsingProp(e, t, {
            property_id: r,
            item_id: e
          }), this.addSuccess(e, r))
        }
      }
    }, {
      key: "gameUsingProp",
      value: function(e, r, t) {
        switch (e) {
          case 1:
            r.wellJump(t)
        }
      }
    }, {
      key: "reviewUsingProp",
      value: function(e, r, t) {
        switch (e) {
          case 1:
            r.wellJump(t), this.audienceWatchPropAni(r, e)
        }
      }
    }, {
      key: "observeUsingProp",
      value: function(e, r, t) {
        switch (e) {
          case 1:
            r.observeWellJump(t), this.audienceWatchPropAni(r, e)
        }
      }
    }, {
      key: "getFirstPropById",
      value: function(e) {
        return this.getPropById("property_id", e)
      }
    }, {
      key: "getFirstPropByClass",
      value: function(e) {
        return this.getPropById("item_id", e)
      }
    }, {
      key: "getPropById",
      value: function(e, r) {
        var t = -1;
        return Array.isArray(s.propArray) && (t = s.propArray.findIndex((function(t) {
          return t[e] == r
        }))), t
      }
    }, {
      key: "resetUsingList",
      value: function() {
        s.succ_property_list = [], s.fail_property_list = []
      }
    }, {
      key: "addSuccess",
      value: function(e, r) {
        Array.isArray(s.succ_property_list) || (s.succ_property_list = []), s.succ_property_list.push({
          item_id: e,
          property_id: r
        })
      }
    }, {
      key: "addFail",
      value: function(e, r) {
        Array.isArray(s.fail_property_list) || (s.fail_property_list = []), s.fail_property_list.push({
          item_id: e,
          property_id: r
        })
      }
    }, {
      key: "handleGameOver",
      value: function(e) {
        var r = this;
        if (s.fail_property_list && s.fail_property_list.length) {
          e.succ_property_list = s.succ_property_list.slice(0), e.fail_property_list = s.fail_property_list.slice(0);
          var t = i.default.revertproperty(e, 0);
          t.then((function() {
            r.getProps()
          }), (function() {
            r.getProps()
          }))
        }
      }
    }, {
      key: "prepareAllIcon",
      value: function() {
        var e = [];
        for (var r in o.PROP_BOARD.skin) {
          var t = this.prepareSingleSkin(r);
          e.push(t)
        }
        return Promise.all(e)
      }
    }, {
      key: "prepareSingleSkin",
      value: function(e) {
        new Promise((function(r, t) {
          o.PROP_BOARD.skinTexture[e] || r(), o.loader.load(o.PROP_BOARD.skin[e], (function(t) {
            o.PROP_BOARD.skinTexture[e] = t, r()
          }), (function() {}), (function() {
            t()
          }))
        }))
      }
    }, {
      key: "audienceWatchPropAni",
      value: function(e, r) {
        e && e.UI && e.UI.audienceWatchPropAni && e.UI.audienceWatchPropAni(r)
      }
    }, {
      key: "checkUsingProp",
      value: function() {
        return !(!s.succ_property_list || !s.succ_property_list.length)
      }
    }]), p
  }();
exports.default = u;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/toConsumableArray":27,"../config":37,"../control/networkCtrl":46,"../lib/mue/eventcenter":67,"../network/network":73}],52:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  s = function() {
    function s(t) {
      e(this, s), this.game = t, this.model = this.game.gameModel, this.gameCtrl = this.game.gameCtrl, this.gameView = this.game.gameView
    }
    return t(s, [{
      key: "identifyMode",
      value: function(e) {
        if (e.query && e.query.hasOwnProperty("mode")) switch (e.query.mode) {
          case "group分享":
            e.shareTicket ? this.model.setMode("group分享") : (this.gameCtrl.identifyModeErr("获取群信息失败"), this.model.setMode("single"));
            break;
          case "battle":
            e.query.pkId ? this.model.setMode("battle") : (this.gameCtrl.identifyModeErr("获取PK信息失败"), this.model.setMode("single"));
            break;
          case "observe":
            e.query.gameId ? this.model.setMode("observe") : (this.gameCtrl.identifyModeErr("获取围观信息失败"), this.model.setMode("single"));
            break;
          case "relay":
            e.query.room_id && e.query.router_id && e.query.version ? this.model.setMode("relay") : this.model.setMode("single");
            break;
          case "reviewPage":
            e.query.open_playback_id ? this.model.setMode("reviewPage") : this.model.setMode("single");
            break;
          case "getGiftPage":
            e.query.id ? (this.model.setMode("getGiftPage"), this.game.reporter.rpClickComeInSkin分享()) : this.model.setMode("single");
            break;
          default:
            this.model.setMode("single")
        } else this.model.setMode("single")
      }
    }]), s
  }();
exports.default = s;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8}],53:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/regeneratorRuntime"),
  t = require("../../@babel/runtime/helpers/asyncToGenerator"),
  o = require("../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../@babel/runtime/helpers/createClass"),
  a = require("../config"),
  n = f(require("../lib/mue/eventcenter")),
  s = f(require("../pages/relay/room")),
  r = require("../shareApp"),
  l = f(require("../pages/relay/gamePage")),
  d = f(require("../pages/relay/fakeRoomPage")),
  h = require("../util/forceUpdate"),
  c = require("../network/getAuth"),
  m = f(require("../network/network")),
  u = require("../chattool");

function f(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var y = function() {
  function f(e, t) {
    o(this, f), this.name = "relay", this.game = e, this.reporter = e.reporter, this.modeCtrl = t, this.gameCtrl = this.game.gameCtrl, this.model = this.game.gameModel, this.view = this.game.gameView, this.netWorkCtrl = this.gameCtrl.netWorkCtrl, this.onSocketOpenCb = function() {}, this.socketTimeout = null, this.gameSocket = this.game.gameSocket, this.reconnectTimeout = null, this.currentPage = null, this.roomPage = new s.default(e), this.gamePage = new l.default(e), this.fakeRoomPage = new d.default(e), this.scene = 1, this.setStartRelayReportTimeOut = null, this.socketMonitor = this.game.socketMonitor
  }
  var y, E;
  return i(f, [{
    key: "init",
    value: function(e) {
      if (e && e.scene) switch (e.scene) {
        case 1044:
          this.scene = 0;
          break;
        default:
          this.scene = 1
      }
      this.addEvent(), this.createRoomNoAddEvent(e)
    }
  }, {
    key: "createRoomNoAddEvent",
    value: function(e) {
      var t = this;
      this.options = e, e ? this.changePage("fakeRoomPage", 0) : this.changePage("fakeRoomPage", 1), (0, c.getAuth使用rInfo)(!1, !1).then((function() {
        t.model.getSessionId() ? t.afterLogin(e, !0) : t.netWorkCtrl.netWorkLogin(t.afterLogin.bind(t, e)), t.is分享Card = !1
      })).catch((function() {
        t.game.full2D._drawAuthModal()
      }))
    }
  }, {
    key: "afterLogin",
    value: function(e, t) {
      var o = this;
      if (!t) return this.view.showJoinRelayFail("n0"), e || n.default.emit(a.EVENT.CREATE_RELAY_ROOM_FAIL, {
        result: 1
      }), void this.modeCtrl.changeMode("singleCtrl");
      if (e) {
        console.log("options12312312312", e);
        var i = e.query.room_id,
          s = decodeURIComponent(e.query.router_id),
          r = e.query.version,
          l = e.shareTicket,
          d = e.query.activityId;
        if (console.log("optionsoptionsoptionsoptions", s), a.VERSION != r) this.rpJoinRoom(1), 1 == (0, h.compareMyVersion)(r) ? (0, h.forceUpdate)((function() {
          o.modeCtrl.changeMode("singleCtrl")
        }), "点击确定，进行版本更新后重试") : (this.view.showVersionMismatching(), this.modeCtrl.changeMode("singleCtrl"));
        else Array.isArray(GameGlobal.liveRooms) || (GameGlobal.liveRooms = []), e.query.is_live && GameGlobal.liveRooms.push(i), this.model.relayInfo = {
          activityId: d,
          room_id: i,
          router_id: s
        }, wx.get分享Info({
          shareTicket: l,
          success: function(t) {
            o.model.relayInfo.shareInfo = {
              activityId: d,
              sharePath: e.query,
              shareTicket: t.rawData || t.encryptedData
            }
          },
          complete: function() {
            o.joinRelayRoom()
          }
        })
      } else this.netWorkCtrl.createRouterId(this.afterCreateRouterId.bind(this))
    }
  }, {
    key: "afterCreateRouterId",
    value: function(e, t) {
      e ? (this.model.relayInfo = {
        router_id: t
      }, this.masterCreateRoom()) : (this.view.showJoinRelayFail(t), n.default.emit(a.EVENT.CREATE_RELAY_ROOM_FAIL, {
        result: 1
      }), this.modeCtrl.changeMode("singleCtrl"))
    }
  }, {
    key: "masterCreateRoom",
    value: function() {
      this.onSocketOpenCb = this.socketCreateRoom.bind(this), this.connectSocket(this.masterCreateRoomFail.bind(this))
    }
  }, {
    key: "joinRelayRoom",
    value: function(e) {
      var t = e || this.joinRelayRoomFail.bind(this);
      this.onSocketOpenCb = this.socketJoinRoom.bind(this), this.connectSocket(t)
    }
  }, {
    key: "join下1步RelayRoom",
    value: function() {
      console.warn("!!! join下1步RelayRoom"), n.default.emitSync(a.EVENT.RELAYMODEDESTROY, {}), this.clearSocketTimeout(), this.scene = 2, this.onSocketOpenCb = this.socketJoin下1步Room.bind(this), this.connectSocket(this.joinRelayRoomFail.bind(this))
    }
  }, {
    key: "connectSocket",
    value: function(e) {
      this.socketTimeout = setTimeout(e, 5e3), this.gameSocket.alive ? this.onSocketOpenCb() : this.gameSocket.connectSocket()
    }
  }, {
    key: "onSocketOpen",
    value: function() {
      this.onSocketOpenCb()
    }
  }, {
    key: "socketCreateRoom",
    value: function() {
      var e = {
        cmdid: 10001,
        buff: {
          router_id: this.model.relayInfo.router_id,
          version: a.VERSION
        }
      };
      this.sendRelayCmd(e)
    }
  }, {
    key: "socketJoinRoom",
    value: function() {
      var e = {
        cmdid: 10002,
        buff: {
          room_id: this.model.relayInfo.room_id
        }
      };
      this.sendRelayCmd(e)
    }
  }, {
    key: "socketJoin下1步Room",
    value: function() {
      var e = {
        cmdid: 10011,
        buff: {
          room_id: this.model.relayInfo.room_id
        }
      };
      this.sendRelayCmd(e)
    }
  }, {
    key: "sendRelayMsg",
    value: function(e, t) {
      var o = t.time,
        i = {
          cmdid: 10015,
          buff: {
            room_id: this.model.relayInfo.room_id,
            msg_info: {
              msginfo: o
            },
            msg_seq: this.game.relayInstructionCtrl.msg_seq
          }
        };
      this.sendRelayCmd(i)
    }
  }, {
    key: "joinRoomSucc",
    value: (E = t(e().mark((function t(o, i) {
      var a, n, s;
      return e().wrap((function(e) {
        for (;;) switch (e.prev = e.next) {
          case 0:
            return console.log("加入房间成功 joinRoomSucc", o, i, this.model.relayInfo), this.clearSocketTimeout(), this.rpJoinRoom(0), this.model.relayInfo.shareInfo && (this.after分享Relay(this.model.relayInfo.shareInfo.sharePath, this.model.relayInfo.shareInfo.shareTicket), this.model.relayInfo.shareInfo = null), this.model.relayInfo.room_seed = i.room_seed, this.model.relayInfo.my_seat_no = i.my_seat_no, this.model.relayInfo.next_room_id = i.next_room_id, this.model.relayInfo.activity_id = i.activity_id, this.model.relayInfo.room_wxa_code = "", e.prev = 9, e.next = 12, (0, u.getGroupEnterInfo)(i.room_id);
          case 12:
            a = e.sent, n = a.activity_id, s = a.group_openid, this.model.chatToolActivityId = n, this.model.groupOpenid = s, e.next = 22;
            break;
          case 19:
            e.prev = 19, e.t0 = e.catch(9), console.error("!!! joinRoomSucc getGroupEnterInfo fail", e.t0);
          case 22:
            console.log("!!! joinRoomSucc data.my_seat_no", i.my_seat_no), console.log("!!! joinRoomSucc data.room_owner_seat", i.room_owner_seat), this.model.chatToolActivityId && this.model.groupOpenid ? i.my_seat_no !== i.room_owner_seat && 0 !== i.my_seat_no && m.default.sendChatToolMsg({
              data: {
                activity_id: this.model.chatToolActivityId,
                target_state: 1,
                participator_info_list: [{
                  group_openid: this.model.groupOpenid,
                  state: 1
                }],
                room_id: i.room_id
              }
            }).catch((function(e) {
              console.error("!!! 未发送聊天模式消息：", e)
            })) : console.warn("!!! joinRoomSucc chatToolActivityId or groupOpenid is null"), this.setCheckGameInterval(), 0 != i.my_seat_no && 1 == i.game_status ? this.rejoinRelay() : this.changePage("roomPage", i);
          case 27:
          case "end":
            return e.stop()
        }
      }), t, this, [
        [9, 19]
      ])
    }))), function(e, t) {
      return E.apply(this, arguments)
    })
  }, {
    key: "joinRelayRoomFail",
    value: function() {
      console.log("joinRelayRoomFail"), this.rpJoinRoom(1), this.view.showJoinRelayFail2(), this.modeCtrl.changeMode("singleCtrl")
    }
  }, {
    key: "masterCreateRoomFail",
    value: function() {
      console.log("masterCreateRoomFail"), n.default.emit(a.EVENT.CREATE_RELAY_ROOM_FAIL, {
        result: 1
      }), this.view.showJoinRelayFail2(), this.modeCtrl.changeMode("singleCtrl")
    }
  }, {
    key: "createRoomSucc",
    value: (y = t(e().mark((function t(o, i) {
      return e().wrap((function(e) {
        for (;;) switch (e.prev = e.next) {
          case 0:
            console.log("createRoomSucc"), this.clearSocketTimeout(), this.model.relayInfo.room_id = i.room_id, this.model.relayInfo.room_seed = i.room_seed, this.model.relayInfo.my_seat_no = i.my_seat_no, this.model.relayInfo.activity_id = i.activity_id, this.model.relayInfo.room_wxa_code = "", this.model.relayInfo.next_room_id = i.next_room_id, this.setCheckGameInterval(), n.default.emit(a.EVENT.CREATE_RELAY_ROOM_FAIL, {
              result: 0
            }), this.changePage("roomPage", i);
          case 11:
          case "end":
            return e.stop()
        }
      }), t, this)
    }))), function(e, t) {
      return y.apply(this, arguments)
    })
  }, {
    key: "sendRelayCmd",
    value: function(e) {
      var t = e.cmdid,
        o = e.buff;
      t && ("10006" != t && console.log("向服务器发送指令：", t, "数据：", o), o = JSON.stringify(o), this.gameSocket.sendRelayCmd({
        cmdid: t,
        buff: o
      }))
    }
  }, {
    key: "clearSocketTimeout",
    value: function() {
      clearTimeout(this.reconnectTimeout), clearTimeout(this.socketTimeout), this.clearCheckGameInterval(), this.socketTimeout = null, this.reconnectTimeout = null
    }
  }, {
    key: "changePage",
    value: function(e, t) {
      this.currentPage && this.currentPage.hide();
      var o = this[e];
      o && (this.currentPage = o, this.model.setStage(o.name), this.currentPage.show(t))
    }
  }, {
    key: "shareRelay",
    value: function() {
      var e = this.model.relayInfo,
        t = e.room_id,
        o = e.router_id,
        i = a.VERSION,
        n = this.after分享Relay.bind(this);
      this.is分享Card = !0, (0, r.分享RelayCard)({
        room_id: t,
        router_id: o,
        version: i,
        cb: n
      }), this.reporter.rpClick分享Observe()
    }
  }, {
    key: "after分享Relay",
    value: function(e, t, o) {
      if (console.log("!!! after分享Relay", e, t, o), this.model.chatToolActivityId = o, e && t && this.gameSocket.alive) {
        var i = {
          cmdid: 10014,
          buff: {
            room_id: this.model.relayInfo.room_id,
            session_id: this.model.getSessionId(),
            share_ticket: t,
            share_query: "?" + e
          }
        };
        this.sendRelayCmd(i), this.reporter.rpRelayClickCard分享()
      }
    }
  }, {
    key: "shareRelayLive",
    value: function(e) {
      var t = e.game_level,
        o = e.game_level_s,
        i = e.member_count;
      this.model.relayInfo.is_live_master = !0;
      var n = this.model.relayInfo,
        s = n.room_id,
        l = n.router_id,
        d = n.activity_id,
        h = a.VERSION,
        c = this.after分享Relay.bind(this);
      (0, r.分享RelayLiveCard)({
        room_id: s,
        router_id: l,
        version: h,
        cb: c,
        activity_id: d,
        game_level: t,
        game_level_s: o,
        member_count: i
      })
    }
  }, {
    key: "addEvent",
    value: function() {
      n.default.on(a.EVENT.RELAYCREATEROOM, this.createRoomSucc.bind(this)), n.default.on(a.EVENT.JOINRELAYROOM, this.joinRoomSucc.bind(this)), n.default.on(a.EVENT.PEOPLECOME, this.upDateRoom.bind(this)), n.default.on(a.EVENT.PEOPLEOUT, this.upDateRoom.bind(this)), n.default.on(a.EVENT.RELAYSTART, this.relayGameStart.bind(this)), n.default.on(a.EVENT.NOWPLAYERJUMP, this.sendPlayerJumpMsg.bind(this)), n.default.on(a.EVENT.CHECKUSER, this.check使用r.bind(this)), n.default.on(a.EVENT.REPLAYAGAIN, this.join下1步Room.bind(this)), n.default.on(a.EVENT.SYNCMSGSEQ, this.syncMsgSeq.bind(this)), n.default.on(a.EVENT.SEND_CHECK_GAME, this.sendCheckGame.bind(this)), n.default.on(a.EVENT.ENDGAME, this.endGame.bind(this)), n.default.on(a.EVENT.CHANGEGAMELEVEL, this.sendChangeGameLevel.bind(this)), n.default.on(a.EVENT.RECEIVEGAMELEVELCHANGE, this.receiveGameLevelChange.bind(this)), n.default.on(a.EVENT.GETRELAYQR, this.getRelayQR.bind(this)), n.default.on(a.EVENT.GETRELAYCHECKUSERERROR, this.syncRelay.bind(this)), n.default.on(a.EVENT.SEND_REALTIME_MSG, this.sendRelayMsg.bind(this))
    }
  }, {
    key: "offEvent",
    value: function() {
      n.default.off(a.EVENT.RELAYCREATEROOM, this.createRoomSucc.bind(this)), n.default.off(a.EVENT.JOINRELAYROOM, this.joinRoomSucc.bind(this)), n.default.off(a.EVENT.PEOPLECOME, this.upDateRoom.bind(this)), n.default.off(a.EVENT.PEOPLEOUT, this.upDateRoom.bind(this)), n.default.off(a.EVENT.RELAYSTART, this.relayGameStart.bind(this)), n.default.off(a.EVENT.NOWPLAYERJUMP, this.sendPlayerJumpMsg.bind(this)), n.default.off(a.EVENT.CHECKUSER, this.check使用r.bind(this)), n.default.off(a.EVENT.REPLAYAGAIN, this.join下1步Room.bind(this)), n.default.off(a.EVENT.SYNCMSGSEQ, this.syncMsgSeq.bind(this)), n.default.off(a.EVENT.SEND_CHECK_GAME, this.sendCheckGame.bind(this)), n.default.off(a.EVENT.ENDGAME, this.endGame.bind(this)), n.default.off(a.EVENT.CHANGEGAMELEVEL, this.sendChangeGameLevel.bind(this)), n.default.off(a.EVENT.RECEIVEGAMELEVELCHANGE, this.receiveGameLevelChange.bind(this)), n.default.off(a.EVENT.GETRELAYQR, this.getRelayQR.bind(this)), n.default.off(a.EVENT.GETRELAYCHECKUSERERROR, this.syncRelay.bind(this)), n.default.off(a.EVENT.SEND_REALTIME_MSG, this.sendRelayMsg.bind(this))
    }
  }, {
    key: "upDateRoom",
    value: function(e, t) {
      console.log("更新房间信息"), this.currentPage == this.roomPage && this.currentPage.show(t)
    }
  }, {
    key: "outRelay1",
    value: function() {
      var e = {
        cmdid: 10003,
        buff: {
          room_id: this.model.relayInfo.room_id,
          is_live_master: this.model.relayInfo.is_live_master
        }
      };
      this.sendRelayCmd(e), this.modeCtrl.changeMode("singleCtrl"), this.model.relayInfo.my_seat_no === this.model.relayInfo.room_owner_seat && (this.model.chatToolActivityId ? m.default.sendChatToolMsg({
        data: {
          activity_id: this.model.chatToolActivityId,
          target_state: 3,
          room_id: this.model.relayInfo.room_id
        }
      }).catch((function(e) {
        console.error("!!! 未发送聊天模式消息：", e)
      })) : console.warn("!!! outRelay1 chatToolActivityId is null"))
    }
  }, {
    key: "outRelay2",
    value: function() {
      this.modeCtrl.changeMode("singleCtrl")
    }
  }, {
    key: "startRelay",
    value: function(e) {
      var t = {
        cmdid: 10004,
        buff: {
          room_id: this.model.relayInfo.room_id,
          game_level: e
        }
      };
      this.sendRelayCmd(t), this.setStartRelayReportTimeOut = setTimeout((function() {
        n.default.emit(a.EVENT.RP_RELAY_START, {
          result: 1
        })
      }), 5e3)
    }
  }, {
    key: "relayGameStart",
    value: function(e) {
      this.changePage("gamePage"), clearTimeout(this.setStartRelayReportTimeOut), n.default.emit(a.EVENT.RP_RELAY_START, {
        result: 0
      })
    }
  }, {
    key: "sendPlayerJumpMsg",
    value: function(e, t) {
      var o = t.msginfo,
        i = t.jump_succ,
        a = t.msg_seq;
      if (this.model.relayInfo.my_seat_no) {
        var n = {
          cmdid: 10009,
          buff: {
            room_id: this.model.relayInfo.room_id,
            msg_info: {
              msgid: this.model.relayInfo.room_id + Date.now(),
              jump_succ: i,
              msginfo: o
            },
            msg_seq: a
          }
        };
        this.sendRelayCmd(n)
      }
    }
  }, {
    key: "check使用r",
    value: function(e, t) {
      var o = t.msgid,
        i = t.msg_seq,
        a = t.jump_succ;
      if (this.model.relayInfo.my_seat_no) {
        var n = {
          cmdid: 10008,
          buff: {
            room_id: this.model.relayInfo.room_id,
            msg_info: {
              msgid: o,
              jump_succ: a,
              msg_seq: i
            }
          }
        };
        this.sendRelayCmd(n)
      }
    }
  }, {
    key: "endGame",
    value: function(e, t) {
      console.log("!!! endGame", t, this.model.relayInfo), this.clearCheckGameInterval(), this.gamePage.hide本次得分(), n.default.emit(a.EVENT.RP_RELAY_GAME_END, {
        jielong_score: t.score,
        player_num: t.playerlist.length,
        max_audience: t.onlookerlist.length,
        difficulty: t.game_level
      }), this.model.chatToolActivityId ? m.default.sendChatToolMsg({
        data: {
          activity_id: this.model.chatToolActivityId,
          target_state: 3,
          room_id: this.model.relayInfo.room_id
        }
      }).catch((function(e) {
        console.error("!!! 未发送聊天模式消息：", e)
      })) : console.warn("!!! endGame chatToolActivityId is null")
    }
  }, {
    key: "syncMsgSeq",
    value: function(e, t) {
      var o = {
        cmdid: 10007,
        buff: {
          room_id: this.model.relayInfo.room_id,
          msg_seq: t.msg_seq
        }
      };
      this.sendRelayCmd(o)
    }
  }, {
    key: "setCheckGameInterval",
    value: function() {
      this.checkRelayInterval = setInterval((function() {
        n.default.emit(a.EVENT.CHECK_GAME, {})
      }), 2e3)
    }
  }, {
    key: "clearCheckGameInterval",
    value: function() {
      console.log("清除业务心跳"), clearInterval(this.checkRelayInterval), this.checkRelayInterval = null
    }
  }, {
    key: "sendCheckGame",
    value: function(e, t) {
      if (this.model.relayInfo.my_seat_no) {
        var o = {
          cmdid: 10006,
          buff: {
            room_id: t.room_id,
            seq: t.seq
          }
        };
        this.sendRelayCmd(o)
      }
    }
  }, {
    key: "join下1步Room",
    value: function(e) {
      if (!this.model.relayInfo.next_room_id) return console.warn("!!! join下1步Room next_room_id is null"), this.view.showJoin下1步RoomFail(), void this.modeCtrl.changeMode("singleCtrl");
      n.default.emitSync(a.EVENT.RELAYMODEDESTROY, {}), this.game.full2D.hide2D(), this.model.relayInfo.room_id = this.model.relayInfo.next_room_id, this.model.relayInfo.room_wxa_code = "", this.join下1步RelayRoom()
    }
  }, {
    key: "afterGetMiniCode",
    value: function(e, t) {
      console.log("getMiniCode", "RECEIVEMINICODE"), this.upDateRoom(e, t)
    }
  }, {
    key: "getMiniCode",
    value: function() {
      var e = {
        cmdid: 10010,
        buff: {
          room_id: this.model.relayInfo.room_id,
          router_id: decodeURIComponent(this.model.relayInfo.router_id),
          client_version: a.VERSION,
          mode: "relay"
        }
      };
      this.sendRelayCmd(e)
    }
  }, {
    key: "watchRelay",
    value: function() {
      this.rejoinRelay()
    }
  }, {
    key: "rejoinRelay",
    value: function() {
      n.default.emitSync(a.EVENT.WATCHRELAY, {}), this.changePage("gamePage")
    }
  }, {
    key: "syncRelay",
    value: function() {
      n.default.emitSync(a.EVENT.WATCHRELAY, {})
    }
  }, {
    key: "onSocketCloseErr",
    value: function() {
      this.socketTimeout || (this.clearSocketTimeout(), this.model.relayInfo.room_id && this.model.relayInfo.router_id ? this.reconnectSocket() : this.modeCtrl.changeMode("singleCtrl"))
    }
  }, {
    key: "reconnectSocket",
    value: function() {
      var e = this.reconnectSocketFail.bind(this);
      this.joinRelayRoom(e)
    }
  }, {
    key: "reconnectSocketFail",
    value: function() {
      this.gameSocket.close(), this.clearSocketTimeout(), clearTimeout(this.reconnectTimeout), this.reconnectTimeout = setTimeout(this.reconnectSocket.bind(this), 3e3)
    }
  }, {
    key: "progressOver",
    value: function(e) {
      var t = {
        cmdid: 10013,
        buff: {
          room_id: this.model.relayInfo.room_id,
          msg_seq: this.game.relayInstructionCtrl.msg_seq
        }
      };
      console.log("告诉服务器这个人过时"), this.sendRelayCmd(t)
    }
  }, {
    key: "receiveGameLevelChange",
    value: function(e, t) {
      this.upDateRoom(e, t)
    }
  }, {
    key: "sendChangeGameLevel",
    value: function(e, t) {
      var o = {
        cmdid: 10012,
        buff: {
          room_id: this.model.relayInfo.room_id,
          game_level: t
        }
      };
      console.log("告诉服务器房间的难度改变"), this.sendRelayCmd(o)
    }
  }, {
    key: "rpJoinRoom",
    value: function(e) {
      2 == this.scene ? n.default.emit(a.EVENT.RP_JOIN_RELAY_ROOM_AGAIN, {
        res: e
      }) : n.default.emit(a.EVENT.RP_JOIN_RELAY_ROOM, {
        scene: this.scene,
        result: e
      })
    }
  }, {
    key: "getRelayQR",
    value: function() {
      this.model.relayInfo.room_wxa_code ? n.default.emitSync(a.EVENT.RECEIVEMINICODE, {
        room_wxa_code: this.model.relayInfo.room_wxa_code
      }) : this.getMiniCode(), this.reporter.rpRelayClickSunCode()
    }
  }, {
    key: "checkCmd",
    value: function() {
      var e = this.game.relayInstructionCtrl.cmdList,
        t = !1;
      e.length && (e[e.length - 1].buff.game_status > 0 && (t = !0));
      return t
    }
  }, {
    key: "wxOnShow",
    value: function() {
      this.is分享Card ? this.checkCmd() ? this.onSocketCloseErr() : this.game.relayInstructionCtrl.run() : (this.game.relayInstructionCtrl.handleOnShow(), this.onSocketCloseErr());
      this.socketMonitor.log("|os|"), this.is分享Card = !1
    }
  }, {
    key: "wxOnhide",
    value: function() {
      this.is分享Card ? this.game.relayInstructionCtrl.stop() : (this.clearSocketTimeout(), this.gameSocket.close(), this.game.relayInstructionCtrl.handleOnhide()), this.socketMonitor.log("|oh|")
    }
  }, {
    key: "skipRelayBeginner",
    value: function() {
      this.init(this.options)
    }
  }, {
    key: "gotoRelayMode",
    value: function() {
      n.default.emitSync(a.EVENT.RELAYMODEDESTROY, {}), this.game.full2D.hide2D(), this.clearSocketTimeout(), this.scene = 1, this.model.relayInfo = {}, this.onSocketOpenCb = function() {}, this.game.relayInstructionCtrl.destroy(), this.createRoomNoAddEvent()
    }
  }, {
    key: "destroy",
    value: function() {
      this.clearSocketTimeout(), this.gameSocket.close(), this.model.relayInfo = {}, this.onSocketOpenCb = function() {}, this.offEvent(), this.game.full2D.hide2D(), wx.hide加载中(), this.game.relayInstructionCtrl.destroy(), this.game.resetScene(), n.default.emitSync(a.EVENT.RELAYMODEDESTROY, {})
    }
  }]), f
}();
exports.default = y;
},{"../../@babel/runtime/helpers/asyncToGenerator":6,"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/regeneratorRuntime":22,"../chattool":36,"../config":37,"../lib/mue/eventcenter":67,"../network/getAuth":72,"../network/network":73,"../pages/relay/fakeRoomPage":105,"../pages/relay/gamePage":106,"../pages/relay/room":107,"../shareApp":124,"../util/forceUpdate":138}],54:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  s = u(require("../lib/mue/eventcenter")),
  o = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var s = n(t);
    if (s && s.has(e)) return s.get(e);
    var o = {},
      i = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var f in e)
      if ("default" !== f && Object.prototype.hasOwnProperty.call(e, f)) {
        var u = i ? Object.getOwnPropertyDescriptor(e, f) : null;
        u && (u.get || u.set) ? Object.defineProperty(o, f, u) : o[f] = e[f]
      } o.default = e, s && s.set(e, o);
    return o
  }(require("../config")),
  i = u(require("../network/network")),
  f = require("../util/log");

function n(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    s = new WeakMap;
  return (n = function(e) {
    return e ? s : t
  })(e)
}

function u(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var r = function() {
  function n(t) {
    var i = this;
    e(this, n), this.game = t, this.runningSeq = 0, this.cmdList = [], this.seq = 0, this.model = t.gameModel, this.monitor = this.game.socketMonitor, s.default.on(o.EVENT.WATCHRELAY, (function() {
      i.sync()
    })), s.default.on(o.EVENT.CHECK_GAME, (function() {
      s.default.emit(o.EVENT.SEND_CHECK_GAME, {
        room_id: i.model.relayInfo.room_id || "",
        seq: i.seq
      })
    })), f.realTimeLogManager.setFilterMsg("room_id:".concat(this.model.relayInfo.room_id))
  }
  return t(n, [{
    key: "cmdCome",
    value: function(e) {
      if (0 == e.ret) {
        var t = JSON.parse(e.data);
        if (0 == t.error_code) {
          if (!t.buff) return;
          if (t.buff = JSON.parse(t.buff), 10006 != t.cmdid && console.log("收到帧，cmdid：", t.cmdid, "帧房号:" + t.buff.room_id + "本机房号" + this.model.relayInfo.room_id + (t.buff.room_id == this.model.relayInfo.room_id ? "匹配" : "不匹配"), "数据：", t), 10009 == t.cmdid || 10008 == t.cmdid || 10006 == t.cmdid || 10004 == t.cmdid || 10012 == t.cmdid || 10013 == t.cmdid || 10014 == t.cmdid || 10015 == t.cmdid) return;
          if (10001 != t.cmdid) {
            if (t.buff.room_id != this.model.relayInfo.room_id) return void console.log("房间号不匹配丢弃帧，cmdid：", t.cmdid, "数据:");
            if (10007 == t.cmdid) return void this.parseCmd(t);
            10002 != t.cmdid && 10011 != t.cmdid || (this.cmdList = [], this.canRunningCmd = !0)
          } else this.cmdList = [], this.canRunningCmd = !0;
          this.cmdList.push(t), this.runCmd()
        } else {
          var s = String(t.error_code);
          "-1019" == s ? (this.handleSyncWrong(), i.default.sendServerError(3)) : "-1015" != s && s < 0 && this.debug(s, t.error_msg + "cmd" + e.cmd, t)
        }
      } else this.debug("ret:" + e.ret, "cmd:" + e.cmd), "-1" == String(e.ret) && i.default.sendServerError(4)
    }
  }, {
    key: "runCmd",
    value: function() {
      if (this.cmdList.length && this.canRunningCmd) {
        this.cmdList.sort((function(e, t) {
          return e.ts - t.ts
        }));
        var e = this.cmdList.shift(),
          t = e.cmdid;
        if (10001 == t || 10002 == t || 10010 == t || 10011 == t) return 10010 != t && (this.seq = e.buff.seq, this.msg_seq = -1), this.parseCmd(e), void this.runCmd();
        var s, o, i, n, u, r, m, a, c = e.buff.seq;
        if (f.realTimeLogManager.info("run cmdid: ".concat(t, ", this.seq: ").concat(this.seq, ", nextSeq: ").concat(c, ", this.msg_seq: ").concat(this.msg_seq, ", nextCmd.msg_seq: ").concat(e.buff.msg_seq, ", data.buff: ").concat((s = e.buff, o = s.create_time, i = s.game_status, n = s.room_id, u = s.room_seed, r = s.seq, m = s.update_time, a = s.msg_seq, JSON.stringify({
            game_status: i,
            room_id: n,
            room_seed: u,
            seq: r,
            msg_seq: a,
            create_time: o,
            update_time: m
          })))), c > this.seq) {
          var d = e.buff.msg_seq - this.msg_seq;
          if (0 == d || 1 == d && "20006" == e.cmdid) return this.parseCmd(e), this.seq = e.buff.seq, this.msg_seq = e.buff.msg_seq, void this.runCmd();
          console.log("丢帧了"), wx.reportEvent("seq_drop", {
            room_id: this.model.relayInfo.room_id,
            cmd_id: t
          }), f.realTimeLogManager.error("run drop frame cmdid: ".concat(t, ", this.seq:").concat(this.seq, ", nextSeq: ").concat(c, ", this.msg_seq: ").concat(this.msg_seq, ", nextCmd.msg_seq: ").concat(e.buff.msg_seq)), this.sync()
        } else 20008 == t && e.buff.msg_seq - this.msg_seq == 0 && (console.log("realtime run"), this.parseCmd(e)), this.runCmd()
      }
    }
  }, {
    key: "sync",
    value: function() {
      this.canRunningCmd = !1, this.cmdList = [], s.default.emitSync(o.EVENT.SYNCMSGSEQ, {
        msg_seq: this.msg_seq
      }), this.clearSyncTimeOut(), this.setSyncTimeOut()
    }
  }, {
    key: "setSyncTimeOut",
    value: function() {
      this.syncTimeOutArr || (this.syncTimeOutArr = []), this.syncTimeOutArr.push(setTimeout(this.sync.bind(this), 5e3))
    }
  }, {
    key: "clearSyncTimeOut",
    value: function() {
      if (Array.isArray(this.syncTimeOutArr))
        for (; this.syncTimeOutArr.length;) {
          var e = this.syncTimeOutArr.pop();
          clearTimeout(e)
        }
    }
  }, {
    key: "receiveSyncCmd",
    value: function(e) {
      if (this.clearSyncTimeOut(), 2 == e.buff.game_status) return s.default.emitSync(o.EVENT.ENDGAME, e.buff), void(this.cmdList = []);
      s.default.emitSync(o.EVENT.SYNCSCENE, {
        now_msg_seq: this.msg_seq,
        serverData: e.buff
      }), this.msg_seq = e.buff.msg_seq, this.seq = e.buff.seq, this.canRunningCmd = !0, this.runCmd()
    }
  }, {
    key: "parseCmd",
    value: function(e) {
      switch (e.cmdid) {
        case 10001:
          console.log(10001, "创建房间", e.buff), this.monitor.log("|10001;" + e.buff.room_id + ";" + e.buff.seq + ";" + e.buff.msg_seq), s.default.emitSync(o.EVENT.RELAYCREATEROOM, e.buff);
          break;
        case 10002:
          console.log(10002, "加入房间", e.buff), this.monitor.log("|10002;" + e.buff.room_id + ";" + e.buff.seq + ";" + e.buff.msg_seq), 0 == e.buff.my_seat_no && 0 != e.buff.game_status && (this.canRunningCmd = !1), s.default.emitSync(o.EVENT.JOINRELAYROOM, e.buff);
          break;
        case 10011:
          console.log(10011, "加入下局房间", e.buff), this.monitor.log("|10011;" + e.buff.room_id + ";" + e.buff.seq + ";" + e.buff.msg_seq), 0 == e.buff.my_seat_no && 0 != e.buff.game_status && (this.canRunningCmd = !1), s.default.emitSync(o.EVENT.JOINRELAYROOM, e.buff);
          break;
        case 20004:
          this.adJustBuff(e.buff, 1), this.monitor.log("|20004;" + e.buff.seq + ";" + e.buff.msg_seq), console.log(20004, "有玩家加入", e.buff), s.default.emitSync(o.EVENT.PEOPLECOME, e.buff);
          break;
        case 20005:
          this.adJustBuff(e.buff, 1), this.monitor.log("|20005;" + e.buff.seq + ";" + e.buff.msg_seq), console.log(20005, "有玩家退出", e.buff), s.default.emitSync(o.EVENT.PEOPLEOUT, e.buff);
          break;
        case 20001:
          this.adJustBuff(e.buff), console.log(20001, "游戏开始 ——————————————————", e.buff), this.monitor.log("|20001;" + e.buff.seq + ";" + e.buff.msg_seq + ";" + e.buff.game_level), console.log("20001 my_seat_no", this.model.relayInfo.my_seat_no), s.default.emitSync(o.EVENT.RELAYSTART, e.buff);
          break;
        case 20006:
          this.adJustBuff(e.buff), console.log(20006, "别人跳了1下 ——————————————————", e.buff.msg_seq, e.buff), this.monitor.log("|20006;" + e.buff.seq + ";" + e.buff.msg_seq), console.log("20006 my_seat_no", this.model.relayInfo.my_seat_no), s.default.emitSync(o.EVENT.RELAYCHECKUSER, e.buff);
          break;
        case 20002:
          this.adJustBuff(e.buff), console.log(20002, "回合往前进1下 ——————————————————", e.buff.msg_seq, e.buff), this.monitor.log("|20002;" + e.buff.seq + ";" + e.buff.msg_seq), console.log("20002 my_seat_no", this.model.relayInfo.my_seat_no), s.default.emitSync(o.EVENT.RUNGAME, e.buff);
          break;
        case 20003:
          this.adJustBuff(e.buff), this.monitor.log("|20003;" + e.buff.room_id + ";" + e.buff.seq + ";" + e.buff.msg_seq), console.log(20003, "整个游戏结束", e.buff), console.log("20003 my_seat_no", this.model.relayInfo.my_seat_no), e.buff && "-1019" == e.buff.error_ret && this.monitor.report(), s.default.emitSync(o.EVENT.ENDGAME, e.buff);
          break;
        case 10010:
          this.model.relayInfo.room_id && (this.model.relayInfo.room_wxa_code = e.buff.room_wxa_code), this.adJustBuff(e.buff), console.log(10010, "收到2维码", e.buff), console.log("10010 my_seat_no", this.model.relayInfo.my_seat_no), s.default.emitSync(o.EVENT.RECEIVEMINICODE, e.buff);
          break;
        case 10007:
          this.adJustBuff(e.buff), console.log(10007, "收到同步帧流", e.buff), this.monitor.log("|10007;" + e.buff.seq + ";" + e.buff.msg_seq), this.receiveSyncCmd(e);
          break;
        case 20007:
          this.adJustBuff(e.buff, 1), console.log(20007, "房间难度等级改变", e.buff), s.default.emitSync(o.EVENT.RECEIVEGAMELEVELCHANGE, e.buff);
          break;
        case 20008:
          this.adJustBuff(e.buff), console.log(20008, "接收实时按压帧", e.buff), s.default.emitSync(o.EVENT.RECEIVE_REALTIME_MSG, e.buff);
          break;
        default:
          console.log("没有执行的帧", e)
      }
    }
  }, {
    key: "adJustBuff",
    value: function(e, t) {
      e.my_seat_no = this.model.relayInfo.my_seat_no, t && (e.room_wxa_code = this.model.relayInfo.room_wxa_code), e.score = this.game.UI.score, console.log("修正数据,玩家房号:", e.my_seat_no)
    }
  }, {
    key: "debug",
    value: function() {}
  }, {
    key: "run",
    value: function() {
      this.canRunningCmd = !0, this.runCmd()
    }
  }, {
    key: "stop",
    value: function() {
      this.canRunningCmd = !1
    }
  }, {
    key: "handleOnShow",
    value: function() {
      this.cmdList = [], this.canRunningCmd = !0
    }
  }, {
    key: "handleOnhide",
    value: function() {
      this.clearSyncTimeOut(), this.cmdList = [], this.stop()
    }
  }, {
    key: "handleSyncWrong",
    value: function() {
      wx.showModal({
        title: "提示",
        content: "游戏异常，请重新开始游戏",
        show取消: !1
      })
    }
  }, {
    key: "destroy",
    value: function() {
      this.clearSyncTimeOut(), this.cmdList = [], this.stop(), this.seq = 0, this.msg_seq = -1
    }
  }]), n
}();
exports.default = r;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/mue/eventcenter":67,"../network/network":73,"../util/log":139}],55:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/slicedToArray"),
  t = require("../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../@babel/runtime/helpers/createClass"),
  a = g(require("../network/network")),
  s = g(require("../pages/review/review")),
  n = g(require("../pages/review/shareCard")),
  o = g(require("../store/storage")),
  r = require("../shareApp"),
  h = require("../pages/pages2d/base"),
  c = g(require("../lib/mue/eventcenter")),
  u = require("../config"),
  l = g(require("../control/bottleSkinBaseCtrl")),
  m = g(require("../control/propertyCtrl")),
  d = require("../util/forceUpdate");

function g(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var p = function() {
  function g(e) {
    t(this, g), this.game = e, this.gameCtrl = e.gameCtrl, this.initData()
  }
  return i(g, [{
    key: "initData",
    value: function() {
      this.isInThisPage = !1, this.isIn分享CardPage = !1, this.scene = void 0, this.pause = !1, this.actionList = [], this.musicList = [], this.touchStartList = [], this.index = 0, this._playCache = function() {}, this.gameData = {}, this.reviewPage = null, this.onHide = function() {}, this.skinResources = null, this.shareCardData = null, this.property = {}, this.playback_poster = null
    }
  }, {
    key: "init",
    value: function(t) {
      var i = t.user_data,
        r = t.scene,
        h = t.callback,
        c = t.is_from_share,
        u = t.onHide,
        m = t.playback_poster;
      if (!this.isInThisPage) {
        var g = this,
          p = i && i.playback_id,
          f = i && i.is_self,
          _ = this.game.skinManager;
        this.onHide = u || this.onHide, this.playback_poster = m, this.isInThisPage = !0,
          function t(i, s) {
            wx.show加载中({
                mask: !0
              }),
              function(t, i) {
                var s;
                return new Promise((function(n, o) {
                  (function(e) {
                    var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
                    return t ? a.default.getFriendPlayBack(e) : new Promise((function(t, i) {
                      a.default.getWeeklyPlayBack((function(e, a) {
                        var s = "";
                        e ? t(a.data) : (a && a.data && a.data.base_resp && a.data.base_resp.errcode && (s = "，(e" + a.data.base_resp.errcode + ")"), i(s))
                      }), e)
                    }))
                  })(t, i).then((function(e) {
                    s = e.game_data;
                    var t, i, a, n = e.bottle_skin_data,
                      o = n && n.id ? (t = n, l.default.getBottleSkinResourceBySkinData(t)) : Promise.resolve(void 0);
                    return Promise.all([o, (i = s.skin_id, a = s.skin_sn, _.loadSkinForOtherMode(i, a))])
                  }), (function(e) {
                    return Promise.reject(e)
                  })).then((function(t) {
                    var i = e(t, 2),
                      a = i[0];
                    i[1];
                    n({
                      gameData: s,
                      skinResources: a
                    })
                  }), (function(e) {
                    o()
                  }))
                }))
              }(s, c).then((function(e) {
                var t = e.gameData,
                  a = e.skinResources;
                wx.hide加载中(), i(t, a), g.game.reporter.clickReviewBtn(0)
              }), (function() {
                var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
                wx.hide加载中(), wx.showModal({
                  title: "提示",
                  content: "获取回放数据失败" + e,
                  confirmText: "重试",
                  cancelText: "取消",
                  success: function(e) {
                    e.confirm ? t(i, s) : c && g.onHide && g.onHide()
                  },
                  fail: function() {
                    c && g.onHide && g.onHide()
                  }
                }), g.game.reporter.clickReviewBtn(1)
              }))
          }((function(e, t) {
            1 === (0, d.compareMyVersion)(e.version) ? (0, d.forceUpdate)((function() {}), "点击确定，进行版本更新后重试") : (h && h(), function(e, t) {
              var h = g.getTotalGameTime(e.timestamp, e.action);
              g.scene = r, g.skinResources = t, g.gameData = e, f ? g.CalGameExtraData((function(e, t) {
                u(e, t)
              })) : u();

              function u() {
                var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0,
                  r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                g.reviewPage = new s.default({
                  game: g.game,
                  week_best_score: i.week_best_score,
                  is_self: f,
                  is_from_share: c,
                  maxBonus本次得分: t,
                  succeedTime: r,
                  onChangeProgress: function(e) {
                    g.isChanging = !1, g.changeProgressTo(e)
                  },
                  onTouchStartProgress: function() {
                    g.isChanging = !0
                  },
                  onHide: function() {
                    g.onHide(), g.destroy()
                  },
                  onOpen分享Page: function() {
                    g.shareCard(i)
                  }
                }), g.shareReviewCard = new n.default({
                  game: g.game,
                  week_best_score: i.week_best_score,
                  headimg: i.headimg,
                  maxBonus本次得分: t,
                  succeedTime: r,
                  on分享: function(e) {
                    g.on分享ToFriends({
                      open_playback_id: e,
                      week_best_score: i.week_best_score,
                      headimg: i.headimg,
                      is_self: i.is_self,
                      playback_poster: g.playback_poster
                    })
                  },
                  onSave: function(e) {
                    g.onSavePhoto(e)
                  },
                  onClose分享Page: function() {
                    g.isIn分享CardPage = !1, g.onClose分享Page()
                  }
                }), g.play(e.seed, e.action, e.musicList, e.timestamp, e.version, e.use_wangzhe, e.mmpay_status, e.use_mmpaybase, e.skin_id, e.property, (function() {
                  if (g.game.current本次得分 && i.week_best_score && g.game.current本次得分 != i.week_best_score) {
                    a.default.sendServerError(9);
                    if (Math.random() < .01) {
                      var e = o.default.getMy使用rInfo(),
                        t = e && e.open_id;
                      t && a.default.badReport("searchflag:reviewNotRight;open_id:".concat(t, ";playback_id:").concat(p, ";current本次得分:").concat(g.game.current本次得分, ";week_best_score:").concat(i.week_best_score, ";"))
                    }
                  }
                  g.onHide && g.onHide()
                })), g.reviewPage.show(i, h)
              }
            }(e, t))
          }), p)
      }
    }
  }, {
    key: "CalGameExtraData",
    value: function(e) {
      this.speedUpto(this.gameData.timestamp.length - 1, this.gameData, (function(t, i) {
        e && e(t, i)
      }))
    }
  }, {
    key: "onSavePhoto",
    value: function(e) {
      e.toTempFilePath({
        x: (0, h.cx)(46),
        y: (0, h.cy)(95),
        width: (0, h.cwh)(322),
        height: (0, h.cwh)(524),
        success: function(e) {
          wx.saveImageToPhotosAlbum({
            filePath: e.tempFilePath,
            success: function() {
              wx.showToast({
                title: "保存成功"
              })
            }
          })
        },
        fail: function(e) {}
      })
    }
  }, {
    key: "shareCard",
    value: function(e) {
      e.playback_id;
      var t = this,
        i = "mode=reviewPage&headimg=".concat(e.headimg);

      function s() {
        t.reviewPage.pause(), t.isIn分享CardPage = !0, t.pausePlay(), t.shareReviewCard.show({
          qrcode: t.shareCardData.qrcode_img,
          open_playback_id: t.shareCardData.open_playback_id
        })
      }
      this.shareCardData ? s() : (wx.show加载中({
        mask: !0
      }), a.default.getOpenPlaybackData(i).then((function(e) {
        wx.hide加载中(), t.isInThisPage && (t.shareCardData = e, s())
      }), (function() {
        wx.hide加载中(), t.isInThisPage && (t.isIn分享CardPage = !1, wx.showToast({
          title: "获取分享失败",
          icon: "none"
        }))
      })))
    }
  }, {
    key: "onClose分享Page",
    value: function() {
      this.continue(), this.reviewPage.continue(), this.setProgressByIndex(this.index)
    }
  }, {
    key: "on分享ToFriends",
    value: function(e) {
      var t = e.open_playback_id,
        i = e.week_best_score,
        a = e.headimg,
        s = e.is_self;
      e.playback_poster;
      (0, r.分享ReviewCard)({
        open_playback_id: t,
        week_best_score: i,
        headimg: a,
        is_self: s,
        playback_poster: this.playback_poster,
        cb: function() {}
      })
    }
  }, {
    key: "getTotalGameTime",
    value: function(e, t) {
      var i = e.length;
      return e[i - 1] - e[0] + t[i - 1][0] + 3e3
    }
  }, {
    key: "changeProgressTo",
    value: function(e) {
      var t = this,
        i = this.findStep(e);
      this._destroy(), this.speedUpto(i, this.gameData, (function() {
        t._playCache()
      })), this.setProgressByIndex(i)
    }
  }, {
    key: "setProgressByIndex",
    value: function(e) {
      var t;
      if (0 === e) t = .01;
      else {
        var i = this.getTotalGameTime(this.gameData.timestamp, this.gameData.action),
          a = this.gameData.timestamp[0];
        t = (this.gameData.timestamp[e - 1] - a) / i
      }
      this.reviewPage.startProgressBarFrom(t)
    }
  }, {
    key: "findStep",
    value: function(e) {
      var t, i = this.gameData.timestamp,
        a = e * this.getTotalGameTime(this.gameData.timestamp, this.gameData.action),
        s = i[0];
      if (a > i[i.length - 1] - s) t = i.length;
      else
        for (t = i.length - 1; t >= 0 && !(a < i[t] - s + 1 && a > i[t - 1] - s); t--);
      return t - 1
    }
  }, {
    key: "destroy",
    value: function(e) {
      this.isInThisPage && (this.reviewPage && this.reviewPage.hide(), this.game.resetScene(), c.default.emitSync(u.EVENT.GOTOSINGLESTARTPAGE, {}), this._destroy(), this.isInThisPage = !1, this.initData())
    }
  }, {
    key: "_play",
    value: function(e) {
      var t = this;
      if (this.index < this.actionList.length && !this.pause) {
        var i = this.actionList[this.index][3] || null,
          a = this.actionList[this.index][1],
          s = this.musicList[this.index + 1],
          n = this.actionList[this.index][2],
          o = this.actionList[this.index][0],
          r = 0 == this.index ? 0 : this.touchStartList[this.index] - this.touchStartList[this.index - 1];
        this.timer = setTimeout((function() {
          ++t.index, "stop" != t.game.bottle.status ? (t.speedUpto(t.index - 2, t.gameData, (function() {
            t._play(e)
          })), t.setProgressByIndex(t.index)) : (t.isChanging && t.setProgressByIndex(t.index), 1 == i || t.game.touchStartAnim({
            fromReview: !0
          }), t.jumpTimer = setTimeout((function() {
            1 == i ? m.default.reviewUsingProp(i, t.game, {
              quick: n,
              music本次得分: s
            }) : t.game.touchEndAnim(o, a, n, s), t.index == t.actionList.length && (t.overTimeout = setTimeout((function() {
              e()
            }), 3e3))
          }), 1 == i ? 0 : 1e3 * o), t._play(e), t._playCache = function() {
            t._play(e)
          })
        }), r)
      } else this.pause
    }
  }, {
    key: "pausePlay",
    value: function() {
      if (this.pause = !0, this.reviewPage && this.reviewPage.stopAnimation(), this.timer && (clearTimeout(this.timer), this.timer = null), this.timers) {
        for (var e = 0; e < this.timers.length; ++e) clearTimeout(this.timers[e]);
        this.timers = null
      }
    }
  }, {
    key: "speedUpto",
    value: function(e, t, i) {
      var a = this;
      this._destroy();
      var s, n = t.seed,
        o = t.action,
        r = t.musicList,
        h = t.timestamp,
        c = t.version,
        u = t.use_wangzhe,
        l = t.mmpay_status,
        m = t.use_mmpaybase,
        d = t.skin_id,
        g = t.property,
        p = o,
        f = h,
        _ = 0;
      for (this.actionList = p, this.musicList = r, this.touchStartList = f, this.property = g, this.index = 0, this.game.resetScene(n, {
          version: c,
          use_wangzhe: u,
          use_mmpaybase: m,
          mmpay_status: l,
          bottleSkin: this.skinResources || null,
          skinId: d || null
        }), s = 0; s < this.actionList.length - 1 && s < e; s++) v(s);

      function v(e) {
        var t, i = a.actionList[e][3] || null,
          s = a.actionList[e][1],
          n = a.actionList[e][0],
          o = a.musicList[e + 1],
          r = a.actionList[e][2];
        1 == (t = 1 == i ? a.game.wellJump({
          property_id: i,
          item_id: 1,
          noAnimation: !0,
          quick: r,
          music本次得分: o
        }) : a.game.touchEndAnim(n, s, r, o, {
          noAnimation: !0
        })) || 7 == t ? (a.game.succeed({
          noAnimation: !0,
          music本次得分: o
        }), 1 === t ? (++a.game.doubleHit, a.game.UI.add本次得分(1, !0, r)) : (a.game.doubleHit = 0, a.game.UI.add本次得分(1, !1, r)), a.game.doubleHit > _ && (_ = a.game.doubleHit)) : 2 == t && a.game.bottle.obj && (a.game.bottle.obj.position.x = a.game.bottle.destination[0], a.game.bottle.obj.position.z = a.game.bottle.destination[1])
      }
      this.index = s, i(_, this.game.succeedTime)
    }
  }, {
    key: "continue",
    value: function() {
      this.isIn分享CardPage || (this.pause = !1, this._playCache())
    }
  }, {
    key: "play",
    value: function(e, t, i, a, s, n, o, r, h, c, u) {
      this.actionList = t, this.musicList = i, this.touchStartList = a, this.property = c, this.index = 0, this.game.resetScene(e, {
        version: s,
        use_wangzhe: n,
        use_mmpaybase: r,
        mmpay_status: o,
        bottleSkin: this.skinResources || null,
        skinId: h || null
      }), this._play(u)
    }
  }, {
    key: "_destroy",
    value: function() {
      if (this.game.stopLoopMusic(), this.timer && (clearTimeout(this.timer), this.timer = null), this.jumpTimer && (clearTimeout(this.jumpTimer), this.jumpTimer = null), this.game.deadTimeout && (clearTimeout(this.game.deadTimeout), this.game.deadTimeout = null), this.overTimeout && (clearTimeout(this.overTimeout), this.overTimeout = null), this.timers) {
        for (var e = 0; e < this.timers.length; ++e) clearTimeout(this.timers[e]);
        this.timers = null
      }
    }
  }]), g
}();
exports.default = p;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/slicedToArray":24,"../config":37,"../control/bottleSkinBaseCtrl":39,"../control/propertyCtrl":51,"../lib/mue/eventcenter":67,"../network/network":73,"../pages/pages2d/base":89,"../pages/review/review":108,"../pages/review/shareCard":109,"../shareApp":124,"../store/storage":128,"../util/forceUpdate":138}],56:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass");
i(require("../pages/group/groupPage")), i(require("../network/network"));

function i(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var r = function() {
  function i(t, r) {
    e(this, i), this.name = "group分享", this.game = t, this.gameCtrl = this.game.gameCtrl, this.model = this.game.gameModel, this.view = this.game.gameView, this.netWorkCtrl = this.gameCtrl.netWorkCtrl, this.modeCtrl = r
  }
  return t(i, [{
    key: "init",
    value: function(e) {
      var t = this;
      this.model.getSessionId() ? this.afterLogin(!0, e) : this.netWorkCtrl.netWorkLogin((function(i) {
        t.afterLogin(i, e)
      }))
    }
  }, {
    key: "afterLogin",
    value: function(e, t) {
      var i = this;
      e && !this.gameCtrl.reviewCtrl.isInThisPage && t && t.query && "reviewPage" == t.query.mode && (wx.show加载中(), setTimeout((function() {
        i.gameCtrl.reviewCtrl.init({
          user_data: {
            playback_id: t.query.open_playback_id,
            is_self: !1,
            headimg: t.query.headimg
          },
          onHide: function() {
            i.modeCtrl.changeMode("singleCtrl")
          },
          scene: "home",
          is_from_share: !0
        })
      }), 500))
    }
  }, {
    key: "destroy",
    value: function() {}
  }, {
    key: "wxOnhide",
    value: function() {}
  }]), i
}();
exports.default = r;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../network/network":73,"../pages/group/groupPage":83}],57:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/typeof"),
  t = require("../../@babel/runtime/helpers/objectSpread2"),
  a = require("../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../@babel/runtime/helpers/createClass"),
  r = y(require("../pages/single/singleStartPage")),
  n = y(require("../pages/single/singleGamePage")),
  o = y(require("../pages/single/singleGameOverPage")),
  s = y(require("../pages/single/singleFriendRankPage")),
  l = y(require("../pages/single/relayGuide")),
  g = y(require("../control/profileCtrl")),
  h = y(require("../control/bottleSkinShopCtrl")),
  u = require("../shareApp"),
  d = y(require("../network/network")),
  c = y(require("../lib/mue/eventcenter")),
  m = y(require("../lib/mue/lookcenter")),
  f = y(require("./msgBoxCtrl")),
  k = y(require("../store/storage")),
  P = require("../config"),
  v = y(require("./propertyCtrl")),
  p = y(require("../control/bottleSkinBaseCtrl")),
  S = require("../network/getAuth"),
  w = y(require("../pages/battle/battlePkRulePage"));

function y(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var C = function() {
  function y(e, t) {
    a(this, y), this.name = "single", this.game = e, this.gameCtrl = this.game.gameCtrl, this.model = this.game.gameModel, this.view = this.game.gameView, this.modeCtrl = t, this.netWorkCtrl = this.gameCtrl.netWorkCtrl, this.gameSocket = this.game.gameSocket, this.startPage = new r.default(e, this.onEnterMsgCenter.bind(this), this.onEnterBottleSkinShop.bind(this)), this.gamePage = new n.default(e), this.gameOverPage = new o.default(e), this.friendRankPage = new s.default(e, this.onProfile.bind(this)), this.relayGuidePage = new l.default(e), this.pkRulePage = new w.default(e), this.currentPage = null, this.lastPage = null, this.socketTimeout = null, this.count = 1
  }
  return i(y, [{
    key: "init",
    value: function(e) {
      this.model.checkAdInfo(), this.startPage.show(), this.model.setStage(this.startPage.name), this.currentPage = this.startPage
    }
  }, {
    key: "onEnterMsgCenter",
    value: function() {
      var e = this,
        a = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
      this.MsgBoxCtrl ? this.MsgBoxCtrl.init(a) : (this.MsgBoxCtrl = new f.default({
        game: this.game,
        onReturn: function() {
          e.gameCtrl.onReturnTo("home")
        },
        onGoSkin: function() {
          e.goShop((function() {
            e.MsgBoxCtrl.init(!1)
          })), e.game.reporter.rpGoSkinBySkinCenter()
        },
        onGoProfile: function(a) {
          var i = k.default.getMy使用rInfo(),
            r = !1;
          i && i.playback_id && (r = !(i.playback_id != a.open_user_id)), a.is_self = r;
          var n = new g.default({
            user_data: a,
            game: e.game,
            onReturn: function() {
              e.onEnterMsgCenter(!1)
            },
            onGoRecord: function(a) {
              e.gameCtrl.reviewCtrl.init({
                user_data: t(t({}, a), {}, {
                  is_self: r
                }),
                is_from_share: !1,
                onHide: function() {
                  e.gameCtrl.reviewCtrl.destroy(), n.showPage()
                }
              })
            }
          });
          n.init(), e.game.reporter.rpGoProfileByMsgBox()
        },
        onGoMyProfile: function() {
          var a = k.default.getMy使用rInfo();
          if (a && a.playback_id) {
            var i = new g.default({
              user_data: {
                is_self: !0,
                playback_id: a.playback_id
              },
              game: e.game,
              onReturn: function() {
                e.onEnterMsgCenter(!1)
              },
              onGoRecord: function(a) {
                e.gameCtrl.reviewCtrl.init({
                  user_data: t(t({}, a), {}, {
                    is_self: !0
                  }),
                  is_from_share: !1,
                  onHide: function() {
                    e.gameCtrl.reviewCtrl.destroy(), i.showPage()
                  }
                })
              }
            });
            i.init(), e.game.reporter.rpGoProfileByMsgBox()
          }
        }
      }), this.MsgBoxCtrl.init()), this.game.reporter.rpMsgBox()
    }
  }, {
    key: "goShop",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
      this.bottleSkinShopCtrl = new h.default({
        game: this.game,
        onReturn: function() {
          e()
        }
      }), this.bottleSkinShopCtrl.init()
    }
  }, {
    key: "onEnterBottleSkinShop",
    value: function() {
      var e = this;
      this.goShop((function() {
        e.gameCtrl.onReturnTo("home")
      })), this.game.reporter.rpSkinInfo()
    }
  }, {
    key: "onProfile",
    value: function(e) {
      var a = this,
        i = k.default.getMy使用rInfo();
      i && e.user_data.is_self && !e.user_data.playback_id && i.playback_id && (e.user_data.playback_id = i.playback_id), e.user_data.playback_id || i.playback_id || (console.log("-----------------------------------"), console.log("-----------------------------------"), console.log("-----------------------------------"), console.log("-----------------------------------"), console.log("-----------------------------------"), console.log("-----------------------------------"), console.log(e), console.log(i));
      var r = new g.default(t(t({}, e), {}, {
        game: this.game,
        onReturn: function() {
          a.gameCtrl.onReturnTo("位好友")
        },
        onGoRecord: function(i) {
          a.gameCtrl.reviewCtrl.init({
            user_data: t(t({}, i), {}, {
              is_self: e.user_data.is_self
            }),
            is_from_share: !1,
            onHide: function() {
              a.gameCtrl.reviewCtrl.destroy(), r.showPage()
            }
          }), Array.isArray(i.routesArr) && a.reportReview(i.routesArr)
        }
      }));
      r.init(), Array.isArray(e.routesArr) && this.reportGoProfile(e.routesArr)
    }
  }, {
    key: "reportReview",
    value: function(e) {
      for (var t = e.length - 1; t >= 0; t--) {
        if ("start" == e[t]) {
          this.game.reporter.rpStartPageFriendReview();
          break
        }
        if ("gameOver" == e[t]) {
          this.game.reporter.rpSingleSettleRankReview();
          break
        }
      }
    }
  }, {
    key: "reportGoProfile",
    value: function(e) {
      for (var t = e.length - 1; t >= 0; t--) {
        if ("start" == e[t]) {
          this.game.reporter.rpStartPageClickFriendInfo();
          break
        }
        if ("gameOver" == e[t]) {
          this.game.reporter.rpGameOverClickFriendInfo();
          break
        }
      }
    }
  }, {
    key: "showStartPage",
    value: function() {
      this.hideCurrentPage(), this.startPage.show(), this.currentPage = this.startPage
    }
  }, {
    key: "clickStart",
    value: function() {
      (0, S.changeCanvasType)("singleStart"), this.hideCurrentPage();
      v.default.can使用Prop(1) ? this.gamePage.show({
        usingProp: 1
      }) : this.gamePage.show(), this.game.replayGame(), this.model.setStage(this.gamePage.name), this.currentPage = this.gamePage, m.default.startScenes("single")
    }
  }, {
    key: "touchProp",
    value: function(e) {
      var t = e.id,
        a = e.cb,
        i = setTimeout((function() {
          wx.show加载中({
            mask: !0
          })
        }), 200);
      v.default.confirmUsingProp({
        id: t,
        game: this.game,
        seed: e.seed
      }).then((function() {
        wx.hide加载中(), clearTimeout(i), a(!0)
      }), (function() {
        wx.hide加载中(), wx.showToast({
          title: "网络繁忙",
          icon: "none",
          duration: 800
        }), clearTimeout(i), a(!1)
      }))
    }
  }, {
    key: "showGameOverPage",
    value: function() {
      var t = this,
        a = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
      this.hideCurrentPage(), a.onRewardAdGetProp = function() {
        t.onRewardAdGetProping || (t.onRewardAdGetProping = !0, d.default.getAdReward().then((function(e) {
          t.onRewardAdGetProping = !1, t.gameOverPage.showAdReward(e.icon || "xxx")
        }), (function() {
          t.onRewardAdGetProping = !1, wx.showToast({
            title: "道具发放失败",
            icon: "none",
            duration: 800
          }), console.log("道具发放失败")
        })))
      }, a.onShowRewardAd = function() {
        var e = wx.getStorageSync("ad");
        e.ad_reward_quota--, wx.setStorage({
          key: "ad",
          data: e
        })
      }, a.onShowBannerAd = function() {
        var t = wx.getStorageSync("ad");
        t && "object" === e(t) && ("number" == typeof t.ad_banner_quota ? t.ad_banner_quota-- : t.ad_banner_quota = 0, wx.setStorage({
          key: "ad",
          data: t
        })), d.default.showBannerAd().then((function(e) {
          console.log("showBannerAd res: ", e)
        }))
      }, this.gameOverPage.show(a), this.model.clearPkId(), this.model.setStage(this.gameOverPage.name), this.currentPage = this.gameOverPage, m.default.stopScenes("single")
    }
  }, {
    key: "gameOverClickReplay",
    value: function() {
      this.clickStart(), this.model.adInfo = {
        canShowAd: !this.model.getAdTagInLS(),
        advertisingInfo: {}
      }
    }
  }, {
    key: "showPkRule",
    value: function() {
      console.log("!!! singleCtrl showPkRule"), this.lastPage = this.currentPage, this.currentPage && this.currentPage.hide(), this.pkRulePage.show({
        score: this.model.current本次得分
      }), this.model.setStage(this.pkRulePage.name), this.currentPage = this.pkRulePage
    }
  }, {
    key: "closePkRule",
    value: function() {
      console.log("!!! singleCtrl closePkRule"), this.hideCurrentPage(), this.lastPage.show(), this.model.setStage(this.lastPage.name), this.currentPage = this.lastPage
    }
  }, {
    key: "setPkDuration",
    value: function() {
      var e = this;
      console.log("!!! singleCtrl setPkDuration"), wx.showActionSheet({
        itemList: ["10分钟", "20分钟", "30分钟", "40分钟", "50分钟", "60分钟"],
        success: function(t) {
          console.log(t.tapIndex), e.pkRulePage.show({
            duration: 10 * (t.tapIndex + 1)
          }), e.model.pkLifeTime = 10 * (t.tapIndex + 1) * 60
        },
        fail: function(e) {
          console.error(e)
        }
      })
    }
  }, {
    key: "showFriendRank",
    value: function(e) {
      m.default.startScenes("rank"), e || (this.lastPage = this.currentPage), this.hideCurrentPage(), this.friendRankPage.show(), this.model.setStage(this.friendRankPage.name), this.currentPage = this.friendRankPage
    }
  }, {
    key: "friendRankReturn",
    value: function() {
      m.default.stopScenes("rank"), this.hideCurrentPage(), this.lastPage.show(), this.lastPage && "singleSettlementPgae" == this.lastPage.name && this.game.reporter.rpSingleSettleRankCloseRank(), this.lastPage && "startPage" == this.lastPage.name && this.game.reporter.rpStartPageRankClose(), this.model.setStage(this.lastPage.name), this.currentPage = this.lastPage
    }
  }, {
    key: "shareGroupRank",
    value: function() {
      var e = this;
      this.lastPage && this.lastPage.name && ("singleSettlementPgae" == this.lastPage.name && this.game.reporter.rpSingleSettleRank分享Group(), "startPage" == this.lastPage.name && this.game.reporter.rpStartPageGroup分享()), (0, u.shareGroupRank)((function(t, a) {
        e.gameCtrl.after分享GroupRank(t, a)
      }))
    }
  }, {
    key: "clickRank",
    value: function() {
      this.showFriendRank()
    }
  }, {
    key: "shareObservCard",
    value: function() {
      console.log("!!! singleCtrl shareObservCard"), this.gamePage.hideLookers分享(), this.model.setStage("loading"), wx.show加载中(), this.model.getSessionId() ? this.afterLogin(!0) : this.netWorkCtrl.netWorkLogin(this.afterLogin.bind(this))
    }
  }, {
    key: "afterLogin",
    value: function(e) {
      var t = this;
      e ? d.default.requestCreateGame((function(e, a) {
        e ? (t.model.setGameId(a.data.game_id), t.model.setGameTicket(a.data.up_op_ticket), t.shareObservCardA()) : t.shareObservCardFail(a)
      })) : this.shareObservCardFail()
    }
  }, {
    key: "shareObservCardFail",
    value: function(e) {
      this.view.show分享ObserveCardFail(e), this.model.clearGameId(), this.model.clearGameTicket(), "loading" == this.model.stage && this.model.setStage("game"), this.clearSocketTimeout(), this.gameSocket.close(), wx.hide加载中()
    }
  }, {
    key: "shareObservCardA",
    value: function() {
      this.socketTimeout = setTimeout(this.shareObservCardFail.bind(this), 5e3), this.gameSocket.connectSocket()
    }
  }, {
    key: "socketJoinSuccess",
    value: function(e) {
      wx.hide加载中(), e ? (this.clearSocketTimeout(), this.shareObservCardB()) : this.shareObservCardFail()
    }
  }, {
    key: "shareObservCardB",
    value: function() {
      var e = this,
        t = p.default.getSelectedSkinId();
      (0, u.shareObserve)({
        bottle_skin_id: t,
        skin_id: this.game.skin_id,
        skin_sn: this.game.skin_sn,
        cb: function(t, a) {
          t && e.gameCtrl.after分享ObserveCard(a)
        }
      })
    }
  }, {
    key: "clearSocketTimeout",
    value: function() {
      null != this.socketTimeout && (clearTimeout(this.socketTimeout), this.socketTimeout = null)
    }
  }, {
    key: "appealNotify",
    value: function() {
      this.currentPage === this.startPage && this.startPage.show({
        banType: 1
      })
    }
  }, {
    key: "gotoRelayMode",
    value: function() {
      this.model.getIsRelayNewBie() ? (console.log("去接龙新手指导"), c.default.emit(P.EVENT.SHOW_RELAY_GUIDE), this.hideCurrentPage(), this.relayGuidePage.show(), this.model.setStage(this.relayGuidePage.name), this.currentPage = this.relayGuidePage) : (console.log("不去接龙新手指导"), this.modeCtrl.changeMode("relayCtrl"))
    }
  }, {
    key: "afterShownStartPage",
    value: function() {
      var e = !1;
      this.lastSyncTime ? Date.now() - this.lastSyncTime > P.SYNC_DEBONCE_TIME && (e = !0, this.lastSyncTime = Date.now()) : (e = !0, this.lastSyncTime = Date.now()), e && (this.checkMsgBox(), v.default.getProps())
    }
  }, {
    key: "checkMsgBox",
    value: function() {
      var e = this;
      d.default.requestMsgRedPot().then((function() {
        var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
        t.count && e.startPage.upDateRedPot()
      }), (function() {}))
    }
  }, {
    key: "handleAd",
    value: function(e) {
      if (("function" == typeof wx.openUrl || "function" == typeof wx.navigateToMiniProgram) && "game" == this.game.stage && this.model.adInfo && this.model.adInfo.canShowAd && e.block && e.block.isAd) {
        var t = e.block;
        this.model.adInfo.advertisingInfo && this.model.adInfo.advertisingInfo.isShowing ? t.order == this.model.adInfo.advertisingInfo.id && (this.model.adInfo.advertisingInfo.score += t.score) : (this.model.adInfo.advertisingInfo = {
          id: t.order,
          score: t.score || 0,
          trademark_url: t.trademark_url || BASE_TRADE_MARK_RUL,
          ad_url: t.ad_url,
          isShowing: !0,
          navigateToMiniProgramData: t.navigateToMiniProgramData
        }, this.game.UI.showAdAvator(this.game.camera, t.trademark_url, t.ad_url, t.navigateToMiniProgramData), this.model.setAdTagInLS())
      }
    }
  }, {
    key: "skipRelayBeginner",
    value: function() {
      this.modeCtrl.changeMode("relayCtrl")
    }
  }, {
    key: "wxOnhide",
    value: function() {}
  }, {
    key: "wxOnShow",
    value: function() {
      "loading" == this.model.stage && (this.model.setStage("game"), this.modeCtrl.singleChangeToPlayer(), this.currentPage = null)
    }
  }, {
    key: "destroy",
    value: function() {
      this.hideCurrentPage(), this.currentPage = null, this.model.setStage(""), this.model.clearGameId(), this.model.clearGameTicket(), this.clearSocketTimeout(), this.model.adInfo = {
        canShowAd: !this.model.getAdTagInLS(),
        advertisingInfo: {}
      }, this.game.resetScene()
    }
  }, {
    key: "hideCurrentPage",
    value: function() {
      this.currentPage && (this.currentPage.hide(), (0, S.hide使用rInfoButton)())
    }
  }]), y
}();
exports.default = C;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/objectSpread2":20,"../../@babel/runtime/helpers/typeof":30,"../config":37,"../control/bottleSkinBaseCtrl":39,"../control/bottleSkinShopCtrl":40,"../control/profileCtrl":50,"../lib/mue/eventcenter":67,"../lib/mue/lookcenter":68,"../network/getAuth":72,"../network/network":73,"../pages/battle/battlePkRulePage":79,"../pages/single/relayGuide":112,"../pages/single/singleFriendRankPage":113,"../pages/single/singleGameOverPage":114,"../pages/single/singleGamePage":115,"../pages/single/singleStartPage":116,"../shareApp":124,"../store/storage":128,"./msgBoxCtrl":45,"./propertyCtrl":51}],58:[function(require,module,exports){
function l(q) {
  if ("function" != typeof WeakMap) return null;
  var e = new WeakMap,
    o = new WeakMap;
  return (l = function(l) {
    return l ? o : e
  })(q)
}
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var q;
(new(function(q, e) {
  if (!e && q && q.__esModule) return q;
  if (null === q || "object" != typeof q && "function" != typeof q) return {
    default: q
  };
  var o = l(e);
  if (o && o.has(q)) return o.get(q);
  var m = {},
    t = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var a in q)
    if ("default" !== a && Object.prototype.hasOwnProperty.call(q, a)) {
      var r = t ? Object.getOwnPropertyDescriptor(q, a) : null;
      r && (r.get || r.set) ? Object.defineProperty(m, a, r) : m[a] = q[a]
    } m.default = q, o && o.set(q, m);
  return m
}(require("./lib/three")).FontLoader)).load(JSON.stringify({
  glyphs: {
    "擂": {
      ha: 1389,
      x_min: 47,
      x_max: 1311,
      o: "m 100 -126 l 74 -7 q 160 -15 119 -15 q 200 42 200 -15 l 200 335 q 79 286 128 304 l 47 408 q 200 458 126 429 l 200 768 l 74 768 l 74 893 l 200 893 l 200 1138 l 326 1138 l 326 893 l 425 893 l 425 768 l 326 768 l 326 517 q 453 589 369 539 l 453 465 q 326 394 401 435 l 326 10 q 203 -126 326 -126 l 100 -126 m 1268 456 l 1268 -147 l 1143 -147 l 1143 -92 l 640 -92 l 640 -147 l 515 -147 l 515 456 l 1268 456 m 640 15 l 833 15 l 833 129 l 640 129 l 640 15 m 951 15 l 1143 15 l 1143 129 l 951 129 l 951 15 m 640 233 l 833 233 l 833 349 l 640 349 l 640 233 m 951 349 l 951 233 l 1143 233 l 1143 349 l 951 349 m 1311 922 l 1311 693 l 1235 693 l 1235 669 l 997 669 l 997 754 l 1200 754 l 1200 819 l 949 819 l 949 492 l 833 492 l 833 819 l 582 819 l 582 754 l 785 754 l 785 669 l 549 669 l 549 694 l 471 694 l 471 922 l 833 922 l 833 988 l 515 988 l 515 1094 l 1265 1094 l 1265 988 l 949 988 l 949 922 l 1311 922 m 549 611 l 785 611 l 785 528 l 549 528 l 549 611 m 997 611 l 1235 611 l 1235 528 l 997 528 l 997 611 z "
    },
    "主": {
      ha: 1389,
      x_min: 75,
      x_max: 1315,
      o: "m 628 785 l 124 785 l 124 914 l 628 914 q 549 1110 594 1017 l 676 1144 q 757 915 726 1025 l 753 914 l 1267 914 l 1267 785 l 761 785 l 761 496 l 1200 496 l 1200 372 l 761 372 l 761 33 l 1315 33 l 1315 -96 l 75 -96 l 75 33 l 628 33 l 628 372 l 190 372 l 190 496 l 628 496 l 628 785 z "
    },
    "得": {
      ha: 1389,
      x_min: 47,
      x_max: 1333,
      o: "m 232 411 q 92 300 168 356 l 54 425 q 364 788 264 582 l 478 735 q 360 546 435 643 l 360 -144 l 232 -144 l 232 411 m 469 1090 q 88 682 357 867 l 47 810 q 360 1142 260 953 l 469 1090 m 547 1096 l 1224 1096 l 1224 633 l 547 633 l 547 1096 m 1097 738 l 1097 815 l 674 815 l 674 738 l 1097 738 m 674 914 l 1097 914 l 1097 990 l 674 990 l 674 914 m 492 554 l 1301 554 l 1301 439 l 1143 439 l 1143 351 l 1333 351 l 1333 236 l 1143 236 l 1143 -6 q 1007 -135 1143 -135 l 856 -135 l 828 -10 q 961 -19 911 -19 q 1013 26 1013 -19 l 1013 236 l 442 236 l 442 351 l 1013 351 l 1013 439 l 492 439 l 492 554 m 657 214 q 832 13 768 104 l 732 -57 q 563 146 669 36 l 657 214 z "
    },
    "分": {
      ha: 1389,
      x_min: 56,
      x_max: 1332,
      o: "m 594 1046 q 403 763 499 871 q 128 524 307 654 l 56 640 q 303 846 189 715 q 483 1113 401 958 l 594 1046 m 257 472 l 257 599 l 1119 599 q 1092 165 1114 339 q 1017 -62 1068 1 q 853 -132 967 -125 l 593 -132 l 558 -6 q 788 -10 679 -10 q 940 79 903 -10 q 988 472 975 168 l 644 472 q 510 119 594 247 q 201 -144 406 -29 l 119 -39 q 392 178 300 58 q 514 472 474 294 l 257 472 m 921 1131 q 1332 638 1035 815 l 1243 533 q 807 1067 932 739 l 921 1131 z "
    },
    "汰": {
      ha: 1389,
      x_min: 11,
      x_max: 1373,
      o: "m 407 830 l 776 830 q 781 1150 781 960 l 901 1150 q 890 830 895 955 l 1340 830 l 1340 727 l 901 727 q 1373 -38 998 233 q 1280 -141 1318 -92 q 846 564 944 130 q 380 -174 776 152 q 293 -81 336 -125 q 770 727 738 260 l 407 727 l 407 830 m 228 374 q 336 320 293 336 q 168 -179 293 174 l 54 -119 q 228 374 163 125 m 76 787 q 342 608 222 700 q 266 510 298 553 q 11 700 130 618 l 76 787 m 152 1139 q 407 955 315 1025 q 331 857 369 906 q 87 1058 212 960 l 152 1139 m 689 114 l 776 174 q 928 -33 857 60 l 830 -98 q 689 114 770 0 z "
    },
    "淘": {
      ha: 1389,
      x_min: 22,
      x_max: 1318,
      o: "m 461 331 l 553 331 l 553 146 l 732 146 l 732 391 l 374 391 l 374 477 l 732 477 l 732 656 l 618 656 q 515 515 564 581 q 429 575 450 559 q 640 873 553 705 l 727 836 q 673 743 700 787 l 1090 743 l 1090 656 l 825 656 l 825 477 l 1166 477 l 1166 391 l 825 391 l 825 146 l 1009 146 l 1009 331 l 1101 331 l 1101 60 l 461 60 l 461 331 m 326 754 q 586 1161 488 944 l 684 1123 q 618 1009 651 1063 l 1318 1009 q 1302 92 1313 315 q 1237 -103 1291 -49 q 1031 -157 1177 -157 q 857 -152 928 -157 q 836 -38 852 -98 q 1031 -54 933 -49 q 1161 -22 1123 -54 q 1199 103 1194 11 q 1215 917 1204 309 l 570 917 q 407 689 488 787 q 326 754 369 716 m 179 385 q 293 336 239 358 q 168 -174 228 87 l 49 -136 q 179 385 119 76 m 87 776 q 326 591 179 711 q 244 505 271 537 q 22 700 98 635 l 87 776 m 141 1134 q 374 933 250 1047 q 293 852 331 890 q 76 1058 146 998 l 141 1134 z "
    },
    "被": {
      ha: 1389,
      x_min: 22,
      x_max: 1367,
      o: "m 564 955 l 917 955 l 917 1150 l 1015 1150 l 1015 955 l 1335 955 l 1335 868 q 1270 684 1313 776 q 1177 722 1226 705 q 1232 863 1210 792 l 1015 863 l 1015 597 l 1259 597 l 1259 515 q 1053 92 1194 260 q 1367 -76 1161 -5 q 1291 -179 1329 -125 q 977 22 1096 -92 q 651 -179 841 -98 q 586 -92 618 -136 q 911 92 787 -11 q 727 510 776 250 l 662 510 l 662 434 q 450 -179 662 43 q 380 -98 418 -136 q 564 434 564 114 l 564 955 m 27 792 l 27 890 l 472 890 l 472 787 q 304 537 401 662 l 304 510 q 358 456 336 477 q 467 581 423 526 l 537 521 q 418 396 488 467 q 510 293 467 336 l 439 222 q 304 385 385 298 l 304 -174 l 212 -174 l 212 423 q 54 271 141 347 q 22 385 43 320 q 353 792 239 570 l 27 792 m 662 597 l 917 597 l 917 863 l 662 863 l 662 597 m 1150 510 l 825 510 q 982 168 868 304 q 1150 510 1090 304 m 163 1118 l 250 1161 q 358 971 315 1069 l 260 922 q 163 1118 222 1009 z "
    },
    "超": {
      ha: 1389,
      x_min: 22,
      x_max: 1367,
      o: "m 22 -60 q 136 488 125 125 l 233 483 q 217 239 228 347 q 342 65 260 130 l 342 570 l 33 570 l 33 667 l 304 667 l 304 863 l 76 863 l 76 960 l 304 960 l 304 1150 l 407 1150 l 407 960 l 608 960 l 608 863 l 407 863 l 407 667 l 629 667 l 629 570 l 445 570 l 445 358 l 640 358 l 640 260 l 445 260 l 445 5 q 673 -38 543 -33 q 1367 -33 928 -38 q 1335 -136 1345 -92 q 640 -136 922 -141 q 190 103 309 -125 q 81 -184 152 -76 q 22 -60 54 -119 m 711 532 l 1280 532 l 1280 43 l 1177 43 l 1177 103 l 814 103 l 814 38 l 711 38 l 711 532 m 646 1004 l 646 1096 l 1291 1096 q 1275 781 1286 906 q 1112 624 1259 624 q 944 624 1042 618 q 922 732 933 678 q 1090 722 1020 716 q 1177 808 1172 722 q 1194 1004 1188 884 l 933 1004 q 705 575 922 694 q 640 662 678 613 q 830 1004 825 765 l 646 1004 m 1177 439 l 814 439 l 814 195 l 1177 195 l 1177 439 z "
    },
    "越": {
      ha: 1389,
      x_min: 27,
      x_max: 1367,
      o: "m 27 -71 q 136 488 130 114 l 228 483 q 212 233 228 347 q 336 71 260 130 l 336 570 l 33 570 l 33 662 l 298 662 l 298 863 l 76 863 l 76 955 l 298 955 l 298 1150 l 391 1150 l 391 955 l 602 955 l 602 863 l 391 863 l 391 662 l 624 662 l 624 570 l 434 570 l 434 353 l 608 353 l 608 260 l 434 260 l 434 11 q 667 -38 532 -33 q 1367 -33 982 -38 q 1335 -136 1345 -92 q 640 -136 944 -136 q 190 98 315 -130 q 81 -184 157 -76 q 27 -71 54 -119 m 770 87 q 987 336 895 206 q 917 808 933 521 l 760 808 l 760 347 q 895 467 819 396 q 917 369 906 418 q 754 222 836 298 q 694 152 727 195 l 624 222 q 667 353 667 277 l 667 895 l 911 895 q 911 1156 911 1020 l 998 1156 q 1004 895 998 1031 l 1340 895 l 1340 808 l 1009 808 q 1058 445 1020 597 q 1183 711 1134 575 l 1270 673 q 1096 326 1199 488 q 1156 201 1118 255 q 1204 163 1177 163 q 1232 212 1221 163 q 1253 423 1242 298 q 1345 385 1313 396 q 1318 168 1335 239 q 1215 49 1297 49 q 1085 125 1139 49 q 1025 233 1053 174 q 846 27 944 119 q 770 87 819 54 m 1074 1101 l 1145 1150 q 1280 993 1204 1085 l 1199 939 q 1074 1101 1128 1036 z "
    },
    "！": {
      ha: 1389,
      x_min: 618,
      x_max: 770,
      o: "m 770 776 l 738 250 l 656 250 l 618 776 l 618 993 l 770 993 l 770 776 m 765 0 l 624 0 l 624 141 l 765 141 l 765 0 z "
    },
    "了": {
      ha: 1389,
      x_min: 71,
      x_max: 1280,
      o: "m 662 651 q 1090 939 890 792 l 71 939 l 71 1053 l 1280 1053 l 1280 917 q 781 591 1036 754 l 781 92 q 727 -92 781 -38 q 543 -146 678 -146 q 326 -141 467 -146 q 304 -11 315 -76 q 532 -27 434 -27 q 662 98 662 -27 l 662 651 z "
    },
    "你": {
      ha: 1389,
      x_min: 16,
      x_max: 1373,
      o: "m 16 483 q 347 1156 233 781 l 456 1123 q 326 808 396 955 l 326 -179 l 222 -179 l 222 602 q 65 363 146 467 q 16 483 43 423 m 1150 624 l 1237 836 l 662 836 q 526 602 597 705 q 445 667 488 635 q 684 1156 597 890 l 792 1112 q 716 939 754 1020 l 1345 939 l 1345 825 l 1248 586 q 1150 624 1188 608 m 846 732 l 955 732 l 955 16 q 787 -163 955 -163 q 608 -163 711 -163 q 586 -43 602 -109 q 760 -54 694 -54 q 846 38 846 -60 l 846 732 m 722 499 q 521 38 629 277 q 418 81 477 60 q 618 532 532 304 l 722 499 m 1166 537 q 1373 98 1259 347 l 1270 49 q 1069 499 1183 266 l 1166 537 z "
    },
    "到": {
      ha: 1389,
      x_min: 22,
      x_max: 1313,
      o: "m 618 895 q 825 559 727 732 q 716 505 770 537 q 673 608 694 559 q 114 548 380 575 l 65 662 q 201 798 146 705 q 304 971 255 873 l 54 971 l 54 1074 l 830 1074 l 830 971 l 434 971 q 228 662 331 803 q 618 694 423 673 q 526 846 575 776 l 618 895 m 60 374 l 380 374 l 380 543 l 488 543 l 488 374 l 798 374 l 798 277 l 488 277 l 488 38 q 819 81 651 60 q 825 -27 819 33 q 54 -130 439 -71 l 22 -16 q 380 22 195 0 l 380 277 l 60 277 l 60 374 m 1199 1156 l 1313 1156 l 1313 5 q 1145 -163 1313 -163 q 949 -163 1090 -163 q 928 -38 939 -103 q 1112 -49 1047 -49 q 1199 38 1199 -49 l 1199 1156 m 901 1009 l 1015 1009 l 1015 146 l 901 146 l 901 1009 z "
    },
    "轮": {
      ha: 1389,
      x_min: 22,
      x_max: 1367,
      o: "m 152 483 l 315 483 l 315 781 l 412 781 l 412 483 l 586 483 l 586 391 l 412 391 l 412 206 q 597 233 510 222 q 597 136 597 201 q 412 114 499 125 l 412 -190 l 315 -190 l 315 103 q 33 65 168 81 l 22 168 q 315 195 174 179 l 315 391 l 49 391 l 49 477 q 174 852 119 678 l 33 852 l 33 944 l 201 944 q 260 1156 233 1053 l 363 1134 q 304 944 336 1036 l 602 944 l 602 852 l 271 852 q 152 483 212 656 m 684 629 l 792 629 l 792 326 q 1118 575 966 429 l 1204 510 q 792 217 998 320 l 792 43 q 884 -43 792 -43 l 1069 -43 q 1177 38 1161 -43 q 1199 239 1194 125 q 1302 201 1210 233 q 1275 5 1291 98 q 1085 -141 1253 -141 l 852 -141 q 684 16 684 -141 l 684 629 m 1009 1139 l 987 1101 q 1367 689 1139 808 q 1297 602 1324 640 q 922 1004 1080 727 q 570 586 765 743 q 499 662 537 629 q 879 1139 738 846 l 1009 1139 z "
    },
    0: {
      ha: 868,
      x_min: 0,
      x_max: 696,
      o: "m 0 868 l 696 868 l 696 693 l 0 693 l 0 868 m 696 0 l 0 0 l 0 175 l 696 175 l 696 0 m 0 694 l 175 694 l 175 174 l 0 174 l 0 694 m 521 694 l 696 694 l 696 174 l 521 174 l 521 694 z "
    },
    1: {
      ha: 521,
      x_min: 0,
      x_max: 347,
      o: "m 174 0 l 347 0 l 347 868 l 0 868 l 0 694 l 174 694 l 174 0 z "
    },
    2: {
      ha: 868,
      x_min: 0,
      x_max: 694,
      o: "m 0 868 l 0 694 l 521 694 l 521 521 l 0 521 l 0 0 l 694 0 l 694 174 l 174 174 l 174 347 l 694 347 l 694 868 l 0 868 z "
    },
    3: {
      ha: 868,
      x_min: 0,
      x_max: 694,
      o: "m 694 0 l 694 868 l 0 868 l 0 694 l 521 694 l 521 521 l 0 521 l 0 347 l 521 347 l 521 174 l 0 174 l 0 0 l 694 0 z "
    },
    4: {
      ha: 868,
      x_min: 0,
      x_max: 694,
      o: "m 521 347 l 174 347 l 174 868 l 0 868 l 0 174 l 521 174 l 521 0 l 694 0 l 694 868 l 521 868 l 521 347 z "
    },
    5: {
      ha: 868,
      x_min: 0,
      x_max: 694,
      o: "m 694 694 l 694 868 l 0 868 l 0 347 l 521 347 l 521 174 l 0 174 l 0 0 l 694 0 l 694 521 l 174 521 l 174 694 l 694 694 z "
    },
    6: {
      ha: 868,
      x_min: 0,
      x_max: 694,
      o: "m 0 869 l 175 869 l 175 0 l 0 0 l 0 869 m 174 519 l 694 519 l 694 346 l 174 346 l 174 519 m 174 869 l 519 869 l 519 694 l 174 694 l 174 869 m 174 174 l 694 174 l 694 0 l 174 0 l 174 174 m 521 347 l 694 347 l 694 174 l 521 174 l 521 347 z "
    },
    7: {
      ha: 868,
      x_min: 0,
      x_max: 694,
      o: "m 0 868 l 0 694 l 521 694 l 521 521 l 694 521 l 694 868 l 0 868 m 347 347 l 521 347 l 521 521 l 347 521 l 347 347 m 174 0 l 347 0 l 347 347 l 174 347 l 174 0 z "
    },
    8: {
      ha: 868,
      x_min: 0,
      x_max: 694,
      o: "m 0 868 l 174 868 l 174 0 l 0 0 l 0 868 m 521 868 l 694 868 l 694 0 l 521 0 l 521 868 m 174 174 l 521 174 l 521 0 l 174 0 l 174 174 m 174 868 l 521 868 l 521 693 l 174 693 l 174 868 m 174 521 l 521 521 l 521 346 l 174 346 l 174 521 z "
    },
    9: {
      ha: 868,
      x_min: 0,
      x_max: 696,
      o: "m 0 521 l 696 521 l 696 346 l 0 346 l 0 521 m 0 868 l 694 868 l 694 694 l 0 694 l 0 868 m 0 696 l 175 696 l 175 519 l 0 519 l 0 696 m 521 696 l 694 696 l 694 521 l 521 521 l 521 696 m 521 349 l 696 349 l 696 -1 l 521 -1 l 521 349 m 174 174 l 521 174 l 521 -1 l 174 -1 l 174 174 z "
    },
    "+": {
      ha: 694,
      x_min: 0,
      x_max: 521,
      o: "m 174 174 l 347 174 l 347 347 l 521 347 l 521 521 l 347 521 l 347 694 l 174 694 l 174 521 l 0 521 l 0 347 l 174 347 l 174 174 z "
    },
    "-": {
      ha: 694,
      x_min: 0,
      x_max: 521,
      o: "m 0 521 l 0 347 l 521 347 l 521 521 l 0 521 z "
    }
  },
  family姓th: "Microsoft YaHei",
  ascender: 1636,
  descender: -296,
  underlinePosition: -119,
  underlineThickness: 80,
  boundingBox: {
    yMin: -186,
    xMin: -220,
    yMax: 1706,
    xMax: 1763
  },
  resolution: 1e3,
  original_font_information: {
    format: 0,
    copyright: "`2005 Microsoft Corporation. All rights reserved.",
    fontFamily: "Microsoft YaHei",
    fontSubfamily: "Regular",
    uniqueID: "Microsoft YaHei-Regular",
    full姓th: "Microsoft YaHei",
    version: "Version 0.71",
    postScript姓th: "MicrosoftYaHei",
    trademark: "Microsoft YaHei is either a registered trademark or a trademark of Microsoft Corporation in the United States and/or other countries.",
    manufacturer: "Microsoft Corporation",
    designer: "Founder",
    description: "Microsoft YaHei is a Simplified Chinese font developed by taking advantage of ClearType technology, and it provides excellent reading experience particularly onscreen. The font is very legible at small sizes.",
    manufacturerURL: "http://www.microsoft.com/typography",
    designerURL: "http://www.founder.com.cn/cn",
    licence: "\r\nNOTIFICATION OF LICENSE AGREEMENT \r\n\r\nThis font software is part of the Microsoft software product in which it was included and is provided under the end user license agreement (“EULA”) for that Microsoft software product. The terms and conditions of the EULA govern the use of font software. Please refer to the applicable Microsoft product EULA if you have any questions about how you may use this font software. Microsoft reserves all rights that are not expressly granted in the EULA. For products that may have installed this font please see the license link.\r\n",
    licenceURL: "http://www.microsoft.com/typography/fonts"
  },
  cssFontWeight: "normal",
  cssFontStyle: "normal"
}), (function(l) {
  q = l
}));
var e = q;
exports.default = e;
},{"./lib/three":70}],59:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../@babel/runtime/helpers/regeneratorRuntime"),
  t = require("../@babel/runtime/helpers/asyncToGenerator"),
  r = require("../@babel/runtime/helpers/objectSpread2"),
  o = require("../@babel/runtime/helpers/classCallCheck"),
  i = require("../@babel/runtime/helpers/createClass"),
  a = v(require("./control/queryCtrl")),
  s = v(require("./control/modeCtrl")),
  n = v(require("./control/networkCtrl")),
  l = v(require("./control/reviewCtrl")),
  c = v(require("./control/bottleSkinBaseCtrl")),
  u = require("./config"),
  h = v(require("./store/session")),
  d = v(require("./lib/mue/eventcenter")),
  m = v(require("./pages/single/bottleSkinSharePage")),
  g = require("./shareApp"),
  p = v(require("./control/propertyCtrl")),
  k = require("./network/getAuth"),
  S = require("./util/common"),
  f = v(require("./network/network"));

function v(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var y = function() {
  function v(e) {
    o(this, v), this.game = e
  }
  var y;
  return i(v, [{
    key: "init",
    value: function() {
      this.gameView = this.game.gameView, this.queryCtrl = new a.default(this.game), this.netWorkCtrl = new n.default(this.game), this.reviewCtrl = new l.default(this.game), this.modeCtrl = new s.default(this.game), this.model = this.game.gameModel, this.reporter = this.game.reporter, this.historyTimes = this.game.historyTimes, this.viewer = this.game.viewer, this.reUpLoadShowOverPage = !0, d.default.on(u.EVENT.TRIGGER_EGG, this.handleAd.bind(this)), d.default.on(u.EVENT.AFTER_SHOWN_START_PAGE, this.afterShownStartPage.bind(this))
    }
  }, {
    key: "firstInitGame",
    value: function(e) {
      this.queryCtrl.identifyMode(e), this.modeCtrl.initFirstPage(e)
    }
  }, {
    key: "identifyModeErr",
    value: function(e) {
      this.gameView.showIdentifyModeErr(e)
    }
  }, {
    key: "onLoginSuccess",
    value: function() {
      this.reporter.setTimer(u.REPORTERTIMEOUT), "single" != this.game.mode && p.default.getProps(), this.checkLaterUpLoad()
    }
  }, {
    key: "clickStart",
    value: function() {
      var e = this;
      (0, k.getAuthWxFriendInteraction)().then((function() {
        e.modeCtrl.clickStart(), e.reporter.rpClickSingleStartPage()
      }))
    }
  }, {
    key: "showFriendRank",
    value: function() {
      var e = this;
      (0, k.getAuthWxFriendInteraction)().then((function() {
        e.netWorkCtrl.upDateFriends本次得分List(), e.reporter.clickStartPageRankBtn(), e.modeCtrl.showFriendRank()
      }))
    }
  }, {
    key: "initReview",
    value: function(e) {
      var t = this;
      this.reviewCtrl.init(r(r({}, e), {}, {
        is_from_share: !1,
        onHide: function() {
          console.log("!!! gameCtrl initReview onHide"), t.modeCtrl.changeMode("singleCtrl")
        }
      }))
    }
  }, {
    key: "quitReview",
    value: function() {
      this.reviewCtrl.reviewPage.onClickHide()
    }
  }, {
    key: "onReturnTo",
    value: function(e) {
      "group" == e ? this.modeCtrl.changeMode("singleCtrl") : "位好友" == e ? this.modeCtrl.showFriendRank(!0) : "home" == e && this.modeCtrl.showStartPage()
    }
  }, {
    key: "clickRank",
    value: function() {
      var e = this;
      this.reporter.clickSingleSettlementPageRankBtn(), (0, k.getAuthWxFriendInteraction)().then((function() {
        e.modeCtrl.clickRank()
      }))
    }
  }, {
    key: "gameOver",
    value: function(e) {
      if (console.log("gameOver", e), "relay" != this.model.mode) {
        var t, r;
        if (!this.reviewCtrl.isInThisPage)
          if (this.model.set本次得分(e), "rankGameChallenge" === this.model.mode || "single" === this.model.mode || "player" === this.model.mode) null === (t = (r = wx).getRankManager) || void 0 === t || t.call(r).update({
            scoreKey: u.RANK_SCORE_KEY,
            score: e,
            success: function(e) {
              console.log("!!! rankManager.update success", e)
            },
            fail: function(e) {
              console.error("!!! rankManager.update fail", e)
            }
          }), this.model.setMode("single");
        if ("observe" != this.model.mode) {
          var o = this.model.getHighest本次得分();
          this.netWorkCtrl.requestMmpayTimeout(), this.historyTimes.addOne();
          var i = this.historyTimes.getTimes();
          p.default.checkUsingProp();
          this.reporter.playGameReport(e, o, i), GameGlobal.matchType || this.netWorkCtrl.upDateFriends本次得分List(), this.netWorkCtrl.update使用rInfo(), c.default.syncSelectBottleSkin()
        }
        "player" == this.model.mode && this.reporter.playAudienceReport(), "battle" == this.model.mode && this.reporter.playPKReport(e), this.reporter.sendReport(), c.default.getSelectedBottleSkinResource().then((function() {}), (function() {}))
      }
    }
  }, {
    key: "gameOverShowPage",
    value: function() {
      var e = this;
      if ("relay" != this.model.mode)
        if (this.reUpLoadShowOverPage = !0, "observe" == this.model.mode) this.modeCtrl.showGameOverPage();
        else {
          this.model.getHighest本次得分();
          var t = this.model.weekBest本次得分,
            r = this.model.current本次得分;
          r < t || GameGlobal.matchType ? (this.modeCtrl.showGameOverPage(), this.historyTimes.checkUp()) : function() {
            var t = {
              seed: e.game.randomSeed,
              time_seed: e.game.time_seed,
              action: e.game.actionList,
              musicList: e.game.musicList,
              touchList: e.game.touchList,
              steps: e.game.touchMoveList,
              timestamp: e.game.touchStartTime,
              version: u.VERSION,
              use_wangzhe: e.game.use_wangzhe,
              use_mmpaybase: e.game.use_mmpaybase,
              mmpay_status: e.game.mmpay_status,
              mmpay_checksum: e.game.mmpay_checksum,
              succ_property_list: p.default.getSuccPropList() || []
            };
            e.game.bottle.skinId && (t.bottle_skin = {
              item_id: e.game.bottle.skinId
            }), void 0 !== e.game.skin_id && (t.skin_id = e.game.skin_id, t.skin_sn = e.game.skin_sn, console.log(JSON.stringify(t)));
            var o = e.historyTimes.getTimes();
            e.model.upLoad本次得分Data = {
              current本次得分: r,
              gameTimes: o,
              verifyData: t
            }, e.netWorkCtrl.requestSettlement(r, o, e.afterRequestSettlement.bind(e), t)
          }(), GameGlobal.matchType || p.default.handleGameOver({
            seed: e.game.randomSeed,
            time_seed: e.game.time_seed,
            action: e.game.actionList,
            musicList: e.game.musicList,
            touchList: e.game.touchList,
            steps: e.game.touchMoveList,
            timestamp: e.game.touchStartTime,
            version: u.VERSION,
            use_wangzhe: e.game.use_wangzhe,
            use_mmpaybase: e.game.use_mmpaybase,
            mmpay_status: e.game.mmpay_status,
            mmpay_checksum: e.game.mmpay_checksum
          }, r)
        }
    }
  }, {
    key: "afterRequestSettlement",
    value: function(e, t, o) {
      var i = this,
        a = new m.default(r(r(r({}, t), o), {}, {
          game: this.game,
          onReturn: function() {
            n(t)
          },
          on分享: function() {
            (0, g.shareGiftCard)(o.gift_id), i.reporter.rpGetSkin分享Goods(), console.log("on分享", o.gift_id)
          },
          on分享Skin: function() {
            i.reporter.rpGetSkinShowOff();
            var e = o.bottle_skin && o.bottle_skin.share_poster;
            (0, g.shareSkin)(e)
          }
        }));
      if (e) {
        if (this.reUpLoadShowOverPage && n(t, o), o && o.bottle_skin && o.bottle_skin.item_id && o.bottle_skin.expire_time && c.default.updateSkinExpire(o.bottle_skin.item_id, o.bottle_skin.expire_time), this.historyTimes.afterUpload(!0), "observe" == this.model.mode) return;
        var s = this.model.upLoad本次得分Data.current本次得分;
        if (null == s || t && t.banType) return;
        s >= this.model.weekBest本次得分 && (this.model.weekBest本次得分 = s, this.model.saveWeekBest本次得分(s), s > this.model.getHighest本次得分() && this.model.saveHeighest本次得分(this.model.current本次得分), o && o.playback_id && c.default.setRankDataTolocalStorage({
          playback_id: o.playback_id
        }))
      } else this.netWorkCtrl.sendServerError(), this.showReUpLoad本次得分Model(t);

      function n(e, t) {
        i.modeCtrl.showGameOverPage(r(r(r({}, e), t), {}, {
          onClickBottleSkin: function() {
            a.show(), i.reporter.rpGetSkinSettleClickSkin()
          }
        }))
      }
    }
  }, {
    key: "showReUpLoad本次得分Model",
    value: function(e) {
      var t = this;
      wx.showModal({
        title: "提示",
        content: "分数上传失败,请检查网络状态后重试(" + e + ")",
        confirmText: "重试",
        cancelText: "延后上传",
        success: function(r) {
          r.confirm ? t.reUpload本次得分() : r.cancel ? t.reUpLoadShowOverPage && t.showOverPage(!0) : t.showReUpLoad本次得分Model(e)
        },
        fail: function() {
          t.reUpLoadShowOverPage && t.showOverPage(!1)
        }
      })
    }
  }, {
    key: "showOverPage",
    value: function(e) {
      if (this.modeCtrl.showGameOverPage(), e && "observe" != this.model.mode) {
        if (!this.model.upLoad本次得分Data.verifyData || !this.model.upLoad本次得分Data.current本次得分) return;
        var t = this.model.getActionData(),
          r = this.model.upLoad本次得分Data.verifyData,
          o = this.model.upLoad本次得分Data.current本次得分;
        t && t.ts > Date.now() && t.score >= o || this.model.saveLaterUpLoad本次得分(o, r)
      }
    }
  }, {
    key: "reUpload本次得分",
    value: function() {
      var e = this;
      h.default.sessionId ? this.reUpload本次得分2() : this.netWorkCtrl.requestLogin((function(t) {
        t ? e.reUpload本次得分2() : e.showReUpLoad本次得分Model("n0")
      }))
    }
  }, {
    key: "reUpload本次得分2",
    value: function() {
      var e = this.model.upLoad本次得分Data,
        t = e.current本次得分,
        r = e.gameTimes,
        o = e.verifyData;
      this.netWorkCtrl.requestSettlement(t, r, this.afterRequestSettlement.bind(this), o)
    }
  }, {
    key: "clickReplay",
    value: function() {
      this.reporter.playAudienceReportStart(), this.reporter.rpSingleSettlePlayAgain(), this.modeCtrl.gameOverClickReplay()
    }
  }, {
    key: "friendRankReturn",
    value: function() {
      this.modeCtrl.friendRankReturn()
    }
  }, {
    key: "netWorkLogin",
    value: function() {
      this.netWorkCtrl.netWorkLogin()
    }
  }, {
    key: "shareGroupRank",
    value: function() {
      this.modeCtrl.shareGroupRank()
    }
  }, {
    key: "after分享GroupRank",
    value: function(e, t) {
      this.reporter.shareGroupReport(t)
    }
  }, {
    key: "showPkRule",
    value: function() {
      console.log("!!! gameCtrl showPkRulePage"), this.modeCtrl.showPkRule()
    }
  }, {
    key: "closePkRule",
    value: function() {
      console.log("!!! gameCtrl closePkRule"), this.modeCtrl.closePkRule()
    }
  }, {
    key: "setPkDuration",
    value: function() {
      console.log("!!! gameCtrl setPkDuration"), this.modeCtrl.setPkDuration()
    }
  }, {
    key: "subscribePk",
    value: (y = t(e().mark((function t() {
      var r, o = this;
      return e().wrap((function(e) {
        for (;;) switch (e.prev = e.next) {
          case 0:
            return e.next = 2, (0, u.getSetting)();
          case 2:
            r = e.sent, wx.requestSubscribeMessage({
              tmplIds: [u.PK_SUBSCRIPTION_TEMPLATE_ID],
              success: function(e) {
                var t, i, a, s, n;
                if (console.log("!!! subscribePk success", e), wx.setStorageSync(o.model.getPkId(), e[u.PK_SUBSCRIPTION_TEMPLATE_ID]), e[u.PK_SUBSCRIPTION_TEMPLATE_ID] && (console.log("!!! 本地设置订阅状态", e[u.PK_SUBSCRIPTION_TEMPLATE_ID]), r.subscriptionsSetting[u.PK_SUBSCRIPTION_TEMPLATE_ID] = e[u.PK_SUBSCRIPTION_TEMPLATE_ID]), null !== (t = r.subscriptionsSetting) && void 0 !== t && t[u.PK_SUBSCRIPTION_TEMPLATE_ID])
                  if ((null === (i = r.subscriptionsSetting) || void 0 === i ? void 0 : i[u.PK_SUBSCRIPTION_TEMPLATE_ID]) === u.SUBSCRIPTION_SETTING_TYPE.ACCEPT || (null === (a = r.subscriptionsSetting) || void 0 === a ? void 0 : a[u.PK_SUBSCRIPTION_TEMPLATE_ID]) === u.SUBSCRIPTION_SETTING_TYPE.ACCEPT_WITH_FORCE_PUSH) wx.showToast({
                    title: "已订阅",
                    icon: "success",
                    duration: 1e3
                  });
                  else if ((null === (s = r.subscriptionsSetting) || void 0 === s ? void 0 : s[u.PK_SUBSCRIPTION_TEMPLATE_ID]) === u.SUBSCRIPTION_SETTING_TYPE.REJECT) wx.showModal({
                  title: "请先前往右上角[···]的「设置 > 订阅消息」开启通知接收",
                  show取消: !1,
                  confirmText: "我知道了"
                });
                else if ((null === (n = r.subscriptionsSetting) || void 0 === n ? void 0 : n[u.PK_SUBSCRIPTION_TEMPLATE_ID]) === u.SUBSCRIPTION_SETTING_TYPE.BAN) {
                  var l;
                  console.error("订阅模板被禁用", null === (l = r.subscriptionsSetting) || void 0 === l ? void 0 : l[u.PK_SUBSCRIPTION_TEMPLATE_ID])
                } else {
                  var c;
                  console.error("未知订阅状态", null === (c = r.subscriptionsSetting) || void 0 === c ? void 0 : c[u.PK_SUBSCRIPTION_TEMPLATE_ID])
                }
                o.modeCtrl.battleCtrl.gotoBattlePage()
              },
              fail: function(e) {
                console.error("!!! subscribePk fail", e)
              }
            });
          case 4:
          case "end":
            return e.stop()
        }
      }), t)
    }))), function() {
      return y.apply(this, arguments)
    })
  }, {
    key: "shareBattleCard",
    value: function(e) {
      var t = this;
      console.log("!!! gameCtrl shareBattleCard"), S.inQQ || (0, S.throttleEvent)({
        event姓th: "shareBattleCard",
        callback: function() {
          if (console.log("shareBattleCard", t.model.current本次得分, u.REWARD_SCORE), e && t.model.current本次得分 >= u.REWARD_SCORE && u.CAN_USE_REWARD_CHALLENGE) wx.getRankManager().createChallenge({
            scoreKey: u.RANK_SCORE_KEY,
            success: function(e) {
              console.log("!!! rankManager.createChallenge success", e)
            },
            fail: function(e) {
              console.error("!!! rankManager.createChallenge fail", e)
            }
          });
          else {
            var r = t.model.getSessionId(),
              o = t.model.current本次得分,
              i = t.model.getPkId();
            r ? (!i || e ? f.default.createPK(o, t.model.pkLifeTime).then((function() {
              t.afterHavePkId(!0)
            }), (function() {
              t.getPKErr()
            })).catch((function(e) {
              return console.log(e)
            })) : t.afterHavePkId(!1), t.reporter.rpClick分享Battle()) : t.gameView.showNoSession()
          }
        }
      })
    }
  }, {
    key: "afterHavePkId",
    value: function(e) {
      var t = this;
      console.log("!!! gameCtrl afterHavePkId", e, this.model.current本次得分, this.model.champion本次得分);
      var r = this.model.getPkId(),
        o = e ? this.model.current本次得分 : this.model.champion本次得分 || 0;
      (0, g.shareBattle)(r, o, (function(e, r, o) {
        t.after分享Battle(e, r, o)
      }), this.model, this.modeCtrl)
    }
  }, {
    key: "getPKErr",
    value: function() {
      this.gameView.showGetPkIdFail()
    }
  }, {
    key: "after分享Battle",
    value: function(e, t, r) {
      console.log("!!! gameCtrl after分享Battle", e, t, r, this.model.mode), e && this.reporter.sharePKReport(r)
    }
  }, {
    key: "groupPlayGame",
    value: function() {
      this.modeCtrl.groupPlayGame()
    }
  }, {
    key: "loginBattle",
    value: function(e) {
      this.reporter.joinPKReport(e), this.reporter.playPKReportStart(e)
    }
  }, {
    key: "showPkPage",
    value: function(e) {
      this.reporter.playPK本次得分(e)
    }
  }, {
    key: "onBattlePlay",
    value: function(e) {
      this.modeCtrl.battlePlay(e)
    }
  }, {
    key: "battleToSingle",
    value: function() {
      this.reporter.resetPKReport()
    }
  }, {
    key: "shareObservCard",
    value: function() {
      console.log("!!! gameCtrl shareObservCard"), this.modeCtrl.shareObservCard(), this.reporter.rpClickObserve分享()
    }
  }, {
    key: "socketJoinSuccess",
    value: function(e) {
      this.modeCtrl.socketJoinSuccess(e), "observe" == this.model.mode ? e ? (this.game.socketFirstSync = !0, this.reporter.joinAudienceReportStart()) : this.reporter.joinAudienceReport() : e && this.reporter.playAudienceReportStart()
    }
  }, {
    key: "after分享ObserveCard",
    value: function(e) {
      this.reporter.shareAudienceReport(e)
    }
  }, {
    key: "showPlayerGG",
    value: function(e) {
      this.modeCtrl.showPlayerGG(e)
    }
  }, {
    key: "showPlayerWaiting",
    value: function() {
      this.modeCtrl.showPlayerWaiting()
    }
  }, {
    key: "onPlayerOut",
    value: function() {
      this.modeCtrl.onPlayerOut()
    }
  }, {
    key: "onViewerStart",
    value: function() {
      this.game.audioManager.scale_intro.stop(), this.game.deadTimeout && (clearTimeout(this.game.deadTimeout), this.game.deadTimeout = null), this.game.pendingReset = !1, this.modeCtrl.onViewerStart(), this.reporter.joinAudienceReport()
    }
  }, {
    key: "wxOnShow",
    value: function(e) {
      var t = this;
      this.netWorkCtrl.requestServerInit(), this.netWorkCtrl.requestMmpayTimeout(), this.reporter.setTimer(u.REPORTERTIMEOUT), c.default.getSelectedBottleSkinResource().then((function() {}), (function() {})), setTimeout((function() {
        e.query && e.query.hasOwnProperty("mode") ? (t.reUpLoadShowOverPage = !1, t.modeCtrl.reInitFirstPage(e), t.game.guider = !1) : "single" != t.model.mode && "rankGameChallenge" != t.model.mode && "player" != t.model.mode && "battle" != t.model.mode && "relay" != t.model.mode ? (console.log("!!! gameCtrl wxOnShow changeMode", t.model.mode), t.reUpLoadShowOverPage = !1, t.modeCtrl.changeMode("singleCtrl"), t.game.guider = !1) : t.reviewCtrl.isInThisPage ? t.reviewCtrl.continue() : t.modeCtrl.wxOnShow()
      }), 300)
    }
  }, {
    key: "wxOnhide",
    value: function() {
      this.reporter.quitReport(), "observe" == this.model.mode ? this.reporter.joinAudienceReport() : this.reviewCtrl.isInThisPage && this.reviewCtrl.pausePlay(), this.netWorkCtrl.clearServerInit(), this.netWorkCtrl.clearMmpayTimeout(), this.reporter.clearTimer(), this.reporter.sendReport(), this.modeCtrl.wxOnhide()
    }
  }, {
    key: "onReplayGame",
    value: function() {
      "observe" != this.model.mode && (this.reporter.playGameReportStart(), this.reporter.gameBeginReport())
    }
  }, {
    key: "onPeopleCome",
    value: function(e) {
      0 == e.audience_cmd ? (this.viewer.peopleCome(e), this.reporter.playAudienceReportMaxPeople(this.viewer.num)) : 1 == e.audience_cmd && this.viewer.peopleOut(e)
    }
  }, {
    key: "onServerConfigForbid",
    value: function() {}
  }, {
    key: "onSocketCloseErr",
    value: function() {
      console.log("!!! gameCtrl onSocketCloseErr", this.model.mode), "relay" === this.game.mode ? this.modeCtrl.onSocketCloseErr() : (this.gameView.showSocketCloseErr(), this.modeCtrl.changeMode("singleCtrl"))
    }
  }, {
    key: "appealNotify",
    value: function() {
      this.modeCtrl.appealNotify()
    }
  }, {
    key: "checkLaterUpLoad",
    value: function(e) {
      var t = this,
        r = this.model.getActionData();
      if (r && r.ts > Date.now() && r.score) {
        var o = r.score,
          i = r.data,
          a = this.historyTimes.getTimes();
        e ? this.netWorkCtrl.requestSettlement(o, a, this.afterCheckLaterUpLoad.bind(this, o), i) : wx.showModal({
          title: "提示",
          content: "当前有分数未上传成功，是否重试",
          confirmText: "重试",
          cancelText: "取消",
          success: function(e) {
            e.confirm ? t.netWorkCtrl.requestSettlement(o, a, t.afterCheckLaterUpLoad.bind(t, o), i) : e.cancel ? t.model.clearLaterUpLoad本次得分() : t.checkLaterUpLoad()
          },
          fail: function() {
            t.checkLaterUpLoad()
          }
        })
      }
    }
  }, {
    key: "touchProp",
    value: function(e) {
      this.modeCtrl.touchProp(e)
    }
  }, {
    key: "afterCheckLaterUpLoad",
    value: function(e, t, r) {
      var o = this;
      if (t) return wx.showToast({
        title: "分数上传成功",
        icon: "success",
        duration: 1e3
      }), this.model.clearLaterUpLoad本次得分(), e > this.model.weekBest本次得分 && (this.model.weekBest本次得分 = e, this.model.saveWeekBest本次得分(e)), void(e > this.model.highest本次得分 && this.model.saveHeighest本次得分(e));
      wx.showModal({
        title: "提示",
        content: "分数延后上传失败,请检查网络状态后重试(" + r + ")",
        confirmText: "重试",
        cancelText: "延后上传",
        success: function(e) {
          e.confirm ? o.checkLaterUpLoad(!0) : e.cancel || o.afterCheckLaterUpLoad(!1, r)
        },
        fail: function() {
          o.afterCheckLaterUpLoad(!1, r)
        }
      })
    }
  }, {
    key: "handleAd",
    value: function(e, t) {
      this.modeCtrl.handleAd(t)
    }
  }, {
    key: "onSocketOpen",
    value: function() {
      this.modeCtrl.onSocketOpen()
    }
  }, {
    key: "gotoRelayMode",
    value: function() {
      this.reporter.reportGotoRelayMode(), this.modeCtrl.gotoRelayMode()
    }
  }, {
    key: "skipRelayBeginner",
    value: function() {
      this.modeCtrl.skipRelayBeginner()
    }
  }, {
    key: "outRelay1",
    value: function() {
      this.reporter.relayBackStart(), this.modeCtrl.outRelay1()
    }
  }, {
    key: "outRelay2",
    value: function() {
      this.reporter.relayBackStart(), this.modeCtrl.outRelay2()
    }
  }, {
    key: "startRelay",
    value: function(e) {
      this.modeCtrl.startRelay(e)
    }
  }, {
    key: "watchRelay",
    value: function() {
      this.modeCtrl.watchRelay(), this.reporter.rpWatchRelay()
    }
  }, {
    key: "replayRelay",
    value: function() {
      this.modeCtrl.replayRelay()
    }
  }, {
    key: "shareRelay",
    value: function() {
      this.modeCtrl.shareRelay()
    }
  }, {
    key: "shareRelayLive",
    value: function(e) {
      this.modeCtrl.shareRelayLive(e)
    }
  }, {
    key: "afterShownStartPage",
    value: function() {
      this.reporter.reportStartPage(), this.modeCtrl.afterShownStartPage()
    }
  }]), v
}();
exports.default = y;
},{"../@babel/runtime/helpers/asyncToGenerator":6,"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"../@babel/runtime/helpers/objectSpread2":20,"../@babel/runtime/helpers/regeneratorRuntime":22,"./config":37,"./control/bottleSkinBaseCtrl":39,"./control/modeCtrl":44,"./control/networkCtrl":46,"./control/propertyCtrl":51,"./control/queryCtrl":52,"./control/reviewCtrl":55,"./lib/mue/eventcenter":67,"./network/getAuth":72,"./network/network":73,"./pages/single/bottleSkinSharePage":111,"./shareApp":124,"./store/session":127,"./util/common":136}],60:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../@babel/runtime/helpers/classCallCheck"),
  t = require("../@babel/runtime/helpers/createClass"),
  a = s(require("./store/storage")),
  i = s(require("./store/session"));

function s(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var r = function() {
  function s(t) {
    e(this, s), this.game = t, this.mode = "", this.stage = "", this.is_from_wn = 0, this.firstBlood = !1, this.current本次得分 = 0, this.highest本次得分 = 0, this.observeInfo = {}, this.位好友本次得分 = [], this.weekBest本次得分 = 0, this.startTime = Math.floor(Date.now() / 1e3), this.upLoad本次得分Data = {}, this.relayInfo = {}, this.groupListData = !1, this.chatToolActivityId = "", this.groupOpenid = "", this.pkLifeTime = void 0, this.champion本次得分 = -1, this.adInfo = {
      canShowAd: !1,
      advertisingInfo: {}
    }
  }
  return t(s, [{
    key: "checkAdInfo",
    value: function() {
      this.adInfo.canShowAd = !this.getAdTagInLS()
    }
  }, {
    key: "setMode",
    value: function(e) {
      this.mode = e, this.game.mode = e
    }
  }, {
    key: "setStage",
    value: function(e) {
      this.stage = e, this.game.stage = e
    }
  }, {
    key: "init",
    value: function() {
      i.default.init(), a.default.getFirstBlood() || (this.setFirstBlood(!0), a.default.saveFirstBlood()), this.highest本次得分 = a.default.getHeighest本次得分() || 0, i.default.setServerConfig(a.default.getServerConfig()), this.weekBest本次得分 = a.default.getWeekBest本次得分() || 0, this.位好友本次得分 = a.default.getFriends本次得分()
    }
  }, {
    key: "getServerConfig",
    value: function() {
      return i.default.serverConfig
    }
  }, {
    key: "setIsFromWn",
    value: function(e) {
      this.is_from_wn = e, this.game.is_from_wn = e
    }
  }, {
    key: "setFirstBlood",
    value: function(e) {
      this.firstBlood = e, this.game.firstBlood = e
    }
  }, {
    key: "getMode",
    value: function() {
      return this.mode
    }
  }, {
    key: "set本次得分",
    value: function(e) {
      this.current本次得分 = e
    }
  }, {
    key: "saveHeighest本次得分",
    value: function(e) {
      a.default.saveHeighest本次得分(e), this.highest本次得分 = e
    }
  }, {
    key: "saveLaterUpLoad本次得分",
    value: function(e, t) {
      if (e && t) {
        var i = {
          ts: this.get下1步Sunday(),
          score: e,
          data: t
        };
        a.default.saveActionData(i)
      }
    }
  }, {
    key: "clearLaterUpLoad本次得分",
    value: function() {
      a.default.saveActionData("")
    }
  }, {
    key: "saveWeekBest本次得分",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0,
        t = {
          ts: this.get下1步Sunday(),
          data: e
        };
      a.default.saveWeekBest本次得分(t)
    }
  }, {
    key: "getActionData",
    value: function() {
      return a.default.getActionData()
    }
  }, {
    key: "getHighest本次得分",
    value: function() {
      return this.highest本次得分
    }
  }, {
    key: "saveFriends本次得分",
    value: function(e) {
      this.位好友本次得分 = e;
      var t = {
        ts: this.get下1步Sunday(),
        data: e
      };
      a.default.saveFriends本次得分(t)
    }
  }, {
    key: "getSessionId",
    value: function() {
      return i.default.sessionId
    }
  }, {
    key: "getPkId",
    value: function() {
      return i.default.pkId
    }
  }, {
    key: "clearPkId",
    value: function() {
      i.default.clearPkId()
    }
  }, {
    key: "set分享Ticket",
    value: function(e) {
      i.default.set分享Ticket(e)
    }
  }, {
    key: "get分享Ticket",
    value: function() {
      return i.default.shareTicket
    }
  }, {
    key: "clear分享Ticket",
    value: function() {
      i.default.clear分享Ticket()
    }
  }, {
    key: "setGameId",
    value: function(e) {
      i.default.setGameId(e)
    }
  }, {
    key: "setGameTicket",
    value: function(e) {
      i.default.setGameTicket(e)
    }
  }, {
    key: "clearGameId",
    value: function() {
      i.default.clearGameId()
    }
  }, {
    key: "clearGameTicket",
    value: function() {
      i.default.clearGameTicket()
    }
  }, {
    key: "setObserveInfo",
    value: function(e) {
      this.observeInfo.headimg = e.headimg, this.observeInfo.nick姓th = e.nick姓th
    }
  }, {
    key: "clearObserveInfo",
    value: function() {
      this.observeInfo.headimg = null, this.observeInfo.nick姓th = null
    }
  }, {
    key: "getIsRelayNewBie",
    value: function() {
      var e = !a.default.getRelayNewBie();
      return e && a.default.setRelayNewBie(), e
    }
  }, {
    key: "getAdTagInLS",
    value: function() {
      var e = a.default.getAdTag();
      return e = !!(e && e.ts && e.ts > Date.now())
    }
  }, {
    key: "setAdTagInLS",
    value: function() {
      var e = this.get下1步Day();
      a.default.saveAdTag({
        ts: e
      })
    }
  }, {
    key: "get下1步Day",
    value: function() {
      var e = new Date;
      return e.setHours(0, 0, 0, 0), e.valueOf() + 864e5
    }
  }, {
    key: "get下1步Sunday",
    value: function() {
      var e = new Date,
        t = e.getDay();
      e.setHours(0, 0, 0, 0);
      var a = 7 - t + 1;
      return 8 == a && (a = 1), e.valueOf() + 24 * a * 60 * 60 * 1e3
    }
  }, {
    key: "setGroupRankData",
    value: function(e, t) {
      this.groupListData = {
        list: e,
        userInfo: t
      }
    }
  }, {
    key: "getGroupRankData",
    value: function() {
      var e = this.groupListData;
      return !(!e || !e.userInfo) && {
        list: e.list,
        userInfo: e.userInfo
      }
    }
  }]), s
}();
exports.default = r;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./store/session":127,"./store/storage":128}],61:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var o = require("../@babel/runtime/helpers/classCallCheck"),
  e = require("../@babel/runtime/helpers/createClass"),
  a = function() {
    function a(e) {
      o(this, a), this.game = e
    }
    return e(a, [{
      key: "init",
      value: function() {}
    }, {
      key: "showIdentifyModeErr",
      value: function(o) {
        this.showModal(o)
      }
    }, {
      key: "showNoSession",
      value: function() {
        this.showModal()
      }
    }, {
      key: "showGetPkIdFail",
      value: function() {
        this.showModal()
      }
    }, {
      key: "showGroup分享Fail",
      value: function() {
        var o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "网络异常,点击确定回到游戏";
        console.warn("!!! showGroup分享Fail", o), this.showModal(o)
      }
    }, {
      key: "showGoToBattleFail",
      value: function() {
        this.showModal()
      }
    }, {
      key: "showUploadPk本次得分Fail",
      value: function() {
        this.showModal("数据上传失败")
      }
    }, {
      key: "show分享ObserveCardFail",
      value: function(o) {
        this.showModal(o)
      }
    }, {
      key: "showObserveStateFail",
      value: function() {
        this.showModal("服务器异常")
      }
    }, {
      key: "showModal",
      value: function() {
        var o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "网络异常,点击确定回到游戏";
        console.warn("!!! showModal", o), wx.showModal({
          title: "提示",
          content: o,
          show取消: !1
        })
      }
    }, {
      key: "showServeConfigForbiddenObserveMode",
      value: function() {
        this.showModal("当前围观人数过多，请稍后再试")
      }
    }, {
      key: "showServeConfigForbiddenGroup分享",
      value: function() {
        this.showModal("查看群排行人数过多，请稍后再试")
      }
    }, {
      key: "showSocketCloseErr",
      value: function() {}
    }, {
      key: "showJoinRelayFail",
      value: function() {
        var o = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
        this.showModal("加入游戏失败(" + o + ")，请检查网络后重试")
      }
    }, {
      key: "showVersionMismatching",
      value: function() {
        this.showModal("加入游戏失败,游戏版本不1致")
      }
    }, {
      key: "showJoinRelayFail2",
      value: function() {
        this.showModal("网络繁忙，请稍后再试")
      }
    }, {
      key: "showJoin下1步RoomFail",
      value: function() {
        this.showModal("获取房间信息失败，请稍后再试")
      }
    }, {
      key: "showSyncopErr",
      value: function() {}
    }]), a
  }();
exports.default = a;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8}],62:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = function(e, r) {
  try {
    if ("undefined" != typeof requirePlugin) {
      var o = new(0, requirePlugin("MiniGameCenter", {
        enableRequireHostModule: !0,
        customEnv: {
          wx: wx
        }
      }).default)(e);
      void 0 === o || void 0 === o.on ? console.error("minigameCenter create error") : (o.on("ready", (function() {
        GameGlobal.minigameCenter = o, r()
      })), o.on("error", (function(e) {
        console.log("插件初始化失败", e)
      })))
    }
  } catch (e) {
    console.error(e)
  }
};
},{}],63:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var o = require("../@babel/runtime/helpers/classCallCheck"),
  r = require("../@babel/runtime/helpers/createClass"),
  t = function(o, r) {
    if (!r && o && o.__esModule) return o;
    if (null === o || "object" != typeof o && "function" != typeof o) return {
      default: o
    };
    var t = i(r);
    if (t && t.has(o)) return t.get(o);
    var e = {},
      n = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var l in o)
      if ("default" !== l && Object.prototype.hasOwnProperty.call(o, l)) {
        var a = n ? Object.getOwnPropertyDescriptor(o, l) : null;
        a && (a.get || a.set) ? Object.defineProperty(e, l, a) : e[l] = o[l]
      } e.default = o, t && t.set(o, e);
    return e
  }(require("./lib/three")),
  e = require("./config"),
  n = require("./lib/animation");

function i(o) {
  if ("function" != typeof WeakMap) return null;
  var r = new WeakMap,
    t = new WeakMap;
  return (i = function(o) {
    return o ? t : r
  })(o)
}
var l = window.innerHeight > window.innerWidth ? window.innerHeight : window.innerWidth,
  a = window.innerHeight < window.innerWidth ? window.innerHeight : window.innerWidth,
  u = function() {
    function i() {
      o(this, i);
      var r = ["varying vec2 vUv;", "void main()", "{", "  vUv = uv;", "  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);", "}"].join("\n"),
        n = ["uniform vec3 topColor;", "uniform vec3 bottomColor;", "varying vec2 vUv;", "void main()", "{", "  float h = vUv.y;", "  gl_FragColor = vec4(mix(bottomColor, topColor, min(max(h, 0.0), 1.0)), 1.0);", "}"].join("\n"),
        u = {
          topColor: {
            type: "c",
            value: new t.Color("rgb(215, 219, 230)")
          },
          bottomColor: {
            type: "c",
            value: new t.Color("rgb(188, 190, 199)")
          }
        },
        s = new t.PlaneGeometry(a / l * e.FRUSTUMSIZE, e.FRUSTUMSIZE);
      this.obj = new t.Object3D;
      var c = new t.ShaderMaterial({
        uniforms: u,
        vertexShader: r,
        fragmentShader: n
      });
      this.ground = new t.Mesh(s, c), this.obj.add(this.ground), this.colors = [{
        topColor: [215, 219, 230],
        bottomColor: [188, 190, 199]
      }, {
        topColor: [252, 235, 227],
        bottomColor: [227, 190, 195]
      }, {
        topColor: [217, 237, 245],
        bottomColor: [188, 218, 191]
      }, {
        topColor: [248, 228, 189],
        bottomColor: [231, 192, 136]
      }, {
        topColor: [214, 230, 249],
        bottomColor: [153, 183, 208]
      }, {
        topColor: [255, 250, 204],
        bottomColor: [239, 232, 152]
      }, {
        topColor: [217, 218, 246],
        bottomColor: [164, 172, 212]
      }], this.current = 0
    }
    return r(i, [{
      key: "changeColor",
      value: function() {
        var o = this,
          r = this.current + 1 > 6 ? 0 : this.current + 1,
          e = [255 * this.ground.material.uniforms.topColor.value.r, 255 * this.ground.material.uniforms.topColor.value.g, 255 * this.ground.material.uniforms.topColor.value.b],
          i = [255 * this.ground.material.uniforms.bottomColor.value.r, 255 * this.ground.material.uniforms.bottomColor.value.g, 255 * this.ground.material.uniforms.bottomColor.value.b],
          l = e.concat(i),
          a = this.colors[r].topColor.concat(this.colors[r].bottomColor);
        (0, n.TweenAnimation)(l, a, 5e3, "Linear", (function(e, n) {
          if (void 0 !== e) {
            for (var i = 0; i < 6; ++i) e[i] = parseInt(e[i]);
            var l = e.slice(0, 3),
              a = e.slice(3);
            o.ground.material.uniforms.topColor.value = new t.Color("rgb(".concat(l.join(","), ")")), o.ground.material.uniforms.bottomColor.value = new t.Color("rgb(".concat(a.join(","), ")")), o.current = r
          }
        }))
      }
    }]), i
  }();
exports.default = u;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./config":37,"./lib/animation":66,"./lib/three":70}],64:[function(require,module,exports){
var e = require("../@babel/runtime/helpers/classCallCheck"),
  t = require("../@babel/runtime/helpers/createClass");
require("./weapp-adapter");
var i = (function (e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || ("object" != typeof e && "function" != typeof e))
      return {
        default: e,
      };
    var i = q(t);
    if (i && i.has(e)) return i.get(e);
    var o = {},
      s = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var n in e)
      if ("default" !== n && Object.prototype.hasOwnProperty.call(e, n)) {
        var a = s ? Object.getOwnPropertyDescriptor(e, n) : null;
        a && (a.get || a.set) ? Object.defineProperty(o, n, a) : (o[n] = e[n]);
      }
    ((o.default = e), i && i.set(e, o));
    return o;
  })(require("./lib/three")),
  o = D(require("./block")),
  s = D(require("./ui")),
  n = D(require("./wave")),
  a = D(require("./ground")),
  r = D(require("./bottle")),
  l = require("./config"),
  h = D(require("./ui/audioManager")),
  c = D(require("./tailSystem")),
  d = D(require("./lib/point-in-polygon")),
  u = D(require("./network/network")),
  m = D(require("./store/storage")),
  g = D(require("./store/session")),
  b = D(require("./rankSystem")),
  p = D(require("./network/socket")),
  k = D(require("./pages/full2D")),
  v = require("./shareApp"),
  f = D(require("./viewer")),
  y = require("./lib/animation"),
  w = D(require("./store/historyTimes")),
  x = D(require("./network/reporter")),
  B = D(require("./gameCtrl")),
  T = D(require("./gameView")),
  C = D(require("./gameModel")),
  S = require("./random"),
  G = D(require("./control/instructionCtrl")),
  j = D(require("./control/relayInstructionCtrl")),
  M = D(require("./lib/mue/eventcenter")),
  L = D(require("./control/onebyoneCtrl")),
  P = D(require("./control/bottleSkinBaseCtrl")),
  O = require("./util/encryption"),
  R = D(require("./network/relayMoniter")),
  E = D(require("./lib/mue/lookcenter")),
  I = D(require("./skin")),
  z = D(require("./control/propertyCtrl")),
  A = D(require("./getPlugin")),
  _ = require("./pages/pages2d/base");

function D(e) {
  return e && e.__esModule
    ? e
    : {
        default: e,
      };
}

function q(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap(),
    i = new WeakMap();
  return (q = function (e) {
    return e ? i : t;
  })(e);
}
var U =
    window.innerHeight > window.innerWidth
      ? window.innerHeight
      : window.innerWidth,
  F =
    window.innerHeight < window.innerWidth
      ? window.innerHeight
      : window.innerWidth,
  H = wx.getSystemInfoSync() || {},
  V = "ios" == H.platform,
  K = "android" == H.platform,
  N = "devtools" == H.platform,
  W = H.model,
  Y = (function () {
    function D(t) {
      var i = this;
      (e(this, D),
        (this.options = t),
        (this.is_from_wn = 0),
        (this.firstInit = !0),
        (this.distance = 0),
        (this.heightest本次得分 = 0),
        (this.stage = ""),
        (this.succeedTime = 0),
        (this.lastAddBonus = -2),
        (this.lastStage = ""),
        (this.deadTimeout = null),
        (this.current本次得分 = 0),
        (this.seq = 0),
        (this.thirdBlock = null),
        (this.straight = !0),
        (this.firstBlood = !1),
        (this.last高Level = 200),
        (this.guider = !1),
        (this.hardDistances = []),
        (0, A.default)(
          {
            autoRender: !1,
            autoShow: !1,
            y: U / 2 - (F / 9) * 5,
          },
          function () {
            i.initMinigameCenter();
          },
        ),
        (this.socketFirstSync = !1),
        this.init(),
        (this.randomSeed = this.generateSeed()),
        (0, S.setRandomSeed)(this.randomSeed),
        (this.actionList = []),
        (this.musicList = []),
        (this.touchList = []),
        (this.touchMoveList = []),
        (this.onceTouchMoveList = []),
        (this.touchStartTime = []),
        (this.blocks = []),
        (this.liveTime = 0),
        (this.eggBlocksCount = {}),
        (this.eggBlocksTriggerCount = {}),
        (this.eggBlocksFailCount = {}),
        (this.eggBlocksSucceedCount = {}),
        wx.setKeepScreenOn &&
          wx.setKeepScreenOn({
            keepScreenOn: !0,
          }),
        E.default.startScenes("global"));
    }
    return (
      t(D, [
        {
          key: "moveTo",
          value: function (e) {
            ((this.camera.position.x = this.camera.position.x + e.x),
              (this.camera.position.z = this.camera.position.z + e.z));
          },
        },
        {
          key: "moveGradually",
          value: function (e, t) {
            if (this.animating && !this.guider) {
              (0, y.TweenAnimation)(
                this.bottle.obj.position.x,
                this.bottle.obj.position.x - e.x,
                500 * t,
                "Linear",
                function (e, t) {
                  void 0 !== e &&
                    ((this.bottle.obj.position.x = e),
                    t && (this.bottle.obj.position.x = -0.098));
                }.bind(this),
              );
              for (var i = 0, o = this.blocksIn使用.length; i < o; ++i)
                (0, y.TweenAnimation)(
                  this.blocksIn使用[i].obj.position.x,
                  this.blocksIn使用[i].obj.position.x - e.x,
                  500 * t,
                  "Linear",
                  function (e) {
                    void 0 !== e && (this.obj.position.x = e);
                  }.bind(this.blocksIn使用[i]),
                );
              this.blocks &&
                this.blocks[0] &&
                (0, y.TweenAnimation)(
                  this.blocks[0].obj.position.x,
                  this.blocks[0].obj.position.x - e.x,
                  500 * t,
                  "Linear",
                  function (e) {
                    void 0 !== e && (this.obj.position.x = e);
                  }.bind(this.blocks[0]),
                );
            } else
              ((this.camera.destination = [
                this.camera.position.x + e.x,
                this.camera.position.z + e.z,
              ]),
                (0, y.TweenAnimation)(
                  this.camera.position.x,
                  this.camera.position.x + e.x,
                  500 * t,
                  "Quad.easeOut",
                  function (e) {
                    void 0 !== e && (this.camera.position.x = e);
                  }.bind(this),
                ),
                (0, y.TweenAnimation)(
                  this.camera.position.z,
                  this.camera.position.z + e.z,
                  500 * t,
                  "Quad.easeOut",
                  function (e) {
                    void 0 !== e && (this.camera.position.z = e);
                  }.bind(this),
                ));
          },
        },
        {
          key: "update",
          value: function (e) {
            var t = this;
            (this.tailSystem && this.tailSystem.update(1e3 * e),
              this.bottle.update(e),
              this.renderer.shadowMap.enabled &&
                ((this.shadowTarget.position.x = this.bottle.obj.position.x),
                (this.shadowTarget.position.z = this.bottle.obj.position.z),
                (this.shadowLight.position.x = this.bottle.obj.position.x + 0),
                (this.shadowLight.position.z =
                  this.bottle.obj.position.z + 10)));
            for (var i = 0, o = this.blocksIn使用.length; i < o; ++i)
              this.blocksIn使用[i].update(e);
            if (
              (this.blocks && this.blocks[0] && this.blocks[0].update(),
              ("forerake" === this.bottle.status ||
                "hypsokinesis" === this.bottle.status) &&
                5 != this.hit)
            ) {
              var s = this.bottle.getBox(),
                n =
                  "forerake" === this.bottle.status
                    ? this.nextBlock.getBox()
                    : this.currentBlock.getBox();
              for (i = 0, o = s.length; i < o; ++i)
                if (s[i].intersectsBox(n)) {
                  0 == i
                    ? (this.bottle.rotate(),
                      this.suspendTimer &&
                        (clearTimeout(this.suspendTimer),
                        (this.suspendTimer = null)))
                    : 1 == i
                      ? (this.bottle.suspend(),
                        this.suspendTimer &&
                          (clearTimeout(this.suspendTimer),
                          (this.suspendTimer = null)))
                      : 2 != i ||
                        this.suspendTimer ||
                        (this.suspendTimer = setTimeout(function () {
                          (t.bottle.suspend(), (t.suspendTimer = null));
                        }, 90 * this.distance));
                  break;
                }
            }
            if (
              this.bottle.obj.position.y <= l.BLOCK.height / 2 + 0.1 &&
              "jump" === this.bottle.status &&
              this.bottle.flyingTime > 0.3 &&
              !this.pendingReset
            ) {
              if (1 === this.hit || 7 === this.hit) {
                if (
                  (this.bottle.stop(),
                  this.bottle.change本次得分Pos(0),
                  this.succeed(),
                  this.animating)
                )
                  return;
                (1 === this.hit
                  ? (this.audioManager[
                      "combo" + Math.min(this.doubleHit + 1, 8)
                    ].seek(0),
                    this.audioManager[
                      "combo" + Math.min(this.doubleHit + 1, 8)
                    ].play(),
                    ++this.doubleHit,
                    this.addWave(Math.min(this.doubleHit, 4)),
                    this.bottle.showAdd本次得分(1, !0, this.quick),
                    this.UI.add本次得分(1, !0, this.quick),
                    (this.current本次得分 = this.UI.score),
                    "observe" != this.mode && this.showCombo())
                  : ((this.doubleHit = 0),
                    this.UI.add本次得分(1, !1, this.quick),
                    (this.current本次得分 = this.UI.score),
                    this.bottle.showAdd本次得分(1, !1, this.quick)),
                  this.audioManager.success.seek(0),
                  this.audioManager.success.play(),
                  "observe" == this.mode ||
                    "relay" == this.mode ||
                    this.gameCtrl.reviewCtrl.isInThisPage ||
                    this.rankSystem.update());
              } else
                2 === this.hit
                  ? (this.bottle.stop(),
                    (this.bottle.obj.position.y = l.BLOCK.height / 2),
                    (this.bottle.obj.position.x = this.bottle.destination[0]),
                    (this.bottle.obj.position.z = this.bottle.destination[1]))
                  : 3 === this.hit
                    ? (this.bottle.hypsokinesis(),
                      this.audioManager.fall_2.play(),
                      (this.bottle.obj.position.y = l.BLOCK.height / 2))
                    : 4 === this.hit || 5 === this.hit
                      ? (this.bottle.forerake(),
                        this.audioManager.fall_2.play(),
                        (this.bottle.obj.position.y = l.BLOCK.height / 2))
                      : 0 === this.hit
                        ? (this.bottle.fall(),
                          this.audioManager.fall.play(),
                          (this.bottle.obj.position.y = l.BLOCK.height / 2))
                        : 6 === this.hit
                          ? (this.bottle.stop(),
                            this.audioManager.fall.play(),
                            (this.bottle.obj.position.y = l.BLOCK.height / 2))
                          : -1 === this.hit &&
                            (this.bottle.stop(),
                            (this.bottle.obj.position.y = l.BLOCK.height / 2),
                            (this.bottle.obj.position.x = 0));
              if (
                0 === this.hit ||
                3 === this.hit ||
                4 === this.hit ||
                5 === this.hit ||
                6 === this.hit
              ) {
                if (this.guider)
                  if (this.UI.score > 0) this.guider = !1;
                  else {
                    if (!(this.liveTime > 3)) return void this.live();
                    ((this.guider = !1), this.full2D.hide2DGradually());
                  }
                ((this.pendingReset = !0),
                  (this.current本次得分 = this.UI.score),
                  this.reporter.addEggBlockReport(
                    this.eggBlocksCount,
                    this.eggBlocksTriggerCount,
                    this.eggBlocksFailCount,
                    this.eggBlocksSucceedCount,
                  ),
                  this.gameCtrl.gameOver(this.current本次得分));
                var a = this.mode;
                this.deadTimeout = setTimeout(function () {
                  ((t.pendingReset = !1),
                    "relay" == a ||
                      t.gameCtrl.reviewCtrl.isInThisPage ||
                      (y.TweenAnimation.killAll(),
                      GameGlobal.minigameCenter && GameGlobal.matchType
                        ? GameGlobal.matchType ===
                          GameGlobal.matchTypes["淘汰赛"]
                          ? (t.gameCtrl.gameOverShowPage(),
                            (GameGlobal.cache本次得分 = 0),
                            (GameGlobal.matchType = 0),
                            GameGlobal.minigameCenter.completeMatchGame())
                          : ((GameGlobal.cache本次得分 = t.current本次得分),
                            t.gameCtrl.clickReplay())
                        : t.gameCtrl.gameOverShowPage()),
                    "observe" == t.mode && t.instructionCtrl.onCmdComplete());
                }, 2e3);
              } else
                "observe" == this.mode && this.instructionCtrl.onCmdComplete();
              "relay" == this.mode &&
                (this.relayHandleInterrupt
                  ? (this.relayHandleInterrupt = !1)
                  : setTimeout(
                      function () {
                        M.default.emitSync(l.EVENT.NOWPLAYEROVER, {
                          hit: t.hit,
                        });
                      },
                      0 === this.hit ||
                        3 === this.hit ||
                        4 === this.hit ||
                        5 === this.hit ||
                        6 === this.hit
                        ? 2e3
                        : 0,
                    ));
            }
            this.renderer.render(this.scene, this.camera);
          },
        },
        {
          key: "succeed",
          value: function (e) {
            var t = this;
            if (
              (++this.succeedTime,
              (this.music本次得分 = !1),
              (this.lastSucceedTime = Date.now()),
              this.succeedTime % 15 == 0 &&
                ((e && e.noAnimation) || this.ground.changeColor()),
              this.blocksIn使用.length >= 9)
            ) {
              var i = this.blocksIn使用.shift();
              ((i.obj.visible = !1), this.blocksPool.push(i));
            }
            var o = this.nextBlock.obj.position
              .clone()
              .sub(this.currentBlock.obj.position);
            ((this.bottle.obj.position.x = this.bottle.destination[0]),
              (this.bottle.obj.position.z = this.bottle.destination[1]));
            var s = this.thirdBlock;
            if ((this.audioManager.setTimerFlag(!0), !this.firstAnimating)) {
              if (
                (this.guider &&
                  ((this.guider = !1), this.full2D.hide2DGradually()),
                !this.animating)
              ) {
                if (
                  (this.nextBlock.whenSucceed &&
                    this.nextBlock.whenSucceed(
                      this.bottle.obj.position.clone(),
                    ),
                  (!this.nextBlock.succeedTimer &&
                    void 0 === this.nextBlock.score &&
                    !this.nextBlock.music姓th) ||
                    (e && e.noAnimation) ||
                    "relay" == this.mode)
                )
                  e &&
                    e.music本次得分 &&
                    "relay" != this.mode &&
                    (31 == this.nextBlock.order &&
                      (this.nextBlock.score = this.mmpay本次得分),
                    this.UI.add本次得分(this.nextBlock.score, !1, !1, !0),
                    32 == this.nextBlock.order && (this.relaxLeft += 2));
                else {
                  var n = this.nextBlock;
                  ((this.musicTimer = setTimeout(function () {
                    (void 0 !== n.score &&
                      ((2 == t.reviewVersion && 15 == n.order) ||
                        ((t.music本次得分 = !0),
                        31 == n.order && (n.score = t.mmpay本次得分),
                        t.UI.add本次得分(n.score, !1, !1, !0),
                        t.bottle.showAdd本次得分(n.score, !1, !1, !0),
                        M.default.emit(l.EVENT.TRIGGER_EGG, {
                          order: n.order,
                          block: n,
                        }))),
                      n.music姓th &&
                        (t.audioManager[n.music姓th].seek(0),
                        t.audioManager[n.music姓th].play(),
                        n.registerAudio &&
                          t.audioManager.register(
                            n.music姓th,
                            function () {
                              n.registerAudio();
                            },
                            function () {
                              n.registerEndAudio && n.registerEndAudio();
                            },
                          )),
                      n.succeedTimer &&
                        n.succeedTimer(
                          t.UI.score,
                          t.bottle.obj.position.clone(),
                        ),
                      32 == n.order && (t.relaxLeft += 2));
                  }, 2e3)),
                    this.audioManager.pop.seek(0),
                    this.audioManager.pop.play());
                }
                var a = this.nextBlock.obj.position.clone(),
                  r = this.nextBlock.radius + this.distance + s.radius;
                (this.straight
                  ? ((a.x += r), this.bottle.lookAt("straight", a.clone()))
                  : ((a.z -= r), this.bottle.lookAt("left", a.clone())),
                  (s.obj.position.x = a.x),
                  (s.obj.position.z = a.z));
              }
              var h = s.obj.position.clone().sub(this.nextBlock.obj.position),
                c = o.add(h);
              ((c.x /= 2),
                (c.z /= 2),
                this.scene.add(s.obj),
                (this.currentBlock = this.nextBlock),
                (this.nextBlock = s));
              var d = c.length() / 10;
              ((this.bottle.human.rotation.z = 0),
                (this.bottle.human.rotation.x = 0),
                e && e.noAnimation
                  ? (this.moveTo(c),
                    (s.body.position.y = l.BLOCK.height / 2 - s.height / 2),
                    (s.obj.visible = !0))
                  : (this.bottle.squeeze(),
                    s.popup(),
                    l.GAME.canShadow && this.bottle.scatterParticles(),
                    this.animating && (c.x = 19.8),
                    (this.cameraMoveDuration = d),
                    this.moveGradually(c, d)));
            }
          },
        },
        {
          key: "handleWxOnHideEvent",
          value: function () {
            ((this.show = !1),
              "prepare" == this.bottle.status && (this.touchObserve = !0),
              this.animateTimer &&
                (clearTimeout(this.animateTimer), (this.animateTimer = null)),
              this.onshowAnimateTimer &&
                (clearTimeout(this.onshowAnimateTimer),
                (this.onshowAnimateTimer = null)),
              this.gameCtrl.wxOnhide(),
              E.default.stopScenes("global"));
          },
        },
        {
          key: "init",
          value: function () {
            var e,
              t,
              d = this;
            (m.default.getFirstBlood() ||
              this.options.query.mode ||
              this.options.query.wxgamechallengeid ||
              (this.guider = !0),
              (this.socketMonitor = new R.default({
                report: this.report.bind(this),
                duration: 13e3,
                logMaxLength: 5e3,
              })),
              (this.gameCtrl = new B.default(this)),
              (this.gameView = new T.default(this)),
              (this.gameModel = new C.default(this)),
              (this.instructionCtrl = new G.default(this)),
              (this.relayInstructionCtrl = new j.default(this)),
              (this.historyTimes = new w.default(this)),
              (this.reporter = new x.default()),
              (this.audioManager = new h.default(this)),
              (this.gameSocket = new p.default(this)),
              (this.scene = new i.Scene()));
            var g = l.FRUSTUMSIZE,
              y = F / U;
            ((this.camera = new i.OrthographicCamera(
              (g * y) / -2,
              (g * y) / 2,
              g / 2,
              g / -2,
              -10,
              85,
            )),
              this.camera.position.set(-17, 30, 26),
              this.camera.lookAt(new i.Vector3(13, 0, -4)),
              this.scene.add(this.camera),
              (this.renderer = new i.WebGLRenderer({
                antialias: !0,
                canvas: canvas,
                preserveDrawingBuffer: !0,
              })),
              (window.renderer = this.renderer),
              (this.blocksPool = []),
              (this.blocksIn使用 = []),
              (this.blocksRemoved = {}),
              (this.doubleHit = 0),
              V &&
              (W.indexOf("i手机号码 4") >= 0 ||
                W.indexOf("i手机号码 5") >= 0 ||
                H.system.indexOf("iOS 9") >= 0 ||
                H.system.indexOf("iOS 8") >= 0 ||
                (W.indexOf("i手机号码 6") >= 0 &&
                  W.indexOf("i手机号码 6s") < 0))
                ? ((this.renderer.shadowMap.enabled = !1),
                  (l.GAME.canShadow = !1),
                  this.renderer.setPixelRatio(1.5))
                : void 0 !== H.benchmarkLevel &&
                    H.benchmarkLevel < 5 &&
                    -1 != H.benchmarkLevel
                  ? ((l.GAME.canShadow = !1),
                    (this.renderer.shadowMap.enabled = !1),
                    this.renderer.setPixelRatio(
                      window.devicePixelRatio
                        ? V
                          ? Math.min(window.devicePixelRatio, 2)
                          : window.devicePixelRatio
                        : 1,
                    ))
                  : (this.renderer.setPixelRatio(
                      window.devicePixelRatio
                        ? V
                          ? Math.min(window.devicePixelRatio, 2)
                          : window.devicePixelRatio
                        : 1,
                    ),
                    (this.renderer.shadowMap.enabled = !0)),
              this.renderer.setSize(F, U),
              (this.renderer.localClippingEnabled = !0),
              (this.ground = new a.default()),
              (this.ground.obj.position.z = -84),
              this.camera.add(this.ground.obj),
              (this.waves = []));
            for (var S = 0; S < 4; ++S) {
              var M = new n.default();
              (this.waves.push(M), (M.obj.visible = !1), this.scene.add(M.obj));
            }
            var O = new i.MeshBasicMaterial({
              color: 16119285,
            });
            ((this.combo = new i.Mesh(new i.CircleGeometry(0.6, 30), O)),
              (this.combo.name = "combo"),
              (this.combo.position.x = -50),
              (this.combo.rotation.x = -Math.PI / 2),
              this.scene.add(this.combo),
              this.renderer.shadowMap.enabled &&
                ((this.shadowTarget = new i.Mesh(
                  new i.PlaneGeometry(0.1, 0.1),
                  O,
                )),
                (this.shadowTarget.visible = !1),
                (this.shadowTarget.name = "shadowTarget"),
                this.scene.add(this.shadowTarget)),
              (this.currentBlock = new o.default(0)),
              (this.init下1步Block = this.nextBlock = new o.default(1)),
              (this.nextBlock.obj.position.x = 20),
              (this.bottle = new r.default({
                getSelectedBottleSkinResourceSync:
                  P.default.getSelectedBottleSkinResourceSync,
              })),
              this.bottle.obj.position.set(-10, -l.BLOCK.height / 2, 0),
              this.scene.add(this.bottle.obj),
              this.guider &&
                (this.bottle.obj.position.set(-11, 50, 0),
                (this.camera.position.x -= 19),
                setTimeout(function () {
                  d.bottle.showup();
                }, 800),
                (this.currentBlock.obj.position.x = -11),
                this.currentBlock.change(null, "gray", 0.7),
                this.scene.add(this.currentBlock.obj),
                (this.guiderTimer = setInterval(function () {
                  ((d.bottle.velocity.vz = 0),
                    (d.bottle.velocity.vy = 150),
                    (d.direction = new i.Vector2(1, 0)));
                  var e = new i.Vector3(1, 0, 0);
                  (d.bottle.jump(e.normalize()),
                    (d.hit = d.checkHit2(d.bottle, d.currentBlock)));
                }, 3e3))),
              this.blocksIn使用.push(this.nextBlock),
              this.blocksIn使用.push(this.currentBlock),
              (this.blocksId = l.LOCALBLOCK.slice(0)),
              (this.object_id_list = l.LOCALBLOCK.slice(0)));
            for (S = 2; S < this.blocksId.length; ++S) {
              var E = new o.default(this.blocksId[S]);
              this.blocksPool.push(E);
            }
            var z = wx.getStorageSync("current_skin");
            (this.addToPool(z),
              this.removeFromPool({
                skinId: z,
              }),
              (this.showRelax本次得分 = 0),
              (this.relaxLeft = 0),
              (this.onebyoneCtrl = new L.default(this, this.camera)),
              (this.full2D = new k.default({
                model: this.gameModel,
                camera: this.camera,
                onClickRank: this.gameCtrl.clickRank.bind(this.gameCtrl),
                onClickReplay: this.gameCtrl.clickReplay.bind(this.gameCtrl),
                onClick分享: this.gameCtrl.shareBattleCard.bind(this.gameCtrl),
                onClickPkRule: this.gameCtrl.showPkRule.bind(this.gameCtrl),
                onClosePkRule: this.gameCtrl.closePkRule.bind(this.gameCtrl),
                onClickSetPkDuration: this.gameCtrl.setPkDuration.bind(
                  this.gameCtrl,
                ),
                onClickStart: this.gameCtrl.clickStart.bind(this.gameCtrl),
                onShowFriendRank: this.gameCtrl.showFriendRank.bind(
                  this.gameCtrl,
                ),
                onBattlePlay: this.gameCtrl.onBattlePlay.bind(this.gameCtrl),
                onSubscribePk: this.gameCtrl.subscribePk.bind(this.gameCtrl),
                onGroup分享: this.gameCtrl.shareGroupRank.bind(this.gameCtrl),
                friendRankReturn: this.gameCtrl.friendRankReturn.bind(
                  this.gameCtrl,
                ),
                groupPlayGame: this.gameCtrl.groupPlayGame.bind(this.gameCtrl),
                onLookersStart: this.gameCtrl.onViewerStart.bind(this.gameCtrl),
                onReturnWechat: function () {
                  wx.exitMiniProgram();
                },
                onClickPure分享: function (e) {
                  ((0, v.pure分享)(e, d.gameModel.current本次得分),
                    d.reporter.best分享(e));
                },
                newRelay: this.gameCtrl.gotoRelayMode.bind(this.gameCtrl),
                outRelay1: this.gameCtrl.outRelay1.bind(this.gameCtrl),
                outRelay2: this.gameCtrl.outRelay2.bind(this.gameCtrl),
                startRelay: this.gameCtrl.startRelay.bind(this.gameCtrl),
                watchRelay: this.gameCtrl.watchRelay.bind(this.gameCtrl),
                replayRelay: this.gameCtrl.replayRelay.bind(this.gameCtrl),
                shareRelay: this.gameCtrl.shareRelay.bind(this.gameCtrl),
                shareRelayLive: this.gameCtrl.shareRelayLive.bind(
                  this.gameCtrl,
                ),
                quitRecord: this.gameCtrl.quitReview.bind(this.gameCtrl),
                goRecord: this.gameCtrl.initReview.bind(this.gameCtrl),
                skipRelayBeginner: this.gameCtrl.skipRelayBeginner.bind(
                  this.gameCtrl,
                ),
              })),
              (this.UI = new s.default(
                this.scene,
                this.camera,
                this.full2D,
                this,
              )),
              l.GAME.canShadow &&
                (this.tailSystem = new c.default(this.scene, this.bottle)),
              this.addLight(),
              this.bindEvent(),
              (this.viewer = new f.default(this.camera)),
              (this.rankSystem = new b.default(this)),
              setTimeout(function () {
                d.audioManager &&
                  d.audioManager.icon &&
                  d.audioManager.icon.play();
              }, 300),
              this.UI.hide本次得分(),
              (this.skinManager = new I.default(this)),
              this.gameModel.init(),
              this.gameCtrl.init(),
              this.gameView.init(),
              wx.onShow(this.handleWxOnShowEvent.bind(this)),
              wx.onHide(this.handleWxOnHideEvent.bind(this)),
              wx.onError(this.handleWxOnError.bind(this)),
              wx.onAudioInterruptionBegin &&
                wx.onAudioInterruptionBegin(this.handleInterrupt.bind(this)),
              u.default.sceneLogin(function (e) {
                (console.log("scene initresp : ", JSON.stringify(e)),
                  wx.setStorage({
                    key: "ad",
                    data: {
                      ad_reward_quota: e.ad_reward_quota || 0,
                      ad_banner_quota: e.ad_banner_quota || 0,
                      t: +new Date(),
                    },
                  }));
              }),
              this.gameCtrl.firstInitGame(this.options),
              wx.showShareMenu(),
              wx.onShareAppMessage(function () {
                return {
                  title: "1起来，跳1跳",
                  imageUrl:
                    "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJHS4AOib6MiaPhwEaqw1NPcZGtgAGTlVJ4lrBAGtchhnXanMyo7q7toRpD4DukV5F2TA/0?wx_fmt=png",
                };
              }),
              null === (e = (t = wx).updateGameLivePanelMenu) ||
                void 0 === e ||
                e.call(t, {
                  enableInvitationMenu: !0,
                }));
          },
        },
        {
          key: "loopAnimate",
          value: function () {
            var e = this;
            if ((this.clearTimer(), this.animating)) {
              (this.touchStartAnim({
                fromGuider: !0,
              }),
                (this.touchStartTimer = setTimeout(function () {
                  ((e.bottle.velocity.vz = Math.min(
                    0.719 * l.BOTTLE.velocityZIncrement,
                    180,
                  )),
                    (e.bottle.velocity.vy = Math.min(
                      l.BOTTLE.velocityY + 0.719 * l.BOTTLE.velocityYIncrement,
                      180,
                    )));
                  var t = new i.Vector3(
                    e.nextBlock.obj.position.x - e.bottle.obj.position.x,
                    0,
                    e.nextBlock.obj.position.z - e.bottle.obj.position.z,
                  );
                  ((e.direction = new i.Vector2(
                    e.nextBlock.obj.position.x - e.bottle.obj.position.x,
                    e.nextBlock.obj.position.z - e.bottle.obj.position.z,
                  )),
                    (e.hit = e.checkHit2(
                      e.bottle,
                      e.currentBlock,
                      e.nextBlock,
                    )),
                    (e.thirdBlock = e.generate下1步Block()),
                    e.thirdBlock &&
                      e.thirdBlock.obj &&
                      (e.thirdBlock.obj.position.set(39.7, 0, 0),
                      e.tailSystem && e.tailSystem.correctPosition(),
                      y.TweenAnimation.kill("progress"),
                      e.bottle.jump(t.normalize()),
                      e.currentBlock.rebound(),
                      (e.animateTimer = setTimeout(function () {
                        e.loopAnimate();
                      }, 3e3))));
                }, 719)));
            }
          },
        },
        {
          key: "animate",
          value: function () {
            var e = this;
            this.firstAnimating = !0;
            for (var t = this, s = 0; s < 7; ++s)
              setTimeout(
                (function (e) {
                  return function () {
                    if (
                      (("single" == t.mode &&
                        ("startPage" == t.stage ||
                          "friendRankList" == t.stage)) ||
                        t.guider) &&
                      t.blocks &&
                      t.blocks.length < 7
                    ) {
                      var i = new o.default(-1, e);
                      (i.showup(e),
                        t.scene.add(i.obj),
                        t.blocks.push(i),
                        0 == e && (this.nextBlock = i));
                    }
                  };
                })(s),
                200 * s,
              );
            this.animateGuiderTimer = setTimeout(function () {
              if (
                ("single" == t.mode &&
                  ("startPage" == t.stage || "friendRankList" == t.stage)) ||
                t.guider
              ) {
                ((e.bottle.velocity.vz = Math.min(
                  0.4 * l.BOTTLE.velocityZIncrement,
                  180,
                )),
                  (e.bottle.velocity.vy = Math.min(
                    l.BOTTLE.velocityY + 0.4 * l.BOTTLE.velocityYIncrement,
                    180,
                  )),
                  (e.direction = new i.Vector2(
                    e.nextBlock.obj.position.x - e.bottle.obj.position.x,
                    e.nextBlock.obj.position.z - e.bottle.obj.position.z,
                  )));
                var o = new i.Vector3(
                  e.nextBlock.obj.position.x - e.bottle.obj.position.x,
                  0,
                  e.nextBlock.obj.position.z - e.bottle.obj.position.z,
                );
                if (
                  (e.bottle.jump(o.normalize()),
                  (e.hit = -1),
                  (e.nextBlock = e.init下1步Block),
                  e.blocks)
                ) {
                  for (var s = 0, n = e.blocks.length; s < n; ++s)
                    y.customAnimation.to(e.blocks[s].hitObj.material, 1, {
                      opacity: 0,
                      delay: 0.2 * s + 0.5,
                    });
                  for (s = 1, n = e.blocks.length; s < n; ++s)
                    y.customAnimation.to(e.blocks[s].obj.position, 0.5, {
                      z: s % 2 == 0 ? 60 : -60,
                      delay: 0.1 * s + 2.2,
                    });
                  if (e.guider) {
                    y.customAnimation.to(e.currentBlock.obj.position, 0.5, {
                      z: -60,
                      delay: 2.1,
                    });
                    var a = e.currentBlock;
                    setTimeout(function () {
                      a.obj.visible = !1;
                    }, 3e3);
                  }
                  ((e.currentBlock = e.blocks[0]),
                    (e.beginnerTimer = setTimeout(function () {
                      if (
                        (("single" == t.mode &&
                          ("startPage" == t.stage ||
                            "friendRankList" == t.stage)) ||
                          t.guider) &&
                        (t.guider && e.full2D.showBeginnerPage(),
                        e.nextBlock.popup(),
                        e.nextBlock.greenMaterial.color.setHex(6118749),
                        e.nextBlock.whiteMaterial.color.setHex(11184810),
                        e.scene.add(e.nextBlock.obj),
                        e.blocks)
                      ) {
                        for (var i = 1, o = e.blocks.length; i < o; ++i)
                          e.blocks[i].obj.visible = !1;
                        (e.guider && (e.animating = !1),
                          (e.firstAnimating = !1));
                      }
                    }, 3e3)),
                    (e.loopAnimateTimer = setTimeout(function () {
                      "single" != t.mode ||
                        ("startPage" != t.stage &&
                          "friendRankList" != t.stage) ||
                        (t.show && e.loopAnimate());
                    }, 4500)));
                }
              }
            }, 1500);
          },
        },
        {
          key: "handleWxOnShowEvent",
          value: function (e) {
            ((e.query && e.query.mode) ||
              (this.options.query && this.options.query.mode)) &&
              (this.guider = !1);
            var t,
              i = this;
            if (
              ((this.show = !0),
              this.reporter.enterReport(e.scene),
              this.guiderTimer &&
                !this.guider &&
                (clearInterval(this.guiderTimer), (this.guiderTimer = null)),
              e.query.wxgamechallengeid)
            ) {
              if (!(0, l.gtVersion)("3.10.1"))
                return void wx.showModal({
                  title: "提示",
                  content: "当前微信版本过低，暂不支持擂台赛。请升级微信版本。",
                });
              if ("ios" !== H.platform && "android" !== H.platform)
                return void wx.showModal({
                  title: "提示",
                  content: "擂台赛功能仅支持移动端设备，请用手机打开。",
                });
            }
            ((this.onshowAnimateTimer = setTimeout(
              ((t = this.firstInit),
              function () {
                "single" == i.mode &&
                  "startPage" == i.stage &&
                  !i.animateTimer &&
                  i.show &&
                  (i.blocks && i.blocks.length > 0 && !i.firstAnimating
                    ? ((this.animating = !0), i.loopAnimate())
                    : i.animating ||
                      !t ||
                      i.guider ||
                      ((i.animating = !0), i.animate()));
              }),
              1e3,
            )),
              this.firstInit
                ? (this.firstInit = !1)
                : (this.gameCtrl.wxOnShow(e), E.default.startScenes("global")));
          },
        },
        {
          key: "showCombo",
          value: function () {
            var e = this;
            setTimeout(function () {
              e.combo.position.set(
                e.nextBlock.obj.position.x,
                l.BLOCK.height / 2 + 0.15,
                e.nextBlock.obj.position.z,
              );
            }, 200);
          },
        },
        {
          key: "hideCombo",
          value: function () {
            this.combo.position.set(-30, 0, 0);
          },
        },
        {
          key: "replayGame",
          value: function (e) {
            ((this.current本次得分 = 0),
              this.gameCtrl.onReplayGame(),
              this.audioManager.restart.seek(0),
              this.audioManager.restart.play(),
              this.guider
                ? (this.guiderTimer &&
                    (clearInterval(this.guiderTimer),
                    (this.guiderTimer = null)),
                  (this.animating = !0),
                  this.animate(),
                  this.moveGradually(new i.Vector3(19, 0, 0), 3),
                  (this.randomSeed = this.generateSeed()),
                  (0, S.setRandomSeed)(this.randomSeed))
                : (this.resetScene(e), this.bottle.showup()));
          },
        },
        {
          key: "addWave",
          value: function (e) {
            for (var t = this, i = 0; i < e; ++i)
              setTimeout(
                (function (e) {
                  return function () {
                    ((t.waves[e].obj.visible = !0),
                      t.waves[e].obj.position.set(
                        t.bottle.obj.position.x,
                        l.BLOCK.height / 2 + 0.1 * e + 1,
                        t.bottle.obj.position.z,
                      ),
                      (0, y.TweenAnimation)(
                        t.waves[e].obj.scale.x,
                        4,
                        (2 / (e / 2.5 + 2)) * 500,
                        "Linear",
                        function (i, o) {
                          void 0 !== i &&
                            ((t.waves[e].obj.scale.x = i),
                            (t.waves[e].obj.scale.y = i),
                            (t.waves[e].obj.scale.z = i));
                        },
                      ),
                      (0, y.TweenAnimation)(
                        t.waves[e].obj.material.opacity,
                        0,
                        (2 / (e / 2.5 + 2)) * 500,
                        "Linear",
                        function (i, o, s) {
                          void 0 !== i &&
                            ((t.waves[e].obj.material.opacity = i),
                            s && t.waves[e].reset());
                        },
                      ));
                  };
                })(i),
                200 * i,
              );
          },
        },
        {
          key: "addLight",
          value: function () {
            var e = new i.AmbientLight(16777215, 0.8);
            if (
              ((this.shadowLight = new i.DirectionalLight(16777215, 0.28)),
              this.shadowLight.position.set(0, 15, 10),
              this.renderer.shadowMap.enabled)
            ) {
              ((this.shadowLight.castShadow = !0),
                (this.shadowLight.target = this.shadowTarget),
                (this.shadowLight.shadow.camera.near = 5),
                (this.shadowLight.shadow.camera.far = 32),
                (this.shadowLight.shadow.camera.left = -10),
                (this.shadowLight.shadow.camera.right = 10),
                (this.shadowLight.shadow.camera.top = 10),
                (this.shadowLight.shadow.camera.bottom = -10),
                (this.shadowLight.shadow.mapSize.width = 512),
                (this.shadowLight.shadow.mapSize.height = 512));
              var t = new i.PlaneGeometry(22, 25);
              ((this.shadowGround = new i.Mesh(
                t,
                new i.ShadowMaterial({
                  transparent: !0,
                  color: 0,
                  opacity: 0.3,
                }),
              )),
                (this.shadowGround.receiveShadow = !0),
                (this.shadowGround.position.x = 0),
                (this.shadowGround.position.y = -18),
                (this.shadowGround.position.z = -14),
                (this.shadowGround.rotation.x = -Math.PI / 2),
                this.shadowLight.add(this.shadowGround),
                (this.shadowGround.renderOrder = 1));
            }
            (this.scene.add(this.shadowLight), this.scene.add(e));
          },
        },
        {
          key: "wellJump",
          value: function (e) {
            var t = e.property_id,
              o = void 0 === t ? "" : t,
              s = e.item_id,
              n = void 0 === s ? "" : s,
              a = e.quick,
              r = void 0 !== a && a,
              h = (e.music本次得分, e.noAnimation),
              c = void 0 !== h && h;
            (this.stopBlockMusic(), (this.bottle.velocity.vy = 160));
            var d = (this.bottle.velocity.vy / l.GAME.gravity) * 2;
            ((this.direction = new i.Vector2(
              this.nextBlock.obj.position.x - this.bottle.obj.position.x,
              this.nextBlock.obj.position.z - this.bottle.obj.position.z,
            )),
              (this.direction.x = +this.direction.x.toFixed(2)),
              (this.direction.y = +this.direction.y.toFixed(2)));
            var u = new i.Vector3(this.direction.x, 0, this.direction.y);
            return (
              (this.bottle.velocity.vz = this.direction.length() / d),
              c ||
                (this.bottle.jump(u.normalize()),
                this.actionList.push([!1, !1, this.quick, n, o]),
                this.musicList.push(this.music本次得分),
                this.touchStartTime.push(Date.now()),
                this.touchMoveList.push([!1, !1]),
                this.touchList.push([!1, !1])),
              (this.hit = this.checkHit2(
                this.bottle,
                this.currentBlock,
                this.nextBlock,
              )),
              (this.thirdBlock = this.generate下1步Block()),
              (this.distance =
                l.BLOCK.minDistance +
                (0, S.random)() * (l.BLOCK.maxDistance - l.BLOCK.minDistance)),
              (this.distance = +this.distance.toFixed(2)),
              (this.quick =
                void 0 === r ? Date.now() - this.lastSucceedTime < 400 : r),
              "player" === this.mode &&
                (++this.seq,
                this.gameSocket.sendCommand(this.seq, {
                  type: 1,
                  c: {
                    x: this.currentBlock.obj.position.x,
                    z: this.currentBlock.obj.position.z,
                    order: this.currentBlock.order,
                    type: this.currentBlock.type,
                    r: this.currentBlock.radius,
                    rs: this.currentBlock.radiusScale,
                  },
                  n: {
                    x: this.nextBlock.obj.position.x,
                    z: this.nextBlock.obj.position.z,
                    order: this.nextBlock.order,
                    type: this.nextBlock.type,
                    r: this.nextBlock.radius,
                    rs: this.nextBlock.radiusScale,
                  },
                  d: this.duration,
                  b: {
                    x: this.bottle.obj.position.x,
                    y: +this.bottle.obj.position.y.toFixed(2),
                    z: this.bottle.obj.position.z,
                    vy: this.bottle.velocity.vy,
                    vz: this.bottle.velocity.vz,
                  },
                  t:
                    1 === this.hit || 7 === this.hit
                      ? {
                          order: this.thirdBlock.order,
                          type: this.thirdBlock.type,
                          r: this.thirdBlock.radius,
                          rs: this.thirdBlock.radiusScale,
                        }
                      : null,
                  h: this.hit,
                  di: this.distance,
                  s: this.straight,
                  q: this.quick,
                  ca: {
                    x: this.camera.position.x,
                    y: this.camera.position.y,
                    z: this.camera.position.z,
                  },
                  gd: {
                    x: this.ground.obj.position.x,
                    y: this.ground.obj.position.y,
                    z: this.ground.obj.position.z,
                  },
                  score: this.UI.score,
                  usingPropType: 1,
                })),
              this.hit
            );
          },
        },
        {
          key: "observeWellJump",
          value: function () {
            (this.stopBlockMusic(), (this.bottle.velocity.vy = 160));
            var e = (this.bottle.velocity.vy / l.GAME.gravity) * 2;
            ((this.direction = new i.Vector2(
              this.nextBlock.obj.position.x - this.bottle.obj.position.x,
              this.nextBlock.obj.position.z - this.bottle.obj.position.z,
            )),
              (this.direction.x = +this.direction.x.toFixed(2)),
              (this.direction.y = +this.direction.y.toFixed(2)));
            var t = new i.Vector3(this.direction.x, 0, this.direction.y);
            ((this.bottle.velocity.vz = this.direction.length() / e),
              this.bottle.jump(t.normalize()));
          },
        },
        {
          key: "checkHit2",
          value: function (e, t, i, o) {
            var s = this.checkHit2Core(e, t, i, o);
            if ("relay" == this.mode && s && s.translate) {
              ((s.translate.x = s.translate.x.toFixed(2)),
                (s.translate.y = s.translate.y.toFixed(2)));
              var n = "|cH:"
                .concat(s.hit, ";fT:")
                .concat(s.flyingTime, ",t:")
                .concat(s.time, ",tsl:")
                .concat(s.translate.x, ",")
                .concat(s.translate.y, ";dst:")
                .concat(JSON.stringify(s.destination), ",inY:")
                .concat(s.initY, ",cb:")
                .concat(this.currentBlock.order, ",")
                .concat(this.currentBlock.obj.position.x.toFixed(2), ",")
                .concat(this.currentBlock.obj.position.z.toFixed(2), ";nb:")
                .concat(this.nextBlock.order, ",")
                .concat(this.nextBlock.obj.position.x.toFixed(2), ",")
                .concat(this.nextBlock.obj.position.z.toFixed(2));
              this.socketMonitor.log(n);
            } else
              i &&
                i.order >= 13 &&
                (1 == s.hit || 7 == s.hit
                  ? (this.eggBlocksSucceedCount[i.order] = this
                      .eggBlocksSucceedCount[i.order]
                      ? this.eggBlocksSucceedCount[i.order] + 1
                      : 1)
                  : 2 != s.hit &&
                    (this.eggBlocksFailCount[i.order] = this.eggBlocksFailCount[
                      i.order
                    ]
                      ? this.eggBlocksFailCount[i.order] + 1
                      : 1));
            return s.hit;
          },
        },
        {
          key: "checkHit2Core",
          value: function (e, t, o, s) {
            var n = (e.velocity.vy / l.GAME.gravity) * 2;
            s = s || +e.obj.position.y.toFixed(2);
            var a = l.BLOCK.height / 2 - s,
              r = +(
                (-e.velocity.vy +
                  Math.sqrt(
                    Math.pow(e.velocity.vy, 2) - 2 * l.GAME.gravity * a,
                  )) /
                -l.GAME.gravity
              ).toFixed(2);
            n = +(n -= r).toFixed(2);
            var h = [],
              c = new i.Vector2(e.obj.position.x, e.obj.position.z),
              u = this.direction.setLength(e.velocity.vz * n);
            if (
              (c.add(u),
              (e.destination = [+c.x.toFixed(2), +c.y.toFixed(2)]),
              h.push(+c.x.toFixed(2), +c.y.toFixed(2)),
              this.animating)
            )
              return {
                hit: 7,
              };
            if (o) {
              var m,
                g =
                  Math.pow(h[0] - o.obj.position.x, 2) +
                  Math.pow(h[1] - o.obj.position.z, 2),
                b = o.getVertices();
              (0, d.default)(h, b)
                ? (m = Math.abs(g) < 0.5 ? 1 : 7)
                : (0, d.default)([h[0] - l.BOTTLE.bodyWidth / 2, h[1]], b) ||
                    (0, d.default)([h[0], h[1] + l.BOTTLE.bodyDepth / 2], b)
                  ? (m = 5)
                  : ((0, d.default)([h[0], h[1] - l.BOTTLE.bodyDepth / 2], b) ||
                      (0, d.default)(
                        [h[0] + l.BOTTLE.bodyDepth / 2, h[1]],
                        b,
                      )) &&
                    (m = 3);
            }
            var p = t.getVertices();
            return (
              (0, d.default)(h, p)
                ? (m = 2)
                : ((0, d.default)([h[0], h[1] + l.BOTTLE.bodyDepth / 2], p) ||
                    (0, d.default)([h[0] - l.BOTTLE.bodyWidth / 2, h[1]], p)) &&
                  (m = m ? 6 : 4),
              {
                hit: m || 0,
                flyingTime: n,
                time: r,
                translate: u,
                destination: h,
                initY: s,
              }
            );
          },
        },
        {
          key: "shuffleArray",
          value: function (e) {
            for (var t = e.length - 1; t > 0; t--) {
              var i = Math.floor((0, S.random)() * (t + 1)),
                o = e[t];
              ((e[t] = e[i]), (e[i] = o));
            }
          },
        },
        {
          key: "useBlock",
          value: function (e) {
            for (var t, i = 0, o = e.length; i < o; ++i)
              for (var s = 0, n = this.blocksPool.length; s < n; ++s)
                if (this.blocksPool[s].order == e[i])
                  return (
                    this.blocksIn使用.push(this.blocksPool[s]),
                    (t = this.blocksPool[s]),
                    this.blocksPool.splice(s, 1),
                    t
                  );
            return !1;
          },
        },
        {
          key: "generate下1步Block",
          value: function () {
            var e;
            if (2 === this.reviewVersion);
            else {
              if (
                this.relaxLeft &&
                (--this.relaxLeft, (e = this.useBlock([33, 34, 35])))
              )
                return e;
              if (
                this.UI.score - this.showRelax本次得分 >= 1e3 &&
                ((e = this.useBlock([32])),
                (this.showRelax本次得分 = this.UI.score),
                (this.relaxLeft = 1),
                e)
              )
                return e;
            }
            var t = 5;
            (this.UI.score > 1e3 ? (t = 6) : this.succeedTime > 3e3 && (t = 7),
              this.animating || this.shuffleArray(this.blocksPool));
            for (var i = 0, o = this.blocksPool.length; i < o; ++i)
              if (
                (this.succeedTime - this.lastAddBonus >= t &&
                  this.blocksPool[i].order >= 13) ||
                (this.succeedTime - this.lastAddBonus < t &&
                  this.blocksPool[i].order < 13)
              ) {
                if ((e = this.blocksPool[i]).order >= 13) {
                  if (
                    (this.lastBonusOrder && this.lastBonusOrder == e.order) ||
                    (this.UI.score < 100 && 29 == e.order) ||
                    [32, 33, 34, 35].indexOf(e.order) >= 0
                  )
                    continue;
                  ((this.lastAddBonus = this.succeedTime),
                    (this.lastBonusOrder = e.order));
                }
                (this.blocksIn使用.push(e), this.blocksPool.splice(i, 1));
                break;
              }
            if (!e) {
              for (var s = this.blocksIn使用.shift(); s.order >= 13; )
                ((s.obj.visible = !1),
                  this.blocksPool.push(s),
                  (s = this.blocksIn使用.shift()));
              ((e = s), this.blocksIn使用.push(e));
            }
            return ((e.obj.visible = !1), e.change(), e);
          },
        },
        {
          key: "live",
          value: function () {
            var e = this;
            (++this.liveTime,
              setTimeout(function () {
                e.resetScene(null, {
                  bottleShowupAnimation: !0,
                });
              }, 2e3));
          },
        },
        {
          key: "clearTimer",
          value: function () {
            (this.animateTimer &&
              (clearTimeout(this.animateTimer), (this.animateTimer = null)),
              this.loopAnimateTimer &&
                (clearTimeout(this.loopAnimateTimer),
                (this.loopAnimateTimer = null)),
              this.beginnerTimer &&
                (clearTimeout(this.beginnerTimer), (this.beginnerTimer = null)),
              this.touchStartTimer &&
                (clearTimeout(this.touchStartTimer),
                (this.touchStartTimer = null)),
              this.suspendTimer &&
                (clearTimeout(this.suspendTimer), (this.suspendTimer = null)));
          },
        },
        {
          key: "setSpecialBaseStatus",
          value: function (e) {
            "relay" == this.mode
              ? (this.use_mmpaybase = this.mmpay_status = this.use_wangzhe = !0)
              : ((this.use_mmpaybase =
                  e && void 0 !== e.use_mmpaybase
                    ? e.use_mmpaybase
                    : m.default.getMmpayBaseStatus()),
                (this.mmpay_status =
                  e && void 0 !== e.mmpay_status
                    ? e.mmpay_status
                    : m.default.getMmpayBonusStatus().status),
                (this.mmpay本次得分 = this.mmpay_status ? 20 : 5),
                (this.mmpay_checksum =
                  m.default.getMmpayBonusStatus().checksum),
                (this.use_wangzhe =
                  (e && e.use_wangzhe) || m.default.getWangZheBaseStatus()));
          },
        },
        {
          key: "addToPool",
          value: function (e) {
            var t = this,
              i = wx.getStorageSync("skins") || {};
            if (e && i[e]) {
              var s = i[e].skin_sn,
                n = i[e].object_id_list;
              this.object_id_list = n;
              for (
                var a = this.blocksId.concat(n).filter(function (e) {
                    return !t.blocksId.includes(e);
                  }),
                  r = wx.getStorageSync("blocks") || {
                    array: [],
                  },
                  l = r.array,
                  h = !1,
                  c = [],
                  d = [],
                  u = 0;
                u < a.length;
                ++u
              )
                this.blocksRemoved[a[u]]
                  ? (c.push(this.blocksRemoved[a[u]]),
                    d.push(a[u]),
                    (this.blocksRemoved[a[u]] = null))
                  : r[a[u]]
                    ? (c.push(new o.default(a[u], r[a[u]])), d.push(a[u]))
                    : ((h = !0),
                      l.indexOf(a[u]) >= 0 && l.splice(l.indexOf(a[u]), 1));
              if (h) {
                for (u = 0; u < c.length; ++u)
                  this.blocksRemoved[c[u].order] = c[u];
                ((r.array = l),
                  wx.setStorage({
                    key: "blocks",
                    data: r,
                  }),
                  wx.setStorage({
                    key: "current_skin",
                    data: null,
                  }));
              } else
                ((this.skin_id = e),
                  (this.skin_sn = s),
                  (this.blocksPool = this.blocksPool.concat(c)),
                  (this.blocksId = this.blocksId.concat(d)));
            }
          },
        },
        {
          key: "removeFromPool",
          value: function (e) {
            this.setSpecialBaseStatus(e);
            var t,
              i = (e && e.version) || l.VERSION;
            ((t = 3 == i || 4 == i ? [24, 26, 27] : [30, 31, 32, 33, 34, 35]),
              !this.use_mmpaybase && t.indexOf(31) < 0 && t.push(31),
              !this.use_wangzhe && t.indexOf(30) < 0 && t.push(30),
              t.sort());
            for (var o = t.length - 1; o >= 0; --o)
              for (var s = this.blocksPool.length - 1; s >= 0; --s)
                if (this.blocksPool[s].order === t[o]) {
                  var n = this.blocksPool.splice(s, 1);
                  this.blocksRemoved[n[0].order] = n[0];
                }
            for (o = this.blocksPool.length - 1; o >= 0; --o)
              if (this.object_id_list.indexOf(this.blocksPool[o].order) < 0) {
                n = this.blocksPool.splice(o, 1);
                (console.log("jahhahahahaha remove", n[0].order),
                  (this.blocksRemoved[n[0].order] = n[0]));
              }
          },
        },
        {
          key: "resetScene",
          value: function (e, t) {
            var i,
              o = this;
            if (
              (console.log("resetScene", e, t, this.gameModel),
              (this.reviewVersion = null),
              (this.object_id_list = l.LOCALBLOCK.slice(0)),
              (this.skin_id = this.skin_sn = void 0),
              t && t.version && (this.reviewVersion = t.version),
              (this.touchObserve = !1),
              (this.firstAnimating = !1),
              (this.myTurn = !1),
              (this.clicked = !1),
              (this.pendingReset = !1),
              this.blocks && this.blocks.length > 0)
            )
              for (var s = 0, n = this.blocks.length; s < n; ++s)
                this.scene.remove(this.blocks[s].obj);
            ((this.blocks = null),
              "observe" == this.mode &&
                this.audioManager.scale_intro &&
                this.audioManager.scale_loop &&
                (this.audioManager.scale_intro.stop(),
                this.audioManager.scale_loop.stop()),
              GameGlobal.seed && GameGlobal.matchType
                ? (this.randomSeed = GameGlobal.seed)
                : (this.randomSeed = e || this.generateSeed()),
              console.log("randomSeed", this.randomSeed),
              (0, S.setRandomSeed)(this.randomSeed),
              (this.actionList = []),
              (this.musicList = []),
              (this.touchList = []),
              (this.touchStartTime = []),
              (this.touchMoveList = []),
              this.clearTimer(),
              this.currentBlock && this.currentBlock.reset(),
              y.TweenAnimation.killAll(),
              (this.animating = !1),
              "relay" == this.mode && t && t.gameLevel
                ? 1 == t.gameLevel
                  ? ((l.BLOCK.minRadiusScale = 0.7),
                    (l.BLOCK.maxRadiusScale = 0.9),
                    (l.BLOCK.minDistance = 1),
                    (l.BLOCK.maxDistance = 19))
                  : 2 == t.gameLevel &&
                    ((l.BLOCK.minRadiusScale = 0.6),
                    (l.BLOCK.maxRadiusScale = 0.8),
                    (l.BLOCK.minDistance = 1),
                    (l.BLOCK.maxDistance = 20))
                : ((l.BLOCK.minRadiusScale = 0.8),
                  (l.BLOCK.maxRadiusScale = 1),
                  (l.BLOCK.minDistance = 1),
                  (l.BLOCK.maxDistance = 17)));
            for (s = 0, n = this.blocksIn使用.length; s < n; ++s) {
              var a = this.blocksIn使用.pop();
              ((a.obj.visible = !1), a.reset(), this.blocksPool.push(a));
            }
            (Object.keys(this.blocksRemoved).forEach(function (e) {
              var t = o.blocksRemoved[e];
              ((t.obj.visible = !1), t.reset(), o.blocksPool.push(t));
            }),
              (this.blocksRemoved = {}));
            for (s = 0, n = this.waves.length; s < n; ++s)
              this.waves[s].reset();
            (this.blocksPool.sort(function (e, t) {
              return e.order - t.order;
            }),
              (!t && "relay" != this.mode) || (t && void 0 === t.skinId)
                ? ((i = wx.getStorageSync("current_skin")),
                  ((t = t || {}).skinId = i))
                : (i = t && t.skinId),
              this.addToPool(i),
              this.removeFromPool(t),
              (this.currentBlock = this.blocksPool.shift()),
              (this.currentBlock.obj.visible = !0),
              this.scene.add(this.currentBlock.obj),
              this.blocksIn使用.push(this.currentBlock),
              this.shadowTarget && this.shadowTarget.position.set(0, 0, 0),
              (this.nextBlock = this.blocksPool.shift()),
              this.currentBlock.change(null, null, 1),
              this.nextBlock.change(null, null, 1),
              this.nextBlock.obj.position.set(20, 0, 0),
              this.currentBlock.obj.position.set(0, 0, 0),
              (this.nextBlock.obj.visible = !0),
              this.scene.add(this.nextBlock.obj),
              this.blocksIn使用.push(this.nextBlock),
              this.bottle.reset(t),
              (this.thirdBlock = null),
              this.UI.reset(),
              this.rankSystem.reset(),
              (this.hit = null),
              (this.lastAddBonus = -2),
              (this.lastBonusOrder = null),
              (this.succeedTime = 0),
              (this.doubleHit = 0),
              this.camera.position.set(-17, 30, 26),
              this.shadowLight.position.set(0, 15, 10),
              t &&
                t.bottleShowupAnimation &&
                (this.bottle.showup(),
                this.audioManager.restart.seek(0),
                this.audioManager.restart.play()),
              (this.showRelax本次得分 = 0),
              (this.relaxLeft = 0),
              (this.eggBlocksCount = {}),
              (this.eggBlocksTriggerCount = {}),
              (this.eggBlocksFailCount = {}),
              (this.eggBlocksSucceedCount = {}),
              (this.straight = !0),
              wx.triggerGC && wx.triggerGC());
          },
        },
        {
          key: "generateSeed",
          value: function () {
            var e = m.default.getMy使用rInfo();
            if (e && e.open_id) {
              var t = Date.now();
              return ((this.time_seed = t), (0, O.encryptSeed)(t, e.open_id));
            }
            return (
              u.default.sendServerError(7),
              null === e && u.default.sendServerError(8),
              (this.time_seed = void 0),
              Date.now()
            );
          },
        },
        {
          key: "stopLoopMusic",
          value: function () {
            (this.audioManager.scale_intro &&
              this.audioManager.scale_intro.stop(),
              this.audioManager.scale_loop &&
                this.audioManager.scale_loop.stop(),
              this.stopBlockMusic());
          },
        },
        {
          key: "generate高Distances",
          value: function () {
            for (
              var e = 2 + Math.floor(2 * (0, S.random)()), t = [], i = 0;
              i < e;
              ++i
            )
              i < e - 1
                ? t.push(l.BLOCK.minDistance + 2 * (0, S.random)())
                : t.push(l.BLOCK.maxDistance - 2 * (0, S.random)());
            return t;
          },
        },
        {
          key: "touchStartAnim",
          value: function (e) {
            "prepare" != this.bottle.status &&
              (this.stopBlockMusic(),
              this.bottle.prepare(),
              this.currentBlock.shrink(),
              (e && e.fromGuider) ||
                (this.audioManager.scale_intro.seek(0),
                this.audioManager.scale_intro.play(),
                (this.mouseDownTime = Date.now()),
                (this.onceTouchMoveList = [])));
          },
        },
        {
          key: "touchEndAnim",
          value: function (e, t, o, s, n) {
            ("relay" == this.mode && y.TweenAnimation.kill("progress"),
              void 0 !== s && (this.music本次得分 = s),
              (this.duration = e || (Date.now() - this.mouseDownTime) / 1e3),
              (this.bottle.velocity.vz = Math.min(
                this.duration * l.BOTTLE.velocityZIncrement,
                150,
              )),
              (this.bottle.velocity.vz = +this.bottle.velocity.vz.toFixed(2)),
              (this.bottle.velocity.vy = Math.min(
                l.BOTTLE.velocityY +
                  this.duration * l.BOTTLE.velocityYIncrement,
                180,
              )),
              (this.bottle.velocity.vy = +this.bottle.velocity.vy.toFixed(2)),
              (this.direction = new i.Vector2(
                this.nextBlock.obj.position.x - this.bottle.obj.position.x,
                this.nextBlock.obj.position.z - this.bottle.obj.position.z,
              )),
              (this.direction.x = +this.direction.x.toFixed(2)),
              (this.direction.y = +this.direction.y.toFixed(2)));
            var a = new i.Vector3(this.direction.x, 0, this.direction.y);
            if (
              ((this.hit = this.checkHit2(
                this.bottle,
                this.currentBlock,
                this.nextBlock,
                t,
              )),
              (this.distance =
                l.BLOCK.minDistance +
                (0, S.random)() * (l.BLOCK.maxDistance - l.BLOCK.minDistance)),
              (this.distance = +this.distance.toFixed(2)),
              (this.straight = (0, S.random)() > 0.5 ? 1 : 0),
              1 === this.hit || 7 === this.hit)
            ) {
              var r = this.generate下1步Block();
              (r &&
                r.order >= 13 &&
                (this.eggBlocksCount[r.order] = this.eggBlocksCount[r.order]
                  ? this.eggBlocksCount[r.order] + 1
                  : 1),
                (this.thirdBlock = r),
                (this.quick =
                  void 0 === o
                    ? Date.now() - this.lastSucceedTime < 800 || !1
                    : o),
                "relay" == this.mode && (this.quick = !1));
            }
            return (
              (n && n.noAnimation) ||
                (this.audioManager.scale_intro.stop(),
                this.audioManager.scale_loop.stop(),
                this.currentBlock.rebound(),
                this.bottle.jump(a.normalize()),
                this.hideCombo()),
              this.hit
            );
          },
        },
        {
          key: "bindEvent",
          value: function () {
            var e = this,
              t = this;
            (M.default.on(l.EVENT.GOTOSINGLESTARTPAGE, function (t, i) {
              (e.clearTimer(),
                (e.animating = !0),
                console.log("gotoSinglepage"),
                e.loopAnimate());
            }),
              M.default.on(l.EVENT.TRIGGER_EGG, function (t, i) {
                var o = i.order;
                e.eggBlocksTriggerCount[o] = e.eggBlocksTriggerCount[o]
                  ? e.eggBlocksTriggerCount[o] + 1
                  : 1;
              }),
              t.instructionCtrl.bindCmdHandler(function (e) {
                if (-1 == e.type)
                  return (
                    t.gameCtrl.showPlayerGG(e.s),
                    void t.instructionCtrl.onCmdComplete()
                  );
                if (0 == e.type)
                  return (
                    (t.socketFirstSync = !0),
                    t.bottle.resetPosition(),
                    t.UI.scoreText.changeStyle({
                      textAlign: "center",
                    }),
                    t.UI.set本次得分(0),
                    void t.instructionCtrl.onCmdComplete()
                  );
                if (
                  (t.gameCtrl.showPlayerWaiting(),
                  e.score != t.UI.score &&
                    ((t.UI.score = e.score), t.UI.set本次得分(e.score)),
                  e && e.b && e.b.vy)
                ) {
                  if (
                    (t.socketFirstSync &&
                      ((t.socketFirstSync = !1),
                      t.camera.position.set(e.ca.x, e.ca.y, e.ca.z),
                      t.ground.obj.position.set(e.gd.x, e.gd.y, e.gd.z)),
                    t.currentBlock.order != e.c.order ||
                      t.nextBlock.order != e.n.order)
                  ) {
                    for (var o = 0, s = t.blocksIn使用.length; o < s; ++o) {
                      var n = t.blocksIn使用.pop();
                      (t.scene.remove(n.obj), t.blocksPool.push(n));
                    }
                    var a = t.blocksPool.findIndex(function (t) {
                      return t.order == e.c.order;
                    });
                    t.currentBlock = t.blocksPool[a];
                    var r = t.blocksPool.splice(a, 1);
                    t.blocksIn使用.push(r[0]);
                    var h = t.blocksPool.findIndex(function (t) {
                      return t.order == e.n.order;
                    });
                    t.nextBlock = t.blocksPool[h];
                    r = t.blocksPool.splice(h, 1);
                    t.blocksIn使用.push(r[0]);
                  }
                  (t.scene.add(t.currentBlock.obj),
                    t.scene.add(t.nextBlock.obj),
                    (t.currentBlock.obj.visible = !0),
                    (t.nextBlock.obj.visible = !0),
                    (t.currentBlock.obj.position.x = e.c.x),
                    (t.currentBlock.obj.position.z = e.c.z),
                    t.currentBlock.change(e.c.r, e.c.type, e.c.rs),
                    (t.nextBlock.obj.position.x = e.n.x),
                    (t.nextBlock.obj.position.z = e.n.z),
                    t.nextBlock.change(e.n.r, e.n.type, e.n.rs),
                    t.bottle.obj.position.set(e.b.x, l.BLOCK.height / 2, e.b.z),
                    (t.bottle.velocity.vz = e.b.vz),
                    (t.bottle.velocity.vy = e.b.vy),
                    (t.distance = e.di),
                    (t.straight = e.s));
                  var c = new i.Vector3(
                    t.nextBlock.obj.position.x - t.bottle.obj.position.x,
                    0,
                    t.nextBlock.obj.position.z - t.bottle.obj.position.z,
                  );
                  if (
                    ((t.direction = new i.Vector2(
                      t.nextBlock.obj.position.x - t.bottle.obj.position.x,
                      t.nextBlock.obj.position.z - t.bottle.obj.position.z,
                    )),
                    t.checkHit2(t.bottle, t.currentBlock, t.nextBlock, e.b.y),
                    (t.quick = e.q),
                    e.t)
                  ) {
                    var d = t.blocksPool.findIndex(function (t) {
                      return t.order == e.t.order;
                    });
                    if (d > -1) {
                      t.thirdBlock = t.blocksPool[d];
                      r = t.blocksPool.splice(d, 1);
                      t.blocksIn使用.push(t.thirdBlock);
                    } else
                      ((t.thirdBlock = t.blocksIn使用.find(function (t) {
                        return t.order == e.t.order;
                      })),
                        t.thirdBlock &&
                          t.thirdBlock.obj &&
                          t.scene.remove(t.thirdBlock.obj));
                    t.thirdBlock.change(e.t.r, e.t.type, e.t.rs);
                  }
                  if (
                    ((t.hit = e.h),
                    t.tailSystem && t.tailSystem.correctPosition(),
                    isNaN(e.usingPropType))
                  ) {
                    (t.audioManager.scale_intro.seek(0),
                      t.audioManager.scale_intro.play(),
                      t.bottle.prepare(),
                      t.currentBlock.shrink());
                    var u = {
                        x: e.ca.x,
                        y: e.ca.y,
                        z: e.ca.z,
                      },
                      m = {
                        x: e.gd.x,
                        y: e.gd.y,
                        z: e.gd.z,
                      };
                    t.instructionCtrl.icTimeout = setTimeout(function () {
                      (t.audioManager.scale_intro.stop(),
                        t.audioManager.scale_loop.stop(),
                        15 == t.currentBlock.order && t.currentBlock.hideGlow(),
                        t.currentBlock.rebound(),
                        t.camera.position.set(u.x, u.y, u.z),
                        t.ground.obj.position.set(m.x, m.y, m.z),
                        (u = null),
                        (m = null),
                        t.bottle.jump(c.normalize()));
                    }, 1e3 * e.d);
                  } else z.default.observeUsingProp(e.usingPropType, t);
                  (t.stopBlockMusic(), (e = null));
                } else t.instructionCtrl.onCmdComplete();
              }),
              t.gameSocket.onReciveCommand(function (e, i) {
                "observe" == t.mode && t.instructionCtrl.onReceiveCommand(i, e);
              }),
              t.gameSocket.onPeopleCome(function (e) {
                t.gameCtrl.onPeopleCome(e);
              }),
              t.gameSocket.onPlayerOut(function () {
                t.gameCtrl.onPlayerOut();
              }),
              t.gameSocket.onJoinSuccess(function (e) {
                (t.gameCtrl.socketJoinSuccess(e),
                  "observe" == t.mode &&
                    (t.bottle.obj.position.set(8, -l.BLOCK.height / 2, 0),
                    t.camera.position.set(-17, 30, 26),
                    t.shadowLight.position.set(0, 15, 10),
                    t.currentBlock && (t.currentBlock.obj.visible = !1),
                    t.nextBlock && (t.nextBlock.obj.visible = !1)));
              }),
              t.gameSocket.onRelayCmdCome(
                t.relayInstructionCtrl.cmdCome.bind(t.relayInstructionCtrl),
              ),
              canvas.addEventListener("touchstart", function (e) {
                if (
                  (!GameGlobal.minigameTouchEventHandler ||
                    GameGlobal.minigameTouchEventHandler.touchStartHandler(
                      e,
                    )) &&
                  !t.pendingReset
                )
                  if (e.touches.length >= 2) t.touchObserve = !0;
                  else if (
                    (console.log("!!! touchstart", t.mode, t.stage),
                    "relay" == t.mode &&
                      "game" == t.stage &&
                      t.full2D.doTouchStartEvent(e),
                    "relay" != t.mode ||
                      "game" != t.stage ||
                      (!t.clicked && t.myTurn))
                  )
                    if (
                      t.gameCtrl.reviewCtrl.isInThisPage &&
                      t.gameCtrl.reviewCtrl.reviewPage
                    )
                      t.gameCtrl.reviewCtrl.reviewPage.doTouchStartEvent(e);
                    else {
                      if (
                        "single" == t.mode ||
                        "player" == t.mode ||
                        "rankGameChallenge" === t.mode
                      ) {
                        var i = e.changedTouches[0].clientX,
                          o = e.changedTouches[0].clientY;
                        if ("game" == t.stage && !t.is_from_wn && !t.guider) {
                          if (i < 0.13 * F && o > 0.88 * U)
                            return (
                              "prepare" == t.bottle.status &&
                                (t.touchObserve = !0),
                              void t.gameCtrl.shareObservCard()
                            );
                          if (
                            t.UI.adBoard &&
                            i >= l.AD_BOARD.UI_left &&
                            i <= l.AD_BOARD.UI_right &&
                            o <= l.AD_BOARD.UI_bottom &&
                            o >= l.AD_BOARD.UI_top
                          )
                            return void M.default.emit(
                              l.EVENT.TRIGGER_AD_JUMP,
                              {},
                            );
                          if (
                            t.UI.propBoard &&
                            i >= l.PROP_BOARD.p.UI_left &&
                            i <= l.PROP_BOARD.p.UI_right &&
                            o <= l.PROP_BOARD.p.UI_bottom &&
                            o >= l.PROP_BOARD.p.UI_top
                          )
                            return void (
                              "stop" == t.bottle.status &&
                              M.default.emit(l.EVENT.TRIGGER_PROP, {})
                            );
                        }
                      }
                      if (
                        "friendRankList" != t.stage &&
                        "battlePage" != t.stage &&
                        "groupRankList" != t.stage &&
                        "singleSettlementPgae" != t.stage &&
                        "startPage" != t.stage
                      )
                        if (
                          "viewerWaiting" != t.stage &&
                          "viewerGG" != t.stage &&
                          "viewerOut" != t.stage
                        )
                          if ("relayRoom" != t.stage)
                            if ("getGiftPage" != t.mode) {
                              if ("game" == t.stage) {
                                if ("observe" === t.mode) return;
                                if (
                                  !(
                                    "prepare" !== t.bottle.status ||
                                    t.pendingReset ||
                                    (t.guider && t.animating)
                                  ) &&
                                  1 == e.targetTouches.length
                                )
                                  return t.touchObserve
                                    ? void (t.touchObserve = !1)
                                    : void t.handleInterrupt();
                                "stop" !== t.bottle.status ||
                                  t.pendingReset ||
                                  (t.guider && t.animating) ||
                                  t.touchStartAnim();
                              }
                            } else t.full2D.doTouchStartEvent(e);
                          else t.full2D.doTouchStartEvent(e);
                        else t.full2D.doTouchStartEvent(e);
                      else t.full2D.doTouchStartEvent(e);
                    }
              }));
            (canvas.addEventListener("touchcancel", function (e) {
              t.handleInterrupt();
            }),
              canvas.addEventListener("touchend", function (e) {
                if (
                  !GameGlobal.minigameTouchEventHandler ||
                  GameGlobal.minigameTouchEventHandler.touchEndHandler(e)
                ) {
                  (e.changedTouches[0].clientX, e.changedTouches[0].clientY);
                  if (
                    ("relay" == t.mode &&
                      "game" == t.stage &&
                      t.full2D.doTouchEndEvent(e),
                    "relay" != t.mode ||
                      "game" != t.stage ||
                      (!t.clicked && t.myTurn))
                  )
                    if (
                      t.gameCtrl.reviewCtrl.isInThisPage &&
                      t.gameCtrl.reviewCtrl.reviewPage
                    )
                      t.gameCtrl.reviewCtrl.reviewPage.doTouchEndEvent(e);
                    else if ("loading" != t.stage && "relay" != t.stage)
                      if (
                        "singleSettlementPgae" != t.stage &&
                        "startPage" != t.stage
                      )
                        if (
                          "viewerWaiting" != t.stage &&
                          "viewerGG" != t.stage &&
                          "viewerOut" != t.stage
                        )
                          if ("friendRankList" != t.stage)
                            if ("battlePage" != t.stage)
                              if ("groupRankList" != t.stage) {
                                if ("getGiftPage" != t.mode)
                                  return "relayRoom" == t.stage
                                    ? (console.log(t.stage),
                                      void t.full2D.doTouchEndEvent(e))
                                    : void (
                                        "game" == t.stage &&
                                        ("prepare" !== t.bottle.status ||
                                          t.pendingReset ||
                                          (t.guider && t.animating) ||
                                          (t.touchEndAnim(),
                                          "player" === t.mode &&
                                            (++t.seq,
                                            t.gameSocket.sendCommand(t.seq, {
                                              type: 1,
                                              c: {
                                                x: t.currentBlock.obj.position
                                                  .x,
                                                z: t.currentBlock.obj.position
                                                  .z,
                                                order: t.currentBlock.order,
                                                type: t.currentBlock.type,
                                                r: t.currentBlock.radius,
                                                rs: t.currentBlock.radiusScale,
                                              },
                                              n: {
                                                x: t.nextBlock.obj.position.x,
                                                z: t.nextBlock.obj.position.z,
                                                order: t.nextBlock.order,
                                                type: t.nextBlock.type,
                                                r: t.nextBlock.radius,
                                                rs: t.nextBlock.radiusScale,
                                              },
                                              d: t.duration,
                                              b: {
                                                x: t.bottle.obj.position.x,
                                                y: +t.bottle.obj.position.y.toFixed(
                                                  2,
                                                ),
                                                z: t.bottle.obj.position.z,
                                                vy: t.bottle.velocity.vy,
                                                vz: t.bottle.velocity.vz,
                                              },
                                              t:
                                                1 === t.hit || 7 === t.hit
                                                  ? {
                                                      order: t.thirdBlock.order,
                                                      type: t.thirdBlock.type,
                                                      r: t.thirdBlock.radius,
                                                      rs: t.thirdBlock
                                                        .radiusScale,
                                                    }
                                                  : null,
                                              h: t.hit,
                                              di: t.distance,
                                              s: t.straight,
                                              q: t.quick,
                                              ca: {
                                                x: t.camera.position.x,
                                                y: t.camera.position.y,
                                                z: t.camera.position.z,
                                              },
                                              gd: {
                                                x: t.ground.obj.position.x,
                                                y: t.ground.obj.position.y,
                                                z: t.ground.obj.position.z,
                                              },
                                              score: t.UI.score,
                                            })),
                                          "observe" != t.mode &&
                                            "review" != t.mode &&
                                            (t.actionList.push([
                                              t.duration,
                                              +t.bottle.obj.position.y.toFixed(
                                                2,
                                              ),
                                              t.quick,
                                            ]),
                                            t.musicList.push(t.music本次得分),
                                            "relay" == t.mode &&
                                              !t.isObserver &&
                                              t.onebyoneCtrl.data &&
                                              ((t.clicked = !0),
                                              M.default.emitSync(
                                                l.EVENT.NOWPLAYERJUMP,
                                                {
                                                  jump_succ:
                                                    1 == t.hit ||
                                                    7 == t.hit ||
                                                    2 == t.hit
                                                      ? 1
                                                      : 0,
                                                  msginfo: JSON.stringify({
                                                    duration: t.duration,
                                                    initY:
                                                      +t.bottle.obj.position.y.toFixed(
                                                        2,
                                                      ),
                                                  }),
                                                  msg_seq:
                                                    t.onebyoneCtrl.data.msg_seq,
                                                },
                                              )),
                                            t.touchStartTime.push(
                                              t.mouseDownTime,
                                            ),
                                            e.changedTouches &&
                                              e.changedTouches[0] &&
                                              (t.touchMoveList.push(
                                                t.onceTouchMoveList,
                                              ),
                                              t.touchList.push([
                                                e.changedTouches[0].clientX,
                                                e.changedTouches[0].clientY,
                                              ])))))
                                      );
                                t.full2D.doTouchEndEvent(e);
                              } else t.full2D.doTouchEndEvent(e);
                            else t.full2D.doTouchEndEvent(e);
                          else t.full2D.doTouchEndEvent(e);
                        else t.full2D.doTouchEndEvent(e);
                      else t.full2D.doTouchEndEvent(e);
                    else t.full2D.doTouchEndEvent(e);
                }
              }),
              canvas.addEventListener("touchmove", function (e) {
                if (
                  !GameGlobal.minigameTouchEventHandler ||
                  GameGlobal.minigameTouchEventHandler.touchMoveHandler(e)
                )
                  if (
                    (console.log("!!! touchmove", t.mode, t.stage),
                    "relay" == t.mode &&
                      ("game" == t.stage && t.full2D.doTouchMoveEvent(e),
                      "relayRoom" == t.stage &&
                        e.changedTouches[0].clientX > 60 &&
                        e.changedTouches[0].clientX < 340 &&
                        e.changedTouches[0].clientY > 285 &&
                        e.changedTouches[0].clientY < 570 &&
                        (console.log("!!! touchmove outDate rank", e),
                        t.full2D.doTouchMoveEvent(e))),
                    "getGiftPage" != t.mode)
                  ) {
                    if (
                      (t.gameCtrl.reviewCtrl.isInThisPage &&
                        t.gameCtrl.reviewCtrl.reviewPage &&
                        t.gameCtrl.reviewCtrl.reviewPage.doTouchMoveEvent(e),
                      "prepare" == t.bottle.status)
                    ) {
                      if (t.onceTouchMoveList.length >= 10) return;
                      t.onceTouchMoveList.push(
                        e.changedTouches[0].clientX,
                        e.changedTouches[0].clientY,
                      );
                    }
                    ("battlePage" != t.stage &&
                      "friendRankList" != t.stage &&
                      "groupRankList" != t.stage &&
                      "startPage" != t.stage) ||
                      t.full2D.doTouchMoveEvent(e);
                  } else t.full2D.doTouchMoveEvent(e);
              }));
          },
        },
        {
          key: "report",
          value: function (e) {
            Math.random() <= 1 &&
              (console.log("日志上报：" + e), u.default.logReport("|SM|:" + e));
          },
        },
        {
          key: "stopBlockMusic",
          value: function () {
            (this.currentBlock.whenLeave && this.currentBlock.whenLeave(),
              this.currentBlock.music姓th &&
                this.audioManager[this.currentBlock.music姓th].stop(),
              this.currentBlock.registerEndAudio &&
                this.currentBlock.registerEndAudio(),
              this.audioManager.clearTimer(),
              this.audioManager.setTimerFlag(!1),
              this.musicTimer &&
                (clearTimeout(this.musicTimer), (this.musicTimer = null)));
          },
        },
        {
          key: "handleNetworkFucked",
          value: function (e) {
            var t =
              arguments.length > 1 && void 0 !== arguments[1]
                ? arguments[1]
                : "网络异常,点击确定进入游戏";
            (this.rollBackToSingle(),
              e &&
                wx.showModal({
                  title: "提示",
                  content: t,
                  show取消: !1,
                }));
          },
        },
        {
          key: "handleSocketFucked",
          value: function () {
            (this.gameSocket.close(),
              "player" == this.mode &&
                (this.shareObservCardFail(), this.updateUI()),
              "observe" == this.mode && this.handleNetworkFucked(!0));
          },
        },
        {
          key: "handleInterrupt",
          value: function () {
            "prepare" == this.bottle.status &&
              ((this.bottle.velocity.vz = 0),
              (this.bottle.velocity.vy = 150),
              this.bottle.jump(new i.Vector3(1, 0, 0).normalize()),
              this.currentBlock.rebound(),
              this.audioManager.scale_loop.stop(),
              (this.direction = new i.Vector2(1, 0)),
              (this.hit = this.checkHit2(
                this.bottle,
                this.currentBlock,
                this.nextBlock,
              )),
              "relay" == this.mode &&
                (M.default.emit(l.EVENT.SEND_REALTIME_MSG_TO_CTRL, {
                  time: -1,
                }),
                (this.relayHandleInterrupt = !0)));
          },
        },
        {
          key: "relayBottleReset",
          value: function (e) {
            (this.bottle.reset({
              preserveDirection: !0,
              bottleSkin: null,
            }),
              (this.bottle.obj.position.x = this.currentBlock.obj.position.x),
              (this.bottle.obj.position.z = this.currentBlock.obj.position.z),
              (e && e.noAnimation) ||
                (this.bottle.showup(),
                this.audioManager.restart.seek(0),
                this.audioManager.restart.play()));
          },
        },
        {
          key: "handleWxOnError",
          value: function (e) {
            var t =
              (null == g.default.serverConfig.bad_js_ratio
                ? 1e6
                : g.default.serverConfig.bad_js_ratio) / 1e6 || 1;
            Math.random() <= t && u.default.badReport(e.message, e.stack);
          },
        },
        {
          key: "sendServerError",
          value: function (e) {
            u.default.sendServerError(e);
          },
        },
        {
          key: "initMinigameCenter",
          value: function () {
            var e,
              t = this;
            ((GameGlobal.gameID = 1),
              (GameGlobal.cache本次得分 = 0),
              GameGlobal.minigameCenter.setTabs(["game"]),
              "startPage" == this.stage && GameGlobal.minigameCenter.show());
            var o = l.FRUSTUMSIZE / U;
            (GameGlobal.minigameCenter.on("render", function () {
              if (
                (e ||
                  GameGlobal.minigameRenderTexture ||
                  (console.log("初始化社交组件渲染"),
                  (e = GameGlobal.minigameCenter.getCanvas()),
                  (function () {
                    GameGlobal.minigameRenderTexture = new i.Texture(e.canvas);
                    var o = !0;
                    (((V && (0, _.gtAppVersion)("8.0.31")) ||
                      (K && (0, _.gtAppVersion)("8.0.27")) ||
                      N) &&
                      (o = !1),
                      o && (GameGlobal.minigameRenderTexture.flipY = !1));
                    var s = new i.MeshBasicMaterial({
                      map: GameGlobal.minigameRenderTexture,
                      transparent: !0,
                    });
                    s.map.minFilter = i.LinearFilter;
                    var n = new i.PlaneBufferGeometry(1, 1);
                    ((GameGlobal.minigameMesh = new i.Mesh(n, s)),
                      (GameGlobal.minigameMesh.position.y = 0),
                      (GameGlobal.minigameMesh.position.x = 0),
                      (GameGlobal.minigameMesh.position.z = 10),
                      (GameGlobal.minigameMesh.visible = !0),
                      (GameGlobal.minigameMesh.name = "minigamePlugin"),
                      t.camera.add(GameGlobal.minigameMesh));
                  })(),
                  (GameGlobal.minigameTouchEventHandler =
                    GameGlobal.minigameCenter.getTouchEventHandler())),
                GameGlobal.minigameCenter && e && GameGlobal.minigameMesh)
              ) {
                var s = o * e.width,
                  n = o * e.height,
                  a = o * (U / 2 - e.height / 2 - e.y),
                  r = o * (e.x + e.width / 2 - F / 2);
                (GameGlobal.minigameMesh.scale.x !== s &&
                  (GameGlobal.minigameMesh.scale.x = s),
                  GameGlobal.minigameMesh.scale.y !== n &&
                    (GameGlobal.minigameMesh.scale.y = n),
                  GameGlobal.minigameMesh.position.y !== a &&
                    (GameGlobal.minigameMesh.position.y = a),
                  GameGlobal.minigameMesh.position.x !== r &&
                    (GameGlobal.minigameMesh.position.x = r),
                  GameGlobal.minigameRenderTexture &&
                    (GameGlobal.minigameRenderTexture.needsUpdate = !0));
              }
            }),
              GameGlobal.minigameCenter.on("gameStart", function (e) {
                ((GameGlobal.cache本次得分 = e.score || 0),
                  (GameGlobal.matchType = e.matchType),
                  (GameGlobal.matchTypes = e.matchTypes),
                  (GameGlobal.seed = +e.matchID.match(/\d+/g).join("")),
                  (GameGlobal.gameID += 1),
                  GameGlobal.controller.gameCtrl.clickReplay());
              }),
              GameGlobal.minigameCenter.on("gameOver", function (e) {
                (y.TweenAnimation.killAll(),
                  GameGlobal.controller.gameCtrl.gameOver(
                    GameGlobal.controller.current本次得分,
                  ),
                  GameGlobal.controller.gameCtrl.gameOverShowPage(),
                  (GameGlobal.cache本次得分 = 0),
                  (GameGlobal.matchType = 0));
              }));
          },
        },
      ]),
      D
    );
  })();
if (wx.getLaunchOptionsSync) {
  var J = wx.getLaunchOptionsSync();
  GameGlobal.controller = new Y(J);
} else GameGlobal.controller = new Y();
var X = Date.now();
!(function e() {
  var t = Date.now(),
    i = t - X;
  if (((X = t), requestAnimationFrame(e, !0), i > 100)) return;
  GameGlobal.controller.update(i / 1e3);
})();

},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./block":33,"./bottle":34,"./config":37,"./control/bottleSkinBaseCtrl":39,"./control/instructionCtrl":43,"./control/onebyoneCtrl":48,"./control/propertyCtrl":51,"./control/relayInstructionCtrl":54,"./gameCtrl":59,"./gameModel":60,"./gameView":61,"./getPlugin":62,"./ground":63,"./lib/animation":66,"./lib/mue/eventcenter":67,"./lib/mue/lookcenter":68,"./lib/point-in-polygon":69,"./lib/three":70,"./network/network":73,"./network/relayMoniter":74,"./network/reporter":75,"./network/socket":76,"./pages/full2D":81,"./pages/pages2d/base":89,"./random":118,"./rankSystem":119,"./shareApp":124,"./skin":125,"./store/historyTimes":126,"./store/session":127,"./store/storage":128,"./tailSystem":129,"./ui":131,"./ui/audioManager":133,"./util/encryption":137,"./viewer":141,"./wave":142,"./weapp-adapter":143}],65:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t, e, r = r || function(t, e) {
  var r = {},
    i = r.lib = {},
    n = function() {},
    s = i.Base = {
      extend: function(t) {
        n.prototype = this;
        var e = new n;
        return t && e.mixIn(t), e.hasOwnProperty("init") || (e.init = function() {
          e.$super.init.apply(this, arguments)
        }), e.init.prototype = e, e.$super = this, e
      },
      create: function() {
        var t = this.extend();
        return t.init.apply(t, arguments), t
      },
      init: function() {},
      mixIn: function(t) {
        for (var e in t) t.hasOwnProperty(e) && (this[e] = t[e]);
        t.hasOwnProperty("toString") && (this.toString = t.toString)
      },
      clone: function() {
        return this.init.prototype.extend(this)
      }
    },
    o = i.WordArray = s.extend({
      init: function(t, e) {
        t = this.words = t || [], this.sigBytes = null != e ? e : 4 * t.length
      },
      toString: function(t) {
        return (t || a).stringify(this)
      },
      concat: function(t) {
        var e = this.words,
          r = t.words,
          i = this.sigBytes;
        if (t = t.sigBytes, this.clamp(), i % 4)
          for (var n = 0; n < t; n++) e[i + n >>> 2] |= (r[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 24 - (i + n) % 4 * 8;
        else if (65535 < r.length)
          for (n = 0; n < t; n += 4) e[i + n >>> 2] = r[n >>> 2];
        else e.push.apply(e, r);
        return this.sigBytes += t, this
      },
      clamp: function() {
        var e = this.words,
          r = this.sigBytes;
        e[r >>> 2] &= 4294967295 << 32 - r % 4 * 8, e.length = t.ceil(r / 4)
      },
      clone: function() {
        var t = s.clone.call(this);
        return t.words = this.words.slice(0), t
      },
      random: function(e) {
        for (var r = [], i = 0; i < e; i += 4) r.push(4294967296 * t.random() | 0);
        return new o.init(r, e)
      }
    }),
    c = r.enc = {},
    a = c.Hex = {
      stringify: function(t) {
        var e = t.words;
        t = t.sigBytes;
        for (var r = [], i = 0; i < t; i++) {
          var n = e[i >>> 2] >>> 24 - i % 4 * 8 & 255;
          r.push((n >>> 4).toString(16)), r.push((15 & n).toString(16))
        }
        return r.join("")
      },
      parse: function(t) {
        for (var e = t.length, r = [], i = 0; i < e; i += 2) r[i >>> 3] |= parseInt(t.substr(i, 2), 16) << 24 - i % 8 * 4;
        return new o.init(r, e / 2)
      }
    },
    h = c.Latin1 = {
      stringify: function(t) {
        var e = t.words;
        t = t.sigBytes;
        for (var r = [], i = 0; i < t; i++) r.push(String.fromCharCode(e[i >>> 2] >>> 24 - i % 4 * 8 & 255));
        return r.join("")
      },
      parse: function(t) {
        for (var e = t.length, r = [], i = 0; i < e; i++) r[i >>> 2] |= (255 & t.charCodeAt(i)) << 24 - i % 4 * 8;
        return new o.init(r, e)
      }
    },
    f = c.Utf8 = {
      stringify: function(t) {
        try {
          return decodeURIComponent(escape(h.stringify(t)))
        } catch (t) {
          throw Error("Malformed UTF-8 data")
        }
      },
      parse: function(t) {
        return h.parse(unescape(encodeURIComponent(t)))
      }
    },
    u = i.BufferedBlockAlgorithm = s.extend({
      reset: function() {
        this._data = new o.init, this._nDataBytes = 0
      },
      _append: function(t) {
        "string" == typeof t && (t = f.parse(t)), this._data.concat(t), this._nDataBytes += t.sigBytes
      },
      _process: function(e) {
        var r = this._data,
          i = r.words,
          n = r.sigBytes,
          s = this.blockSize,
          c = n / (4 * s);
        if (e = (c = e ? t.ceil(c) : t.max((0 | c) - this._minBufferSize, 0)) * s, n = t.min(4 * e, n), e) {
          for (var a = 0; a < e; a += s) this._doProcessBlock(i, a);
          a = i.splice(0, e), r.sigBytes -= n
        }
        return new o.init(a, n)
      },
      clone: function() {
        var t = s.clone.call(this);
        return t._data = this._data.clone(), t
      },
      _minBufferSize: 0
    });
  i.Hasher = u.extend({
    cfg: s.extend(),
    init: function(t) {
      this.cfg = this.cfg.extend(t), this.reset()
    },
    reset: function() {
      u.reset.call(this), this._doReset()
    },
    update: function(t) {
      return this._append(t), this._process(), this
    },
    finalize: function(t) {
      return t && this._append(t), this._doFinalize()
    },
    blockSize: 16,
    _createHelper: function(t) {
      return function(e, r) {
        return new t.init(r).finalize(e)
      }
    },
    _createHmacHelper: function(t) {
      return function(e, r) {
        return new d.HMAC.init(t, r).finalize(e)
      }
    }
  });
  var d = r.algo = {};
  return r
}(Math);
e = (t = r).lib.WordArray, t.enc.Base64 = {
    stringify: function(t) {
      var e = t.words,
        r = t.sigBytes,
        i = this._map;
      t.clamp(), t = [];
      for (var n = 0; n < r; n += 3)
        for (var s = (e[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 16 | (e[n + 1 >>> 2] >>> 24 - (n + 1) % 4 * 8 & 255) << 8 | e[n + 2 >>> 2] >>> 24 - (n + 2) % 4 * 8 & 255, o = 0; 4 > o && n + .75 * o < r; o++) t.push(i.charAt(s >>> 6 * (3 - o) & 63));
      if (e = i.charAt(64))
        for (; t.length % 4;) t.push(e);
      return t.join("")
    },
    parse: function(t) {
      var r = t.length,
        i = this._map;
      (n = i.charAt(64)) && -1 != (n = t.indexOf(n)) && (r = n);
      for (var n = [], s = 0, o = 0; o < r; o++)
        if (o % 4) {
          var c = i.indexOf(t.charAt(o - 1)) << o % 4 * 2,
            a = i.indexOf(t.charAt(o)) >>> 6 - o % 4 * 2;
          n[s >>> 2] |= (c | a) << 24 - s % 4 * 8, s++
        } return e.create(n, s)
    },
    _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
  },
  function(t) {
    function e(t, e, r, i, n, s, o) {
      return ((t = t + (e & r | ~e & i) + n + o) << s | t >>> 32 - s) + e
    }

    function i(t, e, r, i, n, s, o) {
      return ((t = t + (e & i | r & ~i) + n + o) << s | t >>> 32 - s) + e
    }

    function n(t, e, r, i, n, s, o) {
      return ((t = t + (e ^ r ^ i) + n + o) << s | t >>> 32 - s) + e
    }

    function s(t, e, r, i, n, s, o) {
      return ((t = t + (r ^ (e | ~i)) + n + o) << s | t >>> 32 - s) + e
    }
    for (var o = r, c = (h = o.lib).WordArray, a = h.Hasher, h = o.algo, f = [], u = 0; 64 > u; u++) f[u] = 4294967296 * t.abs(t.sin(u + 1)) | 0;
    h = h.MD5 = a.extend({
      _doReset: function() {
        this._hash = new c.init([1732584193, 4023233417, 2562383102, 271733878])
      },
      _doProcessBlock: function(t, r) {
        for (var o = 0; 16 > o; o++) {
          var c = t[a = r + o];
          t[a] = 16711935 & (c << 8 | c >>> 24) | 4278255360 & (c << 24 | c >>> 8)
        }
        o = this._hash.words;
        var a = t[r + 0],
          h = (c = t[r + 1], t[r + 2]),
          u = t[r + 3],
          d = t[r + 4],
          p = t[r + 5],
          l = t[r + 6],
          _ = t[r + 7],
          y = t[r + 8],
          v = t[r + 9],
          g = t[r + 10],
          B = t[r + 11],
          x = t[r + 12],
          k = t[r + 13],
          m = t[r + 14],
          S = t[r + 15],
          w = e(w = o[0], M = o[1], C = o[2], z = o[3], a, 7, f[0]),
          z = e(z, w, M, C, c, 12, f[1]),
          C = e(C, z, w, M, h, 17, f[2]),
          M = e(M, C, z, w, u, 22, f[3]);
        w = e(w, M, C, z, d, 7, f[4]), z = e(z, w, M, C, p, 12, f[5]), C = e(C, z, w, M, l, 17, f[6]), M = e(M, C, z, w, _, 22, f[7]), w = e(w, M, C, z, y, 7, f[8]), z = e(z, w, M, C, v, 12, f[9]), C = e(C, z, w, M, g, 17, f[10]), M = e(M, C, z, w, B, 22, f[11]), w = e(w, M, C, z, x, 7, f[12]), z = e(z, w, M, C, k, 12, f[13]), C = e(C, z, w, M, m, 17, f[14]), w = i(w, M = e(M, C, z, w, S, 22, f[15]), C, z, c, 5, f[16]), z = i(z, w, M, C, l, 9, f[17]), C = i(C, z, w, M, B, 14, f[18]), M = i(M, C, z, w, a, 20, f[19]), w = i(w, M, C, z, p, 5, f[20]), z = i(z, w, M, C, g, 9, f[21]), C = i(C, z, w, M, S, 14, f[22]), M = i(M, C, z, w, d, 20, f[23]), w = i(w, M, C, z, v, 5, f[24]), z = i(z, w, M, C, m, 9, f[25]), C = i(C, z, w, M, u, 14, f[26]), M = i(M, C, z, w, y, 20, f[27]), w = i(w, M, C, z, k, 5, f[28]), z = i(z, w, M, C, h, 9, f[29]), C = i(C, z, w, M, _, 14, f[30]), w = n(w, M = i(M, C, z, w, x, 20, f[31]), C, z, p, 4, f[32]), z = n(z, w, M, C, y, 11, f[33]), C = n(C, z, w, M, B, 16, f[34]), M = n(M, C, z, w, m, 23, f[35]), w = n(w, M, C, z, c, 4, f[36]), z = n(z, w, M, C, d, 11, f[37]), C = n(C, z, w, M, _, 16, f[38]), M = n(M, C, z, w, g, 23, f[39]), w = n(w, M, C, z, k, 4, f[40]), z = n(z, w, M, C, a, 11, f[41]), C = n(C, z, w, M, u, 16, f[42]), M = n(M, C, z, w, l, 23, f[43]), w = n(w, M, C, z, v, 4, f[44]), z = n(z, w, M, C, x, 11, f[45]), C = n(C, z, w, M, S, 16, f[46]), w = s(w, M = n(M, C, z, w, h, 23, f[47]), C, z, a, 6, f[48]), z = s(z, w, M, C, _, 10, f[49]), C = s(C, z, w, M, m, 15, f[50]), M = s(M, C, z, w, p, 21, f[51]), w = s(w, M, C, z, x, 6, f[52]), z = s(z, w, M, C, u, 10, f[53]), C = s(C, z, w, M, g, 15, f[54]), M = s(M, C, z, w, c, 21, f[55]), w = s(w, M, C, z, y, 6, f[56]), z = s(z, w, M, C, S, 10, f[57]), C = s(C, z, w, M, l, 15, f[58]), M = s(M, C, z, w, k, 21, f[59]), w = s(w, M, C, z, d, 6, f[60]), z = s(z, w, M, C, B, 10, f[61]), C = s(C, z, w, M, h, 15, f[62]), M = s(M, C, z, w, v, 21, f[63]);
        o[0] = o[0] + w | 0, o[1] = o[1] + M | 0, o[2] = o[2] + C | 0, o[3] = o[3] + z | 0
      },
      _doFinalize: function() {
        var e = this._data,
          r = e.words,
          i = 8 * this._nDataBytes,
          n = 8 * e.sigBytes;
        r[n >>> 5] |= 128 << 24 - n % 32;
        var s = t.floor(i / 4294967296);
        for (r[15 + (n + 64 >>> 9 << 4)] = 16711935 & (s << 8 | s >>> 24) | 4278255360 & (s << 24 | s >>> 8), r[14 + (n + 64 >>> 9 << 4)] = 16711935 & (i << 8 | i >>> 24) | 4278255360 & (i << 24 | i >>> 8), e.sigBytes = 4 * (r.length + 1), this._process(), r = (e = this._hash).words, i = 0; 4 > i; i++) n = r[i], r[i] = 16711935 & (n << 8 | n >>> 24) | 4278255360 & (n << 24 | n >>> 8);
        return e
      },
      clone: function() {
        var t = a.clone.call(this);
        return t._hash = this._hash.clone(), t
      }
    }), o.MD5 = a._createHelper(h), o.HmacMD5 = a._createHmacHelper(h)
  }(Math),
  function() {
    var t, e = r,
      i = (t = e.lib).Base,
      n = t.WordArray,
      s = (t = e.algo).EvpKDF = i.extend({
        cfg: i.extend({
          keySize: 4,
          hasher: t.MD5,
          iterations: 1
        }),
        init: function(t) {
          this.cfg = this.cfg.extend(t)
        },
        compute: function(t, e) {
          for (var r = (c = this.cfg).hasher.create(), i = n.create(), s = i.words, o = c.keySize, c = c.iterations; s.length < o;) {
            a && r.update(a);
            var a = r.update(t).finalize(e);
            r.reset();
            for (var h = 1; h < c; h++) a = r.finalize(a), r.reset();
            i.concat(a)
          }
          return i.sigBytes = 4 * o, i
        }
      });
    e.EvpKDF = function(t, e, r) {
      return s.create(r).compute(t, e)
    }
  }(), r.lib.Cipher || function(t) {
    var e = (l = r).lib,
      i = e.Base,
      n = e.WordArray,
      s = e.BufferedBlockAlgorithm,
      o = l.enc.Base64,
      c = l.algo.EvpKDF,
      a = e.Cipher = s.extend({
        cfg: i.extend(),
        createEncryptor: function(t, e) {
          return this.create(this._ENC_XFORM_MODE, t, e)
        },
        createDecryptor: function(t, e) {
          return this.create(this._DEC_XFORM_MODE, t, e)
        },
        init: function(t, e, r) {
          this.cfg = this.cfg.extend(r), this._xformMode = t, this._key = e, this.reset()
        },
        reset: function() {
          s.reset.call(this), this._doReset()
        },
        process: function(t) {
          return this._append(t), this._process()
        },
        finalize: function(t) {
          return t && this._append(t), this._doFinalize()
        },
        keySize: 4,
        ivSize: 4,
        _ENC_XFORM_MODE: 1,
        _DEC_XFORM_MODE: 2,
        _createHelper: function(t) {
          return {
            encrypt: function(e, r, i) {
              return ("string" == typeof r ? _ : p).encrypt(t, e, r, i)
            },
            decrypt: function(e, r, i) {
              return ("string" == typeof r ? _ : p).decrypt(t, e, r, i)
            }
          }
        }
      });
    e.StreamCipher = a.extend({
      _doFinalize: function() {
        return this._process(!0)
      },
      blockSize: 1
    });
    var h = l.mode = {},
      f = function(t, e, r) {
        var i = this._iv;
        i ? this._iv = void 0 : i = this._prevBlock;
        for (var n = 0; n < r; n++) t[e + n] ^= i[n]
      },
      u = (e.BlockCipherMode = i.extend({
        createEncryptor: function(t, e) {
          return this.Encryptor.create(t, e)
        },
        createDecryptor: function(t, e) {
          return this.Decryptor.create(t, e)
        },
        init: function(t, e) {
          this._cipher = t, this._iv = e
        }
      })).extend();
    u.Encryptor = u.extend({
      processBlock: function(t, e) {
        var r = this._cipher,
          i = r.blockSize;
        f.call(this, t, e, i), r.encryptBlock(t, e), this._prevBlock = t.slice(e, e + i)
      }
    }), u.Decryptor = u.extend({
      processBlock: function(t, e) {
        var r = this._cipher,
          i = r.blockSize,
          n = t.slice(e, e + i);
        r.decryptBlock(t, e), f.call(this, t, e, i), this._prevBlock = n
      }
    }), h = h.CBC = u, u = (l.pad = {}).Pkcs7 = {
      pad: function(t, e) {
        for (var r, i = (r = (r = 4 * e) - t.sigBytes % r) << 24 | r << 16 | r << 8 | r, s = [], o = 0; o < r; o += 4) s.push(i);
        r = n.create(s, r), t.concat(r)
      },
      unpad: function(t) {
        t.sigBytes -= 255 & t.words[t.sigBytes - 1 >>> 2]
      }
    }, e.BlockCipher = a.extend({
      cfg: a.cfg.extend({
        mode: h,
        padding: u
      }),
      reset: function() {
        a.reset.call(this);
        var t = (e = this.cfg).iv,
          e = e.mode;
        if (this._xformMode == this._ENC_XFORM_MODE) var r = e.createEncryptor;
        else r = e.createDecryptor, this._minBufferSize = 1;
        this._mode = r.call(e, this, t && t.words)
      },
      _doProcessBlock: function(t, e) {
        this._mode.processBlock(t, e)
      },
      _doFinalize: function() {
        var t = this.cfg.padding;
        if (this._xformMode == this._ENC_XFORM_MODE) {
          t.pad(this._data, this.blockSize);
          var e = this._process(!0)
        } else e = this._process(!0), t.unpad(e);
        return e
      },
      blockSize: 4
    });
    var d = e.CipherParams = i.extend({
        init: function(t) {
          this.mixIn(t)
        },
        toString: function(t) {
          return (t || this.formatter).stringify(this)
        }
      }),
      p = (h = (l.format = {}).OpenSSL = {
        stringify: function(t) {
          var e = t.ciphertext;
          return ((t = t.salt) ? n.create([1398893684, 1701076831]).concat(t).concat(e) : e).toString(o)
        },
        parse: function(t) {
          var e = (t = o.parse(t)).words;
          if (1398893684 == e[0] && 1701076831 == e[1]) {
            var r = n.create(e.slice(2, 4));
            e.splice(0, 4), t.sigBytes -= 16
          }
          return d.create({
            ciphertext: t,
            salt: r
          })
        }
      }, e.SerializableCipher = i.extend({
        cfg: i.extend({
          format: h
        }),
        encrypt: function(t, e, r, i) {
          i = this.cfg.extend(i);
          var n = t.createEncryptor(r, i);
          return e = n.finalize(e), n = n.cfg, d.create({
            ciphertext: e,
            key: r,
            iv: n.iv,
            algorithm: t,
            mode: n.mode,
            padding: n.padding,
            blockSize: t.blockSize,
            formatter: i.format
          })
        },
        decrypt: function(t, e, r, i) {
          return i = this.cfg.extend(i), e = this._parse(e, i.format), t.createDecryptor(r, i).finalize(e.ciphertext)
        },
        _parse: function(t, e) {
          return "string" == typeof t ? e.parse(t, this) : t
        }
      })),
      l = (l.kdf = {}).OpenSSL = {
        execute: function(t, e, r, i) {
          return i || (i = n.random(8)), t = c.create({
            keySize: e + r
          }).compute(t, i), r = n.create(t.words.slice(e), 4 * r), t.sigBytes = 4 * e, d.create({
            key: t,
            iv: r,
            salt: i
          })
        }
      },
      _ = e.PasswordBasedCipher = p.extend({
        cfg: p.cfg.extend({
          kdf: l
        }),
        encrypt: function(t, e, r, i) {
          return r = (i = this.cfg.extend(i)).kdf.execute(r, t.keySize, t.ivSize), i.iv = r.iv, (t = p.encrypt.call(this, t, e, r.key, i)).mixIn(r), t
        },
        decrypt: function(t, e, r, i) {
          return i = this.cfg.extend(i), e = this._parse(e, i.format), r = i.kdf.execute(r, t.keySize, t.ivSize, e.salt), i.iv = r.iv, p.decrypt.call(this, t, e, r.key, i)
        }
      })
  }(),
  function() {
    for (var t = r, e = t.lib.BlockCipher, i = t.algo, n = [], s = [], o = [], c = [], a = [], h = [], f = [], u = [], d = [], p = [], l = [], _ = 0; 256 > _; _++) l[_] = 128 > _ ? _ << 1 : _ << 1 ^ 283;
    var y = 0,
      v = 0;
    for (_ = 0; 256 > _; _++) {
      var g = (g = v ^ v << 1 ^ v << 2 ^ v << 3 ^ v << 4) >>> 8 ^ 255 & g ^ 99;
      n[y] = g, s[g] = y;
      var B = l[y],
        x = l[B],
        k = l[x],
        m = 257 * l[g] ^ 16843008 * g;
      o[y] = m << 24 | m >>> 8, c[y] = m << 16 | m >>> 16, a[y] = m << 8 | m >>> 24, h[y] = m, m = 16843009 * k ^ 65537 * x ^ 257 * B ^ 16843008 * y, f[g] = m << 24 | m >>> 8, u[g] = m << 16 | m >>> 16, d[g] = m << 8 | m >>> 24, p[g] = m, y ? (y = B ^ l[l[l[k ^ B]]], v ^= l[l[v]]) : y = v = 1
    }
    var S = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54];
    i = i.AES = e.extend({
      _doReset: function() {
        for (var t = (r = this._key).words, e = r.sigBytes / 4, r = 4 * ((this._nRounds = e + 6) + 1), i = this._keySchedule = [], s = 0; s < r; s++)
          if (s < e) i[s] = t[s];
          else {
            var o = i[s - 1];
            s % e ? 6 < e && 4 == s % e && (o = n[o >>> 24] << 24 | n[o >>> 16 & 255] << 16 | n[o >>> 8 & 255] << 8 | n[255 & o]) : (o = n[(o = o << 8 | o >>> 24) >>> 24] << 24 | n[o >>> 16 & 255] << 16 | n[o >>> 8 & 255] << 8 | n[255 & o], o ^= S[s / e | 0] << 24), i[s] = i[s - e] ^ o
          } for (t = this._invKeySchedule = [], e = 0; e < r; e++) s = r - e, o = e % 4 ? i[s] : i[s - 4], t[e] = 4 > e || 4 >= s ? o : f[n[o >>> 24]] ^ u[n[o >>> 16 & 255]] ^ d[n[o >>> 8 & 255]] ^ p[n[255 & o]]
      },
      encryptBlock: function(t, e) {
        this._doCryptBlock(t, e, this._keySchedule, o, c, a, h, n)
      },
      decryptBlock: function(t, e) {
        var r = t[e + 1];
        t[e + 1] = t[e + 3], t[e + 3] = r, this._doCryptBlock(t, e, this._invKeySchedule, f, u, d, p, s), r = t[e + 1], t[e + 1] = t[e + 3], t[e + 3] = r
      },
      _doCryptBlock: function(t, e, r, i, n, s, o, c) {
        for (var a = this._nRounds, h = t[e] ^ r[0], f = t[e + 1] ^ r[1], u = t[e + 2] ^ r[2], d = t[e + 3] ^ r[3], p = 4, l = 1; l < a; l++) {
          var _ = i[h >>> 24] ^ n[f >>> 16 & 255] ^ s[u >>> 8 & 255] ^ o[255 & d] ^ r[p++],
            y = i[f >>> 24] ^ n[u >>> 16 & 255] ^ s[d >>> 8 & 255] ^ o[255 & h] ^ r[p++],
            v = i[u >>> 24] ^ n[d >>> 16 & 255] ^ s[h >>> 8 & 255] ^ o[255 & f] ^ r[p++];
          d = i[d >>> 24] ^ n[h >>> 16 & 255] ^ s[f >>> 8 & 255] ^ o[255 & u] ^ r[p++], h = _, f = y, u = v
        }
        _ = (c[h >>> 24] << 24 | c[f >>> 16 & 255] << 16 | c[u >>> 8 & 255] << 8 | c[255 & d]) ^ r[p++], y = (c[f >>> 24] << 24 | c[u >>> 16 & 255] << 16 | c[d >>> 8 & 255] << 8 | c[255 & h]) ^ r[p++], v = (c[u >>> 24] << 24 | c[d >>> 16 & 255] << 16 | c[h >>> 8 & 255] << 8 | c[255 & f]) ^ r[p++], d = (c[d >>> 24] << 24 | c[h >>> 16 & 255] << 16 | c[f >>> 8 & 255] << 8 | c[255 & u]) ^ r[p++], t[e] = _, t[e + 1] = y, t[e + 2] = v, t[e + 3] = d
      },
      keySize: 8
    });
    t.AES = e._createHelper(i)
  }(),
  function(t) {
    for (var e = r, i = (s = e.lib).WordArray, n = s.Hasher, s = e.algo, o = [], c = [], a = function(t) {
        return 4294967296 * (t - (0 | t)) | 0
      }, h = 2, f = 0; 64 > f;) {
      var u;
      t: {
        u = h;
        for (var d = t.sqrt(u), p = 2; p <= d; p++)
          if (!(u % p)) {
            u = !1;
            break t
          } u = !0
      }
      u && (8 > f && (o[f] = a(t.pow(h, .5))), c[f] = a(t.pow(h, 1 / 3)), f++), h++
    }
    var l = [];
    s = s.SHA256 = n.extend({
      _doReset: function() {
        this._hash = new i.init(o.slice(0))
      },
      _doProcessBlock: function(t, e) {
        for (var r = this._hash.words, i = r[0], n = r[1], s = r[2], o = r[3], a = r[4], h = r[5], f = r[6], u = r[7], d = 0; 64 > d; d++) {
          if (16 > d) l[d] = 0 | t[e + d];
          else {
            var p = l[d - 15],
              _ = l[d - 2];
            l[d] = ((p << 25 | p >>> 7) ^ (p << 14 | p >>> 18) ^ p >>> 3) + l[d - 7] + ((_ << 15 | _ >>> 17) ^ (_ << 13 | _ >>> 19) ^ _ >>> 10) + l[d - 16]
          }
          p = u + ((a << 26 | a >>> 6) ^ (a << 21 | a >>> 11) ^ (a << 7 | a >>> 25)) + (a & h ^ ~a & f) + c[d] + l[d], _ = ((i << 30 | i >>> 2) ^ (i << 19 | i >>> 13) ^ (i << 10 | i >>> 22)) + (i & n ^ i & s ^ n & s), u = f, f = h, h = a, a = o + p | 0, o = s, s = n, n = i, i = p + _ | 0
        }
        r[0] = r[0] + i | 0, r[1] = r[1] + n | 0, r[2] = r[2] + s | 0, r[3] = r[3] + o | 0, r[4] = r[4] + a | 0, r[5] = r[5] + h | 0, r[6] = r[6] + f | 0, r[7] = r[7] + u | 0
      },
      _doFinalize: function() {
        var e = this._data,
          r = e.words,
          i = 8 * this._nDataBytes,
          n = 8 * e.sigBytes;
        return r[n >>> 5] |= 128 << 24 - n % 32, r[14 + (n + 64 >>> 9 << 4)] = t.floor(i / 4294967296), r[15 + (n + 64 >>> 9 << 4)] = i, e.sigBytes = 4 * r.length, this._process(), this._hash
      },
      clone: function() {
        var t = n.clone.call(this);
        return t._hash = this._hash.clone(), t
      }
    });
    e.SHA256 = n._createHelper(s), e.HmacSHA256 = n._createHmacHelper(s)
  }(Math);
var i = r;
exports.default = i;
},{}],66:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.customAnimation = exports.TweenAnimation = void 0;
var e, n = (e = require("./tween")) && e.__esModule ? e : {
  default: e
};
var t = -1,
  o = t - 1,
  i = {},
  r = {};
exports.customAnimation = r, r.to = function(e, n, o) {
  n *= 1e3;
  o.delay;
  for (var i in o)
    if ("delay" === i);
    else if ("onComplete" === i || "onEnded" === i);
  else if ("ease" === i);
  else if ("name" === i);
  else if (o.delay || 0 !== n) {
    var r = ++t;
    setTimeout(function(t) {
      return function() {
        a(e[t], o[t], n, o.ease || "Linear", (function(n, i, r) {
          r && o.onEnded && o.onEnded(), void 0 !== n && (e[t] = n), i && o.onComplete && o.onComplete()
        }), o.name, r)
      }
    }(i), 1e3 * (o.delay || 0))
  } else e[i] = o[i], o.onComplete && o.onComplete(), o.onEnded && o.onEnded()
};
var a = function(e, r, a, l, s, u, f) {
  f = f || ++t;
  u && (i[u] || (i[u] = []), i[u].push(f));
  var c = function(e) {
      return "function" == typeof e
    },
    d = function(e) {
      return "number" == typeof e
    },
    m = function(e) {
      return "string" == typeof e
    },
    p = function(e) {
      return "[object Array]" == Object.prototype.toString.call(e)
    },
    v = function(e) {
      if (d(e)) return e;
      if (m(e)) {
        if (/\d+m?s$/.test(e)) return /ms/.test(e) ? 1 * e.replace("ms", "") : 1e3 * e.replace("s", "");
        if (/^\d+$/.test(e)) return +e
      }
      return -1
    };
  d(e) && d(r) || p(e) && p(r) || window.console && console.error("from和to两个参数必须且为数值");
  var g = !1;
  p(e) && p(r) && (g = !0);
  var w = n.default;
  if (!w) return window.console && console.error("缓动算法函数缺失"), 0;
  var y = {
      duration: 300,
      easing: "Linear",
      callback: function() {}
    },
    A = function(e) {
      c(e) ? y.callback = e : -1 != v(e) ? y.duration = v(e) : m(e) && (y.easing = e)
    };
  A(a), A(l), A(s), window.requestAnimationFrame || (requestAnimationFrame = function(e) {
    setTimeout(e, 17)
  });
  var b = -1,
    h = Math.ceil(y.duration / 17);
  y.easing = y.easing.slice(0, 1).toUpperCase() + y.easing.slice(1);
  var k, x = y.easing.split(".");
  if (1 == x.length ? k = w[x[0]] : 2 == x.length && (k = w[x[0]] && w[x[0]][x[1]]), 0 != c(k)) {
    var C = Date.now(),
      q = Date.now();
    ! function n() {
      var t = Date.now(),
        a = t - q,
        l = Math.ceil(1e3 / a);
      if (q = t, a > 100) requestAnimationFrame(n);
      else {
        if (l >= 30) b++;
        else {
          var s = Math.floor((t - C) / 17);
          b = s > b ? s : b + 1
        }
        var c;
        if (g) {
          c = [];
          for (var d = 0, m = e.length; d < m; ++d) c.push(k(b, e[d], r[d] - e[d], h))
        } else c = k(b, e, r - e, h);
        if (b <= h && f > o) {
          if (u && i[u] && i[u].indexOf(f) < 0) return;
          y.callback(c), requestAnimationFrame(n)
        } else if (b > h && f > o) {
          if (u && i[u] && i[u].indexOf(f) < 0) return;
          y.callback(r, !0, !0)
        } else y.callback(void 0, !1, !0)
      }
    }()
  } else console.error('没有找到th为"' + y.easing + '"的动画算法')
};
exports.TweenAnimation = a, a.kill = function(e) {
  i[e] = []
}, a.killAll = function() {
  for (var e in o = t, i) i[e] = []
};
},{"./tween":71}],67:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = exports.MueEvent = exports.EventCenter = void 0;
var e = require("../../../@babel/runtime/helpers/createForOfIteratorHelper"),
  t = require("../../../@babel/runtime/helpers/classCallCheck"),
  n = require("../../../@babel/runtime/helpers/createClass"),
  r = function() {
    function e(n) {
      t(this, e), this.type = n, this.defaultPrevented = !1, this.timeStamp = Date.now()
    }
    return n(e, [{
      key: "preventDefault",
      value: function() {
        this.defaultPrevented = !0
      }
    }]), e
  }();
exports.MueEvent = r;
var i = function() {
  function i() {
    t(this, i), console.log("!!! EventCenter constructor"), this.listener = {}
  }
  return n(i, [{
    key: "emit",
    value: function(e) {
      for (var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++) n[r - 1] = arguments[r];
      this._emit.apply(this, [!1, e].concat(n))
    }
  }, {
    key: "emitSync",
    value: function(e) {
      for (var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++) n[r - 1] = arguments[r];
      this._emit.apply(this, [!0, e].concat(n))
    }
  }, {
    key: "_emit",
    value: function(t, n) {
      for (var i = this, s = arguments.length, l = new Array(s > 2 ? s - 2 : 0), a = 2; a < s; a++) l[a - 2] = arguments[a];
      if ("CHECK_GAME" != n && "SEND_CHECK_GAME" != n && "SEND_REALTIME_MSG_TO_CTRL" != n && "SEND_REALTIME_MSG" != n && console.log("触发事件", n), this.listener[n]) {
        var o = new r(n),
          u = function() {
            for (var t in i.listener[n]) {
              var r, s = e(i.listener[n][t]);
              try {
                for (s.s(); !(r = s.n()).done;) {
                  var a = r.value;
                  a.call.apply(a, [a, o].concat(l))
                }
              } catch (e) {
                s.e(e)
              } finally {
                s.f()
              }
            }
            i.listener[n].one = []
          };
        t ? u.call(this) : this._async(u)
      }
    }
  }, {
    key: "on",
    value: function(e, t) {
      this._addListener(e, "on", t)
    }
  }, {
    key: "one",
    value: function(e, t) {
      this._addListener(e, "one", t)
    }
  }, {
    key: "off",
    value: function(e, t) {
      var n = this;
      this.listener[e] && this._async((function() {
        if (t) {
          var r = t.toString();
          for (var i in n.listener[e])
            for (var s = 0; !(s >= n.listener[e][i].length);) r === n.listener[e][i][s].toString() && (n.listener[e][i].splice(s, 1), s--), s++
        } else n.listener[e] = {
          on: [],
          one: []
        }, delete n.listener[e]
      }))
    }
  }, {
    key: "_addListener",
    value: function(e, t, n) {
      this.listener[e] || (this.listener[e] = {
        on: [],
        one: []
      }), this.listener[e][t].push(n)
    }
  }, {
    key: "_async",
    value: function(e) {
      var t = this;
      setTimeout((function() {
        e.call(t)
      }), 0)
    }
  }]), i
}();
exports.EventCenter = i;
var s = new i;
exports.default = s;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../../@babel/runtime/helpers/createForOfIteratorHelper":9}],68:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/createForOfIteratorHelper"),
  r = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  s = {
    global: {
      normal: 21,
      high: 22,
      low: 23
    },
    single: {
      normal: 24,
      high: 0,
      low: 25
    },
    rank: {
      normal: 26,
      high: 0,
      low: 27
    }
  },
  i = function() {
    function i() {
      r(this, i)
    }
    return t(i, null, [{
      key: "add",
      value: function(e, r) {
        var t = s[e];
        t ? r && (r >= 120 ? t.high && i.report([{
          sid: t.high,
          time: 100 * r
        }]) : (i.report([{
          sid: t.normal,
          time: 100 * r
        }]), r <= 30 && t.low && i.report([{
          sid: t.low,
          time: 100 * r
        }]))) : console.warn("No FPS sid for", e)
      }
    }, {
      key: "report",
      value: function(r) {
        var t, s = {
            pid: 415,
            speeds: []
          },
          i = e(r);
        try {
          for (i.s(); !(t = i.n()).done;) {
            var n = t.value;
            s.speeds.push(n.sid + "_" + n.time)
          }
        } catch (e) {
          i.e(e)
        } finally {
          i.f()
        }
        s.speeds = s.speeds.join(";"), wx.request({
          url: "https://badjs.weixinbridge.com/frontend/reportspeed",
          method: "GET",
          data: s
        })
      }
    }]), i
  }(),
  n = function() {
    function e() {
      r(this, e), this.avg = 0, this.pre = 0, this.count = 0
    }
    return t(e, [{
      key: "add",
      value: function(e) {
        this.avg = 1 * ((this.pre * this.count + e) / (this.count + 1)).toFixed(2), this.pre = e, this.count++
      }
    }, {
      key: "get",
      value: function() {
        return this.avg
      }
    }]), e
  }(),
  a = new(function() {
    function e() {
      r(this, e), this.performance = wx.getPerformance(), this.preFrameTime = 0, this.frame = 0, this.fps = 0, this.isStarted = !1, this.scenes = {}, window.requestAnimationFrame(this.loop)
    }
    return t(e, [{
      key: "startScenes",
      value: function(e, r) {
        var t = a;
        r || (r = .05), Math.random() <= r && (t.scenes[e] = new n, t.isStarted = !0)
      }
    }, {
      key: "stopScenes",
      value: function(e) {
        var r = a;
        if (r.scenes[e]) {
          var t = r.scenes[e].get();
          console.debug("Avg fps:", e, t), i.add(e, t), delete r.scenes[e], 0 === Object.keys(r.scenes).length && (r.isStarted = !1, r.reset())
        }
      }
    }, {
      key: "stopAll",
      value: function() {
        var e = a;
        for (var r in e.scenes) e.stopScenes(r)
      }
    }, {
      key: "reset",
      value: function() {
        var e = a;
        e.preFrameTime = 0, e.frame = 0, e.fps = 0
      }
    }, {
      key: "loop",
      value: function() {
        var e = a;
        if (e.preFrameTime) {
          if (e.isStarted) {
            e.frame++;
            var r = Date.now(),
              t = r - e.preFrameTime;
            if (t >= 1e3)
              for (var s in e.fps = 1 * (e.frame / (t / 1e3)).toFixed(2), e.frame = 0, e.preFrameTime = r, e.scenes) e.scenes[s].add(e.fps)
          }
        } else e.preFrameTime = Date.now();
        window.requestAnimationFrame(e.loop)
      }
    }]), e
  }()),
  o = a;
exports.default = o;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../../@babel/runtime/helpers/createForOfIteratorHelper":9}],69:[function(require,module,exports){
module.exports = function(r, t) {
  for (var e = r[0], n = r[1], o = !1, u = 0, l = t.length - 1; u < t.length; l = u++) {
    var s = t[u][0],
      a = t[u][1],
      c = t[l][0],
      f = t[l][1];
    a > n != f > n && e < (c - s) * (n - a) / (f - a) + s && (o = !o)
  }
  return o
};
},{}],70:[function(require,module,exports){
var t = require("../../@babel/runtime/helpers/typeof");
! function(e, i) {
  "object" == ("undefined" == typeof exports ? "undefined" : t(exports)) && "undefined" != typeof module ? i(exports) : "function" == typeof define && define.amd ? define(["exports"], i) : i(e.THREE = e.THREE || {})
}(void 0, (function(e) {
  function i() {}
  void 0 === Number.EPSILON && (Number.EPSILON = Math.pow(2, -52)), void 0 === Number.isInteger && (Number.isInteger = function(t) {
    return "number" == typeof t && isFinite(t) && Math.floor(t) === t
  }), void 0 === Math.sign && (Math.sign = function(t) {
    return t < 0 ? -1 : t > 0 ? 1 : +t
  }), "name" in Function.prototype == 0 && Object.defineProperty(Function.prototype, "name", {
    get: function() {
      return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]
    }
  }), void 0 === Object.assign && (Object.assign = function(t) {
    if (null == t) throw new TypeError("Cannot convert undefined or null to object");
    for (var e = Object(t), i = 1; i < arguments.length; i++) {
      var n = arguments[i];
      if (null != n)
        for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r])
    }
    return e
  }), Object.assign(i.prototype, {
    addEventListener: function(t, e) {
      void 0 === this._listeners && (this._listeners = {});
      var i = this._listeners;
      void 0 === i[t] && (i[t] = []), -1 === i[t].indexOf(e) && i[t].push(e)
    },
    hasEventListener: function(t, e) {
      if (void 0 === this._listeners) return !1;
      var i = this._listeners;
      return void 0 !== i[t] && -1 !== i[t].indexOf(e)
    },
    removeEventListener: function(t, e) {
      if (void 0 !== this._listeners) {
        var i = this._listeners[t];
        if (void 0 !== i) {
          var n = i.indexOf(e); - 1 !== n && i.splice(n, 1)
        }
      }
    },
    dispatchEvent: function(t) {
      if (void 0 !== this._listeners) {
        var e = this._listeners[t.type];
        if (void 0 !== e) {
          t.target = this;
          for (var i = e.slice(0), n = 0, r = i.length; n < r; n++) i[n].call(this, t)
        }
      }
    }
  });
  var n, r, a, o, s, c, h, l, u, p, d, f, m, g = "88dev",
    v = 1e3,
    y = 1001,
    x = 1002,
    b = 1003,
    _ = 1006,
    w = 1008,
    M = 1012,
    E = 1015,
    T = 1020,
    S = 1022,
    A = 1023,
    R = 1026,
    L = 1027,
    P = 2400,
    C = 3e3,
    I = {
      DEG2RAD: Math.PI / 180,
      RAD2DEG: 180 / Math.PI,
      generateUUID: (r = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""), a = new Array(36), o = 0, function() {
        for (var t = 0; t < 36; t++) 8 === t || 13 === t || 18 === t || 23 === t ? a[t] = "-" : 14 === t ? a[t] = "4" : (o <= 2 && (o = 33554432 + 16777216 * Math.random() | 0), n = 15 & o, o >>= 4, a[t] = r[19 === t ? 3 & n | 8 : n]);
        return a.join("")
      }),
      clamp: function(t, e, i) {
        return Math.max(e, Math.min(i, t))
      },
      euclideanModulo: function(t, e) {
        return (t % e + e) % e
      },
      mapLinear: function(t, e, i, n, r) {
        return n + (t - e) * (r - n) / (i - e)
      },
      lerp: function(t, e, i) {
        return (1 - i) * t + i * e
      },
      smoothstep: function(t, e, i) {
        return t <= e ? 0 : t >= i ? 1 : (t = (t - e) / (i - e)) * t * (3 - 2 * t)
      },
      smootherstep: function(t, e, i) {
        return t <= e ? 0 : t >= i ? 1 : (t = (t - e) / (i - e)) * t * t * (t * (6 * t - 15) + 10)
      },
      randInt: function(t, e) {
        return t + Math.floor(Math.random() * (e - t + 1))
      },
      randFloat: function(t, e) {
        return t + Math.random() * (e - t)
      },
      randFloatSpread: function(t) {
        return t * (.5 - Math.random())
      },
      degToRad: function(t) {
        return t * I.DEG2RAD
      },
      radToDeg: function(t) {
        return t * I.RAD2DEG
      },
      isPowerOfTwo: function(t) {
        return 0 == (t & t - 1) && 0 !== t
      },
      ceilPowerOfTwo: function(t) {
        return Math.pow(2, Math.ceil(Math.log(t) / Math.LN2))
      },
      floorPowerOfTwo: function(t) {
        return Math.pow(2, Math.floor(Math.log(t) / Math.LN2))
      }
    };

  function U(t, e) {
    this.x = t || 0, this.y = e || 0
  }

  function D() {
    this.elements = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], arguments.length > 0 && console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")
  }

  function O(t, e, i, n) {
    this._x = t || 0, this._y = e || 0, this._z = i || 0, this._w = void 0 !== n ? n : 1
  }

  function N(t, e, i) {
    this.x = t || 0, this.y = e || 0, this.z = i || 0
  }

  function B() {
    this.elements = [1, 0, 0, 0, 1, 0, 0, 0, 1], arguments.length > 0 && console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")
  }
  Object.defineProperties(U.prototype, {
    width: {
      get: function() {
        return this.x
      },
      set: function(t) {
        this.x = t
      }
    },
    height: {
      get: function() {
        return this.y
      },
      set: function(t) {
        this.y = t
      }
    }
  }), Object.assign(U.prototype, {
    isVector2: !0,
    set: function(t, e) {
      return this.x = t, this.y = e, this
    },
    setScalar: function(t) {
      return this.x = t, this.y = t, this
    },
    setX: function(t) {
      return this.x = t, this
    },
    setY: function(t) {
      return this.y = t, this
    },
    setComponent: function(t, e) {
      switch (t) {
        case 0:
          this.x = e;
          break;
        case 1:
          this.y = e;
          break;
        default:
          throw new Error("index is out of range: " + t)
      }
      return this
    },
    getComponent: function(t) {
      switch (t) {
        case 0:
          return this.x;
        case 1:
          return this.y;
        default:
          throw new Error("index is out of range: " + t)
      }
    },
    clone: function() {
      return new this.constructor(this.x, this.y)
    },
    copy: function(t) {
      return this.x = t.x, this.y = t.y, this
    },
    add: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(t, e)) : (this.x += t.x, this.y += t.y, this)
    },
    addScalar: function(t) {
      return this.x += t, this.y += t, this
    },
    addVectors: function(t, e) {
      return this.x = t.x + e.x, this.y = t.y + e.y, this
    },
    addScaledVector: function(t, e) {
      return this.x += t.x * e, this.y += t.y * e, this
    },
    sub: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(t, e)) : (this.x -= t.x, this.y -= t.y, this)
    },
    subScalar: function(t) {
      return this.x -= t, this.y -= t, this
    },
    subVectors: function(t, e) {
      return this.x = t.x - e.x, this.y = t.y - e.y, this
    },
    multiply: function(t) {
      return this.x *= t.x, this.y *= t.y, this
    },
    multiplyScalar: function(t) {
      return this.x *= t, this.y *= t, this
    },
    divide: function(t) {
      return this.x /= t.x, this.y /= t.y, this
    },
    divideScalar: function(t) {
      return this.multiplyScalar(1 / t)
    },
    applyMatrix3: function(t) {
      var e = this.x,
        i = this.y,
        n = t.elements;
      return this.x = n[0] * e + n[3] * i + n[6], this.y = n[1] * e + n[4] * i + n[7], this
    },
    min: function(t) {
      return this.x = Math.min(this.x, t.x), this.y = Math.min(this.y, t.y), this
    },
    max: function(t) {
      return this.x = Math.max(this.x, t.x), this.y = Math.max(this.y, t.y), this
    },
    clamp: function(t, e) {
      return this.x = Math.max(t.x, Math.min(e.x, this.x)), this.y = Math.max(t.y, Math.min(e.y, this.y)), this
    },
    clampScalar: (s = new U, c = new U, function(t, e) {
      return s.set(t, t), c.set(e, e), this.clamp(s, c)
    }),
    clampLength: function(t, e) {
      var i = this.length();
      return this.divideScalar(i || 1).multiplyScalar(Math.max(t, Math.min(e, i)))
    },
    floor: function() {
      return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
    },
    ceil: function() {
      return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this
    },
    round: function() {
      return this.x = Math.round(this.x), this.y = Math.round(this.y), this
    },
    roundToZero: function() {
      return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this
    },
    negate: function() {
      return this.x = -this.x, this.y = -this.y, this
    },
    dot: function(t) {
      return this.x * t.x + this.y * t.y
    },
    lengthSq: function() {
      return this.x * this.x + this.y * this.y
    },
    length: function() {
      return Math.sqrt(this.x * this.x + this.y * this.y)
    },
    manhattanLength: function() {
      return Math.abs(this.x) + Math.abs(this.y)
    },
    normalize: function() {
      return this.divideScalar(this.length() || 1)
    },
    angle: function() {
      var t = Math.atan2(this.y, this.x);
      return t < 0 && (t += 2 * Math.PI), t
    },
    distanceTo: function(t) {
      return Math.sqrt(this.distanceToSquared(t))
    },
    distanceToSquared: function(t) {
      var e = this.x - t.x,
        i = this.y - t.y;
      return e * e + i * i
    },
    manhattanDistanceTo: function(t) {
      return Math.abs(this.x - t.x) + Math.abs(this.y - t.y)
    },
    setLength: function(t) {
      return this.normalize().multiplyScalar(t)
    },
    lerp: function(t, e) {
      return this.x += (t.x - this.x) * e, this.y += (t.y - this.y) * e, this
    },
    lerpVectors: function(t, e, i) {
      return this.subVectors(e, t).multiplyScalar(i).add(t)
    },
    equals: function(t) {
      return t.x === this.x && t.y === this.y
    },
    fromArray: function(t, e) {
      return void 0 === e && (e = 0), this.x = t[e], this.y = t[e + 1], this
    },
    toArray: function(t, e) {
      return void 0 === t && (t = []), void 0 === e && (e = 0), t[e] = this.x, t[e + 1] = this.y, t
    },
    fromBufferAttribute: function(t, e, i) {
      return void 0 !== i && console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."), this.x = t.getX(e), this.y = t.getY(e), this
    },
    rotateAround: function(t, e) {
      var i = Math.cos(e),
        n = Math.sin(e),
        r = this.x - t.x,
        a = this.y - t.y;
      return this.x = r * i - a * n + t.x, this.y = r * n + a * i + t.y, this
    }
  }), Object.assign(D.prototype, {
    isMatrix4: !0,
    set: function(t, e, i, n, r, a, o, s, c, h, l, u, p, d, f, m) {
      var g = this.elements;
      return g[0] = t, g[4] = e, g[8] = i, g[12] = n, g[1] = r, g[5] = a, g[9] = o, g[13] = s, g[2] = c, g[6] = h, g[10] = l, g[14] = u, g[3] = p, g[7] = d, g[11] = f, g[15] = m, this
    },
    identity: function() {
      return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
    },
    clone: function() {
      return (new D).fromArray(this.elements)
    },
    copy: function(t) {
      var e = this.elements,
        i = t.elements;
      return e[0] = i[0], e[1] = i[1], e[2] = i[2], e[3] = i[3], e[4] = i[4], e[5] = i[5], e[6] = i[6], e[7] = i[7], e[8] = i[8], e[9] = i[9], e[10] = i[10], e[11] = i[11], e[12] = i[12], e[13] = i[13], e[14] = i[14], e[15] = i[15], this
    },
    copyPosition: function(t) {
      var e = this.elements,
        i = t.elements;
      return e[12] = i[12], e[13] = i[13], e[14] = i[14], this
    },
    extractBasis: function(t, e, i) {
      return t.setFromMatrixColumn(this, 0), e.setFromMatrixColumn(this, 1), i.setFromMatrixColumn(this, 2), this
    },
    makeBasis: function(t, e, i) {
      return this.set(t.x, e.x, i.x, 0, t.y, e.y, i.y, 0, t.z, e.z, i.z, 0, 0, 0, 0, 1), this
    },
    extractRotation: (f = new N, function(t) {
      var e = this.elements,
        i = t.elements,
        n = 1 / f.setFromMatrixColumn(t, 0).length(),
        r = 1 / f.setFromMatrixColumn(t, 1).length(),
        a = 1 / f.setFromMatrixColumn(t, 2).length();
      return e[0] = i[0] * n, e[1] = i[1] * n, e[2] = i[2] * n, e[4] = i[4] * r, e[5] = i[5] * r, e[6] = i[6] * r, e[8] = i[8] * a, e[9] = i[9] * a, e[10] = i[10] * a, this
    }),
    makeRotationFromEuler: function(t) {
      t && t.isEuler || console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
      var e = this.elements,
        i = t.x,
        n = t.y,
        r = t.z,
        a = Math.cos(i),
        o = Math.sin(i),
        s = Math.cos(n),
        c = Math.sin(n),
        h = Math.cos(r),
        l = Math.sin(r);
      if ("XYZ" === t.order) {
        var u = a * h,
          p = a * l,
          d = o * h,
          f = o * l;
        e[0] = s * h, e[4] = -s * l, e[8] = c, e[1] = p + d * c, e[5] = u - f * c, e[9] = -o * s, e[2] = f - u * c, e[6] = d + p * c, e[10] = a * s
      } else if ("YXZ" === t.order) {
        var m = s * h,
          g = s * l,
          v = c * h,
          y = c * l;
        e[0] = m + y * o, e[4] = v * o - g, e[8] = a * c, e[1] = a * l, e[5] = a * h, e[9] = -o, e[2] = g * o - v, e[6] = y + m * o, e[10] = a * s
      } else if ("ZXY" === t.order) m = s * h, g = s * l, v = c * h, y = c * l, e[0] = m - y * o, e[4] = -a * l, e[8] = v + g * o, e[1] = g + v * o, e[5] = a * h, e[9] = y - m * o, e[2] = -a * c, e[6] = o, e[10] = a * s;
      else if ("ZYX" === t.order) u = a * h, p = a * l, d = o * h, f = o * l, e[0] = s * h, e[4] = d * c - p, e[8] = u * c + f, e[1] = s * l, e[5] = f * c + u, e[9] = p * c - d, e[2] = -c, e[6] = o * s, e[10] = a * s;
      else if ("YZX" === t.order) {
        var x = a * s,
          b = a * c,
          _ = o * s,
          w = o * c;
        e[0] = s * h, e[4] = w - x * l, e[8] = _ * l + b, e[1] = l, e[5] = a * h, e[9] = -o * h, e[2] = -c * h, e[6] = b * l + _, e[10] = x - w * l
      } else "XZY" === t.order && (x = a * s, b = a * c, _ = o * s, w = o * c, e[0] = s * h, e[4] = -l, e[8] = c * h, e[1] = x * l + w, e[5] = a * h, e[9] = b * l - _, e[2] = _ * l - b, e[6] = o * h, e[10] = w * l + x);
      return e[3] = 0, e[7] = 0, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, this
    },
    makeRotationFromQuaternion: function(t) {
      var e = this.elements,
        i = t._x,
        n = t._y,
        r = t._z,
        a = t._w,
        o = i + i,
        s = n + n,
        c = r + r,
        h = i * o,
        l = i * s,
        u = i * c,
        p = n * s,
        d = n * c,
        f = r * c,
        m = a * o,
        g = a * s,
        v = a * c;
      return e[0] = 1 - (p + f), e[4] = l - v, e[8] = u + g, e[1] = l + v, e[5] = 1 - (h + f), e[9] = d - m, e[2] = u - g, e[6] = d + m, e[10] = 1 - (h + p), e[3] = 0, e[7] = 0, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, this
    },
    lookAt: (u = new N, p = new N, d = new N, function(t, e, i) {
      var n = this.elements;
      return d.subVectors(t, e), 0 === d.lengthSq() && (d.z = 1), d.normalize(), u.crossVectors(i, d), 0 === u.lengthSq() && (1 === Math.abs(i.z) ? d.x += 1e-4 : d.z += 1e-4, d.normalize(), u.crossVectors(i, d)), u.normalize(), p.crossVectors(d, u), n[0] = u.x, n[4] = p.x, n[8] = d.x, n[1] = u.y, n[5] = p.y, n[9] = d.y, n[2] = u.z, n[6] = p.z, n[10] = d.z, this
    }),
    multiply: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."), this.multiplyMatrices(t, e)) : this.multiplyMatrices(this, t)
    },
    premultiply: function(t) {
      return this.multiplyMatrices(t, this)
    },
    multiplyMatrices: function(t, e) {
      var i = t.elements,
        n = e.elements,
        r = this.elements,
        a = i[0],
        o = i[4],
        s = i[8],
        c = i[12],
        h = i[1],
        l = i[5],
        u = i[9],
        p = i[13],
        d = i[2],
        f = i[6],
        m = i[10],
        g = i[14],
        v = i[3],
        y = i[7],
        x = i[11],
        b = i[15],
        _ = n[0],
        w = n[4],
        M = n[8],
        E = n[12],
        T = n[1],
        S = n[5],
        A = n[9],
        R = n[13],
        L = n[2],
        P = n[6],
        C = n[10],
        I = n[14],
        U = n[3],
        D = n[7],
        O = n[11],
        N = n[15];
      return r[0] = a * _ + o * T + s * L + c * U, r[4] = a * w + o * S + s * P + c * D, r[8] = a * M + o * A + s * C + c * O, r[12] = a * E + o * R + s * I + c * N, r[1] = h * _ + l * T + u * L + p * U, r[5] = h * w + l * S + u * P + p * D, r[9] = h * M + l * A + u * C + p * O, r[13] = h * E + l * R + u * I + p * N, r[2] = d * _ + f * T + m * L + g * U, r[6] = d * w + f * S + m * P + g * D, r[10] = d * M + f * A + m * C + g * O, r[14] = d * E + f * R + m * I + g * N, r[3] = v * _ + y * T + x * L + b * U, r[7] = v * w + y * S + x * P + b * D, r[11] = v * M + y * A + x * C + b * O, r[15] = v * E + y * R + x * I + b * N, this
    },
    multiplyScalar: function(t) {
      var e = this.elements;
      return e[0] *= t, e[4] *= t, e[8] *= t, e[12] *= t, e[1] *= t, e[5] *= t, e[9] *= t, e[13] *= t, e[2] *= t, e[6] *= t, e[10] *= t, e[14] *= t, e[3] *= t, e[7] *= t, e[11] *= t, e[15] *= t, this
    },
    applyToBufferAttribute: function() {
      var t = new N;
      return function(e) {
        for (var i = 0, n = e.count; i < n; i++) t.x = e.getX(i), t.y = e.getY(i), t.z = e.getZ(i), t.applyMatrix4(this), e.setXYZ(i, t.x, t.y, t.z);
        return e
      }
    }(),
    determinant: function() {
      var t = this.elements,
        e = t[0],
        i = t[4],
        n = t[8],
        r = t[12],
        a = t[1],
        o = t[5],
        s = t[9],
        c = t[13],
        h = t[2],
        l = t[6],
        u = t[10],
        p = t[14];
      return t[3] * (+r * s * l - n * c * l - r * o * u + i * c * u + n * o * p - i * s * p) + t[7] * (+e * s * p - e * c * u + r * a * u - n * a * p + n * c * h - r * s * h) + t[11] * (+e * c * l - e * o * p - r * a * l + i * a * p + r * o * h - i * c * h) + t[15] * (-n * o * h - e * s * l + e * o * u + n * a * l - i * a * u + i * s * h)
    },
    transpose: function() {
      var t, e = this.elements;
      return t = e[1], e[1] = e[4], e[4] = t, t = e[2], e[2] = e[8], e[8] = t, t = e[6], e[6] = e[9], e[9] = t, t = e[3], e[3] = e[12], e[12] = t, t = e[7], e[7] = e[13], e[13] = t, t = e[11], e[11] = e[14], e[14] = t, this
    },
    setPosition: function(t) {
      var e = this.elements;
      return e[12] = t.x, e[13] = t.y, e[14] = t.z, this
    },
    getInverse: function(t, e) {
      var i = this.elements,
        n = t.elements,
        r = n[0],
        a = n[1],
        o = n[2],
        s = n[3],
        c = n[4],
        h = n[5],
        l = n[6],
        u = n[7],
        p = n[8],
        d = n[9],
        f = n[10],
        m = n[11],
        g = n[12],
        v = n[13],
        y = n[14],
        x = n[15],
        b = d * y * u - v * f * u + v * l * m - h * y * m - d * l * x + h * f * x,
        _ = g * f * u - p * y * u - g * l * m + c * y * m + p * l * x - c * f * x,
        w = p * v * u - g * d * u + g * h * m - c * v * m - p * h * x + c * d * x,
        M = g * d * l - p * v * l - g * h * f + c * v * f + p * h * y - c * d * y,
        E = r * b + a * _ + o * w + s * M;
      if (0 === E) {
        var T = "THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";
        if (!0 === e) throw new Error(T);
        return console.warn(T), this.identity()
      }
      var S = 1 / E;
      return i[0] = b * S, i[1] = (v * f * s - d * y * s - v * o * m + a * y * m + d * o * x - a * f * x) * S, i[2] = (h * y * s - v * l * s + v * o * u - a * y * u - h * o * x + a * l * x) * S, i[3] = (d * l * s - h * f * s - d * o * u + a * f * u + h * o * m - a * l * m) * S, i[4] = _ * S, i[5] = (p * y * s - g * f * s + g * o * m - r * y * m - p * o * x + r * f * x) * S, i[6] = (g * l * s - c * y * s - g * o * u + r * y * u + c * o * x - r * l * x) * S, i[7] = (c * f * s - p * l * s + p * o * u - r * f * u - c * o * m + r * l * m) * S, i[8] = w * S, i[9] = (g * d * s - p * v * s - g * a * m + r * v * m + p * a * x - r * d * x) * S, i[10] = (c * v * s - g * h * s + g * a * u - r * v * u - c * a * x + r * h * x) * S, i[11] = (p * h * s - c * d * s - p * a * u + r * d * u + c * a * m - r * h * m) * S, i[12] = M * S, i[13] = (p * v * o - g * d * o + g * a * f - r * v * f - p * a * y + r * d * y) * S, i[14] = (g * h * o - c * v * o - g * a * l + r * v * l + c * a * y - r * h * y) * S, i[15] = (c * d * o - p * h * o + p * a * l - r * d * l - c * a * f + r * h * f) * S, this
    },
    scale: function(t) {
      var e = this.elements,
        i = t.x,
        n = t.y,
        r = t.z;
      return e[0] *= i, e[4] *= n, e[8] *= r, e[1] *= i, e[5] *= n, e[9] *= r, e[2] *= i, e[6] *= n, e[10] *= r, e[3] *= i, e[7] *= n, e[11] *= r, this
    },
    getMaxScaleOnAxis: function() {
      var t = this.elements,
        e = t[0] * t[0] + t[1] * t[1] + t[2] * t[2],
        i = t[4] * t[4] + t[5] * t[5] + t[6] * t[6],
        n = t[8] * t[8] + t[9] * t[9] + t[10] * t[10];
      return Math.sqrt(Math.max(e, i, n))
    },
    makeTranslation: function(t, e, i) {
      return this.set(1, 0, 0, t, 0, 1, 0, e, 0, 0, 1, i, 0, 0, 0, 1), this
    },
    makeRotationX: function(t) {
      var e = Math.cos(t),
        i = Math.sin(t);
      return this.set(1, 0, 0, 0, 0, e, -i, 0, 0, i, e, 0, 0, 0, 0, 1), this
    },
    makeRotationY: function(t) {
      var e = Math.cos(t),
        i = Math.sin(t);
      return this.set(e, 0, i, 0, 0, 1, 0, 0, -i, 0, e, 0, 0, 0, 0, 1), this
    },
    makeRotationZ: function(t) {
      var e = Math.cos(t),
        i = Math.sin(t);
      return this.set(e, -i, 0, 0, i, e, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
    },
    makeRotationAxis: function(t, e) {
      var i = Math.cos(e),
        n = Math.sin(e),
        r = 1 - i,
        a = t.x,
        o = t.y,
        s = t.z,
        c = r * a,
        h = r * o;
      return this.set(c * a + i, c * o - n * s, c * s + n * o, 0, c * o + n * s, h * o + i, h * s - n * a, 0, c * s - n * o, h * s + n * a, r * s * s + i, 0, 0, 0, 0, 1), this
    },
    makeScale: function(t, e, i) {
      return this.set(t, 0, 0, 0, 0, e, 0, 0, 0, 0, i, 0, 0, 0, 0, 1), this
    },
    makeShear: function(t, e, i) {
      return this.set(1, e, i, 0, t, 1, i, 0, t, e, 1, 0, 0, 0, 0, 1), this
    },
    compose: function(t, e, i) {
      return this.makeRotationFromQuaternion(e), this.scale(i), this.setPosition(t), this
    },
    decompose: (h = new N, l = new D, function(t, e, i) {
      var n = this.elements,
        r = h.set(n[0], n[1], n[2]).length(),
        a = h.set(n[4], n[5], n[6]).length(),
        o = h.set(n[8], n[9], n[10]).length();
      this.determinant() < 0 && (r = -r), t.x = n[12], t.y = n[13], t.z = n[14], l.copy(this);
      var s = 1 / r,
        c = 1 / a,
        u = 1 / o;
      return l.elements[0] *= s, l.elements[1] *= s, l.elements[2] *= s, l.elements[4] *= c, l.elements[5] *= c, l.elements[6] *= c, l.elements[8] *= u, l.elements[9] *= u, l.elements[10] *= u, e.setFromRotationMatrix(l), i.x = r, i.y = a, i.z = o, this
    }),
    makePerspective: function(t, e, i, n, r, a) {
      void 0 === a && console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
      var o = this.elements,
        s = 2 * r / (e - t),
        c = 2 * r / (i - n),
        h = (e + t) / (e - t),
        l = (i + n) / (i - n),
        u = -(a + r) / (a - r),
        p = -2 * a * r / (a - r);
      return o[0] = s, o[4] = 0, o[8] = h, o[12] = 0, o[1] = 0, o[5] = c, o[9] = l, o[13] = 0, o[2] = 0, o[6] = 0, o[10] = u, o[14] = p, o[3] = 0, o[7] = 0, o[11] = -1, o[15] = 0, this
    },
    makeOrthographic: function(t, e, i, n, r, a) {
      var o = this.elements,
        s = 1 / (e - t),
        c = 1 / (i - n),
        h = 1 / (a - r),
        l = (e + t) * s,
        u = (i + n) * c,
        p = (a + r) * h;
      return o[0] = 2 * s, o[4] = 0, o[8] = 0, o[12] = -l, o[1] = 0, o[5] = 2 * c, o[9] = 0, o[13] = -u, o[2] = 0, o[6] = 0, o[10] = -2 * h, o[14] = -p, o[3] = 0, o[7] = 0, o[11] = 0, o[15] = 1, this
    },
    equals: function(t) {
      for (var e = this.elements, i = t.elements, n = 0; n < 16; n++)
        if (e[n] !== i[n]) return !1;
      return !0
    },
    fromArray: function(t, e) {
      void 0 === e && (e = 0);
      for (var i = 0; i < 16; i++) this.elements[i] = t[i + e];
      return this
    },
    toArray: function(t, e) {
      void 0 === t && (t = []), void 0 === e && (e = 0);
      var i = this.elements;
      return t[e] = i[0], t[e + 1] = i[1], t[e + 2] = i[2], t[e + 3] = i[3], t[e + 4] = i[4], t[e + 5] = i[5], t[e + 6] = i[6], t[e + 7] = i[7], t[e + 8] = i[8], t[e + 9] = i[9], t[e + 10] = i[10], t[e + 11] = i[11], t[e + 12] = i[12], t[e + 13] = i[13], t[e + 14] = i[14], t[e + 15] = i[15], t
    }
  }), Object.assign(O, {
    slerp: function(t, e, i, n) {
      return i.copy(t).slerp(e, n)
    },
    slerpFlat: function(t, e, i, n, r, a, o) {
      var s = i[n + 0],
        c = i[n + 1],
        h = i[n + 2],
        l = i[n + 3],
        u = r[a + 0],
        p = r[a + 1],
        d = r[a + 2],
        f = r[a + 3];
      if (l !== f || s !== u || c !== p || h !== d) {
        var m = 1 - o,
          g = s * u + c * p + h * d + l * f,
          v = g >= 0 ? 1 : -1,
          y = 1 - g * g;
        if (y > Number.EPSILON) {
          var x = Math.sqrt(y),
            b = Math.atan2(x, g * v);
          m = Math.sin(m * b) / x, o = Math.sin(o * b) / x
        }
        var _ = o * v;
        if (s = s * m + u * _, c = c * m + p * _, h = h * m + d * _, l = l * m + f * _, m === 1 - o) {
          var w = 1 / Math.sqrt(s * s + c * c + h * h + l * l);
          s *= w, c *= w, h *= w, l *= w
        }
      }
      t[e] = s, t[e + 1] = c, t[e + 2] = h, t[e + 3] = l
    }
  }), Object.defineProperties(O.prototype, {
    x: {
      get: function() {
        return this._x
      },
      set: function(t) {
        this._x = t, this.onChangeCallback()
      }
    },
    y: {
      get: function() {
        return this._y
      },
      set: function(t) {
        this._y = t, this.onChangeCallback()
      }
    },
    z: {
      get: function() {
        return this._z
      },
      set: function(t) {
        this._z = t, this.onChangeCallback()
      }
    },
    w: {
      get: function() {
        return this._w
      },
      set: function(t) {
        this._w = t, this.onChangeCallback()
      }
    }
  }), Object.assign(O.prototype, {
    set: function(t, e, i, n) {
      return this._x = t, this._y = e, this._z = i, this._w = n, this.onChangeCallback(), this
    },
    clone: function() {
      return new this.constructor(this._x, this._y, this._z, this._w)
    },
    copy: function(t) {
      return this._x = t.x, this._y = t.y, this._z = t.z, this._w = t.w, this.onChangeCallback(), this
    },
    setFromEuler: function(t, e) {
      if (!t || !t.isEuler) throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
      var i = t._x,
        n = t._y,
        r = t._z,
        a = t.order,
        o = Math.cos,
        s = Math.sin,
        c = o(i / 2),
        h = o(n / 2),
        l = o(r / 2),
        u = s(i / 2),
        p = s(n / 2),
        d = s(r / 2);
      return "XYZ" === a ? (this._x = u * h * l + c * p * d, this._y = c * p * l - u * h * d, this._z = c * h * d + u * p * l, this._w = c * h * l - u * p * d) : "YXZ" === a ? (this._x = u * h * l + c * p * d, this._y = c * p * l - u * h * d, this._z = c * h * d - u * p * l, this._w = c * h * l + u * p * d) : "ZXY" === a ? (this._x = u * h * l - c * p * d, this._y = c * p * l + u * h * d, this._z = c * h * d + u * p * l, this._w = c * h * l - u * p * d) : "ZYX" === a ? (this._x = u * h * l - c * p * d, this._y = c * p * l + u * h * d, this._z = c * h * d - u * p * l, this._w = c * h * l + u * p * d) : "YZX" === a ? (this._x = u * h * l + c * p * d, this._y = c * p * l + u * h * d, this._z = c * h * d - u * p * l, this._w = c * h * l - u * p * d) : "XZY" === a && (this._x = u * h * l - c * p * d, this._y = c * p * l - u * h * d, this._z = c * h * d + u * p * l, this._w = c * h * l + u * p * d), !1 !== e && this.onChangeCallback(), this
    },
    setFromAxisAngle: function(t, e) {
      var i = e / 2,
        n = Math.sin(i);
      return this._x = t.x * n, this._y = t.y * n, this._z = t.z * n, this._w = Math.cos(i), this.onChangeCallback(), this
    },
    setFromRotationMatrix: function(t) {
      var e, i = t.elements,
        n = i[0],
        r = i[4],
        a = i[8],
        o = i[1],
        s = i[5],
        c = i[9],
        h = i[2],
        l = i[6],
        u = i[10],
        p = n + s + u;
      return p > 0 ? (e = .5 / Math.sqrt(p + 1), this._w = .25 / e, this._x = (l - c) * e, this._y = (a - h) * e, this._z = (o - r) * e) : n > s && n > u ? (e = 2 * Math.sqrt(1 + n - s - u), this._w = (l - c) / e, this._x = .25 * e, this._y = (r + o) / e, this._z = (a + h) / e) : s > u ? (e = 2 * Math.sqrt(1 + s - n - u), this._w = (a - h) / e, this._x = (r + o) / e, this._y = .25 * e, this._z = (c + l) / e) : (e = 2 * Math.sqrt(1 + u - n - s), this._w = (o - r) / e, this._x = (a + h) / e, this._y = (c + l) / e, this._z = .25 * e), this.onChangeCallback(), this
    },
    setFromUnitVectors: function() {
      var t, e = new N;
      return function(i, n) {
        return void 0 === e && (e = new N), (t = i.dot(n) + 1) < 1e-6 ? (t = 0, Math.abs(i.x) > Math.abs(i.z) ? e.set(-i.y, i.x, 0) : e.set(0, -i.z, i.y)) : e.crossVectors(i, n), this._x = e.x, this._y = e.y, this._z = e.z, this._w = t, this.normalize()
      }
    }(),
    inverse: function() {
      return this.conjugate().normalize()
    },
    conjugate: function() {
      return this._x *= -1, this._y *= -1, this._z *= -1, this.onChangeCallback(), this
    },
    dot: function(t) {
      return this._x * t._x + this._y * t._y + this._z * t._z + this._w * t._w
    },
    lengthSq: function() {
      return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w
    },
    length: function() {
      return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w)
    },
    normalize: function() {
      var t = this.length();
      return 0 === t ? (this._x = 0, this._y = 0, this._z = 0, this._w = 1) : (t = 1 / t, this._x = this._x * t, this._y = this._y * t, this._z = this._z * t, this._w = this._w * t), this.onChangeCallback(), this
    },
    multiply: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."), this.multiplyQuaternions(t, e)) : this.multiplyQuaternions(this, t)
    },
    premultiply: function(t) {
      return this.multiplyQuaternions(t, this)
    },
    multiplyQuaternions: function(t, e) {
      var i = t._x,
        n = t._y,
        r = t._z,
        a = t._w,
        o = e._x,
        s = e._y,
        c = e._z,
        h = e._w;
      return this._x = i * h + a * o + n * c - r * s, this._y = n * h + a * s + r * o - i * c, this._z = r * h + a * c + i * s - n * o, this._w = a * h - i * o - n * s - r * c, this.onChangeCallback(), this
    },
    slerp: function(t, e) {
      if (0 === e) return this;
      if (1 === e) return this.copy(t);
      var i = this._x,
        n = this._y,
        r = this._z,
        a = this._w,
        o = a * t._w + i * t._x + n * t._y + r * t._z;
      if (o < 0 ? (this._w = -t._w, this._x = -t._x, this._y = -t._y, this._z = -t._z, o = -o) : this.copy(t), o >= 1) return this._w = a, this._x = i, this._y = n, this._z = r, this;
      var s = Math.sqrt(1 - o * o);
      if (Math.abs(s) < .001) return this._w = .5 * (a + this._w), this._x = .5 * (i + this._x), this._y = .5 * (n + this._y), this._z = .5 * (r + this._z), this;
      var c = Math.atan2(s, o),
        h = Math.sin((1 - e) * c) / s,
        l = Math.sin(e * c) / s;
      return this._w = a * h + this._w * l, this._x = i * h + this._x * l, this._y = n * h + this._y * l, this._z = r * h + this._z * l, this.onChangeCallback(), this
    },
    equals: function(t) {
      return t._x === this._x && t._y === this._y && t._z === this._z && t._w === this._w
    },
    fromArray: function(t, e) {
      return void 0 === e && (e = 0), this._x = t[e], this._y = t[e + 1], this._z = t[e + 2], this._w = t[e + 3], this.onChangeCallback(), this
    },
    toArray: function(t, e) {
      return void 0 === t && (t = []), void 0 === e && (e = 0), t[e] = this._x, t[e + 1] = this._y, t[e + 2] = this._z, t[e + 3] = this._w, t
    },
    onChange: function(t) {
      return this.onChangeCallback = t, this
    },
    onChangeCallback: function() {}
  }), Object.assign(N.prototype, {
    isVector3: !0,
    set: function(t, e, i) {
      return this.x = t, this.y = e, this.z = i, this
    },
    setScalar: function(t) {
      return this.x = t, this.y = t, this.z = t, this
    },
    setX: function(t) {
      return this.x = t, this
    },
    setY: function(t) {
      return this.y = t, this
    },
    setZ: function(t) {
      return this.z = t, this
    },
    setComponent: function(t, e) {
      switch (t) {
        case 0:
          this.x = e;
          break;
        case 1:
          this.y = e;
          break;
        case 2:
          this.z = e;
          break;
        default:
          throw new Error("index is out of range: " + t)
      }
      return this
    },
    getComponent: function(t) {
      switch (t) {
        case 0:
          return this.x;
        case 1:
          return this.y;
        case 2:
          return this.z;
        default:
          throw new Error("index is out of range: " + t)
      }
    },
    clone: function() {
      return new this.constructor(this.x, this.y, this.z)
    },
    copy: function(t) {
      return this.x = t.x, this.y = t.y, this.z = t.z, this
    },
    add: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(t, e)) : (this.x += t.x, this.y += t.y, this.z += t.z, this)
    },
    addScalar: function(t) {
      return this.x += t, this.y += t, this.z += t, this
    },
    addVectors: function(t, e) {
      return this.x = t.x + e.x, this.y = t.y + e.y, this.z = t.z + e.z, this
    },
    addScaledVector: function(t, e) {
      return this.x += t.x * e, this.y += t.y * e, this.z += t.z * e, this
    },
    sub: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(t, e)) : (this.x -= t.x, this.y -= t.y, this.z -= t.z, this)
    },
    subScalar: function(t) {
      return this.x -= t, this.y -= t, this.z -= t, this
    },
    subVectors: function(t, e) {
      return this.x = t.x - e.x, this.y = t.y - e.y, this.z = t.z - e.z, this
    },
    multiply: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."), this.multiplyVectors(t, e)) : (this.x *= t.x, this.y *= t.y, this.z *= t.z, this)
    },
    multiplyScalar: function(t) {
      return this.x *= t, this.y *= t, this.z *= t, this
    },
    multiplyVectors: function(t, e) {
      return this.x = t.x * e.x, this.y = t.y * e.y, this.z = t.z * e.z, this
    },
    applyEuler: (m = new O, function(t) {
      return t && t.isEuler || console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."), this.applyQuaternion(m.setFromEuler(t))
    }),
    applyAxisAngle: function() {
      var t = new O;
      return function(e, i) {
        return this.applyQuaternion(t.setFromAxisAngle(e, i))
      }
    }(),
    applyMatrix3: function(t) {
      var e = this.x,
        i = this.y,
        n = this.z,
        r = t.elements;
      return this.x = r[0] * e + r[3] * i + r[6] * n, this.y = r[1] * e + r[4] * i + r[7] * n, this.z = r[2] * e + r[5] * i + r[8] * n, this
    },
    applyMatrix4: function(t) {
      var e = this.x,
        i = this.y,
        n = this.z,
        r = t.elements,
        a = 1 / (r[3] * e + r[7] * i + r[11] * n + r[15]);
      return this.x = (r[0] * e + r[4] * i + r[8] * n + r[12]) * a, this.y = (r[1] * e + r[5] * i + r[9] * n + r[13]) * a, this.z = (r[2] * e + r[6] * i + r[10] * n + r[14]) * a, this
    },
    applyQuaternion: function(t) {
      var e = this.x,
        i = this.y,
        n = this.z,
        r = t.x,
        a = t.y,
        o = t.z,
        s = t.w,
        c = s * e + a * n - o * i,
        h = s * i + o * e - r * n,
        l = s * n + r * i - a * e,
        u = -r * e - a * i - o * n;
      return this.x = c * s + u * -r + h * -o - l * -a, this.y = h * s + u * -a + l * -r - c * -o, this.z = l * s + u * -o + c * -a - h * -r, this
    },
    project: function() {
      var t = new D;
      return function(e) {
        return t.multiplyMatrices(e.projectionMatrix, t.getInverse(e.matrixWorld)), this.applyMatrix4(t)
      }
    }(),
    unproject: function() {
      var t = new D;
      return function(e) {
        return t.multiplyMatrices(e.matrixWorld, t.getInverse(e.projectionMatrix)), this.applyMatrix4(t)
      }
    }(),
    transformDirection: function(t) {
      var e = this.x,
        i = this.y,
        n = this.z,
        r = t.elements;
      return this.x = r[0] * e + r[4] * i + r[8] * n, this.y = r[1] * e + r[5] * i + r[9] * n, this.z = r[2] * e + r[6] * i + r[10] * n, this.normalize()
    },
    divide: function(t) {
      return this.x /= t.x, this.y /= t.y, this.z /= t.z, this
    },
    divideScalar: function(t) {
      return this.multiplyScalar(1 / t)
    },
    min: function(t) {
      return this.x = Math.min(this.x, t.x), this.y = Math.min(this.y, t.y), this.z = Math.min(this.z, t.z), this
    },
    max: function(t) {
      return this.x = Math.max(this.x, t.x), this.y = Math.max(this.y, t.y), this.z = Math.max(this.z, t.z), this
    },
    clamp: function(t, e) {
      return this.x = Math.max(t.x, Math.min(e.x, this.x)), this.y = Math.max(t.y, Math.min(e.y, this.y)), this.z = Math.max(t.z, Math.min(e.z, this.z)), this
    },
    clampScalar: function() {
      var t = new N,
        e = new N;
      return function(i, n) {
        return t.set(i, i, i), e.set(n, n, n), this.clamp(t, e)
      }
    }(),
    clampLength: function(t, e) {
      var i = this.length();
      return this.divideScalar(i || 1).multiplyScalar(Math.max(t, Math.min(e, i)))
    },
    floor: function() {
      return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this
    },
    ceil: function() {
      return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this
    },
    round: function() {
      return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this
    },
    roundToZero: function() {
      return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this
    },
    negate: function() {
      return this.x = -this.x, this.y = -this.y, this.z = -this.z, this
    },
    dot: function(t) {
      return this.x * t.x + this.y * t.y + this.z * t.z
    },
    lengthSq: function() {
      return this.x * this.x + this.y * this.y + this.z * this.z
    },
    length: function() {
      return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
    },
    manhattanLength: function() {
      return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
    },
    normalize: function() {
      return this.divideScalar(this.length() || 1)
    },
    setLength: function(t) {
      return this.normalize().multiplyScalar(t)
    },
    lerp: function(t, e) {
      return this.x += (t.x - this.x) * e, this.y += (t.y - this.y) * e, this.z += (t.z - this.z) * e, this
    },
    lerpVectors: function(t, e, i) {
      return this.subVectors(e, t).multiplyScalar(i).add(t)
    },
    cross: function(t, e) {
      if (void 0 !== e) return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."), this.crossVectors(t, e);
      var i = this.x,
        n = this.y,
        r = this.z;
      return this.x = n * t.z - r * t.y, this.y = r * t.x - i * t.z, this.z = i * t.y - n * t.x, this
    },
    crossVectors: function(t, e) {
      var i = t.x,
        n = t.y,
        r = t.z,
        a = e.x,
        o = e.y,
        s = e.z;
      return this.x = n * s - r * o, this.y = r * a - i * s, this.z = i * o - n * a, this
    },
    projectOnVector: function(t) {
      var e = t.dot(this) / t.lengthSq();
      return this.copy(t).multiplyScalar(e)
    },
    projectOnPlane: function() {
      var t = new N;
      return function(e) {
        return t.copy(this).projectOnVector(e), this.sub(t)
      }
    }(),
    reflect: function() {
      var t = new N;
      return function(e) {
        return this.sub(t.copy(e).multiplyScalar(2 * this.dot(e)))
      }
    }(),
    angleTo: function(t) {
      var e = this.dot(t) / Math.sqrt(this.lengthSq() * t.lengthSq());
      return Math.acos(I.clamp(e, -1, 1))
    },
    distanceTo: function(t) {
      return Math.sqrt(this.distanceToSquared(t))
    },
    distanceToSquared: function(t) {
      var e = this.x - t.x,
        i = this.y - t.y,
        n = this.z - t.z;
      return e * e + i * i + n * n
    },
    manhattanDistanceTo: function(t) {
      return Math.abs(this.x - t.x) + Math.abs(this.y - t.y) + Math.abs(this.z - t.z)
    },
    setFromSpherical: function(t) {
      var e = Math.sin(t.phi) * t.radius;
      return this.x = e * Math.sin(t.theta), this.y = Math.cos(t.phi) * t.radius, this.z = e * Math.cos(t.theta), this
    },
    setFromCylindrical: function(t) {
      return this.x = t.radius * Math.sin(t.theta), this.y = t.y, this.z = t.radius * Math.cos(t.theta), this
    },
    setFromMatrixPosition: function(t) {
      var e = t.elements;
      return this.x = e[12], this.y = e[13], this.z = e[14], this
    },
    setFromMatrixScale: function(t) {
      var e = this.setFromMatrixColumn(t, 0).length(),
        i = this.setFromMatrixColumn(t, 1).length(),
        n = this.setFromMatrixColumn(t, 2).length();
      return this.x = e, this.y = i, this.z = n, this
    },
    setFromMatrixColumn: function(t, e) {
      return this.fromArray(t.elements, 4 * e)
    },
    equals: function(t) {
      return t.x === this.x && t.y === this.y && t.z === this.z
    },
    fromArray: function(t, e) {
      return void 0 === e && (e = 0), this.x = t[e], this.y = t[e + 1], this.z = t[e + 2], this
    },
    toArray: function(t, e) {
      return void 0 === t && (t = []), void 0 === e && (e = 0), t[e] = this.x, t[e + 1] = this.y, t[e + 2] = this.z, t
    },
    fromBufferAttribute: function(t, e, i) {
      return void 0 !== i && console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."), this.x = t.getX(e), this.y = t.getY(e), this.z = t.getZ(e), this
    }
  }), Object.assign(B.prototype, {
    isMatrix3: !0,
    set: function(t, e, i, n, r, a, o, s, c) {
      var h = this.elements;
      return h[0] = t, h[1] = n, h[2] = o, h[3] = e, h[4] = r, h[5] = s, h[6] = i, h[7] = a, h[8] = c, this
    },
    identity: function() {
      return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1), this
    },
    clone: function() {
      return (new this.constructor).fromArray(this.elements)
    },
    copy: function(t) {
      var e = this.elements,
        i = t.elements;
      return e[0] = i[0], e[1] = i[1], e[2] = i[2], e[3] = i[3], e[4] = i[4], e[5] = i[5], e[6] = i[6], e[7] = i[7], e[8] = i[8], this
    },
    setFromMatrix4: function(t) {
      var e = t.elements;
      return this.set(e[0], e[4], e[8], e[1], e[5], e[9], e[2], e[6], e[10]), this
    },
    applyToBufferAttribute: function() {
      var t = new N;
      return function(e) {
        for (var i = 0, n = e.count; i < n; i++) t.x = e.getX(i), t.y = e.getY(i), t.z = e.getZ(i), t.applyMatrix3(this), e.setXYZ(i, t.x, t.y, t.z);
        return e
      }
    }(),
    multiply: function(t) {
      return this.multiplyMatrices(this, t)
    },
    premultiply: function(t) {
      return this.multiplyMatrices(t, this)
    },
    multiplyMatrices: function(t, e) {
      var i = t.elements,
        n = e.elements,
        r = this.elements,
        a = i[0],
        o = i[3],
        s = i[6],
        c = i[1],
        h = i[4],
        l = i[7],
        u = i[2],
        p = i[5],
        d = i[8],
        f = n[0],
        m = n[3],
        g = n[6],
        v = n[1],
        y = n[4],
        x = n[7],
        b = n[2],
        _ = n[5],
        w = n[8];
      return r[0] = a * f + o * v + s * b, r[3] = a * m + o * y + s * _, r[6] = a * g + o * x + s * w, r[1] = c * f + h * v + l * b, r[4] = c * m + h * y + l * _, r[7] = c * g + h * x + l * w, r[2] = u * f + p * v + d * b, r[5] = u * m + p * y + d * _, r[8] = u * g + p * x + d * w, this
    },
    multiplyScalar: function(t) {
      var e = this.elements;
      return e[0] *= t, e[3] *= t, e[6] *= t, e[1] *= t, e[4] *= t, e[7] *= t, e[2] *= t, e[5] *= t, e[8] *= t, this
    },
    determinant: function() {
      var t = this.elements,
        e = t[0],
        i = t[1],
        n = t[2],
        r = t[3],
        a = t[4],
        o = t[5],
        s = t[6],
        c = t[7],
        h = t[8];
      return e * a * h - e * o * c - i * r * h + i * o * s + n * r * c - n * a * s
    },
    getInverse: function(t, e) {
      t && t.isMatrix4 && console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");
      var i = t.elements,
        n = this.elements,
        r = i[0],
        a = i[1],
        o = i[2],
        s = i[3],
        c = i[4],
        h = i[5],
        l = i[6],
        u = i[7],
        p = i[8],
        d = p * c - h * u,
        f = h * l - p * s,
        m = u * s - c * l,
        g = r * d + a * f + o * m;
      if (0 === g) {
        var v = "THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";
        if (!0 === e) throw new Error(v);
        return console.warn(v), this.identity()
      }
      var y = 1 / g;
      return n[0] = d * y, n[1] = (o * u - p * a) * y, n[2] = (h * a - o * c) * y, n[3] = f * y, n[4] = (p * r - o * l) * y, n[5] = (o * s - h * r) * y, n[6] = m * y, n[7] = (a * l - u * r) * y, n[8] = (c * r - a * s) * y, this
    },
    transpose: function() {
      var t, e = this.elements;
      return t = e[1], e[1] = e[3], e[3] = t, t = e[2], e[2] = e[6], e[6] = t, t = e[5], e[5] = e[7], e[7] = t, this
    },
    getNormalMatrix: function(t) {
      return this.setFromMatrix4(t).getInverse(this).transpose()
    },
    transposeIntoArray: function(t) {
      var e = this.elements;
      return t[0] = e[0], t[1] = e[3], t[2] = e[6], t[3] = e[1], t[4] = e[4], t[5] = e[7], t[6] = e[2], t[7] = e[5], t[8] = e[8], this
    },
    setUvTransform: function(t, e, i, n, r, a, o) {
      var s = Math.cos(r),
        c = Math.sin(r);
      this.set(i * s, i * c, -i * (s * a + c * o) + a + t, -n * c, n * s, -n * (-c * a + s * o) + o + e, 0, 0, 1)
    },
    scale: function(t, e) {
      var i = this.elements;
      return i[0] *= t, i[3] *= t, i[6] *= t, i[1] *= e, i[4] *= e, i[7] *= e, this
    },
    rotate: function(t) {
      var e = Math.cos(t),
        i = Math.sin(t),
        n = this.elements,
        r = n[0],
        a = n[3],
        o = n[6],
        s = n[1],
        c = n[4],
        h = n[7];
      return n[0] = e * r + i * s, n[3] = e * a + i * c, n[6] = e * o + i * h, n[1] = -i * r + e * s, n[4] = -i * a + e * c, n[7] = -i * o + e * h, this
    },
    translate: function(t, e) {
      var i = this.elements;
      return i[0] += t * i[2], i[3] += t * i[5], i[6] += t * i[8], i[1] += e * i[2], i[4] += e * i[5], i[7] += e * i[8], this
    },
    equals: function(t) {
      for (var e = this.elements, i = t.elements, n = 0; n < 9; n++)
        if (e[n] !== i[n]) return !1;
      return !0
    },
    fromArray: function(t, e) {
      void 0 === e && (e = 0);
      for (var i = 0; i < 9; i++) this.elements[i] = t[i + e];
      return this
    },
    toArray: function(t, e) {
      void 0 === t && (t = []), void 0 === e && (e = 0);
      var i = this.elements;
      return t[e] = i[0], t[e + 1] = i[1], t[e + 2] = i[2], t[e + 3] = i[3], t[e + 4] = i[4], t[e + 5] = i[5], t[e + 6] = i[6], t[e + 7] = i[7], t[e + 8] = i[8], t
    }
  });
  var F = 0;

  function z(t, e, i, n, r, a, o, s, c, h) {
    Object.defineProperty(this, "id", {
      value: F++
    }), this.uuid = I.generateUUID(), this.name = "", this.image = void 0 !== t ? t : z.DEFAULT_IMAGE, this.mipmaps = [], this.mapping = void 0 !== e ? e : z.DEFAULT_MAPPING, this.wrapS = void 0 !== i ? i : y, this.wrapT = void 0 !== n ? n : y, this.magFilter = void 0 !== r ? r : _, this.minFilter = void 0 !== a ? a : w, this.anisotropy = void 0 !== c ? c : 1, this.format = void 0 !== o ? o : A, this.type = void 0 !== s ? s : 1009, this.offset = new U(0, 0), this.repeat = new U(1, 1), this.center = new U(0, 0), this.rotation = 0, this.matrixAutoUpdate = !0, this.matrix = new B, this.generateMipmaps = !0, this.premultiplyAlpha = !1, this.flipY = !0, this.unpackAlignment = 4, this.encoding = void 0 !== h ? h : C, this.version = 0, this.onUpdate = null
  }

  function G(t, e, i, n) {
    this.x = t || 0, this.y = e || 0, this.z = i || 0, this.w = void 0 !== n ? n : 1
  }

  function H(t, e, i) {
    this.uuid = I.generateUUID(), this.width = t, this.height = e, this.scissor = new G(0, 0, t, e), this.scissorTest = !1, this.viewport = new G(0, 0, t, e), void 0 === (i = i || {}).minFilter && (i.minFilter = _), this.texture = new z(void 0, void 0, i.wrapS, i.wrapT, i.magFilter, i.minFilter, i.format, i.type, i.anisotropy, i.encoding), this.depthBuffer = void 0 === i.depthBuffer || i.depthBuffer, this.stencilBuffer = void 0 === i.stencilBuffer || i.stencilBuffer, this.depthTexture = void 0 !== i.depthTexture ? i.depthTexture : null
  }

  function V(t, e, i) {
    H.call(this, t, e, i), this.activeCubeFace = 0, this.activeMipMapLevel = 0
  }

  function k(t, e, i, n, r, a, o, s, c, h, l, u) {
    z.call(this, null, a, o, s, c, h, n, r, l, u), this.image = {
      data: t,
      width: e,
      height: i
    }, this.magFilter = void 0 !== c ? c : b, this.minFilter = void 0 !== h ? h : b, this.generateMipmaps = !1, this.flipY = !1, this.unpackAlignment = 1
  }

  function j(t, e, i, n, r, a, o, s, c, h) {
    t = void 0 !== t ? t : [], e = void 0 !== e ? e : 301, z.call(this, t, e, i, n, r, a, o, s, c, h), this.flipY = !1
  }
  z.DEFAULT_IMAGE = void 0, z.DEFAULT_MAPPING = 300, Object.defineProperty(z.prototype, "needsUpdate", {
    set: function(t) {
      !0 === t && this.version++
    }
  }), Object.assign(z.prototype, i.prototype, {
    constructor: z,
    isTexture: !0,
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.name = t.name, this.image = t.image, this.mipmaps = t.mipmaps.slice(0), this.mapping = t.mapping, this.wrapS = t.wrapS, this.wrapT = t.wrapT, this.magFilter = t.magFilter, this.minFilter = t.minFilter, this.anisotropy = t.anisotropy, this.format = t.format, this.type = t.type, this.offset.copy(t.offset), this.repeat.copy(t.repeat), this.center.copy(t.center), this.rotation = t.rotation, this.matrixAutoUpdate = t.matrixAutoUpdate, this.matrix.copy(t.matrix), this.generateMipmaps = t.generateMipmaps, this.premultiplyAlpha = t.premultiplyAlpha, this.flipY = t.flipY, this.unpackAlignment = t.unpackAlignment, this.encoding = t.encoding, this
    },
    toJSON: function(t) {
      var e = void 0 === t || "string" == typeof t;
      if (!e && void 0 !== t.textures[this.uuid]) return t.textures[this.uuid];
      var i = {
        metadata: {
          version: 4.5,
          type: "Texture",
          generator: "Texture.toJSON"
        },
        uuid: this.uuid,
        name: this.name,
        mapping: this.mapping,
        repeat: [this.repeat.x, this.repeat.y],
        offset: [this.offset.x, this.offset.y],
        center: [this.center.x, this.center.y],
        rotation: this.rotation,
        wrap: [this.wrapS, this.wrapT],
        minFilter: this.minFilter,
        magFilter: this.magFilter,
        anisotropy: this.anisotropy,
        flipY: this.flipY
      };
      if (void 0 !== this.image) {
        var n = this.image;
        void 0 === n.uuid && (n.uuid = I.generateUUID()), e || void 0 !== t.images[n.uuid] || (t.images[n.uuid] = {
          uuid: n.uuid,
          url: function(t) {
            var e;
            if (t instanceof HTMLCanvasElement) e = t;
            else {
              (e = document.createElement("canvas")).width = t.width, e.height = t.height;
              var i = e.getContext("2d");
              t instanceof ImageData ? i.putImageData(t, 0, 0) : i.drawImage(t, 0, 0, t.width, t.height)
            }
            return e.width > 2048 || e.height > 2048 ? e.toDataURL("image/jpeg", .6) : e.toDataURL("image/png")
          }(n)
        }), i.image = n.uuid
      }
      return e || (t.textures[this.uuid] = i), i
    },
    dispose: function() {
      this.dispatchEvent({
        type: "dispose"
      })
    },
    transformUv: function(t) {
      if (300 === this.mapping) {
        if (t.applyMatrix3(this.matrix), t.x < 0 || t.x > 1) switch (this.wrapS) {
          case v:
            t.x = t.x - Math.floor(t.x);
            break;
          case y:
            t.x = t.x < 0 ? 0 : 1;
            break;
          case x:
            1 === Math.abs(Math.floor(t.x) % 2) ? t.x = Math.ceil(t.x) - t.x : t.x = t.x - Math.floor(t.x)
        }
        if (t.y < 0 || t.y > 1) switch (this.wrapT) {
          case v:
            t.y = t.y - Math.floor(t.y);
            break;
          case y:
            t.y = t.y < 0 ? 0 : 1;
            break;
          case x:
            1 === Math.abs(Math.floor(t.y) % 2) ? t.y = Math.ceil(t.y) - t.y : t.y = t.y - Math.floor(t.y)
        }
        this.flipY && (t.y = 1 - t.y)
      }
    }
  }), Object.assign(G.prototype, {
    isVector4: !0,
    set: function(t, e, i, n) {
      return this.x = t, this.y = e, this.z = i, this.w = n, this
    },
    setScalar: function(t) {
      return this.x = t, this.y = t, this.z = t, this.w = t, this
    },
    setX: function(t) {
      return this.x = t, this
    },
    setY: function(t) {
      return this.y = t, this
    },
    setZ: function(t) {
      return this.z = t, this
    },
    setW: function(t) {
      return this.w = t, this
    },
    setComponent: function(t, e) {
      switch (t) {
        case 0:
          this.x = e;
          break;
        case 1:
          this.y = e;
          break;
        case 2:
          this.z = e;
          break;
        case 3:
          this.w = e;
          break;
        default:
          throw new Error("index is out of range: " + t)
      }
      return this
    },
    getComponent: function(t) {
      switch (t) {
        case 0:
          return this.x;
        case 1:
          return this.y;
        case 2:
          return this.z;
        case 3:
          return this.w;
        default:
          throw new Error("index is out of range: " + t)
      }
    },
    clone: function() {
      return new this.constructor(this.x, this.y, this.z, this.w)
    },
    copy: function(t) {
      return this.x = t.x, this.y = t.y, this.z = t.z, this.w = void 0 !== t.w ? t.w : 1, this
    },
    add: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(t, e)) : (this.x += t.x, this.y += t.y, this.z += t.z, this.w += t.w, this)
    },
    addScalar: function(t) {
      return this.x += t, this.y += t, this.z += t, this.w += t, this
    },
    addVectors: function(t, e) {
      return this.x = t.x + e.x, this.y = t.y + e.y, this.z = t.z + e.z, this.w = t.w + e.w, this
    },
    addScaledVector: function(t, e) {
      return this.x += t.x * e, this.y += t.y * e, this.z += t.z * e, this.w += t.w * e, this
    },
    sub: function(t, e) {
      return void 0 !== e ? (console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(t, e)) : (this.x -= t.x, this.y -= t.y, this.z -= t.z, this.w -= t.w, this)
    },
    subScalar: function(t) {
      return this.x -= t, this.y -= t, this.z -= t, this.w -= t, this
    },
    subVectors: function(t, e) {
      return this.x = t.x - e.x, this.y = t.y - e.y, this.z = t.z - e.z, this.w = t.w - e.w, this
    },
    multiplyScalar: function(t) {
      return this.x *= t, this.y *= t, this.z *= t, this.w *= t, this
    },
    applyMatrix4: function(t) {
      var e = this.x,
        i = this.y,
        n = this.z,
        r = this.w,
        a = t.elements;
      return this.x = a[0] * e + a[4] * i + a[8] * n + a[12] * r, this.y = a[1] * e + a[5] * i + a[9] * n + a[13] * r, this.z = a[2] * e + a[6] * i + a[10] * n + a[14] * r, this.w = a[3] * e + a[7] * i + a[11] * n + a[15] * r, this
    },
    divideScalar: function(t) {
      return this.multiplyScalar(1 / t)
    },
    setAxisAngleFromQuaternion: function(t) {
      this.w = 2 * Math.acos(t.w);
      var e = Math.sqrt(1 - t.w * t.w);
      return e < 1e-4 ? (this.x = 1, this.y = 0, this.z = 0) : (this.x = t.x / e, this.y = t.y / e, this.z = t.z / e), this
    },
    setAxisAngleFromRotationMatrix: function(t) {
      var e, i, n, r, a = t.elements,
        o = a[0],
        s = a[4],
        c = a[8],
        h = a[1],
        l = a[5],
        u = a[9],
        p = a[2],
        d = a[6],
        f = a[10];
      if (Math.abs(s - h) < .01 && Math.abs(c - p) < .01 && Math.abs(u - d) < .01) {
        if (Math.abs(s + h) < .1 && Math.abs(c + p) < .1 && Math.abs(u + d) < .1 && Math.abs(o + l + f - 3) < .1) return this.set(1, 0, 0, 0), this;
        e = Math.PI;
        var m = (o + 1) / 2,
          g = (l + 1) / 2,
          v = (f + 1) / 2,
          y = (s + h) / 4,
          x = (c + p) / 4,
          b = (u + d) / 4;
        return m > g && m > v ? m < .01 ? (i = 0, n = .707106781, r = .707106781) : (n = y / (i = Math.sqrt(m)), r = x / i) : g > v ? g < .01 ? (i = .707106781, n = 0, r = .707106781) : (i = y / (n = Math.sqrt(g)), r = b / n) : v < .01 ? (i = .707106781, n = .707106781, r = 0) : (i = x / (r = Math.sqrt(v)), n = b / r), this.set(i, n, r, e), this
      }
      var _ = Math.sqrt((d - u) * (d - u) + (c - p) * (c - p) + (h - s) * (h - s));
      return Math.abs(_) < .001 && (_ = 1), this.x = (d - u) / _, this.y = (c - p) / _, this.z = (h - s) / _, this.w = Math.acos((o + l + f - 1) / 2), this
    },
    min: function(t) {
      return this.x = Math.min(this.x, t.x), this.y = Math.min(this.y, t.y), this.z = Math.min(this.z, t.z), this.w = Math.min(this.w, t.w), this
    },
    max: function(t) {
      return this.x = Math.max(this.x, t.x), this.y = Math.max(this.y, t.y), this.z = Math.max(this.z, t.z), this.w = Math.max(this.w, t.w), this
    },
    clamp: function(t, e) {
      return this.x = Math.max(t.x, Math.min(e.x, this.x)), this.y = Math.max(t.y, Math.min(e.y, this.y)), this.z = Math.max(t.z, Math.min(e.z, this.z)), this.w = Math.max(t.w, Math.min(e.w, this.w)), this
    },
    clampScalar: function() {
      var t, e;
      return function(i, n) {
        return void 0 === t && (t = new G, e = new G), t.set(i, i, i, i), e.set(n, n, n, n), this.clamp(t, e)
      }
    }(),
    clampLength: function(t, e) {
      var i = this.length();
      return this.divideScalar(i || 1).multiplyScalar(Math.max(t, Math.min(e, i)))
    },
    floor: function() {
      return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this.w = Math.floor(this.w), this
    },
    ceil: function() {
      return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this.w = Math.ceil(this.w), this
    },
    round: function() {
      return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this.w = Math.round(this.w), this
    },
    roundToZero: function() {
      return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w), this
    },
    negate: function() {
      return this.x = -this.x, this.y = -this.y, this.z = -this.z, this.w = -this.w, this
    },
    dot: function(t) {
      return this.x * t.x + this.y * t.y + this.z * t.z + this.w * t.w
    },
    lengthSq: function() {
      return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
    },
    length: function() {
      return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
    },
    manhattanLength: function() {
      return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w)
    },
    normalize: function() {
      return this.divideScalar(this.length() || 1)
    },
    setLength: function(t) {
      return this.normalize().multiplyScalar(t)
    },
    lerp: function(t, e) {
      return this.x += (t.x - this.x) * e, this.y += (t.y - this.y) * e, this.z += (t.z - this.z) * e, this.w += (t.w - this.w) * e, this
    },
    lerpVectors: function(t, e, i) {
      return this.subVectors(e, t).multiplyScalar(i).add(t)
    },
    equals: function(t) {
      return t.x === this.x && t.y === this.y && t.z === this.z && t.w === this.w
    },
    fromArray: function(t, e) {
      return void 0 === e && (e = 0), this.x = t[e], this.y = t[e + 1], this.z = t[e + 2], this.w = t[e + 3], this
    },
    toArray: function(t, e) {
      return void 0 === t && (t = []), void 0 === e && (e = 0), t[e] = this.x, t[e + 1] = this.y, t[e + 2] = this.z, t[e + 3] = this.w, t
    },
    fromBufferAttribute: function(t, e, i) {
      return void 0 !== i && console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."), this.x = t.getX(e), this.y = t.getY(e), this.z = t.getZ(e), this.w = t.getW(e), this
    }
  }), Object.assign(H.prototype, i.prototype, {
    isWebGLRenderTarget: !0,
    setSize: function(t, e) {
      this.width === t && this.height === e || (this.width = t, this.height = e, this.dispose()), this.viewport.set(0, 0, t, e), this.scissor.set(0, 0, t, e)
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.width = t.width, this.height = t.height, this.viewport.copy(t.viewport), this.texture = t.texture.clone(), this.depthBuffer = t.depthBuffer, this.stencilBuffer = t.stencilBuffer, this.depthTexture = t.depthTexture, this
    },
    dispose: function() {
      this.dispatchEvent({
        type: "dispose"
      })
    }
  }), V.prototype = Object.create(H.prototype), V.prototype.constructor = V, V.prototype.isWebGLRenderTargetCube = !0, k.prototype = Object.create(z.prototype), k.prototype.constructor = k, k.prototype.isDataTexture = !0, j.prototype = Object.create(z.prototype), j.prototype.constructor = j, j.prototype.isCubeTexture = !0, Object.defineProperty(j.prototype, "images", {
    get: function() {
      return this.image
    },
    set: function(t) {
      this.image = t
    }
  });
  var W = new z,
    X = new j;

  function q() {
    this.seq = [], this.map = {}
  }
  var Y = [],
    Z = [],
    J = new Float32Array(16),
    Q = new Float32Array(9);

  function K(t, e, i) {
    var n = t[0];
    if (n <= 0 || n > 0) return t;
    var r = e * i,
      a = Y[r];
    if (void 0 === a && (a = new Float32Array(r), Y[r] = a), 0 !== e) {
      n.toArray(a, 0);
      for (var o = 1, s = 0; o !== e; ++o) s += i, t[o].toArray(a, s)
    }
    return a
  }

  function $(t, e) {
    var i = Z[e];
    void 0 === i && (i = new Int32Array(e), Z[e] = i);
    for (var n = 0; n !== e; ++n) i[n] = t.allocTextureUnit();
    return i
  }

  function tt(t, e) {
    t.uniform1f(this.addr, e)
  }

  function et(t, e) {
    t.uniform1i(this.addr, e)
  }

  function it(t, e) {
    void 0 === e.x ? t.uniform2fv(this.addr, e) : t.uniform2f(this.addr, e.x, e.y)
  }

  function nt(t, e) {
    void 0 !== e.x ? t.uniform3f(this.addr, e.x, e.y, e.z) : void 0 !== e.r ? t.uniform3f(this.addr, e.r, e.g, e.b) : t.uniform3fv(this.addr, e)
  }

  function rt(t, e) {
    void 0 === e.x ? t.uniform4fv(this.addr, e) : t.uniform4f(this.addr, e.x, e.y, e.z, e.w)
  }

  function at(t, e) {
    t.uniformMatrix2fv(this.addr, !1, e.elements || e)
  }

  function ot(t, e) {
    void 0 === e.elements ? t.uniformMatrix3fv(this.addr, !1, e) : (Q.set(e.elements), t.uniformMatrix3fv(this.addr, !1, Q))
  }

  function st(t, e) {
    void 0 === e.elements ? t.uniformMatrix4fv(this.addr, !1, e) : (J.set(e.elements), t.uniformMatrix4fv(this.addr, !1, J))
  }

  function ct(t, e, i) {
    var n = i.allocTextureUnit();
    t.uniform1i(this.addr, n), i.setTexture2D(e || W, n)
  }

  function ht(t, e, i) {
    var n = i.allocTextureUnit();
    t.uniform1i(this.addr, n), i.setTextureCube(e || X, n)
  }

  function lt(t, e) {
    t.uniform2iv(this.addr, e)
  }

  function ut(t, e) {
    t.uniform3iv(this.addr, e)
  }

  function pt(t, e) {
    t.uniform4iv(this.addr, e)
  }

  function dt(t, e) {
    t.uniform1fv(this.addr, e)
  }

  function ft(t, e) {
    t.uniform1iv(this.addr, e)
  }

  function mt(t, e) {
    t.uniform2fv(this.addr, K(e, this.size, 2))
  }

  function gt(t, e) {
    t.uniform3fv(this.addr, K(e, this.size, 3))
  }

  function vt(t, e) {
    t.uniform4fv(this.addr, K(e, this.size, 4))
  }

  function yt(t, e) {
    t.uniformMatrix2fv(this.addr, !1, K(e, this.size, 4))
  }

  function xt(t, e) {
    t.uniformMatrix3fv(this.addr, !1, K(e, this.size, 9))
  }

  function bt(t, e) {
    t.uniformMatrix4fv(this.addr, !1, K(e, this.size, 16))
  }

  function _t(t, e, i) {
    var n = e.length,
      r = $(i, n);
    t.uniform1iv(this.addr, r);
    for (var a = 0; a !== n; ++a) i.setTexture2D(e[a] || W, r[a])
  }

  function wt(t, e, i) {
    var n = e.length,
      r = $(i, n);
    t.uniform1iv(this.addr, r);
    for (var a = 0; a !== n; ++a) i.setTextureCube(e[a] || X, r[a])
  }

  function Mt(t, e, i) {
    this.id = t, this.addr = i, this.setValue = function(t) {
      switch (t) {
        case 5126:
          return tt;
        case 35664:
          return it;
        case 35665:
          return nt;
        case 35666:
          return rt;
        case 35674:
          return at;
        case 35675:
          return ot;
        case 35676:
          return st;
        case 35678:
        case 36198:
          return ct;
        case 35680:
          return ht;
        case 5124:
        case 35670:
          return et;
        case 35667:
        case 35671:
          return lt;
        case 35668:
        case 35672:
          return ut;
        case 35669:
        case 35673:
          return pt
      }
    }(e.type)
  }

  function Et(t, e, i) {
    this.id = t, this.addr = i, this.size = e.size, this.setValue = function(t) {
      switch (t) {
        case 5126:
          return dt;
        case 35664:
          return mt;
        case 35665:
          return gt;
        case 35666:
          return vt;
        case 35674:
          return yt;
        case 35675:
          return xt;
        case 35676:
          return bt;
        case 35678:
          return _t;
        case 35680:
          return wt;
        case 5124:
        case 35670:
          return ft;
        case 35667:
        case 35671:
          return lt;
        case 35668:
        case 35672:
          return ut;
        case 35669:
        case 35673:
          return pt
      }
    }(e.type)
  }

  function Tt(t) {
    this.id = t, q.call(this)
  }
  Tt.prototype.setValue = function(t, e) {
    for (var i = this.seq, n = 0, r = i.length; n !== r; ++n) {
      var a = i[n];
      a.setValue(t, e[a.id])
    }
  };
  var St = /([\w\d_]+)(\])?(\[|\.)?/g;

  function At(t, e) {
    t.seq.push(e), t.map[e.id] = e
  }

  function Rt(t, e, i) {
    var n = t.name,
      r = n.length;
    for (St.lastIndex = 0;;) {
      var a = St.exec(n),
        o = St.lastIndex,
        s = a[1],
        c = "]" === a[2],
        h = a[3];
      if (c && (s |= 0), void 0 === h || "[" === h && o + 2 === r) {
        At(i, void 0 === h ? new Mt(s, t, e) : new Et(s, t, e));
        break
      }
      var l = i.map[s];
      void 0 === l && At(i, l = new Tt(s)), i = l
    }
  }

  function Lt(t, e, i) {
    q.call(this), this.renderer = i;
    for (var n = t.getProgramParameter(e, t.ACTIVE_UNIFORMS), r = 0; r < n; ++r) {
      var a = t.getActiveUniform(e, r),
        o = a.name;
      Rt(a, t.getUniformLocation(e, o), this)
    }
  }
  Lt.prototype.setValue = function(t, e, i) {
    var n = this.map[e];
    void 0 !== n && n.setValue(t, i, this.renderer)
  }, Lt.prototype.setOptional = function(t, e, i) {
    var n = e[i];
    void 0 !== n && this.setValue(t, i, n)
  }, Lt.upload = function(t, e, i, n) {
    for (var r = 0, a = e.length; r !== a; ++r) {
      var o = e[r],
        s = i[o.id];
      !1 !== s.needsUpdate && o.setValue(t, s.value, n)
    }
  }, Lt.seqWithValue = function(t, e) {
    for (var i = [], n = 0, r = t.length; n !== r; ++n) {
      var a = t[n];
      a.id in e && i.push(a)
    }
    return i
  };
  var Pt = {
    aliceblue: 15792383,
    antiquewhite: 16444375,
    aqua: 65535,
    aquamarine: 8388564,
    azure: 15794175,
    beige: 16119260,
    bisque: 16770244,
    black: 0,
    blanchedalmond: 16772045,
    blue: 255,
    blueviolet: 9055202,
    brown: 10824234,
    burlywood: 14596231,
    cadetblue: 6266528,
    chartreuse: 8388352,
    chocolate: 13789470,
    coral: 16744272,
    cornflowerblue: 6591981,
    cornsilk: 16775388,
    crimson: 14423100,
    cyan: 65535,
    darkblue: 139,
    darkcyan: 35723,
    darkgoldenrod: 12092939,
    darkgray: 11119017,
    darkgreen: 25600,
    darkgrey: 11119017,
    darkkhaki: 12433259,
    darkmagenta: 9109643,
    darkolivegreen: 5597999,
    darkorange: 16747520,
    darkorchid: 10040012,
    darkred: 9109504,
    darksalmon: 15308410,
    darkseagreen: 9419919,
    darkslateblue: 4734347,
    darkslategray: 3100495,
    darkslategrey: 3100495,
    darkturquoise: 52945,
    darkviolet: 9699539,
    deeppink: 16716947,
    deepskyblue: 49151,
    dimgray: 6908265,
    dimgrey: 6908265,
    dodgerblue: 2003199,
    firebrick: 11674146,
    floralwhite: 16775920,
    forestgreen: 2263842,
    fuchsia: 16711935,
    gainsboro: 14474460,
    ghostwhite: 16316671,
    gold: 16766720,
    goldenrod: 14329120,
    gray: 8421504,
    green: 32768,
    greenyellow: 11403055,
    grey: 8421504,
    honeydew: 15794160,
    hotpink: 16738740,
    indianred: 13458524,
    indigo: 4915330,
    ivory: 16777200,
    khaki: 15787660,
    lavender: 15132410,
    lavenderblush: 16773365,
    lawngreen: 8190976,
    lemonchiffon: 16775885,
    lightblue: 11393254,
    lightcoral: 15761536,
    lightcyan: 14745599,
    lightgoldenrodyellow: 16448210,
    lightgray: 13882323,
    lightgreen: 9498256,
    lightgrey: 13882323,
    lightpink: 16758465,
    lightsalmon: 16752762,
    lightseagreen: 2142890,
    lightskyblue: 8900346,
    lightslategray: 7833753,
    lightslategrey: 7833753,
    lightsteelblue: 11584734,
    lightyellow: 16777184,
    lime: 65280,
    limegreen: 3329330,
    linen: 16445670,
    magenta: 16711935,
    maroon: 8388608,
    mediumaquamarine: 6737322,
    mediumblue: 205,
    mediumorchid: 12211667,
    mediumpurple: 9662683,
    mediumseagreen: 3978097,
    mediumslateblue: 8087790,
    mediumspringgreen: 64154,
    mediumturquoise: 4772300,
    mediumvioletred: 13047173,
    midnightblue: 1644912,
    mintcream: 16121850,
    mistyrose: 16770273,
    moccasin: 16770229,
    navajowhite: 16768685,
    navy: 128,
    oldlace: 16643558,
    olive: 8421376,
    olivedrab: 7048739,
    orange: 16753920,
    orangered: 16729344,
    orchid: 14315734,
    palegoldenrod: 15657130,
    palegreen: 10025880,
    paleturquoise: 11529966,
    palevioletred: 14381203,
    papayawhip: 16773077,
    peachpuff: 16767673,
    peru: 13468991,
    pink: 16761035,
    plum: 14524637,
    powderblue: 11591910,
    purple: 8388736,
    rebeccapurple: 6697881,
    red: 16711680,
    rosybrown: 12357519,
    royalblue: 4286945,
    saddlebrown: 9127187,
    salmon: 16416882,
    sandybrown: 16032864,
    seagreen: 3050327,
    seashell: 16774638,
    sienna: 10506797,
    silver: 12632256,
    skyblue: 8900331,
    slateblue: 6970061,
    slategray: 7372944,
    slategrey: 7372944,
    snow: 16775930,
    springgreen: 65407,
    steelblue: 4620980,
    tan: 13808780,
    teal: 32896,
    thistle: 14204888,
    tomato: 16737095,
    turquoise: 4251856,
    violet: 15631086,
    wheat: 16113331,
    white: 16777215,
    whitesmoke: 16119285,
    yellow: 16776960,
    yellowgreen: 10145074
  };

  function Ct(t, e, i) {
    return void 0 === e && void 0 === i ? this.set(t) : this.setRGB(t, e, i)
  }
  Object.assign(Ct.prototype, {
    isColor: !0,
    r: 1,
    g: 1,
    b: 1,
    set: function(t) {
      return t && t.isColor ? this.copy(t) : "number" == typeof t ? this.setHex(t) : "string" == typeof t && this.setStyle(t), this
    },
    setScalar: function(t) {
      return this.r = t, this.g = t, this.b = t, this
    },
    setHex: function(t) {
      return t = Math.floor(t), this.r = (t >> 16 & 255) / 255, this.g = (t >> 8 & 255) / 255, this.b = (255 & t) / 255, this
    },
    setRGB: function(t, e, i) {
      return this.r = t, this.g = e, this.b = i, this
    },
    setHSL: function() {
      function t(t, e, i) {
        return i < 0 && (i += 1), i > 1 && (i -= 1), i < 1 / 6 ? t + 6 * (e - t) * i : i < .5 ? e : i < 2 / 3 ? t + 6 * (e - t) * (2 / 3 - i) : t
      }
      return function(e, i, n) {
        if (e = I.euclideanModulo(e, 1), i = I.clamp(i, 0, 1), n = I.clamp(n, 0, 1), 0 === i) this.r = this.g = this.b = n;
        else {
          var r = n <= .5 ? n * (1 + i) : n + i - n * i,
            a = 2 * n - r;
          this.r = t(a, r, e + 1 / 3), this.g = t(a, r, e), this.b = t(a, r, e - 1 / 3)
        }
        return this
      }
    }(),
    setStyle: function(t) {
      function e(e) {
        void 0 !== e && parseFloat(e) < 1 && console.warn("THREE.Color: Alpha component of " + t + " will be ignored.")
      }
      var i;
      if (i = /^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)) {
        var n, r = i[1],
          a = i[2];
        switch (r) {
          case "rgb":
          case "rgba":
            if (n = /^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)) return this.r = Math.min(255, parseInt(n[1], 10)) / 255, this.g = Math.min(255, parseInt(n[2], 10)) / 255, this.b = Math.min(255, parseInt(n[3], 10)) / 255, e(n[5]), this;
            if (n = /^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)) return this.r = Math.min(100, parseInt(n[1], 10)) / 100, this.g = Math.min(100, parseInt(n[2], 10)) / 100, this.b = Math.min(100, parseInt(n[3], 10)) / 100, e(n[5]), this;
            break;
          case "hsl":
          case "hsla":
            if (n = /^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)) {
              var o = parseFloat(n[1]) / 360,
                s = parseInt(n[2], 10) / 100,
                c = parseInt(n[3], 10) / 100;
              return e(n[5]), this.setHSL(o, s, c)
            }
        }
      } else if (i = /^\#([A-Fa-f0-9]+)$/.exec(t)) {
        var h, l = (h = i[1]).length;
        if (3 === l) return this.r = parseInt(h.charAt(0) + h.charAt(0), 16) / 255, this.g = parseInt(h.charAt(1) + h.charAt(1), 16) / 255, this.b = parseInt(h.charAt(2) + h.charAt(2), 16) / 255, this;
        if (6 === l) return this.r = parseInt(h.charAt(0) + h.charAt(1), 16) / 255, this.g = parseInt(h.charAt(2) + h.charAt(3), 16) / 255, this.b = parseInt(h.charAt(4) + h.charAt(5), 16) / 255, this
      }
      return t && t.length > 0 && (void 0 !== (h = Pt[t]) ? this.setHex(h) : console.warn("THREE.Color: Unknown color " + t)), this
    },
    clone: function() {
      return new this.constructor(this.r, this.g, this.b)
    },
    copy: function(t) {
      return this.r = t.r, this.g = t.g, this.b = t.b, this
    },
    copyGammaToLinear: function(t, e) {
      return void 0 === e && (e = 2), this.r = Math.pow(t.r, e), this.g = Math.pow(t.g, e), this.b = Math.pow(t.b, e), this
    },
    copyLinearToGamma: function(t, e) {
      void 0 === e && (e = 2);
      var i = e > 0 ? 1 / e : 1;
      return this.r = Math.pow(t.r, i), this.g = Math.pow(t.g, i), this.b = Math.pow(t.b, i), this
    },
    convertGammaToLinear: function() {
      var t = this.r,
        e = this.g,
        i = this.b;
      return this.r = t * t, this.g = e * e, this.b = i * i, this
    },
    convertLinearToGamma: function() {
      return this.r = Math.sqrt(this.r), this.g = Math.sqrt(this.g), this.b = Math.sqrt(this.b), this
    },
    getHex: function() {
      return 255 * this.r << 16 ^ 255 * this.g << 8 ^ 255 * this.b << 0
    },
    getHexString: function() {
      return ("000000" + this.getHex().toString(16)).slice(-6)
    },
    getHSL: function(t) {
      var e, i, n = t || {
          h: 0,
          s: 0,
          l: 0
        },
        r = this.r,
        a = this.g,
        o = this.b,
        s = Math.max(r, a, o),
        c = Math.min(r, a, o),
        h = (c + s) / 2;
      if (c === s) e = 0, i = 0;
      else {
        var l = s - c;
        switch (i = h <= .5 ? l / (s + c) : l / (2 - s - c), s) {
          case r:
            e = (a - o) / l + (a < o ? 6 : 0);
            break;
          case a:
            e = (o - r) / l + 2;
            break;
          case o:
            e = (r - a) / l + 4
        }
        e /= 6
      }
      return n.h = e, n.s = i, n.l = h, n
    },
    getStyle: function() {
      return "rgb(" + (255 * this.r | 0) + "," + (255 * this.g | 0) + "," + (255 * this.b | 0) + ")"
    },
    offsetHSL: function(t, e, i) {
      var n = this.getHSL();
      return n.h += t, n.s += e, n.l += i, this.setHSL(n.h, n.s, n.l), this
    },
    add: function(t) {
      return this.r += t.r, this.g += t.g, this.b += t.b, this
    },
    addColors: function(t, e) {
      return this.r = t.r + e.r, this.g = t.g + e.g, this.b = t.b + e.b, this
    },
    addScalar: function(t) {
      return this.r += t, this.g += t, this.b += t, this
    },
    sub: function(t) {
      return this.r = Math.max(0, this.r - t.r), this.g = Math.max(0, this.g - t.g), this.b = Math.max(0, this.b - t.b), this
    },
    multiply: function(t) {
      return this.r *= t.r, this.g *= t.g, this.b *= t.b, this
    },
    multiplyScalar: function(t) {
      return this.r *= t, this.g *= t, this.b *= t, this
    },
    lerp: function(t, e) {
      return this.r += (t.r - this.r) * e, this.g += (t.g - this.g) * e, this.b += (t.b - this.b) * e, this
    },
    equals: function(t) {
      return t.r === this.r && t.g === this.g && t.b === this.b
    },
    fromArray: function(t, e) {
      return void 0 === e && (e = 0), this.r = t[e], this.g = t[e + 1], this.b = t[e + 2], this
    },
    toArray: function(t, e) {
      return void 0 === t && (t = []), void 0 === e && (e = 0), t[e] = this.r, t[e + 1] = this.g, t[e + 2] = this.b, t
    },
    toJSON: function() {
      return this.getHex()
    }
  });
  var It = {
      common: {
        diffuse: {
          value: new Ct(15658734)
        },
        opacity: {
          value: 1
        },
        map: {
          value: null
        },
        uvTransform: {
          value: new B
        },
        alphaMap: {
          value: null
        }
      },
      specularmap: {
        specularMap: {
          value: null
        }
      },
      envmap: {
        envMap: {
          value: null
        },
        flipEnvMap: {
          value: -1
        },
        reflectivity: {
          value: 1
        },
        refractionRatio: {
          value: .98
        }
      },
      aomap: {
        aoMap: {
          value: null
        },
        aoMapIntensity: {
          value: 1
        }
      },
      lightmap: {
        lightMap: {
          value: null
        },
        lightMapIntensity: {
          value: 1
        }
      },
      emissivemap: {
        emissiveMap: {
          value: null
        }
      },
      bumpmap: {
        bumpMap: {
          value: null
        },
        bumpScale: {
          value: 1
        }
      },
      normalmap: {
        normalMap: {
          value: null
        },
        normalScale: {
          value: new U(1, 1)
        }
      },
      displacementmap: {
        displacementMap: {
          value: null
        },
        displacementScale: {
          value: 1
        },
        displacementBias: {
          value: 0
        }
      },
      roughnessmap: {
        roughnessMap: {
          value: null
        }
      },
      metalnessmap: {
        metalnessMap: {
          value: null
        }
      },
      gradientmap: {
        gradientMap: {
          value: null
        }
      },
      fog: {
        fogDensity: {
          value: 25e-5
        },
        fogNear: {
          value: 1
        },
        fogFar: {
          value: 2e3
        },
        fogColor: {
          value: new Ct(16777215)
        }
      },
      lights: {
        ambientLightColor: {
          value: []
        },
        directionalLights: {
          value: [],
          properties: {
            direction: {},
            color: {},
            shadow: {},
            shadowBias: {},
            shadowRadius: {},
            shadowMapSize: {}
          }
        },
        directionalShadowMap: {
          value: []
        },
        directionalShadowMatrix: {
          value: []
        },
        spotLights: {
          value: [],
          properties: {
            color: {},
            position: {},
            direction: {},
            distance: {},
            coneCos: {},
            penumbraCos: {},
            decay: {},
            shadow: {},
            shadowBias: {},
            shadowRadius: {},
            shadowMapSize: {}
          }
        },
        spotShadowMap: {
          value: []
        },
        spotShadowMatrix: {
          value: []
        },
        pointLights: {
          value: [],
          properties: {
            color: {},
            position: {},
            decay: {},
            distance: {},
            shadow: {},
            shadowBias: {},
            shadowRadius: {},
            shadowMapSize: {},
            shadowCameraNear: {},
            shadowCameraFar: {}
          }
        },
        pointShadowMap: {
          value: []
        },
        pointShadowMatrix: {
          value: []
        },
        hemisphereLights: {
          value: [],
          properties: {
            direction: {},
            skyColor: {},
            groundColor: {}
          }
        },
        rectAreaLights: {
          value: [],
          properties: {
            color: {},
            position: {},
            width: {},
            height: {}
          }
        }
      },
      points: {
        diffuse: {
          value: new Ct(15658734)
        },
        opacity: {
          value: 1
        },
        size: {
          value: 1
        },
        scale: {
          value: 1
        },
        map: {
          value: null
        },
        uvTransform: {
          value: new B
        }
      }
    },
    Ut = {
      merge: function(t) {
        for (var e = {}, i = 0; i < t.length; i++) {
          var n = this.clone(t[i]);
          for (var r in n) e[r] = n[r]
        }
        return e
      },
      clone: function(t) {
        var e = {};
        for (var i in t)
          for (var n in e[i] = {}, t[i]) {
            var r = t[i][n];
            r && (r.isColor || r.isMatrix3 || r.isMatrix4 || r.isVector2 || r.isVector3 || r.isVector4 || r.isTexture) ? e[i][n] = r.clone() : Array.isArray(r) ? e[i][n] = r.slice() : e[i][n] = r
          }
        return e
      }
    },
    Dt = {
      alphamap_fragment: "#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",
      alphamap_pars_fragment: "#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",
      alphatest_fragment: "#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",
      aomap_fragment: "#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",
      aomap_pars_fragment: "#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",
      begin_vertex: "\nvec3 transformed = vec3( position );\n",
      beginnormal_vertex: "\nvec3 objectNormal = vec3( normal );\n",
      bsdfs: "float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",
      bumpmap_pars_fragment: "#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",
      clipping_planes_fragment: "#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",
      clipping_planes_pars_fragment: "#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",
      clipping_planes_pars_vertex: "#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",
      clipping_planes_vertex: "#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",
      color_fragment: "#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",
      color_pars_fragment: "#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",
      color_pars_vertex: "#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",
      color_vertex: "#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",
      common: "#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",
      cube_uv_reflection_fragment: "#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",
      defaultnormal_vertex: "vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",
      displacementmap_pars_vertex: "#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",
      displacementmap_vertex: "#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",
      emissivemap_fragment: "#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",
      emissivemap_pars_fragment: "#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",
      encodings_fragment: "  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",
      encodings_pars_fragment: "\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",
      envmap_fragment: "#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",
      envmap_pars_fragment: "#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",
      envmap_pars_vertex: "#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",
      envmap_vertex: "#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",
      fog_vertex: "\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",
      fog_pars_vertex: "#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",
      fog_fragment: "#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",
      fog_pars_fragment: "#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",
      gradientmap_pars_fragment: "#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",
      lightmap_fragment: "#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",
      lightmap_pars_fragment: "#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",
      lights_lambert_vertex: "vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",
      lights_pars: "uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",
      lights_phong_fragment: "BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",
      lights_phong_pars_fragment: "varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",
      lights_physical_fragment: "PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",
      lights_physical_pars_fragment: "struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",
      lights_template: "\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",
      logdepthbuf_fragment: "#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",
      logdepthbuf_pars_fragment: "#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",
      logdepthbuf_pars_vertex: "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",
      logdepthbuf_vertex: "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",
      map_fragment: "#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",
      map_pars_fragment: "#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",
      map_particle_fragment: "#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",
      map_particle_pars_fragment: "#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",
      metalnessmap_fragment: "float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",
      metalnessmap_pars_fragment: "#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",
      morphnormal_vertex: "#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",
      morphtarget_pars_vertex: "#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
      morphtarget_vertex: "#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",
      normal_fragment: "#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",
      normalmap_pars_fragment: "#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",
      packing: "vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",
      premultiplied_alpha_fragment: "#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",
      project_vertex: "vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",
      dithering_fragment: "#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",
      dithering_pars_fragment: "#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",
      roughnessmap_fragment: "float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",
      roughnessmap_pars_fragment: "#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",
      shadowmap_pars_fragment: "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",
      shadowmap_pars_vertex: "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",
      shadowmap_vertex: "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",
      shadowmask_pars_fragment: "float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",
      skinbase_vertex: "#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",
      skinning_pars_vertex: "#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",
      skinning_vertex: "#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",
      skinnormal_vertex: "#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",
      specularmap_fragment: "float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",
      specularmap_pars_fragment: "#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",
      tonemapping_fragment: "#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",
      tonemapping_pars_fragment: "#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",
      uv_pars_fragment: "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",
      uv_pars_vertex: "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",
      uv_vertex: "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",
      uv2_pars_fragment: "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",
      uv2_pars_vertex: "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
      uv2_vertex: "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",
      worldpos_vertex: "#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",
      cube_frag: "uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",
      cube_vert: "varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",
      depth_frag: "#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",
      depth_vert: "#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",
      distanceRGBA_frag: "#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",
      distanceRGBA_vert: "#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",
      equirect_frag: "uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",
      equirect_vert: "varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",
      linedashed_frag: "uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
      linedashed_vert: "uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",
      meshbasic_frag: "uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
      meshbasic_vert: "#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",
      meshlambert_frag: "uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
      meshlambert_vert: "#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
      meshphong_frag: "#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
      meshphong_vert: "#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
      meshphysical_frag: "#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
      meshphysical_vert: "#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
      normal_frag: "#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",
      normal_vert: "#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",
      points_frag: "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
      points_vert: "uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
      shadow_frag: "uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",
      shadow_vert: "#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"
    },
    Ot = {
      basic: {
        uniforms: Ut.merge([It.common, It.specularmap, It.envmap, It.aomap, It.lightmap, It.fog]),
        vertexShader: Dt.meshbasic_vert,
        fragmentShader: Dt.meshbasic_frag
      },
      lambert: {
        uniforms: Ut.merge([It.common, It.specularmap, It.envmap, It.aomap, It.lightmap, It.emissivemap, It.fog, It.lights, {
          emissive: {
            value: new Ct(0)
          }
        }]),
        vertexShader: Dt.meshlambert_vert,
        fragmentShader: Dt.meshlambert_frag
      },
      phong: {
        uniforms: Ut.merge([It.common, It.specularmap, It.envmap, It.aomap, It.lightmap, It.emissivemap, It.bumpmap, It.normalmap, It.displacementmap, It.gradientmap, It.fog, It.lights, {
          emissive: {
            value: new Ct(0)
          },
          specular: {
            value: new Ct(1118481)
          },
          shininess: {
            value: 30
          }
        }]),
        vertexShader: Dt.meshphong_vert,
        fragmentShader: Dt.meshphong_frag
      },
      standard: {
        uniforms: Ut.merge([It.common, It.envmap, It.aomap, It.lightmap, It.emissivemap, It.bumpmap, It.normalmap, It.displacementmap, It.roughnessmap, It.metalnessmap, It.fog, It.lights, {
          emissive: {
            value: new Ct(0)
          },
          roughness: {
            value: .5
          },
          metalness: {
            value: .5
          },
          envMapIntensity: {
            value: 1
          }
        }]),
        vertexShader: Dt.meshphysical_vert,
        fragmentShader: Dt.meshphysical_frag
      },
      points: {
        uniforms: Ut.merge([It.points, It.fog]),
        vertexShader: Dt.points_vert,
        fragmentShader: Dt.points_frag
      },
      dashed: {
        uniforms: Ut.merge([It.common, It.fog, {
          scale: {
            value: 1
          },
          dashSize: {
            value: 1
          },
          totalSize: {
            value: 2
          }
        }]),
        vertexShader: Dt.linedashed_vert,
        fragmentShader: Dt.linedashed_frag
      },
      depth: {
        uniforms: Ut.merge([It.common, It.displacementmap]),
        vertexShader: Dt.depth_vert,
        fragmentShader: Dt.depth_frag
      },
      normal: {
        uniforms: Ut.merge([It.common, It.bumpmap, It.normalmap, It.displacementmap, {
          opacity: {
            value: 1
          }
        }]),
        vertexShader: Dt.normal_vert,
        fragmentShader: Dt.normal_frag
      },
      cube: {
        uniforms: {
          tCube: {
            value: null
          },
          tFlip: {
            value: -1
          },
          opacity: {
            value: 1
          }
        },
        vertexShader: Dt.cube_vert,
        fragmentShader: Dt.cube_frag
      },
      equirect: {
        uniforms: {
          tEquirect: {
            value: null
          }
        },
        vertexShader: Dt.equirect_vert,
        fragmentShader: Dt.equirect_frag
      },
      distanceRGBA: {
        uniforms: Ut.merge([It.common, It.displacementmap, {
          referencePosition: {
            value: new N
          },
          nearDistance: {
            value: 1
          },
          farDistance: {
            value: 1e3
          }
        }]),
        vertexShader: Dt.distanceRGBA_vert,
        fragmentShader: Dt.distanceRGBA_frag
      },
      shadow: {
        uniforms: Ut.merge([It.lights, It.fog, {
          color: {
            value: new Ct(0)
          },
          opacity: {
            value: 1
          }
        }]),
        vertexShader: Dt.shadow_vert,
        fragmentShader: Dt.shadow_frag
      }
    };

  function Nt(t, e) {
    this.min = void 0 !== t ? t : new U(1 / 0, 1 / 0), this.max = void 0 !== e ? e : new U(-1 / 0, -1 / 0)
  }

  function Bt(t, e, i, n, r) {
    var a, o, s, c, h, l, u, p;

    function d() {
      var t = new Float32Array([-1, -1, 0, 0, 1, -1, 1, 0, 1, 1, 1, 1, -1, 1, 0, 1]),
        n = new Uint16Array([0, 1, 2, 0, 2, 3]);
      a = e.createBuffer(), o = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, a), e.bufferData(e.ARRAY_BUFFER, t, e.STATIC_DRAW), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, o), e.bufferData(e.ELEMENT_ARRAY_BUFFER, n, e.STATIC_DRAW), u = e.createTexture(), p = e.createTexture(), i.bindTexture(e.TEXTURE_2D, u), e.texImage2D(e.TEXTURE_2D, 0, e.RGB, 16, 16, 0, e.RGB, e.UNSIGNED_BYTE, null), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, e.NEAREST), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, e.NEAREST), i.bindTexture(e.TEXTURE_2D, p), e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, 16, 16, 0, e.RGBA, e.UNSIGNED_BYTE, null), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, e.NEAREST), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, e.NEAREST), s = {
        vertexShader: ["uniform lowp int renderType;", "uniform vec3 screenPosition;", "uniform vec2 scale;", "uniform float rotation;", "uniform sampler2D occlusionMap;", "attribute vec2 position;", "attribute vec2 uv;", "varying vec2 vUV;", "varying float vVisibility;", "void main() {", "\tvUV = uv;", "\tvec2 pos = position;", "\tif ( renderType == 2 ) {", "\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );", "\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );", "\t\tvVisibility =        visibility.r / 9.0;", "\t\tvVisibility *= 1.0 - visibility.g / 9.0;", "\t\tvVisibility *=       visibility.b / 9.0;", "\t\tvVisibility *= 1.0 - visibility.a / 9.0;", "\t\tpos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;", "\t\tpos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;", "\t}", "\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );", "}"].join("\n"),
        fragmentShader: ["uniform lowp int renderType;", "uniform sampler2D map;", "uniform float opacity;", "uniform vec3 color;", "varying vec2 vUV;", "varying float vVisibility;", "void main() {", "\tif ( renderType == 0 ) {", "\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );", "\t} else if ( renderType == 1 ) {", "\t\tgl_FragColor = texture2D( map, vUV );", "\t} else {", "\t\tvec4 texture = texture2D( map, vUV );", "\t\ttexture.a *= opacity * vVisibility;", "\t\tgl_FragColor = texture;", "\t\tgl_FragColor.rgb *= color;", "\t}", "}"].join("\n")
      }, c = function(t) {
        var i = e.createProgram(),
          n = e.createShader(e.FRAGMENT_SHADER),
          a = e.createShader(e.VERTEX_SHADER),
          o = "precision " + r.precision + " float;\n";
        return e.shaderSource(n, o + t.fragmentShader), e.shaderSource(a, o + t.vertexShader), e.compileShader(n), e.compileShader(a), e.attachShader(i, n), e.attachShader(i, a), e.linkProgram(i), i
      }(s), h = {
        vertex: e.getAttribLocation(c, "position"),
        uv: e.getAttribLocation(c, "uv")
      }, l = {
        renderType: e.getUniformLocation(c, "renderType"),
        map: e.getUniformLocation(c, "map"),
        occlusionMap: e.getUniformLocation(c, "occlusionMap"),
        opacity: e.getUniformLocation(c, "opacity"),
        color: e.getUniformLocation(c, "color"),
        scale: e.getUniformLocation(c, "scale"),
        rotation: e.getUniformLocation(c, "rotation"),
        screenPosition: e.getUniformLocation(c, "screenPosition")
      }
    }
    this.render = function(t, r, s, f) {
      if (0 !== t.length) {
        var m = new N,
          g = f.w / f.z,
          v = .5 * f.z,
          y = .5 * f.w,
          x = 16 / f.w,
          b = new U(x * g, x),
          _ = new N(1, 1, 0),
          w = new U(1, 1),
          M = new Nt;
        M.min.set(f.x, f.y), M.max.set(f.x + (f.z - 16), f.y + (f.w - 16)), void 0 === c && d(), i.useProgram(c), i.initAttributes(), i.enableAttribute(h.vertex), i.enableAttribute(h.uv), i.disableUnusedAttributes(), e.uniform1i(l.occlusionMap, 0), e.uniform1i(l.map, 1), e.bindBuffer(e.ARRAY_BUFFER, a), e.vertexAttribPointer(h.vertex, 2, e.FLOAT, !1, 16, 0), e.vertexAttribPointer(h.uv, 2, e.FLOAT, !1, 16, 8), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, o), i.disable(e.CULL_FACE), i.buffers.depth.setMask(!1);
        for (var E = 0, T = t.length; E < T; E++) {
          x = 16 / f.w, b.set(x * g, x);
          var S = t[E];
          if (m.set(S.matrixWorld.elements[12], S.matrixWorld.elements[13], S.matrixWorld.elements[14]), m.applyMatrix4(s.matrixWorldInverse), m.applyMatrix4(s.projectionMatrix), _.copy(m), w.x = f.x + _.x * v + v - 8, w.y = f.y + _.y * y + y - 8, !0 === M.containsPoint(w)) {
            i.activeTexture(e.TEXTURE0), i.bindTexture(e.TEXTURE_2D, null), i.activeTexture(e.TEXTURE1), i.bindTexture(e.TEXTURE_2D, u), e.copyTexImage2D(e.TEXTURE_2D, 0, e.RGB, w.x, w.y, 16, 16, 0), e.uniform1i(l.renderType, 0), e.uniform2f(l.scale, b.x, b.y), e.uniform3f(l.screenPosition, _.x, _.y, _.z), i.disable(e.BLEND), i.enable(e.DEPTH_TEST), e.drawElements(e.TRIANGLES, 6, e.UNSIGNED_SHORT, 0), i.activeTexture(e.TEXTURE0), i.bindTexture(e.TEXTURE_2D, p), e.copyTexImage2D(e.TEXTURE_2D, 0, e.RGBA, w.x, w.y, 16, 16, 0), e.uniform1i(l.renderType, 1), i.disable(e.DEPTH_TEST), i.activeTexture(e.TEXTURE1), i.bindTexture(e.TEXTURE_2D, u), e.drawElements(e.TRIANGLES, 6, e.UNSIGNED_SHORT, 0), S.positionScreen.copy(_), S.customUpdateCallback ? S.customUpdateCallback(S) : S.updateLensFlares(), e.uniform1i(l.renderType, 2), i.enable(e.BLEND);
            for (var A = 0, R = S.lensFlares.length; A < R; A++) {
              var L = S.lensFlares[A];
              L.opacity > .001 && L.scale > .001 && (_.x = L.x, _.y = L.y, _.z = L.z, x = L.size * L.scale / f.w, b.x = x * g, b.y = x, e.uniform3f(l.screenPosition, _.x, _.y, _.z), e.uniform2f(l.scale, b.x, b.y), e.uniform1f(l.rotation, L.rotation), e.uniform1f(l.opacity, L.opacity), e.uniform3f(l.color, L.color.r, L.color.g, L.color.b), i.setBlending(L.blending, L.blendEquation, L.blendSrc, L.blendDst), n.setTexture2D(L.texture, 1), e.drawElements(e.TRIANGLES, 6, e.UNSIGNED_SHORT, 0))
            }
          }
        }
        i.enable(e.CULL_FACE), i.enable(e.DEPTH_TEST), i.buffers.depth.setMask(!0), i.reset()
      }
    }
  }

  function Ft(t, e, i, n, r, a, o, s, c) {
    z.call(this, t, e, i, n, r, a, o, s, c), this.needsUpdate = !0
  }

  function zt(t, e, i, n, r) {
    var a, o, s, c, h, l, u = new N,
      p = new O,
      d = new N;

    function f() {
      var t = new Float32Array([-.5, -.5, 0, 0, .5, -.5, 1, 0, .5, .5, 1, 1, -.5, .5, 0, 1]),
        i = new Uint16Array([0, 1, 2, 0, 2, 3]);
      a = e.createBuffer(), o = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, a), e.bufferData(e.ARRAY_BUFFER, t, e.STATIC_DRAW), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, o), e.bufferData(e.ELEMENT_ARRAY_BUFFER, i, e.STATIC_DRAW), s = function() {
        var t = e.createProgram(),
          i = e.createShader(e.VERTEX_SHADER),
          n = e.createShader(e.FRAGMENT_SHADER);
        return e.shaderSource(i, ["precision " + r.precision + " float;", "#define SHADER_NAME SpriteMaterial", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform float rotation;", "uniform vec2 scale;", "uniform vec2 uvOffset;", "uniform vec2 uvScale;", "attribute vec2 position;", "attribute vec2 uv;", "varying vec2 vUV;", "varying float fogDepth;", "void main() {", "\tvUV = uvOffset + uv * uvScale;", "\tvec2 alignedPosition = position * scale;", "\tvec2 rotatedPosition;", "\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;", "\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;", "\tvec4 mvPosition;", "\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );", "\tmvPosition.xy += rotatedPosition;", "\tgl_Position = projectionMatrix * mvPosition;", "\tfogDepth = - mvPosition.z;", "}"].join("\n")), e.shaderSource(n, ["precision " + r.precision + " float;", "#define SHADER_NAME SpriteMaterial", "uniform vec3 color;", "uniform sampler2D map;", "uniform float opacity;", "uniform int fogType;", "uniform vec3 fogColor;", "uniform float fogDensity;", "uniform float fogNear;", "uniform float fogFar;", "uniform float alphaTest;", "varying vec2 vUV;", "varying float fogDepth;", "void main() {", "\tvec4 texture = texture2D( map, vUV );", "\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );", "\tif ( gl_FragColor.a < alphaTest ) discard;", "\tif ( fogType > 0 ) {", "\t\tfloat fogFactor = 0.0;", "\t\tif ( fogType == 1 ) {", "\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );", "\t\t} else {", "\t\t\tconst float LOG2 = 1.442695;", "\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );", "\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );", "\t\t}", "\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );", "\t}", "}"].join("\n")), e.compileShader(i), e.compileShader(n), e.attachShader(t, i), e.attachShader(t, n), e.linkProgram(t), t
      }(), c = {
        position: e.getAttribLocation(s, "position"),
        uv: e.getAttribLocation(s, "uv")
      }, h = {
        uvOffset: e.getUniformLocation(s, "uvOffset"),
        uvScale: e.getUniformLocation(s, "uvScale"),
        rotation: e.getUniformLocation(s, "rotation"),
        scale: e.getUniformLocation(s, "scale"),
        color: e.getUniformLocation(s, "color"),
        map: e.getUniformLocation(s, "map"),
        opacity: e.getUniformLocation(s, "opacity"),
        modelViewMatrix: e.getUniformLocation(s, "modelViewMatrix"),
        projectionMatrix: e.getUniformLocation(s, "projectionMatrix"),
        fogType: e.getUniformLocation(s, "fogType"),
        fogDensity: e.getUniformLocation(s, "fogDensity"),
        fogNear: e.getUniformLocation(s, "fogNear"),
        fogFar: e.getUniformLocation(s, "fogFar"),
        fogColor: e.getUniformLocation(s, "fogColor"),
        fogDepth: e.getUniformLocation(s, "fogDepth"),
        alphaTest: e.getUniformLocation(s, "alphaTest")
      };
      var n = document.createElement("canvas");
      n.width = 8, n.height = 8;
      var u = n.getContext("2d");
      u.fillStyle = "white", u.fillRect(0, 0, 8, 8), l = new Ft(n)
    }

    function m(t, e) {
      return t.renderOrder !== e.renderOrder ? t.renderOrder - e.renderOrder : t.z !== e.z ? e.z - t.z : e.id - t.id
    }
    this.render = function(r, g, v) {
      if (0 !== r.length) {
        void 0 === s && f(), i.useProgram(s), i.initAttributes(), i.enableAttribute(c.position), i.enableAttribute(c.uv), i.disableUnusedAttributes(), i.disable(e.CULL_FACE), i.enable(e.BLEND), e.bindBuffer(e.ARRAY_BUFFER, a), e.vertexAttribPointer(c.position, 2, e.FLOAT, !1, 16, 0), e.vertexAttribPointer(c.uv, 2, e.FLOAT, !1, 16, 8), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, o), e.uniformMatrix4fv(h.projectionMatrix, !1, v.projectionMatrix.elements), i.activeTexture(e.TEXTURE0), e.uniform1i(h.map, 0);
        var y = 0,
          x = 0,
          b = g.fog;
        b ? (e.uniform3f(h.fogColor, b.color.r, b.color.g, b.color.b), b.isFog ? (e.uniform1f(h.fogNear, b.near), e.uniform1f(h.fogFar, b.far), e.uniform1i(h.fogType, 1), y = 1, x = 1) : b.isFogExp2 && (e.uniform1f(h.fogDensity, b.density), e.uniform1i(h.fogType, 2), y = 2, x = 2)) : (e.uniform1i(h.fogType, 0), y = 0, x = 0);
        for (var _ = 0, w = r.length; _ < w; _++)(E = r[_]).modelViewMatrix.multiplyMatrices(v.matrixWorldInverse, E.matrixWorld), E.z = -E.modelViewMatrix.elements[14];
        r.sort(m);
        var M = [];
        for (_ = 0, w = r.length; _ < w; _++) {
          var E, T = (E = r[_]).material;
          if (!1 !== T.visible) {
            E.onBeforeRender(t, g, v, void 0, T, void 0), e.uniform1f(h.alphaTest, T.alphaTest), e.uniformMatrix4fv(h.modelViewMatrix, !1, E.modelViewMatrix.elements), E.matrixWorld.decompose(u, p, d), M[0] = d.x, M[1] = d.y;
            var S = 0;
            g.fog && T.fog && (S = x), y !== S && (e.uniform1i(h.fogType, S), y = S), null !== T.map ? (e.uniform2f(h.uvOffset, T.map.offset.x, T.map.offset.y), e.uniform2f(h.uvScale, T.map.repeat.x, T.map.repeat.y)) : (e.uniform2f(h.uvOffset, 0, 0), e.uniform2f(h.uvScale, 1, 1)), e.uniform1f(h.opacity, T.opacity), e.uniform3f(h.color, T.color.r, T.color.g, T.color.b), e.uniform1f(h.rotation, T.rotation), e.uniform2fv(h.scale, M), i.setBlending(T.blending, T.blendEquation, T.blendSrc, T.blendDst, T.blendEquationAlpha, T.blendSrcAlpha, T.blendDstAlpha, T.premultipliedAlpha), i.buffers.depth.setTest(T.depthTest), i.buffers.depth.setMask(T.depthWrite), i.buffers.color.setMask(T.colorWrite), n.setTexture2D(T.map || l, 0), e.drawElements(e.TRIANGLES, 6, e.UNSIGNED_SHORT, 0), E.onAfterRender(t, g, v, void 0, T, void 0)
          }
        }
        i.enable(e.CULL_FACE), i.reset()
      }
    }
  }
  Ot.physical = {
    uniforms: Ut.merge([Ot.standard.uniforms, {
      clearCoat: {
        value: 0
      },
      clearCoatRoughness: {
        value: 0
      }
    }]),
    vertexShader: Dt.meshphysical_vert,
    fragmentShader: Dt.meshphysical_frag
  }, Object.assign(Nt.prototype, {
    set: function(t, e) {
      return this.min.copy(t), this.max.copy(e), this
    },
    setFromPoints: function(t) {
      this.makeEmpty();
      for (var e = 0, i = t.length; e < i; e++) this.expandByPoint(t[e]);
      return this
    },
    setFromCenterAndSize: function() {
      var t = new U;
      return function(e, i) {
        var n = t.copy(i).multiplyScalar(.5);
        return this.min.copy(e).sub(n), this.max.copy(e).add(n), this
      }
    }(),
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.min.copy(t.min), this.max.copy(t.max), this
    },
    makeEmpty: function() {
      return this.min.x = this.min.y = 1 / 0, this.max.x = this.max.y = -1 / 0, this
    },
    isEmpty: function() {
      return this.max.x < this.min.x || this.max.y < this.min.y
    },
    getCenter: function(t) {
      var e = t || new U;
      return this.isEmpty() ? e.set(0, 0) : e.addVectors(this.min, this.max).multiplyScalar(.5)
    },
    getSize: function(t) {
      var e = t || new U;
      return this.isEmpty() ? e.set(0, 0) : e.subVectors(this.max, this.min)
    },
    expandByPoint: function(t) {
      return this.min.min(t), this.max.max(t), this
    },
    expandByVector: function(t) {
      return this.min.sub(t), this.max.add(t), this
    },
    expandByScalar: function(t) {
      return this.min.addScalar(-t), this.max.addScalar(t), this
    },
    containsPoint: function(t) {
      return !(t.x < this.min.x || t.x > this.max.x || t.y < this.min.y || t.y > this.max.y)
    },
    containsBox: function(t) {
      return this.min.x <= t.min.x && t.max.x <= this.max.x && this.min.y <= t.min.y && t.max.y <= this.max.y
    },
    getParameter: function(t, e) {
      return (e || new U).set((t.x - this.min.x) / (this.max.x - this.min.x), (t.y - this.min.y) / (this.max.y - this.min.y))
    },
    intersectsBox: function(t) {
      return !(t.max.x < this.min.x || t.min.x > this.max.x || t.max.y < this.min.y || t.min.y > this.max.y)
    },
    clampPoint: function(t, e) {
      return (e || new U).copy(t).clamp(this.min, this.max)
    },
    distanceToPoint: function() {
      var t = new U;
      return function(e) {
        return t.copy(e).clamp(this.min, this.max).sub(e).length()
      }
    }(),
    intersect: function(t) {
      return this.min.max(t.min), this.max.min(t.max), this
    },
    union: function(t) {
      return this.min.min(t.min), this.max.max(t.max), this
    },
    translate: function(t) {
      return this.min.add(t), this.max.add(t), this
    },
    equals: function(t) {
      return t.min.equals(this.min) && t.max.equals(this.max)
    }
  }), Ft.prototype = Object.create(z.prototype), Ft.prototype.constructor = Ft;
  var Gt, Ht, Vt, kt, jt, Wt, Xt, qt = 0;

  function Yt() {
    Object.defineProperty(this, "id", {
      value: qt++
    }), this.uuid = I.generateUUID(), this.name = "", this.type = "Material", this.fog = !0, this.lights = !0, this.blending = 1, this.side = 0, this.flatShading = !1, this.vertexColors = 0, this.opacity = 1, this.transparent = !1, this.blendSrc = 204, this.blendDst = 205, this.blendEquation = 100, this.blendSrcAlpha = null, this.blendDstAlpha = null, this.blendEquationAlpha = null, this.depthFunc = 3, this.depthTest = !0, this.depthWrite = !0, this.clippingPlanes = null, this.clipIntersection = !1, this.clipShadows = !1, this.colorWrite = !0, this.precision = null, this.polygonOffset = !1, this.polygonOffsetFactor = 0, this.polygonOffsetUnits = 0, this.dithering = !1, this.alphaTest = 0, this.premultipliedAlpha = !1, this.overdraw = 0, this.visible = !0, this.userData = {}, this.needsUpdate = !0
  }

  function Zt(t) {
    Yt.call(this), this.type = "MeshDepthMaterial", this.depthPacking = 3200, this.skinning = !1, this.morphTargets = !1, this.map = null, this.alphaMap = null, this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.setValues(t)
  }

  function Jt(t) {
    Yt.call(this), this.type = "MeshDistanceMaterial", this.referencePosition = new N, this.nearDistance = 1, this.farDistance = 1e3, this.skinning = !1, this.morphTargets = !1, this.map = null, this.alphaMap = null, this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.fog = !1, this.lights = !1, this.setValues(t)
  }

  function Qt(t, e) {
    this.min = void 0 !== t ? t : new N(1 / 0, 1 / 0, 1 / 0), this.max = void 0 !== e ? e : new N(-1 / 0, -1 / 0, -1 / 0)
  }

  function Kt(t, e) {
    this.center = void 0 !== t ? t : new N, this.radius = void 0 !== e ? e : 0
  }

  function $t(t, e) {
    this.normal = void 0 !== t ? t : new N(1, 0, 0), this.constant = void 0 !== e ? e : 0
  }

  function te(t, e, i, n, r, a) {
    this.planes = [void 0 !== t ? t : new $t, void 0 !== e ? e : new $t, void 0 !== i ? i : new $t, void 0 !== n ? n : new $t, void 0 !== r ? r : new $t, void 0 !== a ? a : new $t]
  }

  function ee(t, e, i) {
    for (var n = new te, r = new D, a = new U, o = new U(i, i), s = new N, c = new N, h = new Array(4), l = new Array(4), u = {}, p = [new N(1, 0, 0), new N(-1, 0, 0), new N(0, 0, 1), new N(0, 0, -1), new N(0, 1, 0), new N(0, -1, 0)], d = [new N(0, 1, 0), new N(0, 1, 0), new N(0, 1, 0), new N(0, 1, 0), new N(0, 0, 1), new N(0, 0, -1)], f = [new G, new G, new G, new G, new G, new G], m = 0; 4 !== m; ++m) {
      var g = 0 != (1 & m),
        v = 0 != (2 & m),
        y = new Zt({
          depthPacking: 3201,
          morphTargets: g,
          skinning: v
        });
      h[m] = y;
      var x = new Jt({
        morphTargets: g,
        skinning: v
      });
      l[m] = x
    }
    var _ = this;

    function w(e, i, n, r, a, o) {
      var s = e.geometry,
        c = null,
        p = h,
        d = e.customDepthMaterial;
      if (n && (p = l, d = e.customDistanceMaterial), d) c = d;
      else {
        var f = !1;
        i.morphTargets && (s && s.isBufferGeometry ? f = s.morphAttributes && s.morphAttributes.position && s.morphAttributes.position.length > 0 : s && s.isGeometry && (f = s.morphTargets && s.morphTargets.length > 0)), e.isSkinnedMesh && !1 === i.skinning && console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:", e);
        var m = 0;
        f && (m |= 1), e.isSkinnedMesh && i.skinning && (m |= 2), c = p[m]
      }
      if (t.localClippingEnabled && !0 === i.clipShadows && 0 !== i.clippingPlanes.length) {
        var g = c.uuid,
          v = i.uuid,
          y = u[g];
        void 0 === y && (y = {}, u[g] = y);
        var x = y[v];
        void 0 === x && (x = c.clone(), y[v] = x), c = x
      }
      c.visible = i.visible, c.wireframe = i.wireframe;
      var b = i.side;
      return _.renderSingleSided && 2 == b && (b = 0), _.renderReverseSided && (0 === b ? b = 1 : 1 === b && (b = 0)), c.side = b, c.clipShadows = i.clipShadows, c.clippingPlanes = i.clippingPlanes, c.clipIntersection = i.clipIntersection, c.wireframeLinewidth = i.wireframeLinewidth, c.linewidth = i.linewidth, n && c.isMeshDistanceMaterial && (c.referencePosition.copy(r), c.nearDistance = a, c.farDistance = o), c
    }

    function M(i, r, a, o) {
      if (!1 !== i.visible) {
        if (i.layers.test(r.layers) && (i.isMesh || i.isLine || i.isPoints) && i.castShadow && (!i.frustumCulled || n.intersectsObject(i))) {
          i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse, i.matrixWorld);
          var s = e.update(i),
            h = i.material;
          if (Array.isArray(h))
            for (var l = s.groups, u = 0, p = l.length; u < p; u++) {
              var d = l[u],
                f = h[d.materialIndex];
              if (f && f.visible) {
                var m = w(i, f, o, c, a.near, a.far);
                t.renderBufferDirect(a, null, s, m, i, d)
              }
            } else h.visible && (m = w(i, h, o, c, a.near, a.far), t.renderBufferDirect(a, null, s, m, i, null))
        }
        for (var g = i.children, v = 0, y = g.length; v < y; v++) M(g[v], r, a, o)
      }
    }
    this.enabled = !1, this.autoUpdate = !0, this.needsUpdate = !1, this.type = 1, this.renderReverseSided = !0, this.renderSingleSided = !0, this.render = function(e, i, h) {
      if (!1 !== _.enabled && (!1 !== _.autoUpdate || !1 !== _.needsUpdate) && 0 !== e.length) {
        var l, u = t.context,
          m = t.state;
        m.disable(u.BLEND), m.buffers.color.setClear(1, 1, 1, 1), m.buffers.depth.setTest(!0), m.setScissorTest(!1);
        for (var g = 0, v = e.length; g < v; g++) {
          var y = e[g],
            x = y.shadow,
            w = y && y.isPointLight;
          if (void 0 !== x) {
            var E = x.camera;
            if (a.copy(x.mapSize), a.min(o), w) {
              var T = a.x,
                S = a.y;
              f[0].set(2 * T, S, T, S), f[1].set(0, S, T, S), f[2].set(3 * T, S, T, S), f[3].set(T, S, T, S), f[4].set(3 * T, 0, T, S), f[5].set(T, 0, T, S), a.x *= 4, a.y *= 2
            }
            if (null === x.map) {
              var R = {
                minFilter: b,
                magFilter: b,
                format: A
              };
              x.map = new H(a.x, a.y, R), x.map.texture.name = y.name + ".shadowMap", E.updateProjectionMatrix()
            }
            x.isSpotLightShadow && x.update(y);
            var L = x.map,
              P = x.matrix;
            c.setFromMatrixPosition(y.matrixWorld), E.position.copy(c), w ? (l = 6, P.makeTranslation(-c.x, -c.y, -c.z)) : (l = 1, s.setFromMatrixPosition(y.target.matrixWorld), E.lookAt(s), E.updateMatrixWorld(), P.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1), P.multiply(E.projectionMatrix), P.multiply(E.matrixWorldInverse)), t.setRenderTarget(L), t.clear();
            for (var C = 0; C < l; C++) {
              if (w) {
                s.copy(E.position), s.add(p[C]), E.up.copy(d[C]), E.lookAt(s), E.updateMatrixWorld();
                var I = f[C];
                m.viewport(I)
              }
              r.multiplyMatrices(E.projectionMatrix, E.matrixWorldInverse), n.setFromMatrix(r), M(i, h, E, w)
            }
          } else console.warn("THREE.WebGLShadowMap:", y, "has no shadow.")
        }
        _.needsUpdate = !1
      }
    }
  }

  function ie(t) {
    var e = {};
    return {
      get: function(t) {
        return t.isInterleavedBufferAttribute && (t = t.data), e[t.uuid]
      },
      remove: function(i) {
        i.isInterleavedBufferAttribute && (i = i.data);
        var n = e[i.uuid];
        n && (t.deleteBuffer(n.buffer), delete e[i.uuid])
      },
      update: function(i, n) {
        i.isInterleavedBufferAttribute && (i = i.data);
        var r = e[i.uuid];
        void 0 === r ? e[i.uuid] = function(e, i) {
          var n = e.array,
            r = e.dynamic ? t.DYNAMIC_DRAW : t.STATIC_DRAW,
            a = t.createBuffer();
          t.bindBuffer(i, a), t.bufferData(i, n, r), e.onUploadCallback();
          var o = t.FLOAT;
          return n instanceof Float32Array ? o = t.FLOAT : n instanceof Float64Array ? console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.") : n instanceof Uint16Array ? o = t.UNSIGNED_SHORT : n instanceof Int16Array ? o = t.SHORT : n instanceof Uint32Array ? o = t.UNSIGNED_INT : n instanceof Int32Array ? o = t.INT : n instanceof Int8Array ? o = t.BYTE : n instanceof Uint8Array && (o = t.UNSIGNED_BYTE), {
            buffer: a,
            type: o,
            bytesPerElement: n.BYTES_PER_ELEMENT,
            version: e.version
          }
        }(i, n) : r.version < i.version && (function(e, i, n) {
          var r = i.array,
            a = i.updateRange;
          t.bindBuffer(n, e), !1 === i.dynamic ? t.bufferData(n, r, t.STATIC_DRAW) : -1 === a.count ? t.bufferSubData(n, 0, r) : 0 === a.count ? console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.") : (t.bufferSubData(n, a.offset * r.BYTES_PER_ELEMENT, r.subarray(a.offset, a.offset + a.count)), a.count = -1)
        }(r.buffer, i, n), r.version = i.version)
      }
    }
  }

  function ne(t, e, i, n) {
    this._x = t || 0, this._y = e || 0, this._z = i || 0, this._order = n || ne.DefaultOrder
  }

  function re() {
    this.mask = 1
  }
  Object.assign(Yt.prototype, i.prototype, {
    isMaterial: !0,
    onBeforeCompile: function() {},
    setValues: function(t) {
      if (void 0 !== t)
        for (var e in t) {
          var i = t[e];
          if (void 0 !== i)
            if ("shading" !== e) {
              var n = this[e];
              void 0 !== n ? n && n.isColor ? n.set(i) : n && n.isVector3 && i && i.isVector3 ? n.copy(i) : this[e] = "overdraw" === e ? Number(i) : i : console.warn("THREE." + this.type + ": '" + e + "' is not a property of this material.")
            } else console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."), this.flatShading = 1 === i;
          else console.warn("THREE.Material: '" + e + "' parameter is undefined.")
        }
    },
    toJSON: function(t) {
      var e = void 0 === t || "string" == typeof t;
      e && (t = {
        textures: {},
        images: {}
      });
      var i = {
        metadata: {
          version: 4.5,
          type: "Material",
          generator: "Material.toJSON"
        }
      };

      function n(t) {
        var e = [];
        for (var i in t) {
          var n = t[i];
          delete n.metadata, e.push(n)
        }
        return e
      }
      if (i.uuid = this.uuid, i.type = this.type, "" !== this.name && (i.name = this.name), this.color && this.color.isColor && (i.color = this.color.getHex()), void 0 !== this.roughness && (i.roughness = this.roughness), void 0 !== this.metalness && (i.metalness = this.metalness), this.emissive && this.emissive.isColor && (i.emissive = this.emissive.getHex()), 1 !== this.emissiveIntensity && (i.emissiveIntensity = this.emissiveIntensity), this.specular && this.specular.isColor && (i.specular = this.specular.getHex()), void 0 !== this.shininess && (i.shininess = this.shininess), void 0 !== this.clearCoat && (i.clearCoat = this.clearCoat), void 0 !== this.clearCoatRoughness && (i.clearCoatRoughness = this.clearCoatRoughness), this.map && this.map.isTexture && (i.map = this.map.toJSON(t).uuid), this.alphaMap && this.alphaMap.isTexture && (i.alphaMap = this.alphaMap.toJSON(t).uuid), this.lightMap && this.lightMap.isTexture && (i.lightMap = this.lightMap.toJSON(t).uuid), this.bumpMap && this.bumpMap.isTexture && (i.bumpMap = this.bumpMap.toJSON(t).uuid, i.bumpScale = this.bumpScale), this.normalMap && this.normalMap.isTexture && (i.normalMap = this.normalMap.toJSON(t).uuid, i.normalScale = this.normalScale.toArray()), this.displacementMap && this.displacementMap.isTexture && (i.displacementMap = this.displacementMap.toJSON(t).uuid, i.displacementScale = this.displacementScale, i.displacementBias = this.displacementBias), this.roughnessMap && this.roughnessMap.isTexture && (i.roughnessMap = this.roughnessMap.toJSON(t).uuid), this.metalnessMap && this.metalnessMap.isTexture && (i.metalnessMap = this.metalnessMap.toJSON(t).uuid), this.emissiveMap && this.emissiveMap.isTexture && (i.emissiveMap = this.emissiveMap.toJSON(t).uuid), this.specularMap && this.specularMap.isTexture && (i.specularMap = this.specularMap.toJSON(t).uuid), this.envMap && this.envMap.isTexture && (i.envMap = this.envMap.toJSON(t).uuid, i.reflectivity = this.reflectivity), this.gradientMap && this.gradientMap.isTexture && (i.gradientMap = this.gradientMap.toJSON(t).uuid), void 0 !== this.size && (i.size = this.size), void 0 !== this.sizeAttenuation && (i.sizeAttenuation = this.sizeAttenuation), 1 !== this.blending && (i.blending = this.blending), !0 === this.flatShading && (i.flatShading = this.flatShading), 0 !== this.side && (i.side = this.side), 0 !== this.vertexColors && (i.vertexColors = this.vertexColors), this.opacity < 1 && (i.opacity = this.opacity), !0 === this.transparent && (i.transparent = this.transparent), i.depthFunc = this.depthFunc, i.depthTest = this.depthTest, i.depthWrite = this.depthWrite, 0 !== this.rotation && (i.rotation = this.rotation), 1 !== this.linewidth && (i.linewidth = this.linewidth), void 0 !== this.dashSize && (i.dashSize = this.dashSize), void 0 !== this.gapSize && (i.gapSize = this.gapSize), void 0 !== this.scale && (i.scale = this.scale), !0 === this.dithering && (i.dithering = !0), this.alphaTest > 0 && (i.alphaTest = this.alphaTest), !0 === this.premultipliedAlpha && (i.premultipliedAlpha = this.premultipliedAlpha), !0 === this.wireframe && (i.wireframe = this.wireframe), this.wireframeLinewidth > 1 && (i.wireframeLinewidth = this.wireframeLinewidth), "round" !== this.wireframeLinecap && (i.wireframeLinecap = this.wireframeLinecap), "round" !== this.wireframeLinejoin && (i.wireframeLinejoin = this.wireframeLinejoin), !0 === this.morphTargets && (i.morphTargets = !0), !0 === this.skinning && (i.skinning = !0), !1 === this.visible && (i.visible = !1), "{}" !== JSON.stringify(this.userData) && (i.userData = this.userData), e) {
        var r = n(t.textures),
          a = n(t.images);
        r.length > 0 && (i.textures = r), a.length > 0 && (i.images = a)
      }
      return i
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      this.name = t.name, this.fog = t.fog, this.lights = t.lights, this.blending = t.blending, this.side = t.side, this.flatShading = t.flatShading, this.vertexColors = t.vertexColors, this.opacity = t.opacity, this.transparent = t.transparent, this.blendSrc = t.blendSrc, this.blendDst = t.blendDst, this.blendEquation = t.blendEquation, this.blendSrcAlpha = t.blendSrcAlpha, this.blendDstAlpha = t.blendDstAlpha, this.blendEquationAlpha = t.blendEquationAlpha, this.depthFunc = t.depthFunc, this.depthTest = t.depthTest, this.depthWrite = t.depthWrite, this.colorWrite = t.colorWrite, this.precision = t.precision, this.polygonOffset = t.polygonOffset, this.polygonOffsetFactor = t.polygonOffsetFactor, this.polygonOffsetUnits = t.polygonOffsetUnits, this.dithering = t.dithering, this.alphaTest = t.alphaTest, this.premultipliedAlpha = t.premultipliedAlpha, this.overdraw = t.overdraw, this.visible = t.visible, this.userData = JSON.parse(JSON.stringify(t.userData)), this.clipShadows = t.clipShadows, this.clipIntersection = t.clipIntersection;
      var e = t.clippingPlanes,
        i = null;
      if (null !== e) {
        var n = e.length;
        i = new Array(n);
        for (var r = 0; r !== n; ++r) i[r] = e[r].clone()
      }
      return this.clippingPlanes = i, this
    },
    dispose: function() {
      this.dispatchEvent({
        type: "dispose"
      })
    }
  }), Zt.prototype = Object.create(Yt.prototype), Zt.prototype.constructor = Zt, Zt.prototype.isMeshDepthMaterial = !0, Zt.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.depthPacking = t.depthPacking, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this.map = t.map, this.alphaMap = t.alphaMap, this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this
  }, Jt.prototype = Object.create(Yt.prototype), Jt.prototype.constructor = Jt, Jt.prototype.isMeshDistanceMaterial = !0, Jt.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.referencePosition.copy(t.referencePosition), this.nearDistance = t.nearDistance, this.farDistance = t.farDistance, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this.map = t.map, this.alphaMap = t.alphaMap, this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this
  }, Object.assign(Qt.prototype, {
    isBox3: !0,
    set: function(t, e) {
      return this.min.copy(t), this.max.copy(e), this
    },
    setFromArray: function(t) {
      for (var e = 1 / 0, i = 1 / 0, n = 1 / 0, r = -1 / 0, a = -1 / 0, o = -1 / 0, s = 0, c = t.length; s < c; s += 3) {
        var h = t[s],
          l = t[s + 1],
          u = t[s + 2];
        h < e && (e = h), l < i && (i = l), u < n && (n = u), h > r && (r = h), l > a && (a = l), u > o && (o = u)
      }
      return this.min.set(e, i, n), this.max.set(r, a, o), this
    },
    setFromBufferAttribute: function(t) {
      for (var e = 1 / 0, i = 1 / 0, n = 1 / 0, r = -1 / 0, a = -1 / 0, o = -1 / 0, s = 0, c = t.count; s < c; s++) {
        var h = t.getX(s),
          l = t.getY(s),
          u = t.getZ(s);
        h < e && (e = h), l < i && (i = l), u < n && (n = u), h > r && (r = h), l > a && (a = l), u > o && (o = u)
      }
      return this.min.set(e, i, n), this.max.set(r, a, o), this
    },
    setFromPoints: function(t) {
      this.makeEmpty();
      for (var e = 0, i = t.length; e < i; e++) this.expandByPoint(t[e]);
      return this
    },
    setFromCenterAndSize: function() {
      var t = new N;
      return function(e, i) {
        var n = t.copy(i).multiplyScalar(.5);
        return this.min.copy(e).sub(n), this.max.copy(e).add(n), this
      }
    }(),
    setFromObject: function(t) {
      return this.makeEmpty(), this.expandByObject(t)
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.min.copy(t.min), this.max.copy(t.max), this
    },
    makeEmpty: function() {
      return this.min.x = this.min.y = this.min.z = 1 / 0, this.max.x = this.max.y = this.max.z = -1 / 0, this
    },
    isEmpty: function() {
      return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z
    },
    getCenter: function(t) {
      var e = t || new N;
      return this.isEmpty() ? e.set(0, 0, 0) : e.addVectors(this.min, this.max).multiplyScalar(.5)
    },
    getSize: function(t) {
      var e = t || new N;
      return this.isEmpty() ? e.set(0, 0, 0) : e.subVectors(this.max, this.min)
    },
    expandByPoint: function(t) {
      return this.min.min(t), this.max.max(t), this
    },
    expandByVector: function(t) {
      return this.min.sub(t), this.max.add(t), this
    },
    expandByScalar: function(t) {
      return this.min.addScalar(-t), this.max.addScalar(t), this
    },
    expandByObject: function() {
      var t, e, i, n = new N;

      function r(r) {
        var a = r.geometry;
        if (void 0 !== a)
          if (a.isGeometry) {
            var o = a.vertices;
            for (e = 0, i = o.length; e < i; e++) n.copy(o[e]), n.applyMatrix4(r.matrixWorld), t.expandByPoint(n)
          } else if (a.isBufferGeometry) {
          var s = a.attributes.position;
          if (void 0 !== s)
            for (e = 0, i = s.count; e < i; e++) n.fromBufferAttribute(s, e).applyMatrix4(r.matrixWorld), t.expandByPoint(n)
        }
      }
      return function(e) {
        return t = this, e.updateMatrixWorld(!0), e.traverse(r), this
      }
    }(),
    containsPoint: function(t) {
      return !(t.x < this.min.x || t.x > this.max.x || t.y < this.min.y || t.y > this.max.y || t.z < this.min.z || t.z > this.max.z)
    },
    containsBox: function(t) {
      return this.min.x <= t.min.x && t.max.x <= this.max.x && this.min.y <= t.min.y && t.max.y <= this.max.y && this.min.z <= t.min.z && t.max.z <= this.max.z
    },
    getParameter: function(t, e) {
      return (e || new N).set((t.x - this.min.x) / (this.max.x - this.min.x), (t.y - this.min.y) / (this.max.y - this.min.y), (t.z - this.min.z) / (this.max.z - this.min.z))
    },
    intersectsBox: function(t) {
      return !(t.max.x < this.min.x || t.min.x > this.max.x || t.max.y < this.min.y || t.min.y > this.max.y || t.max.z < this.min.z || t.min.z > this.max.z)
    },
    intersectsSphere: (Ht = new N, function(t) {
      return this.clampPoint(t.center, Ht), Ht.distanceToSquared(t.center) <= t.radius * t.radius
    }),
    intersectsPlane: function(t) {
      var e, i;
      return t.normal.x > 0 ? (e = t.normal.x * this.min.x, i = t.normal.x * this.max.x) : (e = t.normal.x * this.max.x, i = t.normal.x * this.min.x), t.normal.y > 0 ? (e += t.normal.y * this.min.y, i += t.normal.y * this.max.y) : (e += t.normal.y * this.max.y, i += t.normal.y * this.min.y), t.normal.z > 0 ? (e += t.normal.z * this.min.z, i += t.normal.z * this.max.z) : (e += t.normal.z * this.max.z, i += t.normal.z * this.min.z), e <= t.constant && i >= t.constant
    },
    clampPoint: function(t, e) {
      return (e || new N).copy(t).clamp(this.min, this.max)
    },
    distanceToPoint: function() {
      var t = new N;
      return function(e) {
        return t.copy(e).clamp(this.min, this.max).sub(e).length()
      }
    }(),
    getBoundingSphere: function() {
      var t = new N;
      return function(e) {
        var i = e || new Kt;
        return this.getCenter(i.center), i.radius = .5 * this.getSize(t).length(), i
      }
    }(),
    intersect: function(t) {
      return this.min.max(t.min), this.max.min(t.max), this.isEmpty() && this.makeEmpty(), this
    },
    union: function(t) {
      return this.min.min(t.min), this.max.max(t.max), this
    },
    applyMatrix4: (Gt = [new N, new N, new N, new N, new N, new N, new N, new N], function(t) {
      return this.isEmpty() || (Gt[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(t), Gt[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(t), Gt[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(t), Gt[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(t), Gt[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(t), Gt[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(t), Gt[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(t), Gt[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(t), this.setFromPoints(Gt)), this
    }),
    translate: function(t) {
      return this.min.add(t), this.max.add(t), this
    },
    equals: function(t) {
      return t.min.equals(this.min) && t.max.equals(this.max)
    }
  }), Object.assign(Kt.prototype, {
    set: function(t, e) {
      return this.center.copy(t), this.radius = e, this
    },
    setFromPoints: (Vt = new Qt, function(t, e) {
      var i = this.center;
      void 0 !== e ? i.copy(e) : Vt.setFromPoints(t).getCenter(i);
      for (var n = 0, r = 0, a = t.length; r < a; r++) n = Math.max(n, i.distanceToSquared(t[r]));
      return this.radius = Math.sqrt(n), this
    }),
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.center.copy(t.center), this.radius = t.radius, this
    },
    empty: function() {
      return this.radius <= 0
    },
    containsPoint: function(t) {
      return t.distanceToSquared(this.center) <= this.radius * this.radius
    },
    distanceToPoint: function(t) {
      return t.distanceTo(this.center) - this.radius
    },
    intersectsSphere: function(t) {
      var e = this.radius + t.radius;
      return t.center.distanceToSquared(this.center) <= e * e
    },
    intersectsBox: function(t) {
      return t.intersectsSphere(this)
    },
    intersectsPlane: function(t) {
      return Math.abs(t.distanceToPoint(this.center)) <= this.radius
    },
    clampPoint: function(t, e) {
      var i = this.center.distanceToSquared(t),
        n = e || new N;
      return n.copy(t), i > this.radius * this.radius && (n.sub(this.center).normalize(), n.multiplyScalar(this.radius).add(this.center)), n
    },
    getBoundingBox: function(t) {
      var e = t || new Qt;
      return e.set(this.center, this.center), e.expandByScalar(this.radius), e
    },
    applyMatrix4: function(t) {
      return this.center.applyMatrix4(t), this.radius = this.radius * t.getMaxScaleOnAxis(), this
    },
    translate: function(t) {
      return this.center.add(t), this
    },
    equals: function(t) {
      return t.center.equals(this.center) && t.radius === this.radius
    }
  }), Object.assign($t.prototype, {
    set: function(t, e) {
      return this.normal.copy(t), this.constant = e, this
    },
    setComponents: function(t, e, i, n) {
      return this.normal.set(t, e, i), this.constant = n, this
    },
    setFromNormalAndCoplanarPoint: function(t, e) {
      return this.normal.copy(t), this.constant = -e.dot(this.normal), this
    },
    setFromCoplanarPoints: function() {
      var t = new N,
        e = new N;
      return function(i, n, r) {
        var a = t.subVectors(r, n).cross(e.subVectors(i, n)).normalize();
        return this.setFromNormalAndCoplanarPoint(a, i), this
      }
    }(),
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.normal.copy(t.normal), this.constant = t.constant, this
    },
    normalize: function() {
      var t = 1 / this.normal.length();
      return this.normal.multiplyScalar(t), this.constant *= t, this
    },
    negate: function() {
      return this.constant *= -1, this.normal.negate(), this
    },
    distanceToPoint: function(t) {
      return this.normal.dot(t) + this.constant
    },
    distanceToSphere: function(t) {
      return this.distanceToPoint(t.center) - t.radius
    },
    projectPoint: function(t, e) {
      return (e || new N).copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)
    },
    intersectLine: function() {
      var t = new N;
      return function(e, i) {
        var n = i || new N,
          r = e.delta(t),
          a = this.normal.dot(r);
        if (0 === a) return 0 === this.distanceToPoint(e.start) ? n.copy(e.start) : void 0;
        var o = -(e.start.dot(this.normal) + this.constant) / a;
        return o < 0 || o > 1 ? void 0 : n.copy(r).multiplyScalar(o).add(e.start)
      }
    }(),
    intersectsLine: function(t) {
      var e = this.distanceToPoint(t.start),
        i = this.distanceToPoint(t.end);
      return e < 0 && i > 0 || i < 0 && e > 0
    },
    intersectsBox: function(t) {
      return t.intersectsPlane(this)
    },
    intersectsSphere: function(t) {
      return t.intersectsPlane(this)
    },
    coplanarPoint: function(t) {
      return (t || new N).copy(this.normal).multiplyScalar(-this.constant)
    },
    applyMatrix4: function() {
      var t = new N,
        e = new B;
      return function(i, n) {
        var r = n || e.getNormalMatrix(i),
          a = this.coplanarPoint(t).applyMatrix4(i),
          o = this.normal.applyMatrix3(r).normalize();
        return this.constant = -a.dot(o), this
      }
    }(),
    translate: function(t) {
      return this.constant -= t.dot(this.normal), this
    },
    equals: function(t) {
      return t.normal.equals(this.normal) && t.constant === this.constant
    }
  }), Object.assign(te.prototype, {
    set: function(t, e, i, n, r, a) {
      var o = this.planes;
      return o[0].copy(t), o[1].copy(e), o[2].copy(i), o[3].copy(n), o[4].copy(r), o[5].copy(a), this
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      for (var e = this.planes, i = 0; i < 6; i++) e[i].copy(t.planes[i]);
      return this
    },
    setFromMatrix: function(t) {
      var e = this.planes,
        i = t.elements,
        n = i[0],
        r = i[1],
        a = i[2],
        o = i[3],
        s = i[4],
        c = i[5],
        h = i[6],
        l = i[7],
        u = i[8],
        p = i[9],
        d = i[10],
        f = i[11],
        m = i[12],
        g = i[13],
        v = i[14],
        y = i[15];
      return e[0].setComponents(o - n, l - s, f - u, y - m).normalize(), e[1].setComponents(o + n, l + s, f + u, y + m).normalize(), e[2].setComponents(o + r, l + c, f + p, y + g).normalize(), e[3].setComponents(o - r, l - c, f - p, y - g).normalize(), e[4].setComponents(o - a, l - h, f - d, y - v).normalize(), e[5].setComponents(o + a, l + h, f + d, y + v).normalize(), this
    },
    intersectsObject: (Wt = new Kt, function(t) {
      var e = t.geometry;
      return null === e.boundingSphere && e.computeBoundingSphere(), Wt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld), this.intersectsSphere(Wt)
    }),
    intersectsSprite: function() {
      var t = new Kt;
      return function(e) {
        return t.center.set(0, 0, 0), t.radius = .7071067811865476, t.applyMatrix4(e.matrixWorld), this.intersectsSphere(t)
      }
    }(),
    intersectsSphere: function(t) {
      for (var e = this.planes, i = t.center, n = -t.radius, r = 0; r < 6; r++)
        if (e[r].distanceToPoint(i) < n) return !1;
      return !0
    },
    intersectsBox: (kt = new N, jt = new N, function(t) {
      for (var e = this.planes, i = 0; i < 6; i++) {
        var n = e[i];
        kt.x = n.normal.x > 0 ? t.min.x : t.max.x, jt.x = n.normal.x > 0 ? t.max.x : t.min.x, kt.y = n.normal.y > 0 ? t.min.y : t.max.y, jt.y = n.normal.y > 0 ? t.max.y : t.min.y, kt.z = n.normal.z > 0 ? t.min.z : t.max.z, jt.z = n.normal.z > 0 ? t.max.z : t.min.z;
        var r = n.distanceToPoint(kt),
          a = n.distanceToPoint(jt);
        if (r < 0 && a < 0) return !1
      }
      return !0
    }),
    containsPoint: function(t) {
      for (var e = this.planes, i = 0; i < 6; i++)
        if (e[i].distanceToPoint(t) < 0) return !1;
      return !0
    }
  }), ne.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"], ne.DefaultOrder = "XYZ", Object.defineProperties(ne.prototype, {
    x: {
      get: function() {
        return this._x
      },
      set: function(t) {
        this._x = t, this.onChangeCallback()
      }
    },
    y: {
      get: function() {
        return this._y
      },
      set: function(t) {
        this._y = t, this.onChangeCallback()
      }
    },
    z: {
      get: function() {
        return this._z
      },
      set: function(t) {
        this._z = t, this.onChangeCallback()
      }
    },
    order: {
      get: function() {
        return this._order
      },
      set: function(t) {
        this._order = t, this.onChangeCallback()
      }
    }
  }), Object.assign(ne.prototype, {
    isEuler: !0,
    set: function(t, e, i, n) {
      return this._x = t, this._y = e, this._z = i, this._order = n || this._order, this.onChangeCallback(), this
    },
    clone: function() {
      return new this.constructor(this._x, this._y, this._z, this._order)
    },
    copy: function(t) {
      return this._x = t._x, this._y = t._y, this._z = t._z, this._order = t._order, this.onChangeCallback(), this
    },
    setFromRotationMatrix: function(t, e, i) {
      var n = I.clamp,
        r = t.elements,
        a = r[0],
        o = r[4],
        s = r[8],
        c = r[1],
        h = r[5],
        l = r[9],
        u = r[2],
        p = r[6],
        d = r[10];
      return "XYZ" === (e = e || this._order) ? (this._y = Math.asin(n(s, -1, 1)), Math.abs(s) < .99999 ? (this._x = Math.atan2(-l, d), this._z = Math.atan2(-o, a)) : (this._x = Math.atan2(p, h), this._z = 0)) : "YXZ" === e ? (this._x = Math.asin(-n(l, -1, 1)), Math.abs(l) < .99999 ? (this._y = Math.atan2(s, d), this._z = Math.atan2(c, h)) : (this._y = Math.atan2(-u, a), this._z = 0)) : "ZXY" === e ? (this._x = Math.asin(n(p, -1, 1)), Math.abs(p) < .99999 ? (this._y = Math.atan2(-u, d), this._z = Math.atan2(-o, h)) : (this._y = 0, this._z = Math.atan2(c, a))) : "ZYX" === e ? (this._y = Math.asin(-n(u, -1, 1)), Math.abs(u) < .99999 ? (this._x = Math.atan2(p, d), this._z = Math.atan2(c, a)) : (this._x = 0, this._z = Math.atan2(-o, h))) : "YZX" === e ? (this._z = Math.asin(n(c, -1, 1)), Math.abs(c) < .99999 ? (this._x = Math.atan2(-l, h), this._y = Math.atan2(-u, a)) : (this._x = 0, this._y = Math.atan2(s, d))) : "XZY" === e ? (this._z = Math.asin(-n(o, -1, 1)), Math.abs(o) < .99999 ? (this._x = Math.atan2(p, h), this._y = Math.atan2(s, a)) : (this._x = Math.atan2(-l, d), this._y = 0)) : console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: " + e), this._order = e, !1 !== i && this.onChangeCallback(), this
    },
    setFromQuaternion: function() {
      var t = new D;
      return function(e, i, n) {
        return t.makeRotationFromQuaternion(e), this.setFromRotationMatrix(t, i, n)
      }
    }(),
    setFromVector3: function(t, e) {
      return this.set(t.x, t.y, t.z, e || this._order)
    },
    reorder: (Xt = new O, function(t) {
      return Xt.setFromEuler(this), this.setFromQuaternion(Xt, t)
    }),
    equals: function(t) {
      return t._x === this._x && t._y === this._y && t._z === this._z && t._order === this._order
    },
    fromArray: function(t) {
      return this._x = t[0], this._y = t[1], this._z = t[2], void 0 !== t[3] && (this._order = t[3]), this.onChangeCallback(), this
    },
    toArray: function(t, e) {
      return void 0 === t && (t = []), void 0 === e && (e = 0), t[e] = this._x, t[e + 1] = this._y, t[e + 2] = this._z, t[e + 3] = this._order, t
    },
    toVector3: function(t) {
      return t ? t.set(this._x, this._y, this._z) : new N(this._x, this._y, this._z)
    },
    onChange: function(t) {
      return this.onChangeCallback = t, this
    },
    onChangeCallback: function() {}
  }), Object.assign(re.prototype, {
    set: function(t) {
      this.mask = 1 << t | 0
    },
    enable: function(t) {
      this.mask |= 1 << t | 0
    },
    toggle: function(t) {
      this.mask ^= 1 << t | 0
    },
    disable: function(t) {
      this.mask &= ~(1 << t | 0)
    },
    test: function(t) {
      return 0 != (this.mask & t.mask)
    }
  });
  var ae, oe, se, ce, he = 0;

  function le() {
    Object.defineProperty(this, "id", {
      value: he++
    }), this.uuid = I.generateUUID(), this.name = "", this.type = "Object3D", this.parent = null, this.children = [], this.up = le.DefaultUp.clone();
    var t = new N,
      e = new ne,
      i = new O,
      n = new N(1, 1, 1);
    e.onChange((function() {
      i.setFromEuler(e, !1)
    })), i.onChange((function() {
      e.setFromQuaternion(i, void 0, !1)
    })), Object.defineProperties(this, {
      position: {
        enumerable: !0,
        value: t
      },
      rotation: {
        enumerable: !0,
        value: e
      },
      quaternion: {
        enumerable: !0,
        value: i
      },
      scale: {
        enumerable: !0,
        value: n
      },
      modelViewMatrix: {
        value: new D
      },
      normalMatrix: {
        value: new B
      }
    }), this.matrix = new D, this.matrixWorld = new D, this.matrixAutoUpdate = le.DefaultMatrixAutoUpdate, this.matrixWorldNeedsUpdate = !1, this.layers = new re, this.visible = !0, this.castShadow = !1, this.receiveShadow = !1, this.frustumCulled = !0, this.renderOrder = 0, this.userData = {}
  }

  function ue() {
    le.call(this), this.type = "Camera", this.matrixWorldInverse = new D, this.projectionMatrix = new D
  }

  function pe(t, e, i, n, r, a) {
    ue.call(this), this.type = "OrthographicCamera", this.zoom = 1, this.view = null, this.left = t, this.right = e, this.top = i, this.bottom = n, this.near = void 0 !== r ? r : .1, this.far = void 0 !== a ? a : 2e3, this.updateProjectionMatrix()
  }

  function de(t, e, i, n, r, a) {
    this.a = t, this.b = e, this.c = i, this.normal = n && n.isVector3 ? n : new N, this.vertexNormals = Array.isArray(n) ? n : [], this.color = r && r.isColor ? r : new Ct, this.vertexColors = Array.isArray(r) ? r : [], this.materialIndex = void 0 !== a ? a : 0
  }
  le.DefaultUp = new N(0, 1, 0), le.DefaultMatrixAutoUpdate = !0, Object.assign(le.prototype, i.prototype, {
    isObject3D: !0,
    onBeforeRender: function() {},
    onAfterRender: function() {},
    applyMatrix: function(t) {
      this.matrix.multiplyMatrices(t, this.matrix), this.matrix.decompose(this.position, this.quaternion, this.scale)
    },
    applyQuaternion: function(t) {
      return this.quaternion.premultiply(t), this
    },
    setRotationFromAxisAngle: function(t, e) {
      this.quaternion.setFromAxisAngle(t, e)
    },
    setRotationFromEuler: function(t) {
      this.quaternion.setFromEuler(t, !0)
    },
    setRotationFromMatrix: function(t) {
      this.quaternion.setFromRotationMatrix(t)
    },
    setRotationFromQuaternion: function(t) {
      this.quaternion.copy(t)
    },
    rotateOnAxis: (ce = new O, function(t, e) {
      return ce.setFromAxisAngle(t, e), this.quaternion.multiply(ce), this
    }),
    rotateOnWorldAxis: function() {
      var t = new O;
      return function(e, i) {
        return t.setFromAxisAngle(e, i), this.quaternion.premultiply(t), this
      }
    }(),
    rotateX: function() {
      var t = new N(1, 0, 0);
      return function(e) {
        return this.rotateOnAxis(t, e)
      }
    }(),
    rotateY: function() {
      var t = new N(0, 1, 0);
      return function(e) {
        return this.rotateOnAxis(t, e)
      }
    }(),
    rotateZ: function() {
      var t = new N(0, 0, 1);
      return function(e) {
        return this.rotateOnAxis(t, e)
      }
    }(),
    translateOnAxis: function() {
      var t = new N;
      return function(e, i) {
        return t.copy(e).applyQuaternion(this.quaternion), this.position.add(t.multiplyScalar(i)), this
      }
    }(),
    translateX: function() {
      var t = new N(1, 0, 0);
      return function(e) {
        return this.translateOnAxis(t, e)
      }
    }(),
    translateY: function() {
      var t = new N(0, 1, 0);
      return function(e) {
        return this.translateOnAxis(t, e)
      }
    }(),
    translateZ: function() {
      var t = new N(0, 0, 1);
      return function(e) {
        return this.translateOnAxis(t, e)
      }
    }(),
    localToWorld: function(t) {
      return t.applyMatrix4(this.matrixWorld)
    },
    worldToLocal: (se = new D, function(t) {
      return t.applyMatrix4(se.getInverse(this.matrixWorld))
    }),
    lookAt: function() {
      var t = new D,
        e = new N;
      return function(i, n, r) {
        i.isVector3 ? e.copy(i) : e.set(i, n, r), this.isCamera ? t.lookAt(this.position, e, this.up) : t.lookAt(e, this.position, this.up), this.quaternion.setFromRotationMatrix(t)
      }
    }(),
    add: function(t) {
      if (arguments.length > 1) {
        for (var e = 0; e < arguments.length; e++) this.add(arguments[e]);
        return this
      }
      return t === this ? (console.error("THREE.Object3D.add: object can't be added as a child of itself.", t), this) : (t && t.isObject3D ? (null !== t.parent && t.parent.remove(t), t.parent = this, t.dispatchEvent({
        type: "added"
      }), this.children.push(t)) : console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.", t), this)
    },
    remove: function(t) {
      if (arguments.length > 1) {
        for (var e = 0; e < arguments.length; e++) this.remove(arguments[e]);
        return this
      }
      var i = this.children.indexOf(t);
      return -1 !== i && (t.parent = null, t.dispatchEvent({
        type: "removed"
      }), this.children.splice(i, 1)), this
    },
    getObjectById: function(t) {
      return this.getObjectByProperty("id", t)
    },
    getObjectByName: function(t) {
      return this.getObjectByProperty("name", t)
    },
    getObjectByProperty: function(t, e) {
      if (this[t] === e) return this;
      for (var i = 0, n = this.children.length; i < n; i++) {
        var r = this.children[i].getObjectByProperty(t, e);
        if (void 0 !== r) return r
      }
    },
    getWorldPosition: function(t) {
      var e = t || new N;
      return this.updateMatrixWorld(!0), e.setFromMatrixPosition(this.matrixWorld)
    },
    getWorldQuaternion: (ae = new N, oe = new N, function(t) {
      var e = t || new O;
      return this.updateMatrixWorld(!0), this.matrixWorld.decompose(ae, e, oe), e
    }),
    getWorldRotation: function() {
      var t = new O;
      return function(e) {
        var i = e || new ne;
        return this.getWorldQuaternion(t), i.setFromQuaternion(t, this.rotation.order, !1)
      }
    }(),
    getWorldScale: function() {
      var t = new N,
        e = new O;
      return function(i) {
        var n = i || new N;
        return this.updateMatrixWorld(!0), this.matrixWorld.decompose(t, e, n), n
      }
    }(),
    getWorldDirection: function() {
      var t = new O;
      return function(e) {
        var i = e || new N;
        return this.getWorldQuaternion(t), i.set(0, 0, 1).applyQuaternion(t)
      }
    }(),
    raycast: function() {},
    traverse: function(t) {
      t(this);
      for (var e = this.children, i = 0, n = e.length; i < n; i++) e[i].traverse(t)
    },
    traverseVisible: function(t) {
      if (!1 !== this.visible) {
        t(this);
        for (var e = this.children, i = 0, n = e.length; i < n; i++) e[i].traverseVisible(t)
      }
    },
    traverseAncestors: function(t) {
      var e = this.parent;
      null !== e && (t(e), e.traverseAncestors(t))
    },
    updateMatrix: function() {
      this.matrix.compose(this.position, this.quaternion, this.scale), this.matrixWorldNeedsUpdate = !0
    },
    updateMatrixWorld: function(t) {
      this.matrixAutoUpdate && this.updateMatrix(), (this.matrixWorldNeedsUpdate || t) && (null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), this.matrixWorldNeedsUpdate = !1, t = !0);
      for (var e = this.children, i = 0, n = e.length; i < n; i++) e[i].updateMatrixWorld(t)
    },
    toJSON: function(t) {
      var e = void 0 === t || "string" == typeof t,
        i = {};
      e && (t = {
        geometries: {},
        materials: {},
        textures: {},
        images: {}
      }, i.metadata = {
        version: 4.5,
        type: "Object",
        generator: "Object3D.toJSON"
      });
      var n = {};

      function r(e, i) {
        return void 0 === e[i.uuid] && (e[i.uuid] = i.toJSON(t)), i.uuid
      }
      if (n.uuid = this.uuid, n.type = this.type, "" !== this.name && (n.name = this.name), !0 === this.castShadow && (n.castShadow = !0), !0 === this.receiveShadow && (n.receiveShadow = !0), !1 === this.visible && (n.visible = !1), "{}" !== JSON.stringify(this.userData) && (n.userData = this.userData), n.matrix = this.matrix.toArray(), void 0 !== this.geometry && (n.geometry = r(t.geometries, this.geometry)), void 0 !== this.material)
        if (Array.isArray(this.material)) {
          for (var a = [], o = 0, s = this.material.length; o < s; o++) a.push(r(t.materials, this.material[o]));
          n.material = a
        } else n.material = r(t.materials, this.material);
      if (this.children.length > 0)
        for (n.children = [], o = 0; o < this.children.length; o++) n.children.push(this.children[o].toJSON(t).object);
      if (e) {
        var c = p(t.geometries),
          h = p(t.materials),
          l = p(t.textures),
          u = p(t.images);
        c.length > 0 && (i.geometries = c), h.length > 0 && (i.materials = h), l.length > 0 && (i.textures = l), u.length > 0 && (i.images = u)
      }
      return i.object = n, i;

      function p(t) {
        var e = [];
        for (var i in t) {
          var n = t[i];
          delete n.metadata, e.push(n)
        }
        return e
      }
    },
    clone: function(t) {
      return (new this.constructor).copy(this, t)
    },
    copy: function(t, e) {
      if (void 0 === e && (e = !0), this.name = t.name, this.up.copy(t.up), this.position.copy(t.position), this.quaternion.copy(t.quaternion), this.scale.copy(t.scale), this.matrix.copy(t.matrix), this.matrixWorld.copy(t.matrixWorld), this.matrixAutoUpdate = t.matrixAutoUpdate, this.matrixWorldNeedsUpdate = t.matrixWorldNeedsUpdate, this.layers.mask = t.layers.mask, this.visible = t.visible, this.castShadow = t.castShadow, this.receiveShadow = t.receiveShadow, this.frustumCulled = t.frustumCulled, this.renderOrder = t.renderOrder, this.userData = JSON.parse(JSON.stringify(t.userData)), !0 === e)
        for (var i = 0; i < t.children.length; i++) {
          var n = t.children[i];
          this.add(n.clone())
        }
      return this
    }
  }), ue.prototype = Object.assign(Object.create(le.prototype), {
    constructor: ue,
    isCamera: !0,
    copy: function(t, e) {
      return le.prototype.copy.call(this, t, e), this.matrixWorldInverse.copy(t.matrixWorldInverse), this.projectionMatrix.copy(t.projectionMatrix), this
    },
    getWorldDirection: function() {
      var t = new O;
      return function(e) {
        var i = e || new N;
        return this.getWorldQuaternion(t), i.set(0, 0, -1).applyQuaternion(t)
      }
    }(),
    updateMatrixWorld: function(t) {
      le.prototype.updateMatrixWorld.call(this, t), this.matrixWorldInverse.getInverse(this.matrixWorld)
    },
    clone: function() {
      return (new this.constructor).copy(this)
    }
  }), pe.prototype = Object.assign(Object.create(ue.prototype), {
    constructor: pe,
    isOrthographicCamera: !0,
    copy: function(t, e) {
      return ue.prototype.copy.call(this, t, e), this.left = t.left, this.right = t.right, this.top = t.top, this.bottom = t.bottom, this.near = t.near, this.far = t.far, this.zoom = t.zoom, this.view = null === t.view ? null : Object.assign({}, t.view), this
    },
    setViewOffset: function(t, e, i, n, r, a) {
      null === this.view && (this.view = {
        enabled: !0,
        fullWidth: 1,
        fullHeight: 1,
        offsetX: 0,
        offsetY: 0,
        width: 1,
        height: 1
      }), this.view.enabled = !0, this.view.fullWidth = t, this.view.fullHeight = e, this.view.offsetX = i, this.view.offsetY = n, this.view.width = r, this.view.height = a, this.updateProjectionMatrix()
    },
    clearViewOffset: function() {
      null !== this.view && (this.view.enabled = !1), this.updateProjectionMatrix()
    },
    updateProjectionMatrix: function() {
      var t = (this.right - this.left) / (2 * this.zoom),
        e = (this.top - this.bottom) / (2 * this.zoom),
        i = (this.right + this.left) / 2,
        n = (this.top + this.bottom) / 2,
        r = i - t,
        a = i + t,
        o = n + e,
        s = n - e;
      if (null !== this.view && this.view.enabled) {
        var c = this.zoom / (this.view.width / this.view.fullWidth),
          h = this.zoom / (this.view.height / this.view.fullHeight),
          l = (this.right - this.left) / this.view.width,
          u = (this.top - this.bottom) / this.view.height;
        a = (r += l * (this.view.offsetX / c)) + l * (this.view.width / c), s = (o -= u * (this.view.offsetY / h)) - u * (this.view.height / h)
      }
      this.projectionMatrix.makeOrthographic(r, a, o, s, this.near, this.far)
    },
    toJSON: function(t) {
      var e = le.prototype.toJSON.call(this, t);
      return e.object.zoom = this.zoom, e.object.left = this.left, e.object.right = this.right, e.object.top = this.top, e.object.bottom = this.bottom, e.object.near = this.near, e.object.far = this.far, null !== this.view && (e.object.view = Object.assign({}, this.view)), e
    }
  }), Object.assign(de.prototype, {
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      this.a = t.a, this.b = t.b, this.c = t.c, this.normal.copy(t.normal), this.color.copy(t.color), this.materialIndex = t.materialIndex;
      for (var e = 0, i = t.vertexNormals.length; e < i; e++) this.vertexNormals[e] = t.vertexNormals[e].clone();
      for (e = 0, i = t.vertexColors.length; e < i; e++) this.vertexColors[e] = t.vertexColors[e].clone();
      return this
    }
  });
  var fe, me = 0;

  function ge() {
    Object.defineProperty(this, "id", {
      value: me += 2
    }), this.uuid = I.generateUUID(), this.name = "", this.type = "Geometry", this.vertices = [], this.colors = [], this.faces = [], this.faceVertexUvs = [
      []
    ], this.morphTargets = [], this.morphNormals = [], this.skinWeights = [], this.skinIndices = [], this.lineDistances = [], this.boundingBox = null, this.boundingSphere = null, this.elementsNeedUpdate = !1, this.verticesNeedUpdate = !1, this.uvsNeedUpdate = !1, this.normalsNeedUpdate = !1, this.colorsNeedUpdate = !1, this.lineDistancesNeedUpdate = !1, this.groupsNeedUpdate = !1
  }

  function ve(t, e, i) {
    if (Array.isArray(t)) throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
    this.uuid = I.generateUUID(), this.name = "", this.array = t, this.itemSize = e, this.count = void 0 !== t ? t.length / e : 0, this.normalized = !0 === i, this.dynamic = !1, this.updateRange = {
      offset: 0,
      count: -1
    }, this.onUploadCallback = function() {}, this.version = 0
  }

  function ye(t, e, i) {
    ve.call(this, new Int8Array(t), e, i)
  }

  function xe(t, e, i) {
    ve.call(this, new Uint8Array(t), e, i)
  }

  function be(t, e, i) {
    ve.call(this, new Uint8ClampedArray(t), e, i)
  }

  function _e(t, e, i) {
    ve.call(this, new Int16Array(t), e, i)
  }

  function we(t, e, i) {
    ve.call(this, new Uint16Array(t), e, i)
  }

  function Me(t, e, i) {
    ve.call(this, new Int32Array(t), e, i)
  }

  function Ee(t, e, i) {
    ve.call(this, new Uint32Array(t), e, i)
  }

  function Te(t, e, i) {
    ve.call(this, new Float32Array(t), e, i)
  }

  function Se(t, e, i) {
    ve.call(this, new Float64Array(t), e, i)
  }

  function Ae() {
    this.indices = [], this.vertices = [], this.normals = [], this.colors = [], this.uvs = [], this.uvs2 = [], this.groups = [], this.morphTargets = {}, this.skinWeights = [], this.skinIndices = [], this.boundingBox = null, this.boundingSphere = null, this.verticesNeedUpdate = !1, this.normalsNeedUpdate = !1, this.colorsNeedUpdate = !1, this.uvsNeedUpdate = !1, this.groupsNeedUpdate = !1
  }

  function Re(t) {
    if (0 === t.length) return -1 / 0;
    for (var e = t[0], i = 1, n = t.length; i < n; ++i) t[i] > e && (e = t[i]);
    return e
  }
  Object.assign(ge.prototype, i.prototype, {
    isGeometry: !0,
    applyMatrix: function(t) {
      for (var e = (new B).getNormalMatrix(t), i = 0, n = this.vertices.length; i < n; i++) this.vertices[i].applyMatrix4(t);
      for (i = 0, n = this.faces.length; i < n; i++) {
        var r = this.faces[i];
        r.normal.applyMatrix3(e).normalize();
        for (var a = 0, o = r.vertexNormals.length; a < o; a++) r.vertexNormals[a].applyMatrix3(e).normalize()
      }
      return null !== this.boundingBox && this.computeBoundingBox(), null !== this.boundingSphere && this.computeBoundingSphere(), this.verticesNeedUpdate = !0, this.normalsNeedUpdate = !0, this
    },
    rotateX: function() {
      var t = new D;
      return function(e) {
        return t.makeRotationX(e), this.applyMatrix(t), this
      }
    }(),
    rotateY: function() {
      var t = new D;
      return function(e) {
        return t.makeRotationY(e), this.applyMatrix(t), this
      }
    }(),
    rotateZ: function() {
      var t = new D;
      return function(e) {
        return t.makeRotationZ(e), this.applyMatrix(t), this
      }
    }(),
    translate: function() {
      var t = new D;
      return function(e, i, n) {
        return t.makeTranslation(e, i, n), this.applyMatrix(t), this
      }
    }(),
    scale: function() {
      var t = new D;
      return function(e, i, n) {
        return t.makeScale(e, i, n), this.applyMatrix(t), this
      }
    }(),
    lookAt: (fe = new le, function(t) {
      fe.lookAt(t), fe.updateMatrix(), this.applyMatrix(fe.matrix)
    }),
    fromBufferGeometry: function(t) {
      var e = this,
        i = null !== t.index ? t.index.array : void 0,
        n = t.attributes,
        r = n.position.array,
        a = void 0 !== n.normal ? n.normal.array : void 0,
        o = void 0 !== n.color ? n.color.array : void 0,
        s = void 0 !== n.uv ? n.uv.array : void 0,
        c = void 0 !== n.uv2 ? n.uv2.array : void 0;
      void 0 !== c && (this.faceVertexUvs[1] = []);
      for (var h = [], l = [], u = [], p = 0, d = 0; p < r.length; p += 3, d += 2) e.vertices.push(new N(r[p], r[p + 1], r[p + 2])), void 0 !== a && h.push(new N(a[p], a[p + 1], a[p + 2])), void 0 !== o && e.colors.push(new Ct(o[p], o[p + 1], o[p + 2])), void 0 !== s && l.push(new U(s[d], s[d + 1])), void 0 !== c && u.push(new U(c[d], c[d + 1]));

      function f(t, i, n, r) {
        var p = new de(t, i, n, void 0 !== a ? [h[t].clone(), h[i].clone(), h[n].clone()] : [], void 0 !== o ? [e.colors[t].clone(), e.colors[i].clone(), e.colors[n].clone()] : [], r);
        e.faces.push(p), void 0 !== s && e.faceVertexUvs[0].push([l[t].clone(), l[i].clone(), l[n].clone()]), void 0 !== c && e.faceVertexUvs[1].push([u[t].clone(), u[i].clone(), u[n].clone()])
      }
      var m = t.groups;
      if (m.length > 0)
        for (p = 0; p < m.length; p++)
          for (var g = m[p], v = g.start, y = (d = v, v + g.count); d < y; d += 3) void 0 !== i ? f(i[d], i[d + 1], i[d + 2], g.materialIndex) : f(d, d + 1, d + 2, g.materialIndex);
      else if (void 0 !== i)
        for (p = 0; p < i.length; p += 3) f(i[p], i[p + 1], i[p + 2]);
      else
        for (p = 0; p < r.length / 3; p += 3) f(p, p + 1, p + 2);
      return this.computeFaceNormals(), null !== t.boundingBox && (this.boundingBox = t.boundingBox.clone()), null !== t.boundingSphere && (this.boundingSphere = t.boundingSphere.clone()), this
    },
    center: function() {
      this.computeBoundingBox();
      var t = this.boundingBox.getCenter().negate();
      return this.translate(t.x, t.y, t.z), t
    },
    normalize: function() {
      this.computeBoundingSphere();
      var t = this.boundingSphere.center,
        e = this.boundingSphere.radius,
        i = 0 === e ? 1 : 1 / e,
        n = new D;
      return n.set(i, 0, 0, -i * t.x, 0, i, 0, -i * t.y, 0, 0, i, -i * t.z, 0, 0, 0, 1), this.applyMatrix(n), this
    },
    computeFaceNormals: function() {
      for (var t = new N, e = new N, i = 0, n = this.faces.length; i < n; i++) {
        var r = this.faces[i],
          a = this.vertices[r.a],
          o = this.vertices[r.b],
          s = this.vertices[r.c];
        t.subVectors(s, o), e.subVectors(a, o), t.cross(e), t.normalize(), r.normal.copy(t)
      }
    },
    computeVertexNormals: function(t) {
      var e, i, n, r, a, o;
      for (void 0 === t && (t = !0), o = new Array(this.vertices.length), e = 0, i = this.vertices.length; e < i; e++) o[e] = new N;
      if (t) {
        var s, c, h, l = new N,
          u = new N;
        for (n = 0, r = this.faces.length; n < r; n++) a = this.faces[n], s = this.vertices[a.a], c = this.vertices[a.b], h = this.vertices[a.c], l.subVectors(h, c), u.subVectors(s, c), l.cross(u), o[a.a].add(l), o[a.b].add(l), o[a.c].add(l)
      } else
        for (this.computeFaceNormals(), n = 0, r = this.faces.length; n < r; n++) o[(a = this.faces[n]).a].add(a.normal), o[a.b].add(a.normal), o[a.c].add(a.normal);
      for (e = 0, i = this.vertices.length; e < i; e++) o[e].normalize();
      for (n = 0, r = this.faces.length; n < r; n++) {
        var p = (a = this.faces[n]).vertexNormals;
        3 === p.length ? (p[0].copy(o[a.a]), p[1].copy(o[a.b]), p[2].copy(o[a.c])) : (p[0] = o[a.a].clone(), p[1] = o[a.b].clone(), p[2] = o[a.c].clone())
      }
      this.faces.length > 0 && (this.normalsNeedUpdate = !0)
    },
    computeFlatVertexNormals: function() {
      var t, e, i;
      for (this.computeFaceNormals(), t = 0, e = this.faces.length; t < e; t++) {
        var n = (i = this.faces[t]).vertexNormals;
        3 === n.length ? (n[0].copy(i.normal), n[1].copy(i.normal), n[2].copy(i.normal)) : (n[0] = i.normal.clone(), n[1] = i.normal.clone(), n[2] = i.normal.clone())
      }
      this.faces.length > 0 && (this.normalsNeedUpdate = !0)
    },
    computeMorphNormals: function() {
      var t, e, i, n, r;
      for (i = 0, n = this.faces.length; i < n; i++)
        for ((r = this.faces[i]).__originalFaceNormal ? r.__originalFaceNormal.copy(r.normal) : r.__originalFaceNormal = r.normal.clone(), r.__originalVertexNormals || (r.__originalVertexNormals = []), t = 0, e = r.vertexNormals.length; t < e; t++) r.__originalVertexNormals[t] ? r.__originalVertexNormals[t].copy(r.vertexNormals[t]) : r.__originalVertexNormals[t] = r.vertexNormals[t].clone();
      var a = new ge;
      for (a.faces = this.faces, t = 0, e = this.morphTargets.length; t < e; t++) {
        if (!this.morphNormals[t]) {
          this.morphNormals[t] = {}, this.morphNormals[t].faceNormals = [], this.morphNormals[t].vertexNormals = [];
          var o = this.morphNormals[t].faceNormals,
            s = this.morphNormals[t].vertexNormals;
          for (i = 0, n = this.faces.length; i < n; i++) c = new N, h = {
            a: new N,
            b: new N,
            c: new N
          }, o.push(c), s.push(h)
        }
        var c, h, l = this.morphNormals[t];
        for (a.vertices = this.morphTargets[t].vertices, a.computeFaceNormals(), a.computeVertexNormals(), i = 0, n = this.faces.length; i < n; i++) r = this.faces[i], c = l.faceNormals[i], h = l.vertexNormals[i], c.copy(r.normal), h.a.copy(r.vertexNormals[0]), h.b.copy(r.vertexNormals[1]), h.c.copy(r.vertexNormals[2])
      }
      for (i = 0, n = this.faces.length; i < n; i++)(r = this.faces[i]).normal = r.__originalFaceNormal, r.vertexNormals = r.__originalVertexNormals
    },
    computeLineDistances: function() {
      for (var t = 0, e = this.vertices, i = 0, n = e.length; i < n; i++) i > 0 && (t += e[i].distanceTo(e[i - 1])), this.lineDistances[i] = t
    },
    computeBoundingBox: function() {
      null === this.boundingBox && (this.boundingBox = new Qt), this.boundingBox.setFromPoints(this.vertices)
    },
    computeBoundingSphere: function() {
      null === this.boundingSphere && (this.boundingSphere = new Kt), this.boundingSphere.setFromPoints(this.vertices)
    },
    merge: function(t, e, i) {
      if (t && t.isGeometry) {
        var n, r = this.vertices.length,
          a = this.vertices,
          o = t.vertices,
          s = this.faces,
          c = t.faces,
          h = this.faceVertexUvs[0],
          l = t.faceVertexUvs[0],
          u = this.colors,
          p = t.colors;
        void 0 === i && (i = 0), void 0 !== e && (n = (new B).getNormalMatrix(e));
        for (var d = 0, f = o.length; d < f; d++) {
          var m = o[d].clone();
          void 0 !== e && m.applyMatrix4(e), a.push(m)
        }
        for (d = 0, f = p.length; d < f; d++) u.push(p[d].clone());
        for (d = 0, f = c.length; d < f; d++) {
          var g, v, y, x = c[d],
            b = x.vertexNormals,
            _ = x.vertexColors;
          (g = new de(x.a + r, x.b + r, x.c + r)).normal.copy(x.normal), void 0 !== n && g.normal.applyMatrix3(n).normalize();
          for (var w = 0, M = b.length; w < M; w++) v = b[w].clone(), void 0 !== n && v.applyMatrix3(n).normalize(), g.vertexNormals.push(v);
          for (g.color.copy(x.color), w = 0, M = _.length; w < M; w++) y = _[w], g.vertexColors.push(y.clone());
          g.materialIndex = x.materialIndex + i, s.push(g)
        }
        for (d = 0, f = l.length; d < f; d++) {
          var E = l[d],
            T = [];
          if (void 0 !== E) {
            for (w = 0, M = E.length; w < M; w++) T.push(E[w].clone());
            h.push(T)
          }
        }
      } else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.", t)
    },
    mergeMesh: function(t) {
      t && t.isMesh ? (t.matrixAutoUpdate && t.updateMatrix(), this.merge(t.geometry, t.matrix)) : console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.", t)
    },
    mergeVertices: function() {
      var t, e, i, n, r, a, o, s, c = {},
        h = [],
        l = [],
        u = Math.pow(10, 4);
      for (i = 0, n = this.vertices.length; i < n; i++) t = this.vertices[i], void 0 === c[e = Math.round(t.x * u) + "_" + Math.round(t.y * u) + "_" + Math.round(t.z * u)] ? (c[e] = i, h.push(this.vertices[i]), l[i] = h.length - 1) : l[i] = l[c[e]];
      var p = [];
      for (i = 0, n = this.faces.length; i < n; i++) {
        (r = this.faces[i]).a = l[r.a], r.b = l[r.b], r.c = l[r.c], a = [r.a, r.b, r.c];
        for (var d = 0; d < 3; d++)
          if (a[d] === a[(d + 1) % 3]) {
            p.push(i);
            break
          }
      }
      for (i = p.length - 1; i >= 0; i--) {
        var f = p[i];
        for (this.faces.splice(f, 1), o = 0, s = this.faceVertexUvs.length; o < s; o++) this.faceVertexUvs[o].splice(f, 1)
      }
      var m = this.vertices.length - h.length;
      return this.vertices = h, m
    },
    setFromPoints: function(t) {
      this.vertices = [];
      for (var e = 0, i = t.length; e < i; e++) {
        var n = t[e];
        this.vertices.push(new N(n.x, n.y, n.z || 0))
      }
      return this
    },
    sortFacesByMaterialIndex: function() {
      for (var t = this.faces, e = t.length, i = 0; i < e; i++) t[i]._id = i;
      t.sort((function(t, e) {
        return t.materialIndex - e.materialIndex
      }));
      var n, r, a = this.faceVertexUvs[0],
        o = this.faceVertexUvs[1];
      for (a && a.length === e && (n = []), o && o.length === e && (r = []), i = 0; i < e; i++) {
        var s = t[i]._id;
        n && n.push(a[s]), r && r.push(o[s])
      }
      n && (this.faceVertexUvs[0] = n), r && (this.faceVertexUvs[1] = r)
    },
    toJSON: function() {
      var t = {
        metadata: {
          version: 4.5,
          type: "Geometry",
          generator: "Geometry.toJSON"
        }
      };
      if (t.uuid = this.uuid, t.type = this.type, "" !== this.name && (t.name = this.name), void 0 !== this.parameters) {
        var e = this.parameters;
        for (var i in e) void 0 !== e[i] && (t[i] = e[i]);
        return t
      }
      for (var n = [], r = 0; r < this.vertices.length; r++) {
        var a = this.vertices[r];
        n.push(a.x, a.y, a.z)
      }
      var o = [],
        s = [],
        c = {},
        h = [],
        l = {},
        u = [],
        p = {};
      for (r = 0; r < this.faces.length; r++) {
        var d = this.faces[r],
          f = void 0 !== this.faceVertexUvs[0][r],
          m = d.normal.length() > 0,
          g = d.vertexNormals.length > 0,
          v = 1 !== d.color.r || 1 !== d.color.g || 1 !== d.color.b,
          y = d.vertexColors.length > 0,
          x = 0;
        if (x = M(x = M(x = M(x = M(x = M(x = M(x = M(x = M(x, 0, 0), 1, !0), 2, !1), 3, f), 4, m), 5, g), 6, v), 7, y), o.push(x), o.push(d.a, d.b, d.c), o.push(d.materialIndex), f) {
          var b = this.faceVertexUvs[0][r];
          o.push(S(b[0]), S(b[1]), S(b[2]))
        }
        if (m && o.push(E(d.normal)), g) {
          var _ = d.vertexNormals;
          o.push(E(_[0]), E(_[1]), E(_[2]))
        }
        if (v && o.push(T(d.color)), y) {
          var w = d.vertexColors;
          o.push(T(w[0]), T(w[1]), T(w[2]))
        }
      }

      function M(t, e, i) {
        return i ? t | 1 << e : t & ~(1 << e)
      }

      function E(t) {
        var e = t.x.toString() + t.y.toString() + t.z.toString();
        return void 0 !== c[e] || (c[e] = s.length / 3, s.push(t.x, t.y, t.z)), c[e]
      }

      function T(t) {
        var e = t.r.toString() + t.g.toString() + t.b.toString();
        return void 0 !== l[e] || (l[e] = h.length, h.push(t.getHex())), l[e]
      }

      function S(t) {
        var e = t.x.toString() + t.y.toString();
        return void 0 !== p[e] || (p[e] = u.length / 2, u.push(t.x, t.y)), p[e]
      }
      return t.data = {}, t.data.vertices = n, t.data.normals = s, h.length > 0 && (t.data.colors = h), u.length > 0 && (t.data.uvs = [u]), t.data.faces = o, t
    },
    clone: function() {
      return (new ge).copy(this)
    },
    copy: function(t) {
      var e, i, n, r, a, o;
      this.vertices = [], this.colors = [], this.faces = [], this.faceVertexUvs = [
        []
      ], this.morphTargets = [], this.morphNormals = [], this.skinWeights = [], this.skinIndices = [], this.lineDistances = [], this.boundingBox = null, this.boundingSphere = null, this.name = t.name;
      var s = t.vertices;
      for (e = 0, i = s.length; e < i; e++) this.vertices.push(s[e].clone());
      var c = t.colors;
      for (e = 0, i = c.length; e < i; e++) this.colors.push(c[e].clone());
      var h = t.faces;
      for (e = 0, i = h.length; e < i; e++) this.faces.push(h[e].clone());
      for (e = 0, i = t.faceVertexUvs.length; e < i; e++) {
        var l = t.faceVertexUvs[e];
        for (void 0 === this.faceVertexUvs[e] && (this.faceVertexUvs[e] = []), n = 0, r = l.length; n < r; n++) {
          var u = l[n],
            p = [];
          for (a = 0, o = u.length; a < o; a++) {
            var d = u[a];
            p.push(d.clone())
          }
          this.faceVertexUvs[e].push(p)
        }
      }
      var f = t.morphTargets;
      for (e = 0, i = f.length; e < i; e++) {
        var m = {};
        if (m.name = f[e].name, void 0 !== f[e].vertices)
          for (m.vertices = [], n = 0, r = f[e].vertices.length; n < r; n++) m.vertices.push(f[e].vertices[n].clone());
        if (void 0 !== f[e].normals)
          for (m.normals = [], n = 0, r = f[e].normals.length; n < r; n++) m.normals.push(f[e].normals[n].clone());
        this.morphTargets.push(m)
      }
      var g = t.morphNormals;
      for (e = 0, i = g.length; e < i; e++) {
        var v = {};
        if (void 0 !== g[e].vertexNormals)
          for (v.vertexNormals = [], n = 0, r = g[e].vertexNormals.length; n < r; n++) {
            var y = g[e].vertexNormals[n],
              x = {};
            x.a = y.a.clone(), x.b = y.b.clone(), x.c = y.c.clone(), v.vertexNormals.push(x)
          }
        if (void 0 !== g[e].faceNormals)
          for (v.faceNormals = [], n = 0, r = g[e].faceNormals.length; n < r; n++) v.faceNormals.push(g[e].faceNormals[n].clone());
        this.morphNormals.push(v)
      }
      var b = t.skinWeights;
      for (e = 0, i = b.length; e < i; e++) this.skinWeights.push(b[e].clone());
      var _ = t.skinIndices;
      for (e = 0, i = _.length; e < i; e++) this.skinIndices.push(_[e].clone());
      var w = t.lineDistances;
      for (e = 0, i = w.length; e < i; e++) this.lineDistances.push(w[e]);
      var M = t.boundingBox;
      null !== M && (this.boundingBox = M.clone());
      var E = t.boundingSphere;
      return null !== E && (this.boundingSphere = E.clone()), this.elementsNeedUpdate = t.elementsNeedUpdate, this.verticesNeedUpdate = t.verticesNeedUpdate, this.uvsNeedUpdate = t.uvsNeedUpdate, this.normalsNeedUpdate = t.normalsNeedUpdate, this.colorsNeedUpdate = t.colorsNeedUpdate, this.lineDistancesNeedUpdate = t.lineDistancesNeedUpdate, this.groupsNeedUpdate = t.groupsNeedUpdate, this
    },
    dispose: function() {
      this.dispatchEvent({
        type: "dispose"
      })
    }
  }), Object.defineProperty(ve.prototype, "needsUpdate", {
    set: function(t) {
      !0 === t && this.version++
    }
  }), Object.assign(ve.prototype, {
    isBufferAttribute: !0,
    setArray: function(t) {
      if (Array.isArray(t)) throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
      this.count = void 0 !== t ? t.length / this.itemSize : 0, this.array = t
    },
    setDynamic: function(t) {
      return this.dynamic = t, this
    },
    copy: function(t) {
      return this.array = new t.array.constructor(t.array), this.itemSize = t.itemSize, this.count = t.count, this.normalized = t.normalized, this.dynamic = t.dynamic, this
    },
    copyAt: function(t, e, i) {
      t *= this.itemSize, i *= e.itemSize;
      for (var n = 0, r = this.itemSize; n < r; n++) this.array[t + n] = e.array[i + n];
      return this
    },
    copyArray: function(t) {
      return this.array.set(t), this
    },
    copyColorsArray: function(t) {
      for (var e = this.array, i = 0, n = 0, r = t.length; n < r; n++) {
        var a = t[n];
        void 0 === a && (console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined", n), a = new Ct), e[i++] = a.r, e[i++] = a.g, e[i++] = a.b
      }
      return this
    },
    copyIndicesArray: function(t) {
      for (var e = this.array, i = 0, n = 0, r = t.length; n < r; n++) {
        var a = t[n];
        e[i++] = a.a, e[i++] = a.b, e[i++] = a.c
      }
      return this
    },
    copyVector2sArray: function(t) {
      for (var e = this.array, i = 0, n = 0, r = t.length; n < r; n++) {
        var a = t[n];
        void 0 === a && (console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined", n), a = new U), e[i++] = a.x, e[i++] = a.y
      }
      return this
    },
    copyVector3sArray: function(t) {
      for (var e = this.array, i = 0, n = 0, r = t.length; n < r; n++) {
        var a = t[n];
        void 0 === a && (console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined", n), a = new N), e[i++] = a.x, e[i++] = a.y, e[i++] = a.z
      }
      return this
    },
    copyVector4sArray: function(t) {
      for (var e = this.array, i = 0, n = 0, r = t.length; n < r; n++) {
        var a = t[n];
        void 0 === a && (console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined", n), a = new G), e[i++] = a.x, e[i++] = a.y, e[i++] = a.z, e[i++] = a.w
      }
      return this
    },
    set: function(t, e) {
      return void 0 === e && (e = 0), this.array.set(t, e), this
    },
    getX: function(t) {
      return this.array[t * this.itemSize]
    },
    setX: function(t, e) {
      return this.array[t * this.itemSize] = e, this
    },
    getY: function(t) {
      return this.array[t * this.itemSize + 1]
    },
    setY: function(t, e) {
      return this.array[t * this.itemSize + 1] = e, this
    },
    getZ: function(t) {
      return this.array[t * this.itemSize + 2]
    },
    setZ: function(t, e) {
      return this.array[t * this.itemSize + 2] = e, this
    },
    getW: function(t) {
      return this.array[t * this.itemSize + 3]
    },
    setW: function(t, e) {
      return this.array[t * this.itemSize + 3] = e, this
    },
    setXY: function(t, e, i) {
      return t *= this.itemSize, this.array[t + 0] = e, this.array[t + 1] = i, this
    },
    setXYZ: function(t, e, i, n) {
      return t *= this.itemSize, this.array[t + 0] = e, this.array[t + 1] = i, this.array[t + 2] = n, this
    },
    setXYZW: function(t, e, i, n, r) {
      return t *= this.itemSize, this.array[t + 0] = e, this.array[t + 1] = i, this.array[t + 2] = n, this.array[t + 3] = r, this
    },
    onUpload: function(t) {
      return this.onUploadCallback = t, this
    },
    clone: function() {
      return new this.constructor(this.array, this.itemSize).copy(this)
    }
  }), ye.prototype = Object.create(ve.prototype), ye.prototype.constructor = ye, xe.prototype = Object.create(ve.prototype), xe.prototype.constructor = xe, be.prototype = Object.create(ve.prototype), be.prototype.constructor = be, _e.prototype = Object.create(ve.prototype), _e.prototype.constructor = _e, we.prototype = Object.create(ve.prototype), we.prototype.constructor = we, Me.prototype = Object.create(ve.prototype), Me.prototype.constructor = Me, Ee.prototype = Object.create(ve.prototype), Ee.prototype.constructor = Ee, Te.prototype = Object.create(ve.prototype), Te.prototype.constructor = Te, Se.prototype = Object.create(ve.prototype), Se.prototype.constructor = Se, Object.assign(Ae.prototype, {
    computeGroups: function(t) {
      for (var e, i = [], n = void 0, r = t.faces, a = 0; a < r.length; a++) {
        var o = r[a];
        o.materialIndex !== n && (n = o.materialIndex, void 0 !== e && (e.count = 3 * a - e.start, i.push(e)), e = {
          start: 3 * a,
          materialIndex: n
        })
      }
      void 0 !== e && (e.count = 3 * a - e.start, i.push(e)), this.groups = i
    },
    fromGeometry: function(t) {
      var e, i = t.faces,
        n = t.vertices,
        r = t.faceVertexUvs,
        a = r[0] && r[0].length > 0,
        o = r[1] && r[1].length > 0,
        s = t.morphTargets,
        c = s.length;
      if (c > 0) {
        e = [];
        for (var h = 0; h < c; h++) e[h] = [];
        this.morphTargets.position = e
      }
      var l, u = t.morphNormals,
        p = u.length;
      if (p > 0) {
        for (l = [], h = 0; h < p; h++) l[h] = [];
        this.morphTargets.normal = l
      }
      var d = t.skinIndices,
        f = t.skinWeights,
        m = d.length === n.length,
        g = f.length === n.length;
      for (h = 0; h < i.length; h++) {
        var v = i[h];
        this.vertices.push(n[v.a], n[v.b], n[v.c]);
        var y = v.vertexNormals;
        if (3 === y.length) this.normals.push(y[0], y[1], y[2]);
        else {
          var x = v.normal;
          this.normals.push(x, x, x)
        }
        var b, _ = v.vertexColors;
        if (3 === _.length) this.colors.push(_[0], _[1], _[2]);
        else {
          var w = v.color;
          this.colors.push(w, w, w)
        }!0 === a && (void 0 !== (b = r[0][h]) ? this.uvs.push(b[0], b[1], b[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ", h), this.uvs.push(new U, new U, new U))), !0 === o && (void 0 !== (b = r[1][h]) ? this.uvs2.push(b[0], b[1], b[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ", h), this.uvs2.push(new U, new U, new U)));
        for (var M = 0; M < c; M++) {
          var E = s[M].vertices;
          e[M].push(E[v.a], E[v.b], E[v.c])
        }
        for (M = 0; M < p; M++) {
          var T = u[M].vertexNormals[h];
          l[M].push(T.a, T.b, T.c)
        }
        m && this.skinIndices.push(d[v.a], d[v.b], d[v.c]), g && this.skinWeights.push(f[v.a], f[v.b], f[v.c])
      }
      return this.computeGroups(t), this.verticesNeedUpdate = t.verticesNeedUpdate, this.normalsNeedUpdate = t.normalsNeedUpdate, this.colorsNeedUpdate = t.colorsNeedUpdate, this.uvsNeedUpdate = t.uvsNeedUpdate, this.groupsNeedUpdate = t.groupsNeedUpdate, this
    }
  });
  var Le, Pe, Ce, Ie, Ue, De, Oe, Ne = 1;

  function Be() {
    Object.defineProperty(this, "id", {
      value: Ne += 2
    }), this.uuid = I.generateUUID(), this.name = "", this.type = "BufferGeometry", this.index = null, this.attributes = {}, this.morphAttributes = {}, this.groups = [], this.boundingBox = null, this.boundingSphere = null, this.drawRange = {
      start: 0,
      count: 1 / 0
    }
  }

  function Fe(t, e, i, n, r, a) {
    ge.call(this), this.type = "BoxGeometry", this.parameters = {
      width: t,
      height: e,
      depth: i,
      widthSegments: n,
      heightSegments: r,
      depthSegments: a
    }, this.fromBufferGeometry(new ze(t, e, i, n, r, a)), this.mergeVertices()
  }

  function ze(t, e, i, n, r, a) {
    Be.call(this), this.type = "BoxBufferGeometry", this.parameters = {
      width: t,
      height: e,
      depth: i,
      widthSegments: n,
      heightSegments: r,
      depthSegments: a
    };
    var o = this;
    t = t || 1, e = e || 1, i = i || 1, n = Math.floor(n) || 1, r = Math.floor(r) || 1, a = Math.floor(a) || 1;
    var s = [],
      c = [],
      h = [],
      l = [],
      u = 0,
      p = 0;

    function d(t, e, i, n, r, a, d, f, m, g, v) {
      var y, x, b = a / m,
        _ = d / g,
        w = a / 2,
        M = d / 2,
        E = f / 2,
        T = m + 1,
        S = g + 1,
        A = 0,
        R = 0,
        L = new N;
      for (x = 0; x < S; x++) {
        var P = x * _ - M;
        for (y = 0; y < T; y++) {
          var C = y * b - w;
          L[t] = C * n, L[e] = P * r, L[i] = E, c.push(L.x, L.y, L.z), L[t] = 0, L[e] = 0, L[i] = f > 0 ? 1 : -1, h.push(L.x, L.y, L.z), l.push(y / m), l.push(1 - x / g), A += 1
        }
      }
      for (x = 0; x < g; x++)
        for (y = 0; y < m; y++) {
          var I = u + y + T * x,
            U = u + y + T * (x + 1),
            D = u + (y + 1) + T * (x + 1),
            O = u + (y + 1) + T * x;
          s.push(I, U, O), s.push(U, D, O), R += 6
        }
      o.addGroup(p, R, v), p += R, u += A
    }
    d("z", "y", "x", -1, -1, i, e, t, a, r, 0), d("z", "y", "x", 1, -1, i, e, -t, a, r, 1), d("x", "z", "y", 1, 1, t, i, e, n, a, 2), d("x", "z", "y", 1, -1, t, i, -e, n, a, 3), d("x", "y", "z", 1, -1, t, e, i, n, r, 4), d("x", "y", "z", -1, -1, t, e, -i, n, r, 5), this.setIndex(s), this.addAttribute("position", new Te(c, 3)), this.addAttribute("normal", new Te(h, 3)), this.addAttribute("uv", new Te(l, 2))
  }

  function Ge(t, e, i, n) {
    ge.call(this), this.type = "PlaneGeometry", this.parameters = {
      width: t,
      height: e,
      widthSegments: i,
      heightSegments: n
    }, this.fromBufferGeometry(new He(t, e, i, n)), this.mergeVertices()
  }

  function He(t, e, i, n) {
    Be.call(this), this.type = "PlaneBufferGeometry", this.parameters = {
      width: t,
      height: e,
      widthSegments: i,
      heightSegments: n
    };
    var r, a, o = (t = t || 1) / 2,
      s = (e = e || 1) / 2,
      c = Math.floor(i) || 1,
      h = Math.floor(n) || 1,
      l = c + 1,
      u = h + 1,
      p = t / c,
      d = e / h,
      f = [],
      m = [],
      g = [],
      v = [];
    for (a = 0; a < u; a++) {
      var y = a * d - s;
      for (r = 0; r < l; r++) {
        var x = r * p - o;
        m.push(x, -y, 0), g.push(0, 0, 1), v.push(r / c), v.push(1 - a / h)
      }
    }
    for (a = 0; a < h; a++)
      for (r = 0; r < c; r++) {
        var b = r + l * a,
          _ = r + l * (a + 1),
          w = r + 1 + l * (a + 1),
          M = r + 1 + l * a;
        f.push(b, _, M), f.push(_, w, M)
      }
    this.setIndex(f), this.addAttribute("position", new Te(m, 3)), this.addAttribute("normal", new Te(g, 3)), this.addAttribute("uv", new Te(v, 2))
  }

  function Ve(t) {
    Yt.call(this), this.type = "MeshBasicMaterial", this.color = new Ct(16777215), this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = 0, this.reflectivity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.lights = !1, this.setValues(t)
  }

  function ke(t) {
    Yt.call(this), this.type = "ShaderMaterial", this.defines = {}, this.uniforms = {}, this.vertexShader = "void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}", this.fragmentShader = "void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}", this.linewidth = 1, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.clipping = !1, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.extensions = {
      derivatives: !1,
      fragDepth: !1,
      drawBuffers: !1,
      shaderTextureLOD: !1
    }, this.defaultAttributeValues = {
      color: [1, 1, 1],
      uv: [0, 0],
      uv2: [0, 0]
    }, this.index0AttributeName = void 0, void 0 !== t && (void 0 !== t.attributes && console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."), this.setValues(t))
  }

  function je(t, e) {
    this.origin = void 0 !== t ? t : new N, this.direction = void 0 !== e ? e : new N
  }

  function We(t, e) {
    this.start = void 0 !== t ? t : new N, this.end = void 0 !== e ? e : new N
  }

  function Xe(t, e, i) {
    this.a = void 0 !== t ? t : new N, this.b = void 0 !== e ? e : new N, this.c = void 0 !== i ? i : new N
  }

  function qe(t, e) {
    le.call(this), this.type = "Mesh", this.geometry = void 0 !== t ? t : new Be, this.material = void 0 !== e ? e : new Ve({
      color: 16777215 * Math.random()
    }), this.drawMode = 0, this.updateMorphTargets()
  }

  function Ye(t, e) {
    return t.renderOrder !== e.renderOrder ? t.renderOrder - e.renderOrder : t.program && e.program && t.program !== e.program ? t.program.id - e.program.id : t.material.id !== e.material.id ? t.material.id - e.material.id : t.z !== e.z ? t.z - e.z : t.id - e.id
  }

  function Ze(t, e) {
    return t.renderOrder !== e.renderOrder ? t.renderOrder - e.renderOrder : t.z !== e.z ? e.z - t.z : t.id - e.id
  }

  function Je() {
    var t = {};
    return {
      get: function(e, i) {
        var n = e.id + "," + i.id,
          r = t[n];
        return void 0 === r && (r = new function() {
          var t = [],
            e = 0,
            i = [],
            n = [];
          return {
            opaque: i,
            transparent: n,
            init: function() {
              e = 0, i.length = 0, n.length = 0
            },
            push: function(r, a, o, s, c) {
              var h = t[e];
              void 0 === h ? (h = {
                id: r.id,
                object: r,
                geometry: a,
                material: o,
                program: o.program,
                renderOrder: r.renderOrder,
                z: s,
                group: c
              }, t[e] = h) : (h.id = r.id, h.object = r, h.geometry = a, h.material = o, h.program = o.program, h.renderOrder = r.renderOrder, h.z = s, h.group = c), (!0 === o.transparent ? n : i).push(h), e++
            },
            sort: function() {
              i.length > 1 && i.sort(Ye), n.length > 1 && n.sort(Ze)
            }
          }
        }, t[n] = r), r
      },
      dispose: function() {
        t = {}
      }
    }
  }

  function Qe(t, e) {
    return Math.abs(e[1]) - Math.abs(t[1])
  }

  function Ke() {
    var t = new function() {
        var t = {};
        return {
          get: function(e) {
            if (void 0 !== t[e.id]) return t[e.id];
            var i;
            switch (e.type) {
              case "DirectionalLight":
                i = {
                  direction: new N,
                  color: new Ct,
                  shadow: !1,
                  shadowBias: 0,
                  shadowRadius: 1,
                  shadowMapSize: new U
                };
                break;
              case "SpotLight":
                i = {
                  position: new N,
                  direction: new N,
                  color: new Ct,
                  distance: 0,
                  coneCos: 0,
                  penumbraCos: 0,
                  decay: 0,
                  shadow: !1,
                  shadowBias: 0,
                  shadowRadius: 1,
                  shadowMapSize: new U
                };
                break;
              case "PointLight":
                i = {
                  position: new N,
                  color: new Ct,
                  distance: 0,
                  decay: 0,
                  shadow: !1,
                  shadowBias: 0,
                  shadowRadius: 1,
                  shadowMapSize: new U,
                  shadowCameraNear: 1,
                  shadowCameraFar: 1e3
                };
                break;
              case "HemisphereLight":
                i = {
                  direction: new N,
                  skyColor: new Ct,
                  groundColor: new Ct
                };
                break;
              case "RectAreaLight":
                i = {
                  color: new Ct,
                  position: new N,
                  halfWidth: new N,
                  halfHeight: new N
                }
            }
            return t[e.id] = i, i
          }
        }
      },
      e = {
        hash: "",
        ambient: [0, 0, 0],
        directional: [],
        directionalShadowMap: [],
        directionalShadowMatrix: [],
        spot: [],
        spotShadowMap: [],
        spotShadowMatrix: [],
        rectArea: [],
        point: [],
        pointShadowMap: [],
        pointShadowMatrix: [],
        hemi: []
      },
      i = new N,
      n = new D,
      r = new D;
    return {
      setup: function(a, o, s) {
        for (var c = 0, h = 0, l = 0, u = 0, p = 0, d = 0, f = 0, m = 0, g = s.matrixWorldInverse, v = 0, y = a.length; v < y; v++) {
          var x = a[v],
            b = x.color,
            _ = x.intensity,
            w = x.distance,
            M = x.shadow && x.shadow.map ? x.shadow.map.texture : null;
          if (x.isAmbientLight) c += b.r * _, h += b.g * _, l += b.b * _;
          else if (x.isDirectionalLight) {
            if ((T = t.get(x)).color.copy(x.color).multiplyScalar(x.intensity), T.direction.setFromMatrixPosition(x.matrixWorld), i.setFromMatrixPosition(x.target.matrixWorld), T.direction.sub(i), T.direction.transformDirection(g), T.shadow = x.castShadow, x.castShadow) {
              var E = x.shadow;
              T.shadowBias = E.bias, T.shadowRadius = E.radius, T.shadowMapSize = E.mapSize
            }
            e.directionalShadowMap[u] = M, e.directionalShadowMatrix[u] = x.shadow.matrix, e.directional[u] = T, u++
          } else if (x.isSpotLight)(T = t.get(x)).position.setFromMatrixPosition(x.matrixWorld), T.position.applyMatrix4(g), T.color.copy(b).multiplyScalar(_), T.distance = w, T.direction.setFromMatrixPosition(x.matrixWorld), i.setFromMatrixPosition(x.target.matrixWorld), T.direction.sub(i), T.direction.transformDirection(g), T.coneCos = Math.cos(x.angle), T.penumbraCos = Math.cos(x.angle * (1 - x.penumbra)), T.decay = 0 === x.distance ? 0 : x.decay, T.shadow = x.castShadow, x.castShadow && (E = x.shadow, T.shadowBias = E.bias, T.shadowRadius = E.radius, T.shadowMapSize = E.mapSize), e.spotShadowMap[d] = M, e.spotShadowMatrix[d] = x.shadow.matrix, e.spot[d] = T, d++;
          else if (x.isRectAreaLight)(T = t.get(x)).color.copy(b).multiplyScalar(_ / (x.width * x.height)), T.position.setFromMatrixPosition(x.matrixWorld), T.position.applyMatrix4(g), r.identity(), n.copy(x.matrixWorld), n.premultiply(g), r.extractRotation(n), T.halfWidth.set(.5 * x.width, 0, 0), T.halfHeight.set(0, .5 * x.height, 0), T.halfWidth.applyMatrix4(r), T.halfHeight.applyMatrix4(r), e.rectArea[f] = T, f++;
          else if (x.isPointLight)(T = t.get(x)).position.setFromMatrixPosition(x.matrixWorld), T.position.applyMatrix4(g), T.color.copy(x.color).multiplyScalar(x.intensity), T.distance = x.distance, T.decay = 0 === x.distance ? 0 : x.decay, T.shadow = x.castShadow, x.castShadow && (E = x.shadow, T.shadowBias = E.bias, T.shadowRadius = E.radius, T.shadowMapSize = E.mapSize, T.shadowCameraNear = E.camera.near, T.shadowCameraFar = E.camera.far), e.pointShadowMap[p] = M, e.pointShadowMatrix[p] = x.shadow.matrix, e.point[p] = T, p++;
          else if (x.isHemisphereLight) {
            var T;
            (T = t.get(x)).direction.setFromMatrixPosition(x.matrixWorld), T.direction.transformDirection(g), T.direction.normalize(), T.skyColor.copy(x.color).multiplyScalar(_), T.groundColor.copy(x.groundColor).multiplyScalar(_), e.hemi[m] = T, m++
          }
        }
        e.ambient[0] = c, e.ambient[1] = h, e.ambient[2] = l, e.directional.length = u, e.spot.length = d, e.rectArea.length = f, e.point.length = p, e.hemi.length = m, e.hash = u + "," + p + "," + d + "," + f + "," + m + "," + o.length
      },
      state: e
    }
  }

  function $e(t, e, i) {
    var n = t.createShader(e);
    return t.shaderSource(n, i), t.compileShader(n), !1 === t.getShaderParameter(n, t.COMPILE_STATUS) && console.error("THREE.WebGLShader: Shader couldn't compile."), "" !== t.getShaderInfoLog(n) && console.warn("THREE.WebGLShader: gl.getShaderInfoLog()", e === t.VERTEX_SHADER ? "vertex" : "fragment", t.getShaderInfoLog(n), function(t) {
      for (var e = t.split("\n"), i = 0; i < e.length; i++) e[i] = i + 1 + ": " + e[i];
      return e.join("\n")
    }(i)), n
  }
  Object.assign(Be.prototype, i.prototype, {
    isBufferGeometry: !0,
    getIndex: function() {
      return this.index
    },
    setIndex: function(t) {
      Array.isArray(t) ? this.index = new(Re(t) > 65535 ? Ee : we)(t, 1) : this.index = t
    },
    addAttribute: function(t, e) {
      return e && e.isBufferAttribute || e && e.isInterleavedBufferAttribute ? "index" === t ? (console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."), void this.setIndex(e)) : (this.attributes[t] = e, this) : (console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."), void this.addAttribute(t, new ve(arguments[1], arguments[2])))
    },
    getAttribute: function(t) {
      return this.attributes[t]
    },
    removeAttribute: function(t) {
      return delete this.attributes[t], this
    },
    addGroup: function(t, e, i) {
      this.groups.push({
        start: t,
        count: e,
        materialIndex: void 0 !== i ? i : 0
      })
    },
    clearGroups: function() {
      this.groups = []
    },
    setDrawRange: function(t, e) {
      this.drawRange.start = t, this.drawRange.count = e
    },
    applyMatrix: function(t) {
      var e = this.attributes.position;
      void 0 !== e && (t.applyToBufferAttribute(e), e.needsUpdate = !0);
      var i = this.attributes.normal;
      return void 0 !== i && ((new B).getNormalMatrix(t).applyToBufferAttribute(i), i.needsUpdate = !0), null !== this.boundingBox && this.computeBoundingBox(), null !== this.boundingSphere && this.computeBoundingSphere(), this
    },
    rotateX: function() {
      var t = new D;
      return function(e) {
        return t.makeRotationX(e), this.applyMatrix(t), this
      }
    }(),
    rotateY: function() {
      var t = new D;
      return function(e) {
        return t.makeRotationY(e), this.applyMatrix(t), this
      }
    }(),
    rotateZ: function() {
      var t = new D;
      return function(e) {
        return t.makeRotationZ(e), this.applyMatrix(t), this
      }
    }(),
    translate: function() {
      var t = new D;
      return function(e, i, n) {
        return t.makeTranslation(e, i, n), this.applyMatrix(t), this
      }
    }(),
    scale: function() {
      var t = new D;
      return function(e, i, n) {
        return t.makeScale(e, i, n), this.applyMatrix(t), this
      }
    }(),
    lookAt: function() {
      var t = new le;
      return function(e) {
        t.lookAt(e), t.updateMatrix(), this.applyMatrix(t.matrix)
      }
    }(),
    center: function() {
      this.computeBoundingBox();
      var t = this.boundingBox.getCenter().negate();
      return this.translate(t.x, t.y, t.z), t
    },
    setFromObject: function(t) {
      var e = t.geometry;
      if (t.isPoints || t.isLine) {
        var i = new Te(3 * e.vertices.length, 3),
          n = new Te(3 * e.colors.length, 3);
        if (this.addAttribute("position", i.copyVector3sArray(e.vertices)), this.addAttribute("color", n.copyColorsArray(e.colors)), e.lineDistances && e.lineDistances.length === e.vertices.length) {
          var r = new Te(e.lineDistances.length, 1);
          this.addAttribute("lineDistance", r.copyArray(e.lineDistances))
        }
        null !== e.boundingSphere && (this.boundingSphere = e.boundingSphere.clone()), null !== e.boundingBox && (this.boundingBox = e.boundingBox.clone())
      } else t.isMesh && e && e.isGeometry && this.fromGeometry(e);
      return this
    },
    setFromPoints: function(t) {
      for (var e = [], i = 0, n = t.length; i < n; i++) {
        var r = t[i];
        e.push(r.x, r.y, r.z || 0)
      }
      return this.addAttribute("position", new Te(e, 3)), this
    },
    updateFromObject: function(t) {
      var e, i = t.geometry;
      if (t.isMesh) {
        var n = i.__directGeometry;
        if (!0 === i.elementsNeedUpdate && (n = void 0, i.elementsNeedUpdate = !1), void 0 === n) return this.fromGeometry(i);
        n.verticesNeedUpdate = i.verticesNeedUpdate, n.normalsNeedUpdate = i.normalsNeedUpdate, n.colorsNeedUpdate = i.colorsNeedUpdate, n.uvsNeedUpdate = i.uvsNeedUpdate, n.groupsNeedUpdate = i.groupsNeedUpdate, i.verticesNeedUpdate = !1, i.normalsNeedUpdate = !1, i.colorsNeedUpdate = !1, i.uvsNeedUpdate = !1, i.groupsNeedUpdate = !1, i = n
      }
      return !0 === i.verticesNeedUpdate && (void 0 !== (e = this.attributes.position) && (e.copyVector3sArray(i.vertices), e.needsUpdate = !0), i.verticesNeedUpdate = !1), !0 === i.normalsNeedUpdate && (void 0 !== (e = this.attributes.normal) && (e.copyVector3sArray(i.normals), e.needsUpdate = !0), i.normalsNeedUpdate = !1), !0 === i.colorsNeedUpdate && (void 0 !== (e = this.attributes.color) && (e.copyColorsArray(i.colors), e.needsUpdate = !0), i.colorsNeedUpdate = !1), i.uvsNeedUpdate && (void 0 !== (e = this.attributes.uv) && (e.copyVector2sArray(i.uvs), e.needsUpdate = !0), i.uvsNeedUpdate = !1), i.lineDistancesNeedUpdate && (void 0 !== (e = this.attributes.lineDistance) && (e.copyArray(i.lineDistances), e.needsUpdate = !0), i.lineDistancesNeedUpdate = !1), i.groupsNeedUpdate && (i.computeGroups(t.geometry), this.groups = i.groups, i.groupsNeedUpdate = !1), this
    },
    fromGeometry: function(t) {
      return t.__directGeometry = (new Ae).fromGeometry(t), this.fromDirectGeometry(t.__directGeometry)
    },
    fromDirectGeometry: function(t) {
      var e = new Float32Array(3 * t.vertices.length);
      if (this.addAttribute("position", new ve(e, 3).copyVector3sArray(t.vertices)), t.normals.length > 0) {
        var i = new Float32Array(3 * t.normals.length);
        this.addAttribute("normal", new ve(i, 3).copyVector3sArray(t.normals))
      }
      if (t.colors.length > 0) {
        var n = new Float32Array(3 * t.colors.length);
        this.addAttribute("color", new ve(n, 3).copyColorsArray(t.colors))
      }
      if (t.uvs.length > 0) {
        var r = new Float32Array(2 * t.uvs.length);
        this.addAttribute("uv", new ve(r, 2).copyVector2sArray(t.uvs))
      }
      if (t.uvs2.length > 0) {
        var a = new Float32Array(2 * t.uvs2.length);
        this.addAttribute("uv2", new ve(a, 2).copyVector2sArray(t.uvs2))
      }
      if (t.indices.length > 0) {
        var o = new(Re(t.indices) > 65535 ? Uint32Array : Uint16Array)(3 * t.indices.length);
        this.setIndex(new ve(o, 1).copyIndicesArray(t.indices))
      }
      for (var s in this.groups = t.groups, t.morphTargets) {
        for (var c = [], h = t.morphTargets[s], l = 0, u = h.length; l < u; l++) {
          var p = h[l],
            d = new Te(3 * p.length, 3);
          c.push(d.copyVector3sArray(p))
        }
        this.morphAttributes[s] = c
      }
      if (t.skinIndices.length > 0) {
        var f = new Te(4 * t.skinIndices.length, 4);
        this.addAttribute("skinIndex", f.copyVector4sArray(t.skinIndices))
      }
      if (t.skinWeights.length > 0) {
        var m = new Te(4 * t.skinWeights.length, 4);
        this.addAttribute("skinWeight", m.copyVector4sArray(t.skinWeights))
      }
      return null !== t.boundingSphere && (this.boundingSphere = t.boundingSphere.clone()), null !== t.boundingBox && (this.boundingBox = t.boundingBox.clone()), this
    },
    computeBoundingBox: function() {
      null === this.boundingBox && (this.boundingBox = new Qt);
      var t = this.attributes.position;
      void 0 !== t ? this.boundingBox.setFromBufferAttribute(t) : this.boundingBox.makeEmpty(), (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) && console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.', this)
    },
    computeBoundingSphere: function() {
      var t = new Qt,
        e = new N;
      return function() {
        null === this.boundingSphere && (this.boundingSphere = new Kt);
        var i = this.attributes.position;
        if (i) {
          var n = this.boundingSphere.center;
          t.setFromBufferAttribute(i), t.getCenter(n);
          for (var r = 0, a = 0, o = i.count; a < o; a++) e.x = i.getX(a), e.y = i.getY(a), e.z = i.getZ(a), r = Math.max(r, n.distanceToSquared(e));
          this.boundingSphere.radius = Math.sqrt(r), isNaN(this.boundingSphere.radius) && console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.', this)
        }
      }
    }(),
    computeFaceNormals: function() {},
    computeVertexNormals: function() {
      var t = this.index,
        e = this.attributes,
        i = this.groups;
      if (e.position) {
        var n = e.position.array;
        if (void 0 === e.normal) this.addAttribute("normal", new ve(new Float32Array(n.length), 3));
        else
          for (var r = e.normal.array, a = 0, o = r.length; a < o; a++) r[a] = 0;
        var s, c, h, l = e.normal.array,
          u = new N,
          p = new N,
          d = new N,
          f = new N,
          m = new N;
        if (t) {
          var g = t.array;
          0 === i.length && this.addGroup(0, g.length);
          for (var v = 0, y = i.length; v < y; ++v) {
            var x = i[v],
              b = x.start;
            for (a = b, o = b + x.count; a < o; a += 3) s = 3 * g[a + 0], c = 3 * g[a + 1], h = 3 * g[a + 2], u.fromArray(n, s), p.fromArray(n, c), d.fromArray(n, h), f.subVectors(d, p), m.subVectors(u, p), f.cross(m), l[s] += f.x, l[s + 1] += f.y, l[s + 2] += f.z, l[c] += f.x, l[c + 1] += f.y, l[c + 2] += f.z, l[h] += f.x, l[h + 1] += f.y, l[h + 2] += f.z
          }
        } else
          for (a = 0, o = n.length; a < o; a += 9) u.fromArray(n, a), p.fromArray(n, a + 3), d.fromArray(n, a + 6), f.subVectors(d, p), m.subVectors(u, p), f.cross(m), l[a] = f.x, l[a + 1] = f.y, l[a + 2] = f.z, l[a + 3] = f.x, l[a + 4] = f.y, l[a + 5] = f.z, l[a + 6] = f.x, l[a + 7] = f.y, l[a + 8] = f.z;
        this.normalizeNormals(), e.normal.needsUpdate = !0
      }
    },
    merge: function(t, e) {
      if (t && t.isBufferGeometry) {
        void 0 === e && (e = 0);
        var i = this.attributes;
        for (var n in i)
          if (void 0 !== t.attributes[n])
            for (var r = i[n].array, a = t.attributes[n], o = a.array, s = 0, c = a.itemSize * e; s < o.length; s++, c++) r[c] = o[s];
        return this
      }
      console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.", t)
    },
    normalizeNormals: function() {
      var t = new N;
      return function() {
        for (var e = this.attributes.normal, i = 0, n = e.count; i < n; i++) t.x = e.getX(i), t.y = e.getY(i), t.z = e.getZ(i), t.normalize(), e.setXYZ(i, t.x, t.y, t.z)
      }
    }(),
    toNonIndexed: function() {
      if (null === this.index) return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."), this;
      var t = new Be,
        e = this.index.array,
        i = this.attributes;
      for (var n in i) {
        for (var r = i[n], a = r.array, o = r.itemSize, s = new a.constructor(e.length * o), c = 0, h = 0, l = 0, u = e.length; l < u; l++) {
          c = e[l] * o;
          for (var p = 0; p < o; p++) s[h++] = a[c++]
        }
        t.addAttribute(n, new ve(s, o))
      }
      return t
    },
    toJSON: function() {
      var t = {
        metadata: {
          version: 4.5,
          type: "BufferGeometry",
          generator: "BufferGeometry.toJSON"
        }
      };
      if (t.uuid = this.uuid, t.type = this.type, "" !== this.name && (t.name = this.name), void 0 !== this.parameters) {
        var e = this.parameters;
        for (var i in e) void 0 !== e[i] && (t[i] = e[i]);
        return t
      }
      t.data = {
        attributes: {}
      };
      var n = this.index;
      if (null !== n) {
        var r = Array.prototype.slice.call(n.array);
        t.data.index = {
          type: n.array.constructor.name,
          array: r
        }
      }
      var a = this.attributes;
      for (var i in a) {
        var o = a[i];
        r = Array.prototype.slice.call(o.array), t.data.attributes[i] = {
          itemSize: o.itemSize,
          type: o.array.constructor.name,
          array: r,
          normalized: o.normalized
        }
      }
      var s = this.groups;
      s.length > 0 && (t.data.groups = JSON.parse(JSON.stringify(s)));
      var c = this.boundingSphere;
      return null !== c && (t.data.boundingSphere = {
        center: c.center.toArray(),
        radius: c.radius
      }), t
    },
    clone: function() {
      return (new Be).copy(this)
    },
    copy: function(t) {
      var e, i, n;
      this.index = null, this.attributes = {}, this.morphAttributes = {}, this.groups = [], this.boundingBox = null, this.boundingSphere = null, this.name = t.name;
      var r = t.index;
      null !== r && this.setIndex(r.clone());
      var a = t.attributes;
      for (e in a) {
        var o = a[e];
        this.addAttribute(e, o.clone())
      }
      var s = t.morphAttributes;
      for (e in s) {
        var c = [],
          h = s[e];
        for (i = 0, n = h.length; i < n; i++) c.push(h[i].clone());
        this.morphAttributes[e] = c
      }
      var l = t.groups;
      for (i = 0, n = l.length; i < n; i++) {
        var u = l[i];
        this.addGroup(u.start, u.count, u.materialIndex)
      }
      var p = t.boundingBox;
      null !== p && (this.boundingBox = p.clone());
      var d = t.boundingSphere;
      return null !== d && (this.boundingSphere = d.clone()), this.drawRange.start = t.drawRange.start, this.drawRange.count = t.drawRange.count, this
    },
    dispose: function() {
      this.dispatchEvent({
        type: "dispose"
      })
    }
  }), Fe.prototype = Object.create(ge.prototype), Fe.prototype.constructor = Fe, ze.prototype = Object.create(Be.prototype), ze.prototype.constructor = ze, Ge.prototype = Object.create(ge.prototype), Ge.prototype.constructor = Ge, He.prototype = Object.create(Be.prototype), He.prototype.constructor = He, Ve.prototype = Object.create(Yt.prototype), Ve.prototype.constructor = Ve, Ve.prototype.isMeshBasicMaterial = !0, Ve.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.color.copy(t.color), this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.specularMap = t.specularMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.combine = t.combine, this.reflectivity = t.reflectivity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this
  }, ke.prototype = Object.create(Yt.prototype), ke.prototype.constructor = ke, ke.prototype.isShaderMaterial = !0, ke.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.fragmentShader = t.fragmentShader, this.vertexShader = t.vertexShader, this.uniforms = Ut.clone(t.uniforms), this.defines = t.defines, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.lights = t.lights, this.clipping = t.clipping, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this.morphNormals = t.morphNormals, this.extensions = t.extensions, this
  }, ke.prototype.toJSON = function(t) {
    var e = Yt.prototype.toJSON.call(this, t);
    return e.uniforms = this.uniforms, e.vertexShader = this.vertexShader, e.fragmentShader = this.fragmentShader, e
  }, Object.assign(je.prototype, {
    set: function(t, e) {
      return this.origin.copy(t), this.direction.copy(e), this
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.origin.copy(t.origin), this.direction.copy(t.direction), this
    },
    at: function(t, e) {
      return (e || new N).copy(this.direction).multiplyScalar(t).add(this.origin)
    },
    lookAt: function(t) {
      return this.direction.copy(t).sub(this.origin).normalize(), this
    },
    recast: function() {
      var t = new N;
      return function(e) {
        return this.origin.copy(this.at(e, t)), this
      }
    }(),
    closestPointToPoint: function(t, e) {
      var i = e || new N;
      i.subVectors(t, this.origin);
      var n = i.dot(this.direction);
      return n < 0 ? i.copy(this.origin) : i.copy(this.direction).multiplyScalar(n).add(this.origin)
    },
    distanceToPoint: function(t) {
      return Math.sqrt(this.distanceSqToPoint(t))
    },
    distanceSqToPoint: function() {
      var t = new N;
      return function(e) {
        var i = t.subVectors(e, this.origin).dot(this.direction);
        return i < 0 ? this.origin.distanceToSquared(e) : (t.copy(this.direction).multiplyScalar(i).add(this.origin), t.distanceToSquared(e))
      }
    }(),
    distanceSqToSegment: (Pe = new N, Ce = new N, Ie = new N, function(t, e, i, n) {
      Pe.copy(t).add(e).multiplyScalar(.5), Ce.copy(e).sub(t).normalize(), Ie.copy(this.origin).sub(Pe);
      var r, a, o, s, c = .5 * t.distanceTo(e),
        h = -this.direction.dot(Ce),
        l = Ie.dot(this.direction),
        u = -Ie.dot(Ce),
        p = Ie.lengthSq(),
        d = Math.abs(1 - h * h);
      if (d > 0)
        if (a = h * l - u, s = c * d, (r = h * u - l) >= 0)
          if (a >= -s)
            if (a <= s) {
              var f = 1 / d;
              o = (r *= f) * (r + h * (a *= f) + 2 * l) + a * (h * r + a + 2 * u) + p
            } else a = c, o = -(r = Math.max(0, -(h * a + l))) * r + a * (a + 2 * u) + p;
      else a = -c, o = -(r = Math.max(0, -(h * a + l))) * r + a * (a + 2 * u) + p;
      else a <= -s ? o = -(r = Math.max(0, -(-h * c + l))) * r + (a = r > 0 ? -c : Math.min(Math.max(-c, -u), c)) * (a + 2 * u) + p : a <= s ? (r = 0, o = (a = Math.min(Math.max(-c, -u), c)) * (a + 2 * u) + p) : o = -(r = Math.max(0, -(h * c + l))) * r + (a = r > 0 ? c : Math.min(Math.max(-c, -u), c)) * (a + 2 * u) + p;
      else a = h > 0 ? -c : c, o = -(r = Math.max(0, -(h * a + l))) * r + a * (a + 2 * u) + p;
      return i && i.copy(this.direction).multiplyScalar(r).add(this.origin), n && n.copy(Ce).multiplyScalar(a).add(Pe), o
    }),
    intersectSphere: function() {
      var t = new N;
      return function(e, i) {
        t.subVectors(e.center, this.origin);
        var n = t.dot(this.direction),
          r = t.dot(t) - n * n,
          a = e.radius * e.radius;
        if (r > a) return null;
        var o = Math.sqrt(a - r),
          s = n - o,
          c = n + o;
        return s < 0 && c < 0 ? null : s < 0 ? this.at(c, i) : this.at(s, i)
      }
    }(),
    intersectsSphere: function(t) {
      return this.distanceToPoint(t.center) <= t.radius
    },
    distanceToPlane: function(t) {
      var e = t.normal.dot(this.direction);
      if (0 === e) return 0 === t.distanceToPoint(this.origin) ? 0 : null;
      var i = -(this.origin.dot(t.normal) + t.constant) / e;
      return i >= 0 ? i : null
    },
    intersectPlane: function(t, e) {
      var i = this.distanceToPlane(t);
      return null === i ? null : this.at(i, e)
    },
    intersectsPlane: function(t) {
      var e = t.distanceToPoint(this.origin);
      return 0 === e || t.normal.dot(this.direction) * e < 0
    },
    intersectBox: function(t, e) {
      var i, n, r, a, o, s, c = 1 / this.direction.x,
        h = 1 / this.direction.y,
        l = 1 / this.direction.z,
        u = this.origin;
      return c >= 0 ? (i = (t.min.x - u.x) * c, n = (t.max.x - u.x) * c) : (i = (t.max.x - u.x) * c, n = (t.min.x - u.x) * c), h >= 0 ? (r = (t.min.y - u.y) * h, a = (t.max.y - u.y) * h) : (r = (t.max.y - u.y) * h, a = (t.min.y - u.y) * h), i > a || r > n ? null : ((r > i || i != i) && (i = r), (a < n || n != n) && (n = a), l >= 0 ? (o = (t.min.z - u.z) * l, s = (t.max.z - u.z) * l) : (o = (t.max.z - u.z) * l, s = (t.min.z - u.z) * l), i > s || o > n ? null : ((o > i || i != i) && (i = o), (s < n || n != n) && (n = s), n < 0 ? null : this.at(i >= 0 ? i : n, e)))
    },
    intersectsBox: (Le = new N, function(t) {
      return null !== this.intersectBox(t, Le)
    }),
    intersectTriangle: function() {
      var t = new N,
        e = new N,
        i = new N,
        n = new N;
      return function(r, a, o, s, c) {
        e.subVectors(a, r), i.subVectors(o, r), n.crossVectors(e, i);
        var h, l = this.direction.dot(n);
        if (l > 0) {
          if (s) return null;
          h = 1
        } else {
          if (!(l < 0)) return null;
          h = -1, l = -l
        }
        t.subVectors(this.origin, r);
        var u = h * this.direction.dot(i.crossVectors(t, i));
        if (u < 0) return null;
        var p = h * this.direction.dot(e.cross(t));
        if (p < 0) return null;
        if (u + p > l) return null;
        var d = -h * t.dot(n);
        return d < 0 ? null : this.at(d / l, c)
      }
    }(),
    applyMatrix4: function(t) {
      return this.origin.applyMatrix4(t), this.direction.transformDirection(t), this
    },
    equals: function(t) {
      return t.origin.equals(this.origin) && t.direction.equals(this.direction)
    }
  }), Object.assign(We.prototype, {
    set: function(t, e) {
      return this.start.copy(t), this.end.copy(e), this
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.start.copy(t.start), this.end.copy(t.end), this
    },
    getCenter: function(t) {
      return (t || new N).addVectors(this.start, this.end).multiplyScalar(.5)
    },
    delta: function(t) {
      return (t || new N).subVectors(this.end, this.start)
    },
    distanceSq: function() {
      return this.start.distanceToSquared(this.end)
    },
    distance: function() {
      return this.start.distanceTo(this.end)
    },
    at: function(t, e) {
      var i = e || new N;
      return this.delta(i).multiplyScalar(t).add(this.start)
    },
    closestPointToPointParameter: (Ue = new N, De = new N, function(t, e) {
      Ue.subVectors(t, this.start), De.subVectors(this.end, this.start);
      var i = De.dot(De),
        n = De.dot(Ue) / i;
      return e && (n = I.clamp(n, 0, 1)), n
    }),
    closestPointToPoint: function(t, e, i) {
      var n = this.closestPointToPointParameter(t, e),
        r = i || new N;
      return this.delta(r).multiplyScalar(n).add(this.start)
    },
    applyMatrix4: function(t) {
      return this.start.applyMatrix4(t), this.end.applyMatrix4(t), this
    },
    equals: function(t) {
      return t.start.equals(this.start) && t.end.equals(this.end)
    }
  }), Object.assign(Xe, {
    normal: (Oe = new N, function(t, e, i, n) {
      var r = n || new N;
      r.subVectors(i, e), Oe.subVectors(t, e), r.cross(Oe);
      var a = r.lengthSq();
      return a > 0 ? r.multiplyScalar(1 / Math.sqrt(a)) : r.set(0, 0, 0)
    }),
    barycoordFromPoint: function() {
      var t = new N,
        e = new N,
        i = new N;
      return function(n, r, a, o, s) {
        t.subVectors(o, r), e.subVectors(a, r), i.subVectors(n, r);
        var c = t.dot(t),
          h = t.dot(e),
          l = t.dot(i),
          u = e.dot(e),
          p = e.dot(i),
          d = c * u - h * h,
          f = s || new N;
        if (0 === d) return f.set(-2, -1, -1);
        var m = 1 / d,
          g = (u * l - h * p) * m,
          v = (c * p - h * l) * m;
        return f.set(1 - g - v, v, g)
      }
    }(),
    containsPoint: function() {
      var t = new N;
      return function(e, i, n, r) {
        var a = Xe.barycoordFromPoint(e, i, n, r, t);
        return a.x >= 0 && a.y >= 0 && a.x + a.y <= 1
      }
    }()
  }), Object.assign(Xe.prototype, {
    set: function(t, e, i) {
      return this.a.copy(t), this.b.copy(e), this.c.copy(i), this
    },
    setFromPointsAndIndices: function(t, e, i, n) {
      return this.a.copy(t[e]), this.b.copy(t[i]), this.c.copy(t[n]), this
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    copy: function(t) {
      return this.a.copy(t.a), this.b.copy(t.b), this.c.copy(t.c), this
    },
    area: function() {
      var t = new N,
        e = new N;
      return function() {
        return t.subVectors(this.c, this.b), e.subVectors(this.a, this.b), .5 * t.cross(e).length()
      }
    }(),
    midpoint: function(t) {
      return (t || new N).addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3)
    },
    normal: function(t) {
      return Xe.normal(this.a, this.b, this.c, t)
    },
    plane: function(t) {
      return (t || new $t).setFromCoplanarPoints(this.a, this.b, this.c)
    },
    barycoordFromPoint: function(t, e) {
      return Xe.barycoordFromPoint(t, this.a, this.b, this.c, e)
    },
    containsPoint: function(t) {
      return Xe.containsPoint(t, this.a, this.b, this.c)
    },
    closestPointToPoint: function() {
      var t = new $t,
        e = [new We, new We, new We],
        i = new N,
        n = new N;
      return function(r, a) {
        var o = a || new N,
          s = 1 / 0;
        if (t.setFromCoplanarPoints(this.a, this.b, this.c), t.projectPoint(r, i), !0 === this.containsPoint(i)) o.copy(i);
        else {
          e[0].set(this.a, this.b), e[1].set(this.b, this.c), e[2].set(this.c, this.a);
          for (var c = 0; c < e.length; c++) {
            e[c].closestPointToPoint(i, !0, n);
            var h = i.distanceToSquared(n);
            h < s && (s = h, o.copy(n))
          }
        }
        return o
      }
    }(),
    equals: function(t) {
      return t.a.equals(this.a) && t.b.equals(this.b) && t.c.equals(this.c)
    }
  }), qe.prototype = Object.assign(Object.create(le.prototype), {
    constructor: qe,
    isMesh: !0,
    setDrawMode: function(t) {
      this.drawMode = t
    },
    copy: function(t) {
      return le.prototype.copy.call(this, t), this.drawMode = t.drawMode, void 0 !== t.morphTargetInfluences && (this.morphTargetInfluences = t.morphTargetInfluences.slice()), void 0 !== t.morphTargetDictionary && (this.morphTargetDictionary = Object.assign({}, t.morphTargetDictionary)), this
    },
    updateMorphTargets: function() {
      var t, e, i, n = this.geometry;
      if (n.isBufferGeometry) {
        var r = n.morphAttributes,
          a = Object.keys(r);
        if (a.length > 0) {
          var o = r[a[0]];
          if (void 0 !== o)
            for (this.morphTargetInfluences = [], this.morphTargetDictionary = {}, t = 0, e = o.length; t < e; t++) i = o[t].name || String(t), this.morphTargetInfluences.push(0), this.morphTargetDictionary[i] = t
        }
      } else {
        var s = n.morphTargets;
        if (void 0 !== s && s.length > 0)
          for (this.morphTargetInfluences = [], this.morphTargetDictionary = {}, t = 0, e = s.length; t < e; t++) i = s[t].name || String(t), this.morphTargetInfluences.push(0), this.morphTargetDictionary[i] = t
      }
    },
    raycast: function() {
      var t = new D,
        e = new je,
        i = new Kt,
        n = new N,
        r = new N,
        a = new N,
        o = new N,
        s = new N,
        c = new N,
        h = new U,
        l = new U,
        u = new U,
        p = new N,
        d = new N,
        f = new N;

      function m(t, e, i, n, r, a, o) {
        return Xe.barycoordFromPoint(t, e, i, n, p), r.multiplyScalar(p.x), a.multiplyScalar(p.y), o.multiplyScalar(p.z), r.add(a).add(o), r.clone()
      }

      function g(t, e, i, n, r, a, o, s) {
        if (null === (1 === e.side ? n.intersectTriangle(o, a, r, !0, s) : n.intersectTriangle(r, a, o, 2 !== e.side, s))) return null;
        f.copy(s), f.applyMatrix4(t.matrixWorld);
        var c = i.ray.origin.distanceTo(f);
        return c < i.near || c > i.far ? null : {
          distance: c,
          point: f.clone(),
          object: t
        }
      }

      function v(t, e, i, o, s, c, p, f) {
        n.fromBufferAttribute(o, c), r.fromBufferAttribute(o, p), a.fromBufferAttribute(o, f);
        var v = g(t, t.material, e, i, n, r, a, d);
        return v && (s && (h.fromBufferAttribute(s, c), l.fromBufferAttribute(s, p), u.fromBufferAttribute(s, f), v.uv = m(d, n, r, a, h, l, u)), v.face = new de(c, p, f, Xe.normal(n, r, a)), v.faceIndex = c), v
      }
      return function(p, f) {
        var y, x = this.geometry,
          b = this.material,
          _ = this.matrixWorld;
        if (void 0 !== b && (null === x.boundingSphere && x.computeBoundingSphere(), i.copy(x.boundingSphere), i.applyMatrix4(_), !1 !== p.ray.intersectsSphere(i) && (t.getInverse(_), e.copy(p.ray).applyMatrix4(t), null === x.boundingBox || !1 !== e.intersectsBox(x.boundingBox))))
          if (x.isBufferGeometry) {
            var w, M, E, T, S, A = x.index,
              R = x.attributes.position,
              L = x.attributes.uv;
            if (null !== A)
              for (T = 0, S = A.count; T < S; T += 3) w = A.getX(T), M = A.getX(T + 1), E = A.getX(T + 2), (y = v(this, p, e, R, L, w, M, E)) && (y.faceIndex = Math.floor(T / 3), f.push(y));
            else if (void 0 !== R)
              for (T = 0, S = R.count; T < S; T += 3)(y = v(this, p, e, R, L, w = T, M = T + 1, E = T + 2)) && (y.index = w, f.push(y))
          } else if (x.isGeometry) {
          var P, C, I, U, D = Array.isArray(b),
            O = x.vertices,
            N = x.faces,
            B = x.faceVertexUvs[0];
          B.length > 0 && (U = B);
          for (var F = 0, z = N.length; F < z; F++) {
            var G = N[F],
              H = D ? b[G.materialIndex] : b;
            if (void 0 !== H) {
              if (P = O[G.a], C = O[G.b], I = O[G.c], !0 === H.morphTargets) {
                var V = x.morphTargets,
                  k = this.morphTargetInfluences;
                n.set(0, 0, 0), r.set(0, 0, 0), a.set(0, 0, 0);
                for (var j = 0, W = V.length; j < W; j++) {
                  var X = k[j];
                  if (0 !== X) {
                    var q = V[j].vertices;
                    n.addScaledVector(o.subVectors(q[G.a], P), X), r.addScaledVector(s.subVectors(q[G.b], C), X), a.addScaledVector(c.subVectors(q[G.c], I), X)
                  }
                }
                n.add(P), r.add(C), a.add(I), P = n, C = r, I = a
              }
              if (y = g(this, H, p, e, P, C, I, d)) {
                if (U && U[F]) {
                  var Y = U[F];
                  h.copy(Y[0]), l.copy(Y[1]), u.copy(Y[2]), y.uv = m(d, P, C, I, h, l, u)
                }
                y.face = G, y.faceIndex = F, f.push(y)
              }
            }
          }
        }
      }
    }(),
    clone: function() {
      return new this.constructor(this.geometry, this.material).copy(this)
    }
  });
  var ti, ei, ii, ni, ri, ai, oi = 0;

  function si(t) {
    switch (t) {
      case C:
        return ["Linear", "( value )"];
      case 3001:
        return ["sRGB", "( value )"];
      case 3002:
        return ["RGBE", "( value )"];
      case 3004:
        return ["RGBM", "( value, 7.0 )"];
      case 3005:
        return ["RGBM", "( value, 16.0 )"];
      case 3006:
        return ["RGBD", "( value, 256.0 )"];
      case 3007:
        return ["Gamma", "( value, float( GAMMA_FACTOR ) )"];
      default:
        throw new Error("unsupported encoding: " + t)
    }
  }

  function ci(t, e) {
    var i = si(e);
    return "vec4 " + t + "( vec4 value ) { return " + i[0] + "ToLinear" + i[1] + "; }"
  }

  function hi(t) {
    return "" !== t
  }

  function li(t, e) {
    return t.replace(/NUM_DIR_LIGHTS/g, e.numDirLights).replace(/NUM_SPOT_LIGHTS/g, e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g, e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g, e.numPointLights).replace(/NUM_HEMI_LIGHTS/g, e.numHemiLights)
  }

  function ui(t) {
    return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm, (function(t, e) {
      var i = Dt[e];
      if (void 0 === i) throw new Error("Can not resolve #include <" + e + ">");
      return ui(i)
    }))
  }

  function pi(t) {
    return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g, (function(t, e, i, n) {
      for (var r = "", a = parseInt(e); a < parseInt(i); a++) r += n.replace(/\[ i \]/g, "[ " + a + " ]");
      return r
    }))
  }

  function di(t, e, i, n, r, a) {
    var o = t.context,
      s = n.defines,
      c = r.vertexShader,
      h = r.fragmentShader,
      l = "SHADOWMAP_TYPE_BASIC";
    1 === a.shadowMapType ? l = "SHADOWMAP_TYPE_PCF" : 2 === a.shadowMapType && (l = "SHADOWMAP_TYPE_PCF_SOFT");
    var u = "ENVMAP_TYPE_CUBE",
      p = "ENVMAP_MODE_REFLECTION",
      d = "ENVMAP_BLENDING_MULTIPLY";
    if (a.envMap) {
      switch (n.envMap.mapping) {
        case 301:
        case 302:
          u = "ENVMAP_TYPE_CUBE";
          break;
        case 306:
        case 307:
          u = "ENVMAP_TYPE_CUBE_UV";
          break;
        case 303:
        case 304:
          u = "ENVMAP_TYPE_EQUIREC";
          break;
        case 305:
          u = "ENVMAP_TYPE_SPHERE"
      }
      switch (n.envMap.mapping) {
        case 302:
        case 304:
          p = "ENVMAP_MODE_REFRACTION"
      }
      switch (n.combine) {
        case 0:
          d = "ENVMAP_BLENDING_MULTIPLY";
          break;
        case 1:
          d = "ENVMAP_BLENDING_MIX";
          break;
        case 2:
          d = "ENVMAP_BLENDING_ADD"
      }
    }
    var f, m, g, v, y = t.gammaFactor > 0 ? t.gammaFactor : 1,
      x = function(t, e, i) {
        return [(t = t || {}).derivatives || e.envMapCubeUV || e.bumpMap || e.normalMap || e.flatShading ? "#extension GL_OES_standard_derivatives : enable" : "", (t.fragDepth || e.logarithmicDepthBuffer) && i.get("EXT_frag_depth") ? "#extension GL_EXT_frag_depth : enable" : "", t.drawBuffers && i.get("WEBGL_draw_buffers") ? "#extension GL_EXT_draw_buffers : require" : "", (t.shaderTextureLOD || e.envMap) && i.get("EXT_shader_texture_lod") ? "#extension GL_EXT_shader_texture_lod : enable" : ""].filter(hi).join("\n")
      }(n.extensions, a, e),
      b = function(t) {
        var e = [];
        for (var i in t) {
          var n = t[i];
          !1 !== n && e.push("#define " + i + " " + n)
        }
        return e.join("\n")
      }(s),
      _ = o.createProgram();
    n.isRawShaderMaterial ? ((f = [b].filter(hi).join("\n")).length > 0 && (f += "\n"), (m = [x, b].filter(hi).join("\n")).length > 0 && (m += "\n")) : (f = ["precision " + a.precision + " float;", "precision " + a.precision + " int;", "#define SHADER_NAME " + r.name, b, a.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "", "#define GAMMA_FACTOR " + y, "#define MAX_BONES " + a.maxBones, a.useFog && a.fog ? "#define USE_FOG" : "", a.useFog && a.fogExp ? "#define FOG_EXP2" : "", a.map ? "#define USE_MAP" : "", a.envMap ? "#define USE_ENVMAP" : "", a.envMap ? "#define " + p : "", a.lightMap ? "#define USE_LIGHTMAP" : "", a.aoMap ? "#define USE_AOMAP" : "", a.emissiveMap ? "#define USE_EMISSIVEMAP" : "", a.bumpMap ? "#define USE_BUMPMAP" : "", a.normalMap ? "#define USE_NORMALMAP" : "", a.displacementMap && a.supportsVertexTextures ? "#define USE_DISPLACEMENTMAP" : "", a.specularMap ? "#define USE_SPECULARMAP" : "", a.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", a.metalnessMap ? "#define USE_METALNESSMAP" : "", a.alphaMap ? "#define USE_ALPHAMAP" : "", a.vertexColors ? "#define USE_COLOR" : "", a.flatShading ? "#define FLAT_SHADED" : "", a.skinning ? "#define USE_SKINNING" : "", a.useVertexTexture ? "#define BONE_TEXTURE" : "", a.morphTargets ? "#define USE_MORPHTARGETS" : "", a.morphNormals && !1 === a.flatShading ? "#define USE_MORPHNORMALS" : "", a.doubleSided ? "#define DOUBLE_SIDED" : "", a.flipSided ? "#define FLIP_SIDED" : "", "#define NUM_CLIPPING_PLANES " + a.numClippingPlanes, a.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", a.shadowMapEnabled ? "#define " + l : "", a.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "", a.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", a.logarithmicDepthBuffer && e.get("EXT_frag_depth") ? "#define USE_LOGDEPTHBUF_EXT" : "", "uniform mat4 modelMatrix;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform mat4 viewMatrix;", "uniform mat3 normalMatrix;", "uniform vec3 cameraPosition;", "attribute vec3 position;", "attribute vec3 normal;", "attribute vec2 uv;", "#ifdef USE_COLOR", "\tattribute vec3 color;", "#endif", "#ifdef USE_MORPHTARGETS", "\tattribute vec3 morphTarget0;", "\tattribute vec3 morphTarget1;", "\tattribute vec3 morphTarget2;", "\tattribute vec3 morphTarget3;", "\t#ifdef USE_MORPHNORMALS", "\t\tattribute vec3 morphNormal0;", "\t\tattribute vec3 morphNormal1;", "\t\tattribute vec3 morphNormal2;", "\t\tattribute vec3 morphNormal3;", "\t#else", "\t\tattribute vec3 morphTarget4;", "\t\tattribute vec3 morphTarget5;", "\t\tattribute vec3 morphTarget6;", "\t\tattribute vec3 morphTarget7;", "\t#endif", "#endif", "#ifdef USE_SKINNING", "\tattribute vec4 skinIndex;", "\tattribute vec4 skinWeight;", "#endif", "\n"].filter(hi).join("\n"), m = [x, "precision " + a.precision + " float;", "precision " + a.precision + " int;", "#define SHADER_NAME " + r.name, b, a.alphaTest ? "#define ALPHATEST " + a.alphaTest : "", "#define GAMMA_FACTOR " + y, a.useFog && a.fog ? "#define USE_FOG" : "", a.useFog && a.fogExp ? "#define FOG_EXP2" : "", a.map ? "#define USE_MAP" : "", a.envMap ? "#define USE_ENVMAP" : "", a.envMap ? "#define " + u : "", a.envMap ? "#define " + p : "", a.envMap ? "#define " + d : "", a.lightMap ? "#define USE_LIGHTMAP" : "", a.aoMap ? "#define USE_AOMAP" : "", a.emissiveMap ? "#define USE_EMISSIVEMAP" : "", a.bumpMap ? "#define USE_BUMPMAP" : "", a.normalMap ? "#define USE_NORMALMAP" : "", a.specularMap ? "#define USE_SPECULARMAP" : "", a.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", a.metalnessMap ? "#define USE_METALNESSMAP" : "", a.alphaMap ? "#define USE_ALPHAMAP" : "", a.vertexColors ? "#define USE_COLOR" : "", a.gradientMap ? "#define USE_GRADIENTMAP" : "", a.flatShading ? "#define FLAT_SHADED" : "", a.doubleSided ? "#define DOUBLE_SIDED" : "", a.flipSided ? "#define FLIP_SIDED" : "", "#define NUM_CLIPPING_PLANES " + a.numClippingPlanes, "#define UNION_CLIPPING_PLANES " + (a.numClippingPlanes - a.numClipIntersection), a.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", a.shadowMapEnabled ? "#define " + l : "", a.premultipliedAlpha ? "#define PREMULTIPLIED_ALPHA" : "", a.physicallyCorrectLights ? "#define PHYSICALLY_CORRECT_LIGHTS" : "", a.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", a.logarithmicDepthBuffer && e.get("EXT_frag_depth") ? "#define USE_LOGDEPTHBUF_EXT" : "", a.envMap && e.get("EXT_shader_texture_lod") ? "#define TEXTURE_LOD_EXT" : "", "uniform mat4 viewMatrix;", "uniform vec3 cameraPosition;", 0 !== a.toneMapping ? "#define TONE_MAPPING" : "", 0 !== a.toneMapping ? Dt.tonemapping_pars_fragment : "", 0 !== a.toneMapping ? function(t, e) {
      var i;
      switch (e) {
        case 1:
          i = "Linear";
          break;
        case 2:
          i = "Reinhard";
          break;
        case 3:
          i = "Uncharted2";
          break;
        case 4:
          i = "OptimizedCineon";
          break;
        default:
          throw new Error("unsupported toneMapping: " + e)
      }
      return "vec3 toneMapping( vec3 color ) { return " + i + "ToneMapping( color ); }"
    }(0, a.toneMapping) : "", a.dithering ? "#define DITHERING" : "", a.outputEncoding || a.mapEncoding || a.envMapEncoding || a.emissiveMapEncoding ? Dt.encodings_pars_fragment : "", a.mapEncoding ? ci("mapTexelToLinear", a.mapEncoding) : "", a.envMapEncoding ? ci("envMapTexelToLinear", a.envMapEncoding) : "", a.emissiveMapEncoding ? ci("emissiveMapTexelToLinear", a.emissiveMapEncoding) : "", a.outputEncoding ? ("linearToOutputTexel", g = a.outputEncoding, v = si(g), "vec4 linearToOutputTexel( vec4 value ) { return LinearTo" + v[0] + v[1] + "; }") : "", a.depthPacking ? "#define DEPTH_PACKING " + n.depthPacking : "", "\n"].filter(hi).join("\n")), c = li(c = ui(c), a), h = li(h = ui(h), a), n.isShaderMaterial || (c = pi(c), h = pi(h));
    var w = f + c,
      M = m + h,
      E = $e(o, o.VERTEX_SHADER, w),
      T = $e(o, o.FRAGMENT_SHADER, M);
    o.attachShader(_, E), o.attachShader(_, T), void 0 !== n.index0AttributeName ? o.bindAttribLocation(_, 0, n.index0AttributeName) : !0 === a.morphTargets && o.bindAttribLocation(_, 0, "position"), o.linkProgram(_);
    var S, A, R = o.getProgramInfoLog(_),
      L = o.getShaderInfoLog(E),
      P = o.getShaderInfoLog(T),
      C = !0,
      I = !0;
    return !1 === o.getProgramParameter(_, o.LINK_STATUS) ? (C = !1, console.error("THREE.WebGLProgram: shader error: ", o.getError(), "gl.VALIDATE_STATUS", o.getProgramParameter(_, o.VALIDATE_STATUS), "gl.getProgramInfoLog", R, L, P)) : "" !== R ? console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()", R) : "" !== L && "" !== P || (I = !1), I && (this.diagnostics = {
      runnable: C,
      material: n,
      programLog: R,
      vertexShader: {
        log: L,
        prefix: f
      },
      fragmentShader: {
        log: P,
        prefix: m
      }
    }), o.deleteShader(E), o.deleteShader(T), this.getUniforms = function() {
      return void 0 === S && (S = new Lt(o, _, t)), S
    }, this.getAttributes = function() {
      return void 0 === A && (A = function(t, e) {
        for (var i = {}, n = t.getProgramParameter(e, t.ACTIVE_ATTRIBUTES), r = 0; r < n; r++) {
          var a = t.getActiveAttrib(e, r).name;
          i[a] = t.getAttribLocation(e, a)
        }
        return i
      }(o, _)), A
    }, this.destroy = function() {
      o.deleteProgram(_), this.program = void 0
    }, Object.defineProperties(this, {
      uniforms: {
        get: function() {
          return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."), this.getUniforms()
        }
      },
      attributes: {
        get: function() {
          return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."), this.getAttributes()
        }
      }
    }), this.id = oi++, this.code = i, this.usedTimes = 1, this.program = _, this.vertexShader = E, this.fragmentShader = T, this
  }

  function fi(t, e, i) {
    var n = [],
      r = {
        MeshDepthMaterial: "depth",
        MeshDistanceMaterial: "distanceRGBA",
        MeshNormalMaterial: "normal",
        MeshBasicMaterial: "basic",
        MeshLambertMaterial: "lambert",
        MeshPhongMaterial: "phong",
        MeshToonMaterial: "phong",
        MeshStandardMaterial: "physical",
        MeshPhysicalMaterial: "physical",
        LineBasicMaterial: "basic",
        LineDashedMaterial: "dashed",
        PointsMaterial: "points",
        ShadowMaterial: "shadow"
      },
      a = ["precision", "supportsVertexTextures", "map", "mapEncoding", "envMap", "envMapMode", "envMapEncoding", "lightMap", "aoMap", "emissiveMap", "emissiveMapEncoding", "bumpMap", "normalMap", "displacementMap", "specularMap", "roughnessMap", "metalnessMap", "gradientMap", "alphaMap", "combine", "vertexColors", "fog", "useFog", "fogExp", "flatShading", "sizeAttenuation", "logarithmicDepthBuffer", "skinning", "maxBones", "useVertexTexture", "morphTargets", "morphNormals", "maxMorphTargets", "maxMorphNormals", "premultipliedAlpha", "numDirLights", "numPointLights", "numSpotLights", "numHemiLights", "numRectAreaLights", "shadowMapEnabled", "shadowMapType", "toneMapping", "physicallyCorrectLights", "alphaTest", "doubleSided", "flipSided", "numClippingPlanes", "numClipIntersection", "depthPacking", "dithering"];

    function o(t, e) {
      var i;
      return t ? t.isTexture ? i = t.encoding : t.isWebGLRenderTarget && (console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."), i = t.texture.encoding) : i = C, i === C && e && (i = 3007), i
    }
    this.getParameters = function(e, n, a, s, c, h, l) {
      var u = r[e.type],
        p = l.isSkinnedMesh ? function(t) {
          var e = t.skeleton.bones;
          if (i.floatVertexTextures) return 1024;
          var n = i.maxVertexUniforms,
            r = Math.floor((n - 20) / 4),
            a = Math.min(r, e.length);
          return a < e.length ? (console.warn("THREE.WebGLRenderer: Skeleton has " + e.length + " bones. This GPU supports " + a + "."), 0) : a
        }(l) : 0,
        d = i.precision;
      null !== e.precision && (d = i.getMaxPrecision(e.precision)) !== e.precision && console.warn("THREE.WebGLProgram.getParameters:", e.precision, "not supported, using", d, "instead.");
      var f = t.getRenderTarget();
      return {
        shaderID: u,
        precision: d,
        supportsVertexTextures: i.vertexTextures,
        outputEncoding: o(f ? f.texture : null, t.gammaOutput),
        map: !!e.map,
        mapEncoding: o(e.map, t.gammaInput),
        envMap: !!e.envMap,
        envMapMode: e.envMap && e.envMap.mapping,
        envMapEncoding: o(e.envMap, t.gammaInput),
        envMapCubeUV: !!e.envMap && (306 === e.envMap.mapping || 307 === e.envMap.mapping),
        lightMap: !!e.lightMap,
        aoMap: !!e.aoMap,
        emissiveMap: !!e.emissiveMap,
        emissiveMapEncoding: o(e.emissiveMap, t.gammaInput),
        bumpMap: !!e.bumpMap,
        normalMap: !!e.normalMap,
        displacementMap: !!e.displacementMap,
        roughnessMap: !!e.roughnessMap,
        metalnessMap: !!e.metalnessMap,
        specularMap: !!e.specularMap,
        alphaMap: !!e.alphaMap,
        gradientMap: !!e.gradientMap,
        combine: e.combine,
        vertexColors: e.vertexColors,
        fog: !!s,
        useFog: e.fog,
        fogExp: s && s.isFogExp2,
        flatShading: e.flatShading,
        sizeAttenuation: e.sizeAttenuation,
        logarithmicDepthBuffer: i.logarithmicDepthBuffer,
        skinning: e.skinning && p > 0,
        maxBones: p,
        useVertexTexture: i.floatVertexTextures,
        morphTargets: e.morphTargets,
        morphNormals: e.morphNormals,
        maxMorphTargets: t.maxMorphTargets,
        maxMorphNormals: t.maxMorphNormals,
        numDirLights: n.directional.length,
        numPointLights: n.point.length,
        numSpotLights: n.spot.length,
        numRectAreaLights: n.rectArea.length,
        numHemiLights: n.hemi.length,
        numClippingPlanes: c,
        numClipIntersection: h,
        dithering: e.dithering,
        shadowMapEnabled: t.shadowMap.enabled && l.receiveShadow && a.length > 0,
        shadowMapType: t.shadowMap.type,
        toneMapping: t.toneMapping,
        physicallyCorrectLights: t.physicallyCorrectLights,
        premultipliedAlpha: e.premultipliedAlpha,
        alphaTest: e.alphaTest,
        doubleSided: 2 === e.side,
        flipSided: 1 === e.side,
        depthPacking: void 0 !== e.depthPacking && e.depthPacking
      }
    }, this.getProgramCode = function(e, i) {
      var n = [];
      if (i.shaderID ? n.push(i.shaderID) : (n.push(e.fragmentShader), n.push(e.vertexShader)), void 0 !== e.defines)
        for (var r in e.defines) n.push(r), n.push(e.defines[r]);
      for (var o = 0; o < a.length; o++) n.push(i[a[o]]);
      return n.push(e.onBeforeCompile.toString()), n.push(t.gammaOutput), n.join()
    }, this.acquireProgram = function(i, r, a, o) {
      for (var s, c = 0, h = n.length; c < h; c++) {
        var l = n[c];
        if (l.code === o) {
          ++(s = l).usedTimes;
          break
        }
      }
      return void 0 === s && (s = new di(t, e, o, i, r, a), n.push(s)), s
    }, this.releaseProgram = function(t) {
      if (0 == --t.usedTimes) {
        var e = n.indexOf(t);
        n[e] = n[n.length - 1], n.pop(), t.destroy()
      }
    }, this.programs = n
  }

  function mi(t, e, i, n, r, a, o) {
    var s = "undefined" != typeof WebGL2RenderingContext && t instanceof window.WebGL2RenderingContext;

    function c(t, e) {
      if (t.width > e || t.height > e) {
        var i = e / Math.max(t.width, t.height),
          n = document.createElement("canvas");
        return n.width = Math.floor(t.width * i), n.height = Math.floor(t.height * i), n.getContext("2d").drawImage(t, 0, 0, t.width, t.height, 0, 0, n.width, n.height), console.warn("THREE.WebGLRenderer: image is too big (" + t.width + "x" + t.height + "). Resized to " + n.width + "x" + n.height, t), n
      }
      return t
    }

    function h(t) {
      return I.isPowerOfTwo(t.width) && I.isPowerOfTwo(t.height)
    }

    function l(t, e) {
      return t.generateMipmaps && e && t.minFilter !== b && t.minFilter !== _
    }

    function u(e) {
      return e === b || 1004 === e || 1005 === e ? t.NEAREST : t.LINEAR
    }

    function p(e) {
      var i = e.target;
      i.removeEventListener("dispose", p),
        function(e) {
          var i = n.get(e);
          if (e.image && i.__image__webglTextureCube) t.deleteTexture(i.__image__webglTextureCube);
          else {
            if (void 0 === i.__webglInit) return;
            t.deleteTexture(i.__webglTexture)
          }
          n.remove(e)
        }(i), o.textures--
    }

    function d(e) {
      var i = e.target;
      i.removeEventListener("dispose", d),
        function(e) {
          var i = n.get(e),
            r = n.get(e.texture);
          if (e) {
            if (void 0 !== r.__webglTexture && t.deleteTexture(r.__webglTexture), e.depthTexture && e.depthTexture.dispose(), e.isWebGLRenderTargetCube)
              for (var a = 0; a < 6; a++) t.deleteFramebuffer(i.__webglFramebuffer[a]), i.__webglDepthbuffer && t.deleteRenderbuffer(i.__webglDepthbuffer[a]);
            else t.deleteFramebuffer(i.__webglFramebuffer), i.__webglDepthbuffer && t.deleteRenderbuffer(i.__webglDepthbuffer);
            n.remove(e.texture), n.remove(e)
          }
        }(i), o.textures--
    }

    function f(e, u) {
      var d = n.get(e);
      if (e.version > 0 && d.__version !== e.version) {
        var f = e.image;
        if (void 0 === f) console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined", e);
        else {
          if (!1 !== f.complete) return void
          function(e, n, u) {
            void 0 === e.__webglInit && (e.__webglInit = !0, n.addEventListener("dispose", p), e.__webglTexture = t.createTexture(), o.textures++), i.activeTexture(t.TEXTURE0 + u), i.bindTexture(t.TEXTURE_2D, e.__webglTexture), t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL, n.flipY), t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL, n.premultiplyAlpha), t.pixelStorei(t.UNPACK_ALIGNMENT, n.unpackAlignment);
            var d = c(n.image, r.maxTextureSize);
            (function(t) {
              return t.wrapS !== y || t.wrapT !== y || t.minFilter !== b && t.minFilter !== _
            })(n) && !1 === h(d) && (d = function(t) {
              if (t instanceof HTMLImageElement || t instanceof HTMLCanvasElement) {
                var e = document.createElement("canvas");
                return e.width = I.floorPowerOfTwo(t.width), e.height = I.floorPowerOfTwo(t.height), e.getContext("2d").drawImage(t, 0, 0, e.width, e.height), console.warn("THREE.WebGLRenderer: image is not power of two (" + t.width + "x" + t.height + "). Resized to " + e.width + "x" + e.height, t), e
              }
              return t
            }(d));
            var f = h(d),
              g = a.convert(n.format),
              v = a.convert(n.type);
            m(t.TEXTURE_2D, n, f);
            var x, w = n.mipmaps;
            if (n.isDepthTexture) {
              var P = t.DEPTH_COMPONENT;
              if (n.type === E) {
                if (!s) throw new Error("Float Depth Texture only supported in WebGL2.0");
                P = t.DEPTH_COMPONENT32F
              } else s && (P = t.DEPTH_COMPONENT16);
              n.format === R && P === t.DEPTH_COMPONENT && n.type !== M && 1014 !== n.type && (console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."), n.type = M, v = a.convert(n.type)), n.format === L && (P = t.DEPTH_STENCIL, n.type !== T && (console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."), n.type = T, v = a.convert(n.type))), i.texImage2D(t.TEXTURE_2D, 0, P, d.width, d.height, 0, g, v, null)
            } else if (n.isDataTexture)
              if (w.length > 0 && f) {
                for (var C = 0, U = w.length; C < U; C++) x = w[C], i.texImage2D(t.TEXTURE_2D, C, g, x.width, x.height, 0, g, v, x.data);
                n.generateMipmaps = !1
              } else i.texImage2D(t.TEXTURE_2D, 0, g, d.width, d.height, 0, g, v, d.data);
            else if (n.isCompressedTexture)
              for (C = 0, U = w.length; C < U; C++) x = w[C], n.format !== A && n.format !== S ? i.getCompressedTextureFormats().indexOf(g) > -1 ? i.compressedTexImage2D(t.TEXTURE_2D, C, g, x.width, x.height, 0, x.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()") : i.texImage2D(t.TEXTURE_2D, C, g, x.width, x.height, 0, g, v, x.data);
            else if (w.length > 0 && f) {
              for (C = 0, U = w.length; C < U; C++) x = w[C], i.texImage2D(t.TEXTURE_2D, C, g, g, v, x);
              n.generateMipmaps = !1
            } else i.texImage2D(t.TEXTURE_2D, 0, g, g, v, d);
            l(n, f) && t.generateMipmap(t.TEXTURE_2D), e.__version = n.version, n.onUpdate && n.onUpdate(n)
          }(d, e, u);
          console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete", e)
        }
      }
      i.activeTexture(t.TEXTURE0 + u), i.bindTexture(t.TEXTURE_2D, d.__webglTexture)
    }

    function m(i, o, s) {
      var c;
      if (s ? (t.texParameteri(i, t.TEXTURE_WRAP_S, a.convert(o.wrapS)), t.texParameteri(i, t.TEXTURE_WRAP_T, a.convert(o.wrapT)), t.texParameteri(i, t.TEXTURE_MAG_FILTER, a.convert(o.magFilter)), t.texParameteri(i, t.TEXTURE_MIN_FILTER, a.convert(o.minFilter))) : (t.texParameteri(i, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE), t.texParameteri(i, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE), o.wrapS === y && o.wrapT, t.texParameteri(i, t.TEXTURE_MAG_FILTER, u(o.magFilter)), t.texParameteri(i, t.TEXTURE_MIN_FILTER, u(o.minFilter)), o.minFilter !== b && o.minFilter), c = e.get("EXT_texture_filter_anisotropic")) {
        if (o.type === E && null === e.get("OES_texture_float_linear")) return;
        if (1016 === o.type && null === e.get("OES_texture_half_float_linear")) return;
        (o.anisotropy > 1 || n.get(o).__currentAnisotropy) && (t.texParameterf(i, c.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(o.anisotropy, r.getMaxAnisotropy())), n.get(o).__currentAnisotropy = o.anisotropy)
      }
    }

    function g(e, r, o, s) {
      var c = a.convert(r.texture.format),
        h = a.convert(r.texture.type);
      i.texImage2D(s, 0, c, r.width, r.height, 0, c, h, null), t.bindFramebuffer(t.FRAMEBUFFER, e), t.framebufferTexture2D(t.FRAMEBUFFER, o, s, n.get(r.texture).__webglTexture, 0), t.bindFramebuffer(t.FRAMEBUFFER, null)
    }

    function v(e, i) {
      t.bindRenderbuffer(t.RENDERBUFFER, e), i.depthBuffer && !i.stencilBuffer ? (t.renderbufferStorage(t.RENDERBUFFER, t.DEPTH_COMPONENT16, i.width, i.height), t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_ATTACHMENT, t.RENDERBUFFER, e)) : i.depthBuffer && i.stencilBuffer ? (t.renderbufferStorage(t.RENDERBUFFER, t.DEPTH_STENCIL, i.width, i.height), t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_STENCIL_ATTACHMENT, t.RENDERBUFFER, e)) : t.renderbufferStorage(t.RENDERBUFFER, t.RGBA4, i.width, i.height), t.bindRenderbuffer(t.RENDERBUFFER, null)
    }
    this.setTexture2D = f, this.setTextureCube = function(e, s) {
      var u = n.get(e);
      if (6 === e.image.length)
        if (e.version > 0 && u.__version !== e.version) {
          u.__image__webglTextureCube || (e.addEventListener("dispose", p), u.__image__webglTextureCube = t.createTexture(), o.textures++), i.activeTexture(t.TEXTURE0 + s), i.bindTexture(t.TEXTURE_CUBE_MAP, u.__image__webglTextureCube), t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL, e.flipY);
          for (var d = e && e.isCompressedTexture, f = e.image[0] && e.image[0].isDataTexture, g = [], v = 0; v < 6; v++) g[v] = d || f ? f ? e.image[v].image : e.image[v] : c(e.image[v], r.maxCubemapSize);
          var y = h(g[0]),
            x = a.convert(e.format),
            b = a.convert(e.type);
          for (m(t.TEXTURE_CUBE_MAP, e, y), v = 0; v < 6; v++)
            if (d)
              for (var _, w = g[v].mipmaps, M = 0, E = w.length; M < E; M++) _ = w[M], e.format !== A && e.format !== S ? i.getCompressedTextureFormats().indexOf(x) > -1 ? i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X + v, M, x, _.width, _.height, 0, _.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()") : i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X + v, M, x, _.width, _.height, 0, x, b, _.data);
            else f ? i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X + v, 0, x, g[v].width, g[v].height, 0, x, b, g[v].data) : i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X + v, 0, x, x, b, g[v]);
          l(e, y) && t.generateMipmap(t.TEXTURE_CUBE_MAP), u.__version = e.version, e.onUpdate && e.onUpdate(e)
        } else i.activeTexture(t.TEXTURE0 + s), i.bindTexture(t.TEXTURE_CUBE_MAP, u.__image__webglTextureCube)
    }, this.setTextureCubeDynamic = function(e, r) {
      i.activeTexture(t.TEXTURE0 + r), i.bindTexture(t.TEXTURE_CUBE_MAP, n.get(e).__webglTexture)
    }, this.setupRenderTarget = function(e) {
      var r = n.get(e),
        a = n.get(e.texture);
      e.addEventListener("dispose", d), a.__webglTexture = t.createTexture(), o.textures++;
      var s = !0 === e.isWebGLRenderTargetCube,
        c = h(e);
      if (s) {
        r.__webglFramebuffer = [];
        for (var u = 0; u < 6; u++) r.__webglFramebuffer[u] = t.createFramebuffer()
      } else r.__webglFramebuffer = t.createFramebuffer();
      if (s) {
        for (i.bindTexture(t.TEXTURE_CUBE_MAP, a.__webglTexture), m(t.TEXTURE_CUBE_MAP, e.texture, c), u = 0; u < 6; u++) g(r.__webglFramebuffer[u], e, t.COLOR_ATTACHMENT0, t.TEXTURE_CUBE_MAP_POSITIVE_X + u);
        l(e.texture, c) && t.generateMipmap(t.TEXTURE_CUBE_MAP), i.bindTexture(t.TEXTURE_CUBE_MAP, null)
      } else i.bindTexture(t.TEXTURE_2D, a.__webglTexture), m(t.TEXTURE_2D, e.texture, c), g(r.__webglFramebuffer, e, t.COLOR_ATTACHMENT0, t.TEXTURE_2D), l(e.texture, c) && t.generateMipmap(t.TEXTURE_2D), i.bindTexture(t.TEXTURE_2D, null);
      e.depthBuffer && function(e) {
        var i = n.get(e),
          r = !0 === e.isWebGLRenderTargetCube;
        if (e.depthTexture) {
          if (r) throw new Error("target.depthTexture not supported in Cube render targets");
          ! function(e, i) {
            if (i && i.isWebGLRenderTargetCube) throw new Error("Depth Texture with cube render targets is not supported");
            if (t.bindFramebuffer(t.FRAMEBUFFER, e), !i.depthTexture || !i.depthTexture.isDepthTexture) throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
            n.get(i.depthTexture).__webglTexture && i.depthTexture.image.width === i.width && i.depthTexture.image.height === i.height || (i.depthTexture.image.width = i.width, i.depthTexture.image.height = i.height, i.depthTexture.needsUpdate = !0), f(i.depthTexture, 0);
            var r = n.get(i.depthTexture).__webglTexture;
            if (i.depthTexture.format === R) t.framebufferTexture2D(t.FRAMEBUFFER, t.DEPTH_ATTACHMENT, t.TEXTURE_2D, r, 0);
            else {
              if (i.depthTexture.format !== L) throw new Error("Unknown depthTexture format");
              t.framebufferTexture2D(t.FRAMEBUFFER, t.DEPTH_STENCIL_ATTACHMENT, t.TEXTURE_2D, r, 0)
            }
          }(i.__webglFramebuffer, e)
        } else if (r) {
          i.__webglDepthbuffer = [];
          for (var a = 0; a < 6; a++) t.bindFramebuffer(t.FRAMEBUFFER, i.__webglFramebuffer[a]), i.__webglDepthbuffer[a] = t.createRenderbuffer(), v(i.__webglDepthbuffer[a], e)
        } else t.bindFramebuffer(t.FRAMEBUFFER, i.__webglFramebuffer), i.__webglDepthbuffer = t.createRenderbuffer(), v(i.__webglDepthbuffer, e);
        t.bindFramebuffer(t.FRAMEBUFFER, null)
      }(e)
    }, this.updateRenderTargetMipmap = function(e) {
      var r = e.texture;
      if (l(r, h(e))) {
        var a = e.isWebGLRenderTargetCube ? t.TEXTURE_CUBE_MAP : t.TEXTURE_2D,
          o = n.get(r).__webglTexture;
        i.bindTexture(a, o), t.generateMipmap(a), i.bindTexture(a, null)
      }
    }
  }

  function gi(t, e, i, n) {
    ue.call(this), this.type = "PerspectiveCamera", this.fov = void 0 !== t ? t : 50, this.zoom = 1, this.near = void 0 !== i ? i : .1, this.far = void 0 !== n ? n : 2e3, this.focus = 10, this.aspect = void 0 !== e ? e : 1, this.view = null, this.filmGauge = 35, this.filmOffset = 0, this.updateProjectionMatrix()
  }

  function vi(t) {
    gi.call(this), this.cameras = t || []
  }

  function yi(t, e) {
    return {
      convert: function(i) {
        var n;
        if (i === v) return t.REPEAT;
        if (i === y) return t.CLAMP_TO_EDGE;
        if (i === x) return t.MIRRORED_REPEAT;
        if (i === b) return t.NEAREST;
        if (1004 === i) return t.NEAREST_MIPMAP_NEAREST;
        if (1005 === i) return t.NEAREST_MIPMAP_LINEAR;
        if (i === _) return t.LINEAR;
        if (1007 === i) return t.LINEAR_MIPMAP_NEAREST;
        if (i === w) return t.LINEAR_MIPMAP_LINEAR;
        if (1009 === i) return t.UNSIGNED_BYTE;
        if (1017 === i) return t.UNSIGNED_SHORT_4_4_4_4;
        if (1018 === i) return t.UNSIGNED_SHORT_5_5_5_1;
        if (1019 === i) return t.UNSIGNED_SHORT_5_6_5;
        if (1010 === i) return t.BYTE;
        if (1011 === i) return t.SHORT;
        if (i === M) return t.UNSIGNED_SHORT;
        if (1013 === i) return t.INT;
        if (1014 === i) return t.UNSIGNED_INT;
        if (i === E) return t.FLOAT;
        if (1016 === i && null !== (n = e.get("OES_texture_half_float"))) return n.HALF_FLOAT_OES;
        if (1021 === i) return t.ALPHA;
        if (i === S) return t.RGB;
        if (i === A) return t.RGBA;
        if (1024 === i) return t.LUMINANCE;
        if (1025 === i) return t.LUMINANCE_ALPHA;
        if (i === R) return t.DEPTH_COMPONENT;
        if (i === L) return t.DEPTH_STENCIL;
        if (100 === i) return t.FUNC_ADD;
        if (101 === i) return t.FUNC_SUBTRACT;
        if (102 === i) return t.FUNC_REVERSE_SUBTRACT;
        if (200 === i) return t.ZERO;
        if (201 === i) return t.ONE;
        if (202 === i) return t.SRC_COLOR;
        if (203 === i) return t.ONE_MINUS_SRC_COLOR;
        if (204 === i) return t.SRC_ALPHA;
        if (205 === i) return t.ONE_MINUS_SRC_ALPHA;
        if (206 === i) return t.DST_ALPHA;
        if (207 === i) return t.ONE_MINUS_DST_ALPHA;
        if (208 === i) return t.DST_COLOR;
        if (209 === i) return t.ONE_MINUS_DST_COLOR;
        if (210 === i) return t.SRC_ALPHA_SATURATE;
        if ((2001 === i || 2002 === i || 2003 === i || 2004 === i) && null !== (n = e.get("WEBGL_compressed_texture_s3tc"))) {
          if (2001 === i) return n.COMPRESSED_RGB_S3TC_DXT1_EXT;
          if (2002 === i) return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;
          if (2003 === i) return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;
          if (2004 === i) return n.COMPRESSED_RGBA_S3TC_DXT5_EXT
        }
        if ((2100 === i || 2101 === i || 2102 === i || 2103 === i) && null !== (n = e.get("WEBGL_compressed_texture_pvrtc"))) {
          if (2100 === i) return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
          if (2101 === i) return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
          if (2102 === i) return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
          if (2103 === i) return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG
        }
        if (2151 === i && null !== (n = e.get("WEBGL_compressed_texture_etc1"))) return n.COMPRESSED_RGB_ETC1_WEBGL;
        if ((103 === i || 104 === i) && null !== (n = e.get("EXT_blend_minmax"))) {
          if (103 === i) return n.MIN_EXT;
          if (104 === i) return n.MAX_EXT
        }
        return i === T && null !== (n = e.get("WEBGL_depth_texture")) ? n.UNSIGNED_INT_24_8_WEBGL : 0
      }
    }
  }

  function xi(t) {
    console.log("THREE.WebGLRenderer", g);
    var e = void 0 !== (t = t || {}).canvas ? t.canvas : document.createElement("canvas"),
      i = void 0 !== t.context ? t.context : null,
      n = void 0 !== t.alpha && t.alpha,
      r = void 0 === t.depth || t.depth,
      a = void 0 === t.stencil || t.stencil,
      o = void 0 !== t.antialias && t.antialias,
      s = void 0 === t.premultipliedAlpha || t.premultipliedAlpha,
      c = void 0 !== t.preserveDrawingBuffer && t.preserveDrawingBuffer,
      h = [],
      l = [],
      u = null,
      p = [],
      d = [];
    this.domElement = e, this.context = null, this.autoClear = !0, this.autoClearColor = !0, this.autoClearDepth = !0, this.autoClearStencil = !0, this.sortObjects = !0, this.clippingPlanes = [], this.localClippingEnabled = !1, this.gammaFactor = 2, this.gammaInput = !1, this.gammaOutput = !1, this.physicallyCorrectLights = !1, this.toneMapping = 1, this.toneMappingExposure = 1, this.toneMappingWhitePoint = 1, this.maxMorphTargets = 8, this.maxMorphNormals = 4;
    var f, m, v, y, x, b, _, w, M, T, S, R, L, P, C, U, O, F, z, H = this,
      V = !1,
      j = null,
      W = null,
      X = -1,
      q = "",
      Y = null,
      Z = null,
      J = new G,
      Q = new G,
      K = null,
      $ = 0,
      tt = e.width,
      et = e.height,
      it = 1,
      nt = new G(0, 0, tt, et),
      rt = new G(0, 0, tt, et),
      at = !1,
      ot = new te,
      st = new function() {
        var t = this,
          e = null,
          i = 0,
          n = !1,
          r = !1,
          a = new $t,
          o = new B,
          s = {
            value: null,
            needsUpdate: !1
          };

        function c() {
          s.value !== e && (s.value = e, s.needsUpdate = i > 0), t.numPlanes = i, t.numIntersection = 0
        }

        function h(e, i, n, r) {
          var c = null !== e ? e.length : 0,
            h = null;
          if (0 !== c) {
            if (h = s.value, !0 !== r || null === h) {
              var l = n + 4 * c,
                u = i.matrixWorldInverse;
              o.getNormalMatrix(u), (null === h || h.length < l) && (h = new Float32Array(l));
              for (var p = 0, d = n; p !== c; ++p, d += 4) a.copy(e[p]).applyMatrix4(u, o), a.normal.toArray(h, d), h[d + 3] = a.constant
            }
            s.value = h, s.needsUpdate = !0
          }
          return t.numPlanes = c, h
        }
        this.uniform = s, this.numPlanes = 0, this.numIntersection = 0, this.init = function(t, r, a) {
          var o = 0 !== t.length || r || 0 !== i || n;
          return n = r, e = h(t, a, 0), i = t.length, o
        }, this.beginShadows = function() {
          r = !0, h(null)
        }, this.endShadows = function() {
          r = !1, c()
        }, this.setState = function(t, a, o, l, u, p) {
          if (!n || null === t || 0 === t.length || r && !o) r ? h(null) : c();
          else {
            var d = r ? 0 : i,
              f = 4 * d,
              m = u.clippingState || null;
            s.value = m, m = h(t, l, f, p);
            for (var g = 0; g !== f; ++g) m[g] = e[g];
            u.clippingState = m, this.numIntersection = a ? this.numPlanes : 0, this.numPlanes += d
          }
        }
      },
      ct = !1,
      ht = !1,
      lt = new D,
      ut = new N,
      pt = {
        geometries: 0,
        textures: 0
      },
      dt = {
        frame: 0,
        calls: 0,
        vertices: 0,
        faces: 0,
        points: 0
      };

    function ft() {
      return null === j ? it : 1
    }
    this.info = {
      render: dt,
      memory: pt,
      programs: null
    };
    try {
      var mt = {
        alpha: n,
        depth: r,
        stencil: a,
        antialias: o,
        premultipliedAlpha: s,
        preserveDrawingBuffer: c
      };
      if (null === (f = i || e.getContext("webgl", mt) || e.getContext("experimental-webgl", mt))) throw null !== e.getContext("webgl") ? "Error creating WebGL context with your selected attributes." : "Error creating WebGL context.";
      void 0 === f.getShaderPrecisionFormat && (f.getShaderPrecisionFormat = function() {
        return {
          rangeMin: 1,
          rangeMax: 1,
          precision: 1
        }
      }), e.addEventListener("webglcontextlost", xt, !1), e.addEventListener("webglcontextrestored", bt, !1)
    } catch (t) {
      console.error("THREE.WebGLRenderer: " + t)
    }

    function gt() {
      (m = new function(t) {
        var e = {};
        return {
          get: function(i) {
            if (void 0 !== e[i]) return e[i];
            var n;
            switch (i) {
              case "WEBGL_depth_texture":
                n = t.getExtension("WEBGL_depth_texture") || t.getExtension("MOZ_WEBGL_depth_texture") || t.getExtension("WEBKIT_WEBGL_depth_texture");
                break;
              case "EXT_texture_filter_anisotropic":
                n = t.getExtension("EXT_texture_filter_anisotropic") || t.getExtension("MOZ_EXT_texture_filter_anisotropic") || t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                break;
              case "WEBGL_compressed_texture_s3tc":
                n = t.getExtension("WEBGL_compressed_texture_s3tc") || t.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
                break;
              case "WEBGL_compressed_texture_pvrtc":
                n = t.getExtension("WEBGL_compressed_texture_pvrtc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
                break;
              case "WEBGL_compressed_texture_etc1":
                n = t.getExtension("WEBGL_compressed_texture_etc1");
                break;
              default:
                n = t.getExtension(i)
            }
            return null === n && console.warn("THREE.WebGLRenderer: " + i + " extension not supported."), e[i] = n, n
          }
        }
      }(f)).get("WEBGL_depth_texture"), m.get("OES_texture_float"), m.get("OES_texture_float_linear"), m.get("OES_texture_half_float"), m.get("OES_texture_half_float_linear"), m.get("OES_standard_derivatives"), m.get("OES_element_index_uint"), m.get("ANGLE_instanced_arrays"), z = new yi(f, m), v = new function(t, e, i) {
        var n;

        function r(e) {
          if ("highp" === e) {
            if (t.getShaderPrecisionFormat(t.VERTEX_SHADER, t.HIGH_FLOAT).precision > 0 && t.getShaderPrecisionFormat(t.FRAGMENT_SHADER, t.HIGH_FLOAT).precision > 0) return "highp";
            e = "mediump"
          }
          return "mediump" === e && t.getShaderPrecisionFormat(t.VERTEX_SHADER, t.MEDIUM_FLOAT).precision > 0 && t.getShaderPrecisionFormat(t.FRAGMENT_SHADER, t.MEDIUM_FLOAT).precision > 0 ? "mediump" : "lowp"
        }
        var a = void 0 !== i.precision ? i.precision : "highp",
          o = r(a);
        o !== a && (console.warn("THREE.WebGLRenderer:", a, "not supported, using", o, "instead."), a = o);
        var s = !0 === i.logarithmicDepthBuffer,
          c = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),
          h = t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
          l = t.getParameter(t.MAX_TEXTURE_SIZE),
          u = t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),
          p = t.getParameter(t.MAX_VERTEX_ATTRIBS),
          d = t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),
          f = t.getParameter(t.MAX_VARYING_VECTORS),
          m = t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),
          g = h > 0,
          v = !!e.get("OES_texture_float");
        return {
          getMaxAnisotropy: function() {
            if (void 0 !== n) return n;
            var i = e.get("EXT_texture_filter_anisotropic");
            return n = null !== i ? t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0
          },
          getMaxPrecision: r,
          precision: a,
          logarithmicDepthBuffer: s,
          maxTextures: c,
          maxVertexTextures: h,
          maxTextureSize: l,
          maxCubemapSize: u,
          maxAttributes: p,
          maxVertexUniforms: d,
          maxVaryings: f,
          maxFragmentUniforms: m,
          vertexTextures: g,
          floatFragmentTextures: v,
          floatVertexTextures: g && v
        }
      }(f, m, t), (y = new function(t, e, i) {
        var n = new function() {
            var e = !1,
              i = new G,
              n = null,
              r = new G(0, 0, 0, 0);
            return {
              setMask: function(i) {
                n === i || e || (t.colorMask(i, i, i, i), n = i)
              },
              setLocked: function(t) {
                e = t
              },
              setClear: function(e, n, a, o, s) {
                !0 === s && (e *= o, n *= o, a *= o), i.set(e, n, a, o), !1 === r.equals(i) && (t.clearColor(e, n, a, o), r.copy(i))
              },
              reset: function() {
                e = !1, n = null, r.set(-1, 0, 0, 0)
              }
            }
          },
          r = new function() {
            var e = !1,
              i = null,
              n = null,
              r = null;
            return {
              setTest: function(e) {
                e ? U(t.DEPTH_TEST) : D(t.DEPTH_TEST)
              },
              setMask: function(n) {
                i === n || e || (t.depthMask(n), i = n)
              },
              setFunc: function(e) {
                if (n !== e) {
                  if (e) switch (e) {
                    case 0:
                      t.depthFunc(t.NEVER);
                      break;
                    case 1:
                      t.depthFunc(t.ALWAYS);
                      break;
                    case 2:
                      t.depthFunc(t.LESS);
                      break;
                    case 3:
                      t.depthFunc(t.LEQUAL);
                      break;
                    case 4:
                      t.depthFunc(t.EQUAL);
                      break;
                    case 5:
                      t.depthFunc(t.GEQUAL);
                      break;
                    case 6:
                      t.depthFunc(t.GREATER);
                      break;
                    case 7:
                      t.depthFunc(t.NOTEQUAL);
                      break;
                    default:
                      t.depthFunc(t.LEQUAL)
                  } else t.depthFunc(t.LEQUAL);
                  n = e
                }
              },
              setLocked: function(t) {
                e = t
              },
              setClear: function(e) {
                r !== e && (t.clearDepth(e), r = e)
              },
              reset: function() {
                e = !1, i = null, n = null, r = null
              }
            }
          },
          a = new function() {
            var e = !1,
              i = null,
              n = null,
              r = null,
              a = null,
              o = null,
              s = null,
              c = null,
              h = null;
            return {
              setTest: function(e) {
                e ? U(t.STENCIL_TEST) : D(t.STENCIL_TEST)
              },
              setMask: function(n) {
                i === n || e || (t.stencilMask(n), i = n)
              },
              setFunc: function(e, i, o) {
                n === e && r === i && a === o || (t.stencilFunc(e, i, o), n = e, r = i, a = o)
              },
              setOp: function(e, i, n) {
                o === e && s === i && c === n || (t.stencilOp(e, i, n), o = e, s = i, c = n)
              },
              setLocked: function(t) {
                e = t
              },
              setClear: function(e) {
                h !== e && (t.clearStencil(e), h = e)
              },
              reset: function() {
                e = !1, i = null, n = null, r = null, a = null, o = null, s = null, c = null, h = null
              }
            }
          },
          o = t.getParameter(t.MAX_VERTEX_ATTRIBS),
          s = new Uint8Array(o),
          c = new Uint8Array(o),
          h = new Uint8Array(o),
          l = {},
          u = null,
          p = null,
          d = null,
          f = null,
          m = null,
          g = null,
          v = null,
          y = null,
          x = null,
          b = !1,
          _ = null,
          w = null,
          M = null,
          E = null,
          T = null,
          S = t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),
          A = null,
          R = {},
          L = new G,
          P = new G;

        function C(e, i, n) {
          var r = new Uint8Array(4),
            a = t.createTexture();
          t.bindTexture(e, a), t.texParameteri(e, t.TEXTURE_MIN_FILTER, t.NEAREST), t.texParameteri(e, t.TEXTURE_MAG_FILTER, t.NEAREST);
          for (var o = 0; o < n; o++) t.texImage2D(i + o, 0, t.RGBA, 1, 1, 0, t.RGBA, t.UNSIGNED_BYTE, r);
          return a
        }
        var I = {};

        function U(e) {
          !0 !== l[e] && (t.enable(e), l[e] = !0)
        }

        function D(e) {
          !1 !== l[e] && (t.disable(e), l[e] = !1)
        }

        function O(e, n, r, a, o, s, c, h) {
          if (0 !== e ? U(t.BLEND) : D(t.BLEND), 5 !== e) {
            if (e !== d || h !== b) switch (e) {
              case 2:
                h ? (t.blendEquationSeparate(t.FUNC_ADD, t.FUNC_ADD), t.blendFuncSeparate(t.ONE, t.ONE, t.ONE, t.ONE)) : (t.blendEquation(t.FUNC_ADD), t.blendFunc(t.SRC_ALPHA, t.ONE));
                break;
              case 3:
                h ? (t.blendEquationSeparate(t.FUNC_ADD, t.FUNC_ADD), t.blendFuncSeparate(t.ZERO, t.ZERO, t.ONE_MINUS_SRC_COLOR, t.ONE_MINUS_SRC_ALPHA)) : (t.blendEquation(t.FUNC_ADD), t.blendFunc(t.ZERO, t.ONE_MINUS_SRC_COLOR));
                break;
              case 4:
                h ? (t.blendEquationSeparate(t.FUNC_ADD, t.FUNC_ADD), t.blendFuncSeparate(t.ZERO, t.SRC_COLOR, t.ZERO, t.SRC_ALPHA)) : (t.blendEquation(t.FUNC_ADD), t.blendFunc(t.ZERO, t.SRC_COLOR));
                break;
              default:
                h ? (t.blendEquationSeparate(t.FUNC_ADD, t.FUNC_ADD), t.blendFuncSeparate(t.ONE, t.ONE_MINUS_SRC_ALPHA, t.ONE, t.ONE_MINUS_SRC_ALPHA)) : (t.blendEquationSeparate(t.FUNC_ADD, t.FUNC_ADD), t.blendFuncSeparate(t.SRC_ALPHA, t.ONE_MINUS_SRC_ALPHA, t.ONE, t.ONE_MINUS_SRC_ALPHA))
            }
            f = null, m = null, g = null, v = null, y = null, x = null
          } else o = o || n, s = s || r, c = c || a, n === f && o === v || (t.blendEquationSeparate(i.convert(n), i.convert(o)), f = n, v = o), r === m && a === g && s === y && c === x || (t.blendFuncSeparate(i.convert(r), i.convert(a), i.convert(s), i.convert(c)), m = r, g = a, y = s, x = c);
          d = e, b = h
        }

        function N(e) {
          _ !== e && (e ? t.frontFace(t.CW) : t.frontFace(t.CCW), _ = e)
        }

        function B(e) {
          0 !== e ? (U(t.CULL_FACE), e !== w && (1 === e ? t.cullFace(t.BACK) : 2 === e ? t.cullFace(t.FRONT) : t.cullFace(t.FRONT_AND_BACK))) : D(t.CULL_FACE), w = e
        }

        function F(e, i, n) {
          e ? (U(t.POLYGON_OFFSET_FILL), E === i && T === n || (t.polygonOffset(i, n), E = i, T = n)) : D(t.POLYGON_OFFSET_FILL)
        }

        function z(e) {
          void 0 === e && (e = t.TEXTURE0 + S - 1), A !== e && (t.activeTexture(e), A = e)
        }
        return I[t.TEXTURE_2D] = C(t.TEXTURE_2D, t.TEXTURE_2D, 1), I[t.TEXTURE_CUBE_MAP] = C(t.TEXTURE_CUBE_MAP, t.TEXTURE_CUBE_MAP_POSITIVE_X, 6), n.setClear(0, 0, 0, 1), r.setClear(1), a.setClear(0), U(t.DEPTH_TEST), r.setFunc(3), N(!1), B(1), U(t.CULL_FACE), U(t.BLEND), O(1), {
          buffers: {
            color: n,
            depth: r,
            stencil: a
          },
          initAttributes: function() {
            for (var t = 0, e = s.length; t < e; t++) s[t] = 0
          },
          enableAttribute: function(i) {
            s[i] = 1, 0 === c[i] && (t.enableVertexAttribArray(i), c[i] = 1), 0 !== h[i] && (e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i, 0), h[i] = 0)
          },
          enableAttributeAndDivisor: function(i, n) {
            s[i] = 1, 0 === c[i] && (t.enableVertexAttribArray(i), c[i] = 1), h[i] !== n && (e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i, n), h[i] = n)
          },
          disableUnusedAttributes: function() {
            for (var e = 0, i = c.length; e !== i; ++e) c[e] !== s[e] && (t.disableVertexAttribArray(e), c[e] = 0)
          },
          enable: U,
          disable: D,
          getCompressedTextureFormats: function() {
            if (null === u && (u = [], e.get("WEBGL_compressed_texture_pvrtc") || e.get("WEBGL_compressed_texture_s3tc") || e.get("WEBGL_compressed_texture_etc1")))
              for (var i = t.getParameter(t.COMPRESSED_TEXTURE_FORMATS), n = 0; n < i.length; n++) u.push(i[n]);
            return u
          },
          useProgram: function(e) {
            return p !== e && (t.useProgram(e), p = e, !0)
          },
          setBlending: O,
          setMaterial: function(e) {
            2 === e.side ? D(t.CULL_FACE) : U(t.CULL_FACE), N(1 === e.side), !0 === e.transparent ? O(e.blending, e.blendEquation, e.blendSrc, e.blendDst, e.blendEquationAlpha, e.blendSrcAlpha, e.blendDstAlpha, e.premultipliedAlpha) : O(0), r.setFunc(e.depthFunc), r.setTest(e.depthTest), r.setMask(e.depthWrite), n.setMask(e.colorWrite), F(e.polygonOffset, e.polygonOffsetFactor, e.polygonOffsetUnits)
          },
          setFlipSided: N,
          setCullFace: B,
          setLineWidth: function(e) {
            e !== M && (t.lineWidth(e), M = e)
          },
          setPolygonOffset: F,
          setScissorTest: function(e) {
            e ? U(t.SCISSOR_TEST) : D(t.SCISSOR_TEST)
          },
          activeTexture: z,
          bindTexture: function(e, i) {
            null === A && z();
            var n = R[A];
            void 0 === n && (n = {
              type: void 0,
              texture: void 0
            }, R[A] = n), n.type === e && n.texture === i || (t.bindTexture(e, i || I[e]), n.type = e, n.texture = i)
          },
          compressedTexImage2D: function() {
            try {
              t.compressedTexImage2D.apply(t, arguments)
            } catch (t) {
              console.error("THREE.WebGLState:", t)
            }
          },
          texImage2D: function() {
            try {
              t.texImage2D.apply(t, arguments)
            } catch (t) {
              console.error("THREE.WebGLState:", t)
            }
          },
          scissor: function(e) {
            !1 === L.equals(e) && (t.scissor(e.x, e.y, e.z, e.w), L.copy(e))
          },
          viewport: function(e) {
            !1 === P.equals(e) && (t.viewport(e.x, e.y, e.z, e.w), P.copy(e))
          },
          reset: function() {
            for (var e = 0; e < c.length; e++) 1 === c[e] && (t.disableVertexAttribArray(e), c[e] = 0);
            l = {}, u = null, A = null, R = {}, p = null, d = null, _ = null, w = null, n.reset(), r.reset(), a.reset()
          }
        }
      }(f, m, z)).scissor(Q.copy(rt).multiplyScalar(it)), y.viewport(J.copy(nt).multiplyScalar(it)), x = new function() {
        var t = {};
        return {
          get: function(e) {
            var i = e.uuid,
              n = t[i];
            return void 0 === n && (n = {}, t[i] = n), n
          },
          remove: function(e) {
            delete t[e.uuid]
          },
          clear: function() {
            t = {}
          }
        }
      }, b = new mi(f, m, y, x, v, z, pt), _ = new ie(f), w = new function(t, e, i) {
        var n = {},
          r = {};

        function a(t) {
          var o = t.target,
            s = n[o.id];
          for (var c in null !== s.index && e.remove(s.index), s.attributes) e.remove(s.attributes[c]);
          o.removeEventListener("dispose", a), delete n[o.id];
          var h = r[o.id];
          h && (e.remove(h), delete r[o.id]), (h = r[s.id]) && (e.remove(h), delete r[s.id]), i.geometries--
        }
        return {
          get: function(t, e) {
            var r = n[e.id];
            return r || (e.addEventListener("dispose", a), e.isBufferGeometry ? r = e : e.isGeometry && (void 0 === e._bufferGeometry && (e._bufferGeometry = (new Be).setFromObject(t)), r = e._bufferGeometry), n[e.id] = r, i.geometries++, r)
          },
          update: function(i) {
            var n = i.index,
              r = i.attributes;
            for (var a in null !== n && e.update(n, t.ELEMENT_ARRAY_BUFFER), r) e.update(r[a], t.ARRAY_BUFFER);
            var o = i.morphAttributes;
            for (var a in o)
              for (var s = o[a], c = 0, h = s.length; c < h; c++) e.update(s[c], t.ARRAY_BUFFER)
          },
          getWireframeAttribute: function(i) {
            var n = r[i.id];
            if (n) return n;
            var a, o = [],
              s = i.index,
              c = i.attributes;
            if (null !== s)
              for (var h = 0, l = (a = s.array).length; h < l; h += 3) {
                var u = a[h + 0],
                  p = a[h + 1],
                  d = a[h + 2];
                o.push(u, p, p, d, d, u)
              } else
                for (h = 0, l = (a = c.position.array).length / 3 - 1; h < l; h += 3) u = h + 0, p = h + 1, d = h + 2, o.push(u, p, p, d, d, u);
            return n = new(Re(o) > 65535 ? Ee : we)(o, 1), e.update(n, t.ELEMENT_ARRAY_BUFFER), r[i.id] = n, n
          }
        }
      }(f, _, pt), M = new function(t, e) {
        var i = {};
        return {
          update: function(n) {
            var r = e.frame,
              a = n.geometry,
              o = t.get(n, a);
            return i[o.id] !== r && (a.isGeometry && o.updateFromObject(n), t.update(o), i[o.id] = r), o
          },
          clear: function() {
            i = {}
          }
        }
      }(w, dt), P = new function(t) {
        var e = {},
          i = new Float32Array(8);
        return {
          update: function(n, r, a, o) {
            var s = n.morphTargetInfluences,
              c = s.length,
              h = e[r.id];
            if (void 0 === h) {
              h = [];
              for (var l = 0; l < c; l++) h[l] = [l, 0];
              e[r.id] = h
            }
            var u = a.morphTargets && r.morphAttributes.position,
              p = a.morphNormals && r.morphAttributes.normal;
            for (l = 0; l < c; l++) 0 !== (d = h[l])[1] && (u && r.removeAttribute("morphTarget" + l), p && r.removeAttribute("morphNormal" + l));
            for (l = 0; l < c; l++)(d = h[l])[0] = l, d[1] = s[l];
            for (h.sort(Qe), l = 0; l < 8; l++) {
              var d;
              if (d = h[l]) {
                var f = d[0],
                  m = d[1];
                if (m) {
                  u && r.addAttribute("morphTarget" + l, u[f]), p && r.addAttribute("morphNormal" + l, p[f]), i[l] = m;
                  continue
                }
              }
              i[l] = 0
            }
            o.getUniforms().setValue(t, "morphTargetInfluences", i)
          }
        }
      }(f), S = new fi(H, m, v), T = new Ke, R = new Je, L = new function(t, e, i, n) {
        var r, a, o, s = new Ct(0),
          c = 0;

        function h(t, i) {
          e.buffers.color.setClear(t.r, t.g, t.b, i, n)
        }
        return {
          getClearColor: function() {
            return s
          },
          setClearColor: function(t, e) {
            s.set(t), h(s, c = void 0 !== e ? e : 1)
          },
          getClearAlpha: function() {
            return c
          },
          setClearAlpha: function(t) {
            h(s, c = t)
          },
          render: function(e, n, l, u) {
            var p = n.background;
            null === p ? h(s, c) : p && p.isColor && (h(p, 1), u = !0), (t.autoClear || u) && t.clear(t.autoClearColor, t.autoClearDepth, t.autoClearStencil), p && p.isCubeTexture ? (void 0 === o && ((o = new qe(new ze(1, 1, 1), new ke({
              uniforms: Ot.cube.uniforms,
              vertexShader: Ot.cube.vertexShader,
              fragmentShader: Ot.cube.fragmentShader,
              side: 1,
              depthTest: !0,
              depthWrite: !1,
              fog: !1
            }))).geometry.removeAttribute("normal"), o.geometry.removeAttribute("uv"), o.onBeforeRender = function(t, e, i) {
              this.matrixWorld.copyPosition(i.matrixWorld)
            }, i.update(o.geometry)), o.material.uniforms.tCube.value = p, e.push(o, o.geometry, o.material, 0, null)) : p && p.isTexture && (void 0 === r && (r = new pe(-1, 1, 1, -1, 0, 1), a = new qe(new He(2, 2), new Ve({
              depthTest: !1,
              depthWrite: !1,
              fog: !1
            })), i.update(a.geometry)), a.material.map = p, t.renderBufferDirect(r, null, a.geometry, a.material, a, null))
          }
        }
      }(H, y, w, s), C = new function(t, e, i) {
        var n;
        this.setMode = function(t) {
          n = t
        }, this.render = function(e, r) {
          t.drawArrays(n, e, r), i.calls++, i.vertices += r, n === t.TRIANGLES ? i.faces += r / 3 : n === t.POINTS && (i.points += r)
        }, this.renderInstances = function(r, a, o) {
          var s = e.get("ANGLE_instanced_arrays");
          if (null !== s) {
            var c = r.attributes.position;
            c.isInterleavedBufferAttribute ? (o = c.data.count, s.drawArraysInstancedANGLE(n, 0, o, r.maxInstancedCount)) : s.drawArraysInstancedANGLE(n, a, o, r.maxInstancedCount), i.calls++, i.vertices += o * r.maxInstancedCount, n === t.TRIANGLES ? i.faces += r.maxInstancedCount * o / 3 : n === t.POINTS && (i.points += r.maxInstancedCount * o)
          } else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")
        }
      }(f, m, dt), U = new function(t, e, i) {
        var n, r, a;
        this.setMode = function(t) {
          n = t
        }, this.setIndex = function(t) {
          r = t.type, a = t.bytesPerElement
        }, this.render = function(e, o) {
          t.drawElements(n, o, r, e * a), i.calls++, i.vertices += o, n === t.TRIANGLES ? i.faces += o / 3 : n === t.POINTS && (i.points += o)
        }, this.renderInstances = function(o, s, c) {
          var h = e.get("ANGLE_instanced_arrays");
          null !== h ? (h.drawElementsInstancedANGLE(n, c, r, s * a, o.maxInstancedCount), i.calls++, i.vertices += c * o.maxInstancedCount, n === t.TRIANGLES ? i.faces += o.maxInstancedCount * c / 3 : n === t.POINTS && (i.points += o.maxInstancedCount * c)) : console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")
        }
      }(f, m, dt), O = new Bt(H, f, y, b, v), F = new zt(H, f, y, b, v), H.info.programs = S.programs, H.context = f, H.capabilities = v, H.extensions = m, H.properties = x, H.renderLists = R, H.state = y
    }
    gt();
    var vt = new function(t) {
      var e = this,
        i = null,
        n = null;
      "undefined" != typeof window && "VRFrameData" in window && (n = new window.VRFrameData);
      var r = new D,
        a = new D,
        o = new D,
        s = new gi;
      s.bounds = new G(0, 0, .5, 1), s.layers.enable(1);
      var c = new gi;
      c.bounds = new G(.5, 0, .5, 1), c.layers.enable(2);
      var h, l, u = new vi([s, c]);

      function p() {
        if (null !== i && i.isPresenting) {
          var n = i.getEyeParameters("left"),
            r = n.renderWidth,
            a = n.renderHeight;
          l = t.getPixelRatio(), h = t.getSize(), t.setDrawingBufferSize(2 * r, a, 1)
        } else e.enabled && t.setDrawingBufferSize(h.width, h.height, l)
      }
      u.layers.enable(1), u.layers.enable(2), "undefined" != typeof window && window.addEventListener("vrdisplaypresentchange", p, !1), this.enabled = !1, this.standing = !1, this.getDevice = function() {
        return i
      }, this.setDevice = function(t) {
        void 0 !== t && (i = t)
      }, this.getCamera = function(t) {
        if (null === i) return t;
        i.depthNear = t.near, i.depthFar = t.far, i.getFrameData(n);
        var e = n.pose;
        null !== e.position ? t.position.fromArray(e.position) : t.position.set(0, 0, 0), null !== e.orientation && t.quaternion.fromArray(e.orientation), t.updateMatrixWorld();
        var h = i.stageParameters;
        if (this.standing && h && (a.fromArray(h.sittingToStandingTransform), o.getInverse(a), t.matrixWorld.multiply(a), t.matrixWorldInverse.multiply(o)), !1 === i.isPresenting) return t;
        s.near = t.near, c.near = t.near, s.far = t.far, c.far = t.far, u.matrixWorld.copy(t.matrixWorld), u.matrixWorldInverse.copy(t.matrixWorldInverse), s.matrixWorldInverse.fromArray(n.leftViewMatrix), c.matrixWorldInverse.fromArray(n.rightViewMatrix), this.standing && h && (s.matrixWorldInverse.multiply(o), c.matrixWorldInverse.multiply(o));
        var l = t.parent;
        null !== l && (r.getInverse(l.matrixWorld), s.matrixWorldInverse.multiply(r), c.matrixWorldInverse.multiply(r)), s.matrixWorld.getInverse(s.matrixWorldInverse), c.matrixWorld.getInverse(c.matrixWorldInverse), s.projectionMatrix.fromArray(n.leftProjectionMatrix), c.projectionMatrix.fromArray(n.rightProjectionMatrix), u.projectionMatrix.copy(s.projectionMatrix);
        var p = i.getLayers();
        if (p.length) {
          var d = p[0];
          null !== d.leftBounds && 4 === d.leftBounds.length && s.bounds.fromArray(d.leftBounds), null !== d.rightBounds && 4 === d.rightBounds.length && c.bounds.fromArray(d.rightBounds)
        }
        return u
      }, this.getStandingMatrix = function() {
        return a
      }, this.submitFrame = function() {
        i && i.isPresenting && i.submitFrame()
      }, this.dispose = function() {
        window.removeEventListener("vrdisplaypresentchange", p)
      }
    }(H);
    this.vr = vt;
    var yt = new ee(H, M, v.maxTextureSize);

    function xt(t) {
      t.preventDefault(), console.log("THREE.WebGLRenderer: Context Lost."), V = !0
    }

    function bt() {
      console.log("THREE.WebGLRenderer: Context Restored."), V = !1, gt()
    }

    function _t(t) {
      var e = t.target;
      e.removeEventListener("dispose", _t),
        function(t) {
          wt(t), x.remove(t)
        }(e)
    }

    function wt(t) {
      var e = x.get(t).program;
      t.program = void 0, void 0 !== e && S.releaseProgram(e)
    }
    this.shadowMap = yt, this.getContext = function() {
      return f
    }, this.getContextAttributes = function() {
      return f.getContextAttributes()
    }, this.forceContextLoss = function() {
      var t = m.get("WEBGL_lose_context");
      t && t.loseContext()
    }, this.forceContextRestore = function() {
      var t = m.get("WEBGL_lose_context");
      t && t.restoreContext()
    }, this.getPixelRatio = function() {
      return it
    }, this.setPixelRatio = function(t) {
      void 0 !== t && (it = t, this.setSize(tt, et, !1))
    }, this.getSize = function() {
      return {
        width: tt,
        height: et
      }
    }, this.setSize = function(t, i, n) {
      var r = vt.getDevice();
      r && r.isPresenting ? console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.") : (tt = t, et = i, e.width = t * it, e.height = i * it, !1 !== n && (e.style.width = t + "px", e.style.height = i + "px"), this.setViewport(0, 0, t, i))
    }, this.getDrawingBufferSize = function() {
      return {
        width: tt * it,
        height: et * it
      }
    }, this.setDrawingBufferSize = function(t, i, n) {
      tt = t, et = i, it = n, e.width = t * n, e.height = i * n, this.setViewport(0, 0, t, i)
    }, this.setViewport = function(t, e, i, n) {
      nt.set(t, et - e - n, i, n), y.viewport(J.copy(nt).multiplyScalar(it))
    }, this.setScissor = function(t, e, i, n) {
      rt.set(t, et - e - n, i, n), y.scissor(Q.copy(rt).multiplyScalar(it))
    }, this.setScissorTest = function(t) {
      y.setScissorTest(at = t)
    }, this.getClearColor = function() {
      return L.getClearColor()
    }, this.setClearColor = function() {
      L.setClearColor.apply(L, arguments)
    }, this.getClearAlpha = function() {
      return L.getClearAlpha()
    }, this.setClearAlpha = function() {
      L.setClearAlpha.apply(L, arguments)
    }, this.clear = function(t, e, i) {
      var n = 0;
      (void 0 === t || t) && (n |= f.COLOR_BUFFER_BIT), (void 0 === e || e) && (n |= f.DEPTH_BUFFER_BIT), (void 0 === i || i) && (n |= f.STENCIL_BUFFER_BIT), f.clear(n)
    }, this.clearColor = function() {
      this.clear(!0, !1, !1)
    }, this.clearDepth = function() {
      this.clear(!1, !0, !1)
    }, this.clearStencil = function() {
      this.clear(!1, !1, !0)
    }, this.clearTarget = function(t, e, i, n) {
      this.setRenderTarget(t), this.clear(e, i, n)
    }, this.dispose = function() {
      e.removeEventListener("webglcontextlost", xt, !1), e.removeEventListener("webglcontextrestored", bt, !1), R.dispose(), vt.dispose()
    }, this.renderBufferImmediate = function(t, e, i) {
      y.initAttributes();
      var n = x.get(t);
      t.hasPositions && !n.position && (n.position = f.createBuffer()), t.hasNormals && !n.normal && (n.normal = f.createBuffer()), t.hasUvs && !n.uv && (n.uv = f.createBuffer()), t.hasColors && !n.color && (n.color = f.createBuffer());
      var r = e.getAttributes();
      if (t.hasPositions && (f.bindBuffer(f.ARRAY_BUFFER, n.position), f.bufferData(f.ARRAY_BUFFER, t.positionArray, f.DYNAMIC_DRAW), y.enableAttribute(r.position), f.vertexAttribPointer(r.position, 3, f.FLOAT, !1, 0, 0)), t.hasNormals) {
        if (f.bindBuffer(f.ARRAY_BUFFER, n.normal), !i.isMeshPhongMaterial && !i.isMeshStandardMaterial && !i.isMeshNormalMaterial && !0 === i.flatShading)
          for (var a = 0, o = 3 * t.count; a < o; a += 9) {
            var s = t.normalArray,
              c = (s[a + 0] + s[a + 3] + s[a + 6]) / 3,
              h = (s[a + 1] + s[a + 4] + s[a + 7]) / 3,
              l = (s[a + 2] + s[a + 5] + s[a + 8]) / 3;
            s[a + 0] = c, s[a + 1] = h, s[a + 2] = l, s[a + 3] = c, s[a + 4] = h, s[a + 5] = l, s[a + 6] = c, s[a + 7] = h, s[a + 8] = l
          }
        f.bufferData(f.ARRAY_BUFFER, t.normalArray, f.DYNAMIC_DRAW), y.enableAttribute(r.normal), f.vertexAttribPointer(r.normal, 3, f.FLOAT, !1, 0, 0)
      }
      t.hasUvs && i.map && (f.bindBuffer(f.ARRAY_BUFFER, n.uv), f.bufferData(f.ARRAY_BUFFER, t.uvArray, f.DYNAMIC_DRAW), y.enableAttribute(r.uv), f.vertexAttribPointer(r.uv, 2, f.FLOAT, !1, 0, 0)), t.hasColors && 0 !== i.vertexColors && (f.bindBuffer(f.ARRAY_BUFFER, n.color), f.bufferData(f.ARRAY_BUFFER, t.colorArray, f.DYNAMIC_DRAW), y.enableAttribute(r.color), f.vertexAttribPointer(r.color, 3, f.FLOAT, !1, 0, 0)), y.disableUnusedAttributes(), f.drawArrays(f.TRIANGLES, 0, t.count), t.count = 0
    }, this.renderBufferDirect = function(t, e, i, n, r, a) {
      y.setMaterial(n);
      var o = Dt(t, e, n, r),
        s = i.id + "_" + o.id + "_" + (!0 === n.wireframe),
        c = !1;
      s !== q && (q = s, c = !0), r.morphTargetInfluences && (P.update(r, i, n, o), c = !0);
      var h, l = i.index,
        u = i.attributes.position,
        p = 1;
      !0 === n.wireframe && (l = w.getWireframeAttribute(i), p = 2);
      var d = C;
      null !== l && (h = _.get(l), (d = U).setIndex(h)), c && (function(t, e, i, n) {
        if (i && i.isInstancedBufferGeometry && null === m.get("ANGLE_instanced_arrays")) console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
        else {
          void 0 === n && (n = 0), y.initAttributes();
          var r = i.attributes,
            a = e.getAttributes(),
            o = t.defaultAttributeValues;
          for (var s in a) {
            var c = a[s];
            if (c >= 0) {
              var h = r[s];
              if (void 0 !== h) {
                var l = h.normalized,
                  u = h.itemSize,
                  p = _.get(h);
                if (void 0 === p) continue;
                var d = p.buffer,
                  g = p.type,
                  v = p.bytesPerElement;
                if (h.isInterleavedBufferAttribute) {
                  var x = h.data,
                    b = x.stride,
                    w = h.offset;
                  x && x.isInstancedInterleavedBuffer ? (y.enableAttributeAndDivisor(c, x.meshPerAttribute), void 0 === i.maxInstancedCount && (i.maxInstancedCount = x.meshPerAttribute * x.count)) : y.enableAttribute(c), f.bindBuffer(f.ARRAY_BUFFER, d), f.vertexAttribPointer(c, u, g, l, b * v, (n * b + w) * v)
                } else h.isInstancedBufferAttribute ? (y.enableAttributeAndDivisor(c, h.meshPerAttribute), void 0 === i.maxInstancedCount && (i.maxInstancedCount = h.meshPerAttribute * h.count)) : y.enableAttribute(c), f.bindBuffer(f.ARRAY_BUFFER, d), f.vertexAttribPointer(c, u, g, l, 0, n * u * v)
              } else if (void 0 !== o) {
                var M = o[s];
                if (void 0 !== M) switch (M.length) {
                  case 2:
                    f.vertexAttrib2fv(c, M);
                    break;
                  case 3:
                    f.vertexAttrib3fv(c, M);
                    break;
                  case 4:
                    f.vertexAttrib4fv(c, M);
                    break;
                  default:
                    f.vertexAttrib1fv(c, M)
                }
              }
            }
          }
          y.disableUnusedAttributes()
        }
      }(n, o, i), null !== l && f.bindBuffer(f.ELEMENT_ARRAY_BUFFER, h.buffer));
      var g = 0;
      null !== l ? g = l.count : void 0 !== u && (g = u.count);
      var v = i.drawRange.start * p,
        x = i.drawRange.count * p,
        b = null !== a ? a.start * p : 0,
        M = null !== a ? a.count * p : 1 / 0,
        E = Math.max(v, b),
        T = Math.min(g, v + x, b + M) - 1,
        S = Math.max(0, T - E + 1);
      if (0 !== S) {
        if (r.isMesh)
          if (!0 === n.wireframe) y.setLineWidth(n.wireframeLinewidth * ft()), d.setMode(f.LINES);
          else switch (r.drawMode) {
            case 0:
              d.setMode(f.TRIANGLES);
              break;
            case 1:
              d.setMode(f.TRIANGLE_STRIP);
              break;
            case 2:
              d.setMode(f.TRIANGLE_FAN)
          } else if (r.isLine) {
            var A = n.linewidth;
            void 0 === A && (A = 1), y.setLineWidth(A * ft()), r.isLineSegments ? d.setMode(f.LINES) : r.isLineLoop ? d.setMode(f.LINE_LOOP) : d.setMode(f.LINE_STRIP)
          } else r.isPoints && d.setMode(f.POINTS);
        i && i.isInstancedBufferGeometry ? i.maxInstancedCount > 0 && d.renderInstances(i, E, S) : d.render(E, S)
      }
    }, this.compile = function(t, e) {
      h.length = 0, l.length = 0, t.traverse((function(t) {
        t.isLight && (h.push(t), t.castShadow && l.push(t))
      })), T.setup(h, l, e), t.traverse((function(e) {
        if (e.material)
          if (Array.isArray(e.material))
            for (var i = 0; i < e.material.length; i++) Pt(e.material[i], t.fog, e);
          else Pt(e.material, t.fog, e)
      }))
    };
    var Mt, Et = !1,
      Tt = null;

    function St(t) {
      null !== Tt && Tt(t), (vt.getDevice() || window).requestAnimationFrame(St)
    }

    function At(t, e, i, n) {
      for (var r = 0, a = t.length; r < a; r++) {
        var o = t[r],
          s = o.object,
          c = o.geometry,
          h = void 0 === n ? o.material : n,
          l = o.group;
        if (i.isArrayCamera) {
          Z = i;
          for (var u = i.cameras, p = 0, d = u.length; p < d; p++) {
            var f = u[p];
            if (s.layers.test(f.layers)) {
              var m = f.bounds,
                g = m.x * tt,
                v = m.y * et,
                x = m.z * tt,
                b = m.w * et;
              y.viewport(J.set(g, v, x, b).multiplyScalar(it)), Rt(s, e, f, c, h, l)
            }
          }
        } else Z = null, Rt(s, e, i, c, h, l)
      }
    }

    function Rt(t, e, i, n, r, a) {
      if (t.onBeforeRender(H, e, i, n, r, a), t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse, t.matrixWorld), t.normalMatrix.getNormalMatrix(t.modelViewMatrix), t.isImmediateRenderObject) {
        y.setMaterial(r);
        var o = Dt(i, e.fog, r, t);
        q = "",
          function(t, e, i) {
            t.render((function(t) {
              H.renderBufferImmediate(t, e, i)
            }))
          }(t, o, r)
      } else H.renderBufferDirect(i, e.fog, n, r, t, a);
      t.onAfterRender(H, e, i, n, r, a)
    }

    function Pt(t, e, i) {
      var n = x.get(t),
        r = S.getParameters(t, T.state, l, e, st.numPlanes, st.numIntersection, i),
        a = S.getProgramCode(t, r),
        o = n.program,
        s = !0;
      if (void 0 === o) t.addEventListener("dispose", _t);
      else if (o.code !== a) wt(t);
      else {
        if (void 0 !== r.shaderID) return;
        s = !1
      }
      if (s) {
        if (r.shaderID) {
          var c = Ot[r.shaderID];
          n.shader = {
            name: t.type,
            uniforms: Ut.clone(c.uniforms),
            vertexShader: c.vertexShader,
            fragmentShader: c.fragmentShader
          }
        } else n.shader = {
          name: t.type,
          uniforms: t.uniforms,
          vertexShader: t.vertexShader,
          fragmentShader: t.fragmentShader
        };
        t.onBeforeCompile(n.shader), o = S.acquireProgram(t, n.shader, r, a), n.program = o, t.program = o
      }
      var h = o.getAttributes();
      if (t.morphTargets) {
        t.numSupportedMorphTargets = 0;
        for (var u = 0; u < H.maxMorphTargets; u++) h["morphTarget" + u] >= 0 && t.numSupportedMorphTargets++
      }
      if (t.morphNormals)
        for (t.numSupportedMorphNormals = 0, u = 0; u < H.maxMorphNormals; u++) h["morphNormal" + u] >= 0 && t.numSupportedMorphNormals++;
      var p = n.shader.uniforms;
      (t.isShaderMaterial || t.isRawShaderMaterial) && !0 !== t.clipping || (n.numClippingPlanes = st.numPlanes, n.numIntersection = st.numIntersection, p.clippingPlanes = st.uniform), n.fog = e, n.lightsHash = T.state.hash, t.lights && (p.ambientLightColor.value = T.state.ambient, p.directionalLights.value = T.state.directional, p.spotLights.value = T.state.spot, p.rectAreaLights.value = T.state.rectArea, p.pointLights.value = T.state.point, p.hemisphereLights.value = T.state.hemi, p.directionalShadowMap.value = T.state.directionalShadowMap, p.directionalShadowMatrix.value = T.state.directionalShadowMatrix, p.spotShadowMap.value = T.state.spotShadowMap, p.spotShadowMatrix.value = T.state.spotShadowMatrix, p.pointShadowMap.value = T.state.pointShadowMap, p.pointShadowMatrix.value = T.state.pointShadowMatrix);
      var d = n.program.getUniforms(),
        f = Lt.seqWithValue(d.seq, p);
      n.uniformsList = f
    }

    function Dt(t, e, i, n) {
      $ = 0;
      var r = x.get(i);
      if (ct && (ht || t !== Y)) {
        var a = t === Y && i.id === X;
        st.setState(i.clippingPlanes, i.clipIntersection, i.clipShadows, t, r, a)
      }!1 === i.needsUpdate && (void 0 === r.program || i.fog && r.fog !== e || i.lights && r.lightsHash !== T.state.hash ? i.needsUpdate = !0 : void 0 === r.numClippingPlanes || r.numClippingPlanes === st.numPlanes && r.numIntersection === st.numIntersection || (i.needsUpdate = !0)), i.needsUpdate && (Pt(i, e, n), i.needsUpdate = !1);
      var o, s, c = !1,
        h = !1,
        l = !1,
        u = r.program,
        p = u.getUniforms(),
        d = r.shader.uniforms;
      if (y.useProgram(u.program) && (c = !0, h = !0, l = !0), i.id !== X && (X = i.id, h = !0), c || t !== Y) {
        if (p.setValue(f, "projectionMatrix", t.projectionMatrix), v.logarithmicDepthBuffer && p.setValue(f, "logDepthBufFC", 2 / (Math.log(t.far + 1) / Math.LN2)), Y !== (Z || t) && (Y = Z || t, h = !0, l = !0), i.isShaderMaterial || i.isMeshPhongMaterial || i.isMeshStandardMaterial || i.envMap) {
          var m = p.map.cameraPosition;
          void 0 !== m && m.setValue(f, ut.setFromMatrixPosition(t.matrixWorld))
        }(i.isMeshPhongMaterial || i.isMeshLambertMaterial || i.isMeshBasicMaterial || i.isMeshStandardMaterial || i.isShaderMaterial || i.skinning) && p.setValue(f, "viewMatrix", t.matrixWorldInverse)
      }
      if (i.skinning) {
        p.setOptional(f, n, "bindMatrix"), p.setOptional(f, n, "bindMatrixInverse");
        var g = n.skeleton;
        if (g) {
          var b = g.bones;
          if (v.floatVertexTextures) {
            if (void 0 === g.boneTexture) {
              var _ = Math.sqrt(4 * b.length);
              _ = I.ceilPowerOfTwo(_), _ = Math.max(_, 4);
              var w = new Float32Array(_ * _ * 4);
              w.set(g.boneMatrices);
              var M = new k(w, _, _, A, E);
              g.boneMatrices = w, g.boneTexture = M, g.boneTextureSize = _
            }
            p.setValue(f, "boneTexture", g.boneTexture), p.setValue(f, "boneTextureSize", g.boneTextureSize)
          } else p.setOptional(f, g, "boneMatrices")
        }
      }
      return h && (p.setValue(f, "toneMappingExposure", H.toneMappingExposure), p.setValue(f, "toneMappingWhitePoint", H.toneMappingWhitePoint), i.lights && (s = l, (o = d).ambientLightColor.needsUpdate = s, o.directionalLights.needsUpdate = s, o.pointLights.needsUpdate = s, o.spotLights.needsUpdate = s, o.rectAreaLights.needsUpdate = s, o.hemisphereLights.needsUpdate = s), e && i.fog && function(t, e) {
        t.fogColor.value = e.color, e.isFog ? (t.fogNear.value = e.near, t.fogFar.value = e.far) : e.isFogExp2 && (t.fogDensity.value = e.density)
      }(d, e), i.isMeshBasicMaterial ? Nt(d, i) : i.isMeshLambertMaterial ? (Nt(d, i), function(t, e) {
        e.emissiveMap && (t.emissiveMap.value = e.emissiveMap)
      }(d, i)) : i.isMeshPhongMaterial ? (Nt(d, i), i.isMeshToonMaterial ? function(t, e) {
        Ft(t, e), e.gradientMap && (t.gradientMap.value = e.gradientMap)
      }(d, i) : Ft(d, i)) : i.isMeshStandardMaterial ? (Nt(d, i), i.isMeshPhysicalMaterial ? function(t, e) {
        t.clearCoat.value = e.clearCoat, t.clearCoatRoughness.value = e.clearCoatRoughness, Gt(t, e)
      }(d, i) : Gt(d, i)) : i.isMeshDepthMaterial ? (Nt(d, i), function(t, e) {
        e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias)
      }(d, i)) : i.isMeshDistanceMaterial ? (Nt(d, i), function(t, e) {
        e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias), t.referencePosition.value.copy(e.referencePosition), t.nearDistance.value = e.nearDistance, t.farDistance.value = e.farDistance
      }(d, i)) : i.isMeshNormalMaterial ? (Nt(d, i), function(t, e) {
        e.bumpMap && (t.bumpMap.value = e.bumpMap, t.bumpScale.value = e.bumpScale), e.normalMap && (t.normalMap.value = e.normalMap, t.normalScale.value.copy(e.normalScale)), e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias)
      }(d, i)) : i.isLineBasicMaterial ? (function(t, e) {
        t.diffuse.value = e.color, t.opacity.value = e.opacity
      }(d, i), i.isLineDashedMaterial && function(t, e) {
        t.dashSize.value = e.dashSize, t.totalSize.value = e.dashSize + e.gapSize, t.scale.value = e.scale
      }(d, i)) : i.isPointsMaterial ? function(t, e) {
        if (t.diffuse.value = e.color, t.opacity.value = e.opacity, t.size.value = e.size * it, t.scale.value = .5 * et, t.map.value = e.map, null !== e.map) {
          if (!0 === e.map.matrixAutoUpdate) {
            var i = e.map.offset,
              n = e.map.repeat,
              r = e.map.rotation,
              a = e.map.center;
            e.map.matrix.setUvTransform(i.x, i.y, n.x, n.y, r, a.x, a.y)
          }
          t.uvTransform.value.copy(e.map.matrix)
        }
      }(d, i) : i.isShadowMaterial && (d.color.value = i.color, d.opacity.value = i.opacity), void 0 !== d.ltcMat && (d.ltcMat.value = It.LTC_MAT_TEXTURE), void 0 !== d.ltcMag && (d.ltcMag.value = It.LTC_MAG_TEXTURE), Lt.upload(f, r.uniformsList, d, H)), p.setValue(f, "modelViewMatrix", n.modelViewMatrix), p.setValue(f, "normalMatrix", n.normalMatrix), p.setValue(f, "modelMatrix", n.matrixWorld), u
    }

    function Nt(t, e) {
      var i;
      if (t.opacity.value = e.opacity, e.color && (t.diffuse.value = e.color), e.emissive && t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity), e.map && (t.map.value = e.map), e.alphaMap && (t.alphaMap.value = e.alphaMap), e.specularMap && (t.specularMap.value = e.specularMap), e.envMap && (t.envMap.value = e.envMap, t.flipEnvMap.value = e.envMap && e.envMap.isCubeTexture ? -1 : 1, t.reflectivity.value = e.reflectivity, t.refractionRatio.value = e.refractionRatio), e.lightMap && (t.lightMap.value = e.lightMap, t.lightMapIntensity.value = e.lightMapIntensity), e.aoMap && (t.aoMap.value = e.aoMap, t.aoMapIntensity.value = e.aoMapIntensity), e.map ? i = e.map : e.specularMap ? i = e.specularMap : e.displacementMap ? i = e.displacementMap : e.normalMap ? i = e.normalMap : e.bumpMap ? i = e.bumpMap : e.roughnessMap ? i = e.roughnessMap : e.metalnessMap ? i = e.metalnessMap : e.alphaMap ? i = e.alphaMap : e.emissiveMap && (i = e.emissiveMap), void 0 !== i) {
        if (i.isWebGLRenderTarget && (i = i.texture), !0 === i.matrixAutoUpdate) {
          var n = i.offset,
            r = i.repeat,
            a = i.rotation,
            o = i.center;
          i.matrix.setUvTransform(n.x, n.y, r.x, r.y, a, o.x, o.y)
        }
        t.uvTransform.value.copy(i.matrix)
      }
    }

    function Ft(t, e) {
      t.specular.value = e.specular, t.shininess.value = Math.max(e.shininess, 1e-4), e.emissiveMap && (t.emissiveMap.value = e.emissiveMap), e.bumpMap && (t.bumpMap.value = e.bumpMap, t.bumpScale.value = e.bumpScale), e.normalMap && (t.normalMap.value = e.normalMap, t.normalScale.value.copy(e.normalScale)), e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias)
    }

    function Gt(t, e) {
      t.roughness.value = e.roughness, t.metalness.value = e.metalness, e.roughnessMap && (t.roughnessMap.value = e.roughnessMap), e.metalnessMap && (t.metalnessMap.value = e.metalnessMap), e.emissiveMap && (t.emissiveMap.value = e.emissiveMap), e.bumpMap && (t.bumpMap.value = e.bumpMap, t.bumpScale.value = e.bumpScale), e.normalMap && (t.normalMap.value = e.normalMap, t.normalScale.value.copy(e.normalScale)), e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias), e.envMap && (t.envMapIntensity.value = e.envMapIntensity)
    }
    this.animate = function(t) {
      Tt = t, Et || ((vt.getDevice() || window).requestAnimationFrame(St), Et = !0)
    }, this.render = function(t, e, i, n) {
      if (e && e.isCamera) {
        if (!V) {
          q = "", X = -1, Y = null, !0 === t.autoUpdate && t.updateMatrixWorld(), null === e.parent && e.updateMatrixWorld(), vt.enabled && (e = vt.getCamera(e)), lt.multiplyMatrices(e.projectionMatrix, e.matrixWorldInverse), ot.setFromMatrix(lt), h.length = 0, l.length = 0, p.length = 0, d.length = 0, ht = this.localClippingEnabled, ct = st.init(this.clippingPlanes, ht, e), (u = R.get(t, e)).init(),
            function t(e, i, n) {
              if (!1 !== e.visible) {
                if (e.layers.test(i.layers))
                  if (e.isLight) h.push(e), e.castShadow && l.push(e);
                  else if (e.isSprite) e.frustumCulled && !ot.intersectsSprite(e) || p.push(e);
                else if (e.isLensFlare) d.push(e);
                else if (e.isImmediateRenderObject) n && ut.setFromMatrixPosition(e.matrixWorld).applyMatrix4(lt), u.push(e, null, e.material, ut.z, null);
                else if ((e.isMesh || e.isLine || e.isPoints) && (e.isSkinnedMesh && e.skeleton.update(), !e.frustumCulled || ot.intersectsObject(e))) {
                  n && ut.setFromMatrixPosition(e.matrixWorld).applyMatrix4(lt);
                  var r = M.update(e),
                    a = e.material;
                  if (Array.isArray(a))
                    for (var o = r.groups, s = 0, c = o.length; s < c; s++) {
                      var f = o[s],
                        m = a[f.materialIndex];
                      m && m.visible && u.push(e, r, m, ut.z, f)
                    } else a.visible && u.push(e, r, a, ut.z, null)
                }
                var g = e.children;
                for (s = 0, c = g.length; s < c; s++) t(g[s], i, n)
              }
            }(t, e, H.sortObjects), !0 === H.sortObjects && u.sort(), ct && st.beginShadows(), yt.render(l, t, e), T.setup(h, l, e), ct && st.endShadows(), dt.frame++, dt.calls = 0, dt.vertices = 0, dt.faces = 0, dt.points = 0, void 0 === i && (i = null), this.setRenderTarget(i), L.render(u, t, e, n);
          var r = u.opaque,
            a = u.transparent;
          if (t.overrideMaterial) {
            var o = t.overrideMaterial;
            r.length && At(r, t, e, o), a.length && At(a, t, e, o)
          } else r.length && At(r, t, e), a.length && At(a, t, e);
          F.render(p, t, e), O.render(d, t, e, J), i && b.updateRenderTargetMipmap(i), y.buffers.depth.setTest(!0), y.buffers.depth.setMask(!0), y.buffers.color.setMask(!0), y.setPolygonOffset(!1), vt.enabled && vt.submitFrame()
        }
      } else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")
    }, this.setFaceCulling = function(t, e) {
      y.setCullFace(t), y.setFlipSided(0 === e)
    }, this.allocTextureUnit = function() {
      var t = $;
      return t >= v.maxTextures && console.warn("THREE.WebGLRenderer: Trying to use " + t + " texture units while this GPU supports only " + v.maxTextures), $ += 1, t
    }, this.setTexture2D = (Mt = !1, function(t, e) {
      t && t.isWebGLRenderTarget && (Mt || (console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."), Mt = !0), t = t.texture), b.setTexture2D(t, e)
    }), this.setTexture = function() {
      var t = !1;
      return function(e, i) {
        t || (console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."), t = !0), b.setTexture2D(e, i)
      }
    }(), this.setTextureCube = function() {
      var t = !1;
      return function(e, i) {
        e && e.isWebGLRenderTargetCube && (t || (console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."), t = !0), e = e.texture), e && e.isCubeTexture || Array.isArray(e.image) && 6 === e.image.length ? b.setTextureCube(e, i) : b.setTextureCubeDynamic(e, i)
      }
    }(), this.getRenderTarget = function() {
      return j
    }, this.setRenderTarget = function(t) {
      j = t, t && void 0 === x.get(t).__webglFramebuffer && b.setupRenderTarget(t);
      var e = null,
        i = !1;
      if (t) {
        var n = x.get(t).__webglFramebuffer;
        t.isWebGLRenderTargetCube ? (e = n[t.activeCubeFace], i = !0) : e = n, J.copy(t.viewport), Q.copy(t.scissor), K = t.scissorTest
      } else J.copy(nt).multiplyScalar(it), Q.copy(rt).multiplyScalar(it), K = at;
      if (W !== e && (f.bindFramebuffer(f.FRAMEBUFFER, e), W = e), y.viewport(J), y.scissor(Q), y.setScissorTest(K), i) {
        var r = x.get(t.texture);
        f.framebufferTexture2D(f.FRAMEBUFFER, f.COLOR_ATTACHMENT0, f.TEXTURE_CUBE_MAP_POSITIVE_X + t.activeCubeFace, r.__webglTexture, t.activeMipMapLevel)
      }
    }, this.readRenderTargetPixels = function(t, e, i, n, r, a) {
      if (t && t.isWebGLRenderTarget) {
        var o = x.get(t).__webglFramebuffer;
        if (o) {
          var s = !1;
          o !== W && (f.bindFramebuffer(f.FRAMEBUFFER, o), s = !0);
          try {
            var c = t.texture,
              h = c.format,
              l = c.type;
            if (h !== A && z.convert(h) !== f.getParameter(f.IMPLEMENTATION_COLOR_READ_FORMAT)) return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");
            if (!(1009 === l || z.convert(l) === f.getParameter(f.IMPLEMENTATION_COLOR_READ_TYPE) || l === E && (m.get("OES_texture_float") || m.get("WEBGL_color_buffer_float")) || 1016 === l && m.get("EXT_color_buffer_half_float"))) return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");
            f.checkFramebufferStatus(f.FRAMEBUFFER) === f.FRAMEBUFFER_COMPLETE ? e >= 0 && e <= t.width - n && i >= 0 && i <= t.height - r && f.readPixels(e, i, n, r, z.convert(h), z.convert(l), a) : console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")
          } finally {
            s && f.bindFramebuffer(f.FRAMEBUFFER, W)
          }
        }
      } else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")
    }
  }

  function bi(t, e) {
    this.name = "", this.color = new Ct(t), this.density = void 0 !== e ? e : 25e-5
  }

  function _i(t, e, i) {
    this.name = "", this.color = new Ct(t), this.near = void 0 !== e ? e : 1, this.far = void 0 !== i ? i : 1e3
  }

  function wi() {
    le.call(this), this.type = "Scene", this.background = null, this.fog = null, this.overrideMaterial = null, this.autoUpdate = !0
  }

  function Mi(t, e, i, n, r) {
    le.call(this), this.lensFlares = [], this.positionScreen = new N, this.customUpdateCallback = void 0, void 0 !== t && this.add(t, e, i, n, r)
  }

  function Ei(t) {
    Yt.call(this), this.type = "SpriteMaterial", this.color = new Ct(16777215), this.map = null, this.rotation = 0, this.fog = !1, this.lights = !1, this.setValues(t)
  }

  function Ti(t) {
    le.call(this), this.type = "Sprite", this.material = void 0 !== t ? t : new Ei
  }

  function Si() {
    le.call(this), this.type = "LOD", Object.defineProperties(this, {
      levels: {
        enumerable: !0,
        value: []
      }
    })
  }

  function Ai(t, e) {
    if (t = t || [], this.bones = t.slice(0), this.boneMatrices = new Float32Array(16 * this.bones.length), void 0 === e) this.calculateInverses();
    else if (this.bones.length === e.length) this.boneInverses = e.slice(0);
    else {
      console.warn("THREE.Skeleton boneInverses is the wrong length."), this.boneInverses = [];
      for (var i = 0, n = this.bones.length; i < n; i++) this.boneInverses.push(new D)
    }
  }

  function Ri() {
    le.call(this), this.type = "Bone"
  }

  function Li(t, e) {
    qe.call(this, t, e), this.type = "SkinnedMesh", this.bindMode = "attached", this.bindMatrix = new D, this.bindMatrixInverse = new D;
    var i = new Ai(this.initBones());
    this.bind(i, this.matrixWorld), this.normalizeSkinWeights()
  }

  function Pi(t) {
    Yt.call(this), this.type = "LineBasicMaterial", this.color = new Ct(16777215), this.linewidth = 1, this.linecap = "round", this.linejoin = "round", this.lights = !1, this.setValues(t)
  }

  function Ci(t, e, i) {
    if (1 === i) return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."), new Ii(t, e);
    le.call(this), this.type = "Line", this.geometry = void 0 !== t ? t : new Be, this.material = void 0 !== e ? e : new Pi({
      color: 16777215 * Math.random()
    })
  }

  function Ii(t, e) {
    Ci.call(this, t, e), this.type = "LineSegments"
  }

  function Ui(t, e) {
    Ci.call(this, t, e), this.type = "LineLoop"
  }

  function Di(t) {
    Yt.call(this), this.type = "PointsMaterial", this.color = new Ct(16777215), this.map = null, this.size = 1, this.sizeAttenuation = !0, this.lights = !1, this.setValues(t)
  }

  function Oi(t, e) {
    le.call(this), this.type = "Points", this.geometry = void 0 !== t ? t : new Be, this.material = void 0 !== e ? e : new Di({
      color: 16777215 * Math.random()
    })
  }

  function Ni() {
    le.call(this), this.type = "Group"
  }

  function Bi(t, e, i, n, r, a, o, s, c) {
    z.call(this, t, e, i, n, r, a, o, s, c), this.generateMipmaps = !1;
    var h = this;
    requestAnimationFrame((function e() {
      t.readyState >= t.HAVE_CURRENT_DATA && (h.needsUpdate = !0), requestAnimationFrame(e)
    }))
  }

  function Fi(t, e, i, n, r, a, o, s, c, h, l, u) {
    z.call(this, null, a, o, s, c, h, n, r, l, u), this.image = {
      width: e,
      height: i
    }, this.mipmaps = t, this.flipY = !1, this.generateMipmaps = !1
  }

  function zi(t, e, i, n, r, a, o, s, c, h) {
    if ((h = void 0 !== h ? h : R) !== R && h !== L) throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");
    void 0 === i && h === R && (i = M), void 0 === i && h === L && (i = T), z.call(this, null, n, r, a, o, s, h, i, c), this.image = {
      width: t,
      height: e
    }, this.magFilter = void 0 !== o ? o : b, this.minFilter = void 0 !== s ? s : b, this.flipY = !1, this.generateMipmaps = !1
  }

  function Gi(t) {
    Be.call(this), this.type = "WireframeGeometry";
    var e, i, n, r, a, o, s, c, h, l, u = [],
      p = [0, 0],
      d = {},
      f = ["a", "b", "c"];
    if (t && t.isGeometry) {
      var m = t.faces;
      for (e = 0, n = m.length; e < n; e++) {
        var g = m[e];
        for (i = 0; i < 3; i++) s = g[f[i]], c = g[f[(i + 1) % 3]], p[0] = Math.min(s, c), p[1] = Math.max(s, c), void 0 === d[h = p[0] + "," + p[1]] && (d[h] = {
          index1: p[0],
          index2: p[1]
        })
      }
      for (h in d) o = d[h], l = t.vertices[o.index1], u.push(l.x, l.y, l.z), l = t.vertices[o.index2], u.push(l.x, l.y, l.z)
    } else if (t && t.isBufferGeometry) {
      var v, y, x, b, _, w, M;
      if (l = new N, null !== t.index) {
        for (v = t.attributes.position, y = t.index, 0 === (x = t.groups).length && (x = [{
            start: 0,
            count: y.count,
            materialIndex: 0
          }]), r = 0, a = x.length; r < a; ++r)
          for (e = _ = (b = x[r]).start, n = _ + b.count; e < n; e += 3)
            for (i = 0; i < 3; i++) s = y.getX(e + i), c = y.getX(e + (i + 1) % 3), p[0] = Math.min(s, c), p[1] = Math.max(s, c), void 0 === d[h = p[0] + "," + p[1]] && (d[h] = {
              index1: p[0],
              index2: p[1]
            });
        for (h in d) o = d[h], l.fromBufferAttribute(v, o.index1), u.push(l.x, l.y, l.z), l.fromBufferAttribute(v, o.index2), u.push(l.x, l.y, l.z)
      } else
        for (e = 0, n = (v = t.attributes.position).count / 3; e < n; e++)
          for (i = 0; i < 3; i++) w = 3 * e + i, l.fromBufferAttribute(v, w), u.push(l.x, l.y, l.z), M = 3 * e + (i + 1) % 3, l.fromBufferAttribute(v, M), u.push(l.x, l.y, l.z)
    }
    this.addAttribute("position", new Te(u, 3))
  }

  function Hi(t, e, i) {
    ge.call(this), this.type = "ParametricGeometry", this.parameters = {
      func: t,
      slices: e,
      stacks: i
    }, this.fromBufferGeometry(new Vi(t, e, i)), this.mergeVertices()
  }

  function Vi(t, e, i) {
    Be.call(this), this.type = "ParametricBufferGeometry", this.parameters = {
      func: t,
      slices: e,
      stacks: i
    };
    var n, r, a = [],
      o = [],
      s = [],
      c = [],
      h = new N,
      l = new N,
      u = new N,
      p = new N,
      d = new N,
      f = e + 1;
    for (n = 0; n <= i; n++) {
      var m = n / i;
      for (r = 0; r <= e; r++) {
        var g = r / e;
        l = t(g, m, l), o.push(l.x, l.y, l.z), g - 1e-5 >= 0 ? (u = t(g - 1e-5, m, u), p.subVectors(l, u)) : (u = t(g + 1e-5, m, u), p.subVectors(u, l)), m - 1e-5 >= 0 ? (u = t(g, m - 1e-5, u), d.subVectors(l, u)) : (u = t(g, m + 1e-5, u), d.subVectors(u, l)), h.crossVectors(p, d).normalize(), s.push(h.x, h.y, h.z), c.push(g, m)
      }
    }
    for (n = 0; n < i; n++)
      for (r = 0; r < e; r++) {
        var v = n * f + r,
          y = n * f + r + 1,
          x = (n + 1) * f + r + 1,
          b = (n + 1) * f + r;
        a.push(v, y, b), a.push(y, x, b)
      }
    this.setIndex(a), this.addAttribute("position", new Te(o, 3)), this.addAttribute("normal", new Te(s, 3)), this.addAttribute("uv", new Te(c, 2))
  }

  function ki(t, e, i, n) {
    ge.call(this), this.type = "PolyhedronGeometry", this.parameters = {
      vertices: t,
      indices: e,
      radius: i,
      detail: n
    }, this.fromBufferGeometry(new ji(t, e, i, n)), this.mergeVertices()
  }

  function ji(t, e, i, n) {
    Be.call(this), this.type = "PolyhedronBufferGeometry", this.parameters = {
      vertices: t,
      indices: e,
      radius: i,
      detail: n
    }, i = i || 1;
    var r = [],
      a = [];

    function o(t, e, i, n) {
      var r, a, o = Math.pow(2, n),
        c = [];
      for (r = 0; r <= o; r++) {
        c[r] = [];
        var h = t.clone().lerp(i, r / o),
          l = e.clone().lerp(i, r / o),
          u = o - r;
        for (a = 0; a <= u; a++) c[r][a] = 0 === a && r === o ? h : h.clone().lerp(l, a / u)
      }
      for (r = 0; r < o; r++)
        for (a = 0; a < 2 * (o - r) - 1; a++) {
          var p = Math.floor(a / 2);
          a % 2 == 0 ? (s(c[r][p + 1]), s(c[r + 1][p]), s(c[r][p])) : (s(c[r][p + 1]), s(c[r + 1][p + 1]), s(c[r + 1][p]))
        }
    }

    function s(t) {
      r.push(t.x, t.y, t.z)
    }

    function c(e, i) {
      var n = 3 * e;
      i.x = t[n + 0], i.y = t[n + 1], i.z = t[n + 2]
    }

    function h(t, e, i, n) {
      n < 0 && 1 === t.x && (a[e] = t.x - 1), 0 === i.x && 0 === i.z && (a[e] = n / 2 / Math.PI + .5)
    }

    function l(t) {
      return Math.atan2(t.z, -t.x)
    }! function(t) {
      for (var i = new N, n = new N, r = new N, a = 0; a < e.length; a += 3) c(e[a + 0], i), c(e[a + 1], n), c(e[a + 2], r), o(i, n, r, t)
    }(n = n || 0),
    function(t) {
      for (var e = new N, i = 0; i < r.length; i += 3) e.x = r[i + 0], e.y = r[i + 1], e.z = r[i + 2], e.normalize().multiplyScalar(t), r[i + 0] = e.x, r[i + 1] = e.y, r[i + 2] = e.z
    }(i),
    function() {
      for (var t = new N, e = 0; e < r.length; e += 3) {
        t.x = r[e + 0], t.y = r[e + 1], t.z = r[e + 2];
        var i = l(t) / 2 / Math.PI + .5,
          n = (o = t, Math.atan2(-o.y, Math.sqrt(o.x * o.x + o.z * o.z)) / Math.PI + .5);
        a.push(i, 1 - n)
      }
      var o;
      (function() {
        for (var t = new N, e = new N, i = new N, n = new N, o = new U, s = new U, c = new U, u = 0, p = 0; u < r.length; u += 9, p += 6) {
          t.set(r[u + 0], r[u + 1], r[u + 2]), e.set(r[u + 3], r[u + 4], r[u + 5]), i.set(r[u + 6], r[u + 7], r[u + 8]), o.set(a[p + 0], a[p + 1]), s.set(a[p + 2], a[p + 3]), c.set(a[p + 4], a[p + 5]), n.copy(t).add(e).add(i).divideScalar(3);
          var d = l(n);
          h(o, p + 0, t, d), h(s, p + 2, e, d), h(c, p + 4, i, d)
        }
      })(),
      function() {
        for (var t = 0; t < a.length; t += 6) {
          var e = a[t + 0],
            i = a[t + 2],
            n = a[t + 4],
            r = Math.max(e, i, n),
            o = Math.min(e, i, n);
          r > .9 && o < .1 && (e < .2 && (a[t + 0] += 1), i < .2 && (a[t + 2] += 1), n < .2 && (a[t + 4] += 1))
        }
      }()
    }(), this.addAttribute("position", new Te(r, 3)), this.addAttribute("normal", new Te(r.slice(), 3)), this.addAttribute("uv", new Te(a, 2)), 0 === n ? this.computeVertexNormals() : this.normalizeNormals()
  }

  function Wi(t, e) {
    ge.call(this), this.type = "TetrahedronGeometry", this.parameters = {
      radius: t,
      detail: e
    }, this.fromBufferGeometry(new Xi(t, e)), this.mergeVertices()
  }

  function Xi(t, e) {
    ji.call(this, [1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1], [2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1], t, e), this.type = "TetrahedronBufferGeometry", this.parameters = {
      radius: t,
      detail: e
    }
  }

  function qi(t, e) {
    ge.call(this), this.type = "OctahedronGeometry", this.parameters = {
      radius: t,
      detail: e
    }, this.fromBufferGeometry(new Yi(t, e)), this.mergeVertices()
  }

  function Yi(t, e) {
    ji.call(this, [1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1], [0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2], t, e), this.type = "OctahedronBufferGeometry", this.parameters = {
      radius: t,
      detail: e
    }
  }

  function Zi(t, e) {
    ge.call(this), this.type = "IcosahedronGeometry", this.parameters = {
      radius: t,
      detail: e
    }, this.fromBufferGeometry(new Ji(t, e)), this.mergeVertices()
  }

  function Ji(t, e) {
    var i = (1 + Math.sqrt(5)) / 2,
      n = [-1, i, 0, 1, i, 0, -1, -i, 0, 1, -i, 0, 0, -1, i, 0, 1, i, 0, -1, -i, 0, 1, -i, i, 0, -1, i, 0, 1, -i, 0, -1, -i, 0, 1];
    ji.call(this, n, [0, 11, 5, 0, 5, 1, 0, 1, 7, 0, 7, 10, 0, 10, 11, 1, 5, 9, 5, 11, 4, 11, 10, 2, 10, 7, 6, 7, 1, 8, 3, 9, 4, 3, 4, 2, 3, 2, 6, 3, 6, 8, 3, 8, 9, 4, 9, 5, 2, 4, 11, 6, 2, 10, 8, 6, 7, 9, 8, 1], t, e), this.type = "IcosahedronBufferGeometry", this.parameters = {
      radius: t,
      detail: e
    }
  }

  function Qi(t, e) {
    ge.call(this), this.type = "DodecahedronGeometry", this.parameters = {
      radius: t,
      detail: e
    }, this.fromBufferGeometry(new Ki(t, e)), this.mergeVertices()
  }

  function Ki(t, e) {
    var i = (1 + Math.sqrt(5)) / 2,
      n = 1 / i,
      r = [-1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 0, -n, -i, 0, -n, i, 0, n, -i, 0, n, i, -n, -i, 0, -n, i, 0, n, -i, 0, n, i, 0, -i, 0, -n, i, 0, -n, -i, 0, n, i, 0, n];
    ji.call(this, r, [3, 11, 7, 3, 7, 15, 3, 15, 13, 7, 19, 17, 7, 17, 6, 7, 6, 15, 17, 4, 8, 17, 8, 10, 17, 10, 6, 8, 0, 16, 8, 16, 2, 8, 2, 10, 0, 12, 1, 0, 1, 18, 0, 18, 16, 6, 10, 2, 6, 2, 13, 6, 13, 15, 2, 16, 18, 2, 18, 3, 2, 3, 13, 18, 1, 9, 18, 9, 11, 18, 11, 3, 4, 14, 12, 4, 12, 0, 4, 0, 8, 11, 9, 5, 11, 5, 19, 11, 19, 7, 19, 5, 14, 19, 14, 4, 19, 4, 17, 1, 12, 14, 1, 14, 5, 1, 5, 9], t, e), this.type = "DodecahedronBufferGeometry", this.parameters = {
      radius: t,
      detail: e
    }
  }

  function $i(t, e, i, n, r, a) {
    ge.call(this), this.type = "TubeGeometry", this.parameters = {
      path: t,
      tubularSegments: e,
      radius: i,
      radialSegments: n,
      closed: r
    }, void 0 !== a && console.warn("THREE.TubeGeometry: taper has been removed.");
    var o = new tn(t, e, i, n, r);
    this.tangents = o.tangents, this.normals = o.normals, this.binormals = o.binormals, this.fromBufferGeometry(o), this.mergeVertices()
  }

  function tn(t, e, i, n, r) {
    Be.call(this), this.type = "TubeBufferGeometry", this.parameters = {
      path: t,
      tubularSegments: e,
      radius: i,
      radialSegments: n,
      closed: r
    }, e = e || 64, i = i || 1, n = n || 8, r = r || !1;
    var a = t.computeFrenetFrames(e, r);
    this.tangents = a.tangents, this.normals = a.normals, this.binormals = a.binormals;
    var o, s, c = new N,
      h = new N,
      l = new U,
      u = new N,
      p = [],
      d = [],
      f = [],
      m = [];

    function g(r) {
      u = t.getPointAt(r / e, u);
      var o = a.normals[r],
        l = a.binormals[r];
      for (s = 0; s <= n; s++) {
        var f = s / n * Math.PI * 2,
          m = Math.sin(f),
          g = -Math.cos(f);
        h.x = g * o.x + m * l.x, h.y = g * o.y + m * l.y, h.z = g * o.z + m * l.z, h.normalize(), d.push(h.x, h.y, h.z), c.x = u.x + i * h.x, c.y = u.y + i * h.y, c.z = u.z + i * h.z, p.push(c.x, c.y, c.z)
      }
    }! function() {
      for (o = 0; o < e; o++) g(o);
      g(!1 === r ? e : 0),
        function() {
          for (o = 0; o <= e; o++)
            for (s = 0; s <= n; s++) l.x = o / e, l.y = s / n, f.push(l.x, l.y)
        }(),
        function() {
          for (s = 1; s <= e; s++)
            for (o = 1; o <= n; o++) {
              var t = (n + 1) * (s - 1) + (o - 1),
                i = (n + 1) * s + (o - 1),
                r = (n + 1) * s + o,
                a = (n + 1) * (s - 1) + o;
              m.push(t, i, a), m.push(i, r, a)
            }
        }()
    }(), this.setIndex(m), this.addAttribute("position", new Te(p, 3)), this.addAttribute("normal", new Te(d, 3)), this.addAttribute("uv", new Te(f, 2))
  }

  function en(t, e, i, n, r, a, o) {
    ge.call(this), this.type = "TorusKnotGeometry", this.parameters = {
      radius: t,
      tube: e,
      tubularSegments: i,
      radialSegments: n,
      p: r,
      q: a
    }, void 0 !== o && console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."), this.fromBufferGeometry(new nn(t, e, i, n, r, a)), this.mergeVertices()
  }

  function nn(t, e, i, n, r, a) {
    Be.call(this), this.type = "TorusKnotBufferGeometry", this.parameters = {
      radius: t,
      tube: e,
      tubularSegments: i,
      radialSegments: n,
      p: r,
      q: a
    }, t = t || 1, e = e || .4, i = Math.floor(i) || 64, n = Math.floor(n) || 8, r = r || 2, a = a || 3;
    var o, s, c = [],
      h = [],
      l = [],
      u = [],
      p = new N,
      d = new N,
      f = new N,
      m = new N,
      g = new N,
      v = new N,
      y = new N;
    for (o = 0; o <= i; ++o) {
      var x = o / i * r * Math.PI * 2;
      for (A(x, r, a, t, f), A(x + .01, r, a, t, m), v.subVectors(m, f), y.addVectors(m, f), g.crossVectors(v, y), y.crossVectors(g, v), g.normalize(), y.normalize(), s = 0; s <= n; ++s) {
        var b = s / n * Math.PI * 2,
          _ = -e * Math.cos(b),
          w = e * Math.sin(b);
        p.x = f.x + (_ * y.x + w * g.x), p.y = f.y + (_ * y.y + w * g.y), p.z = f.z + (_ * y.z + w * g.z), h.push(p.x, p.y, p.z), d.subVectors(p, f).normalize(), l.push(d.x, d.y, d.z), u.push(o / i), u.push(s / n)
      }
    }
    for (s = 1; s <= i; s++)
      for (o = 1; o <= n; o++) {
        var M = (n + 1) * (s - 1) + (o - 1),
          E = (n + 1) * s + (o - 1),
          T = (n + 1) * s + o,
          S = (n + 1) * (s - 1) + o;
        c.push(M, E, S), c.push(E, T, S)
      }

    function A(t, e, i, n, r) {
      var a = Math.cos(t),
        o = Math.sin(t),
        s = i / e * t,
        c = Math.cos(s);
      r.x = n * (2 + c) * .5 * a, r.y = n * (2 + c) * o * .5, r.z = n * Math.sin(s) * .5
    }
    this.setIndex(c), this.addAttribute("position", new Te(h, 3)), this.addAttribute("normal", new Te(l, 3)), this.addAttribute("uv", new Te(u, 2))
  }

  function rn(t, e, i, n, r) {
    ge.call(this), this.type = "TorusGeometry", this.parameters = {
      radius: t,
      tube: e,
      radialSegments: i,
      tubularSegments: n,
      arc: r
    }, this.fromBufferGeometry(new an(t, e, i, n, r)), this.mergeVertices()
  }

  function an(t, e, i, n, r) {
    Be.call(this), this.type = "TorusBufferGeometry", this.parameters = {
      radius: t,
      tube: e,
      radialSegments: i,
      tubularSegments: n,
      arc: r
    }, t = t || 1, e = e || .4, i = Math.floor(i) || 8, n = Math.floor(n) || 6, r = r || 2 * Math.PI;
    var a, o, s = [],
      c = [],
      h = [],
      l = [],
      u = new N,
      p = new N,
      d = new N;
    for (a = 0; a <= i; a++)
      for (o = 0; o <= n; o++) {
        var f = o / n * r,
          m = a / i * Math.PI * 2;
        p.x = (t + e * Math.cos(m)) * Math.cos(f), p.y = (t + e * Math.cos(m)) * Math.sin(f), p.z = e * Math.sin(m), c.push(p.x, p.y, p.z), u.x = t * Math.cos(f), u.y = t * Math.sin(f), d.subVectors(p, u).normalize(), h.push(d.x, d.y, d.z), l.push(o / n), l.push(a / i)
      }
    for (a = 1; a <= i; a++)
      for (o = 1; o <= n; o++) {
        var g = (n + 1) * a + o - 1,
          v = (n + 1) * (a - 1) + o - 1,
          y = (n + 1) * (a - 1) + o,
          x = (n + 1) * a + o;
        s.push(g, v, x), s.push(v, y, x)
      }
    this.setIndex(s), this.addAttribute("position", new Te(c, 3)), this.addAttribute("normal", new Te(h, 3)), this.addAttribute("uv", new Te(l, 2))
  }
  gi.prototype = Object.assign(Object.create(ue.prototype), {
    constructor: gi,
    isPerspectiveCamera: !0,
    copy: function(t, e) {
      return ue.prototype.copy.call(this, t, e), this.fov = t.fov, this.zoom = t.zoom, this.near = t.near, this.far = t.far, this.focus = t.focus, this.aspect = t.aspect, this.view = null === t.view ? null : Object.assign({}, t.view), this.filmGauge = t.filmGauge, this.filmOffset = t.filmOffset, this
    },
    setFocalLength: function(t) {
      var e = .5 * this.getFilmHeight() / t;
      this.fov = 2 * I.RAD2DEG * Math.atan(e), this.updateProjectionMatrix()
    },
    getFocalLength: function() {
      var t = Math.tan(.5 * I.DEG2RAD * this.fov);
      return .5 * this.getFilmHeight() / t
    },
    getEffectiveFOV: function() {
      return 2 * I.RAD2DEG * Math.atan(Math.tan(.5 * I.DEG2RAD * this.fov) / this.zoom)
    },
    getFilmWidth: function() {
      return this.filmGauge * Math.min(this.aspect, 1)
    },
    getFilmHeight: function() {
      return this.filmGauge / Math.max(this.aspect, 1)
    },
    setViewOffset: function(t, e, i, n, r, a) {
      this.aspect = t / e, null === this.view && (this.view = {
        enabled: !0,
        fullWidth: 1,
        fullHeight: 1,
        offsetX: 0,
        offsetY: 0,
        width: 1,
        height: 1
      }), this.view.enabled = !0, this.view.fullWidth = t, this.view.fullHeight = e, this.view.offsetX = i, this.view.offsetY = n, this.view.width = r, this.view.height = a, this.updateProjectionMatrix()
    },
    clearViewOffset: function() {
      null !== this.view && (this.view.enabled = !1), this.updateProjectionMatrix()
    },
    updateProjectionMatrix: function() {
      var t = this.near,
        e = t * Math.tan(.5 * I.DEG2RAD * this.fov) / this.zoom,
        i = 2 * e,
        n = this.aspect * i,
        r = -.5 * n,
        a = this.view;
      if (null !== this.view && this.view.enabled) {
        var o = a.fullWidth,
          s = a.fullHeight;
        r += a.offsetX * n / o, e -= a.offsetY * i / s, n *= a.width / o, i *= a.height / s
      }
      var c = this.filmOffset;
      0 !== c && (r += t * c / this.getFilmWidth()), this.projectionMatrix.makePerspective(r, r + n, e, e - i, t, this.far)
    },
    toJSON: function(t) {
      var e = le.prototype.toJSON.call(this, t);
      return e.object.fov = this.fov, e.object.zoom = this.zoom, e.object.near = this.near, e.object.far = this.far, e.object.focus = this.focus, e.object.aspect = this.aspect, null !== this.view && (e.object.view = Object.assign({}, this.view)), e.object.filmGauge = this.filmGauge, e.object.filmOffset = this.filmOffset, e
    }
  }), vi.prototype = Object.assign(Object.create(gi.prototype), {
    constructor: vi,
    isArrayCamera: !0
  }), bi.prototype.isFogExp2 = !0, bi.prototype.clone = function() {
    return new bi(this.color.getHex(), this.density)
  }, bi.prototype.toJSON = function() {
    return {
      type: "FogExp2",
      color: this.color.getHex(),
      density: this.density
    }
  }, _i.prototype.isFog = !0, _i.prototype.clone = function() {
    return new _i(this.color.getHex(), this.near, this.far)
  }, _i.prototype.toJSON = function() {
    return {
      type: "Fog",
      color: this.color.getHex(),
      near: this.near,
      far: this.far
    }
  }, wi.prototype = Object.assign(Object.create(le.prototype), {
    constructor: wi,
    copy: function(t, e) {
      return le.prototype.copy.call(this, t, e), null !== t.background && (this.background = t.background.clone()), null !== t.fog && (this.fog = t.fog.clone()), null !== t.overrideMaterial && (this.overrideMaterial = t.overrideMaterial.clone()), this.autoUpdate = t.autoUpdate, this.matrixAutoUpdate = t.matrixAutoUpdate, this
    },
    toJSON: function(t) {
      var e = le.prototype.toJSON.call(this, t);
      return null !== this.background && (e.object.background = this.background.toJSON(t)), null !== this.fog && (e.object.fog = this.fog.toJSON()), e
    }
  }), Mi.prototype = Object.assign(Object.create(le.prototype), {
    constructor: Mi,
    isLensFlare: !0,
    copy: function(t) {
      le.prototype.copy.call(this, t), this.positionScreen.copy(t.positionScreen), this.customUpdateCallback = t.customUpdateCallback;
      for (var e = 0, i = t.lensFlares.length; e < i; e++) this.lensFlares.push(t.lensFlares[e]);
      return this
    },
    add: function(t, e, i, n, r, a) {
      void 0 === e && (e = -1), void 0 === i && (i = 0), void 0 === a && (a = 1), void 0 === r && (r = new Ct(16777215)), void 0 === n && (n = 1), i = Math.min(i, Math.max(0, i)), this.lensFlares.push({
        texture: t,
        size: e,
        distance: i,
        x: 0,
        y: 0,
        z: 0,
        scale: 1,
        rotation: 0,
        opacity: a,
        color: r,
        blending: n
      })
    },
    updateLensFlares: function() {
      var t, e, i = this.lensFlares.length,
        n = 2 * -this.positionScreen.x,
        r = 2 * -this.positionScreen.y;
      for (t = 0; t < i; t++)(e = this.lensFlares[t]).x = this.positionScreen.x + n * e.distance, e.y = this.positionScreen.y + r * e.distance, e.wantedRotation = e.x * Math.PI * .25, e.rotation += .25 * (e.wantedRotation - e.rotation)
    }
  }), Ei.prototype = Object.create(Yt.prototype), Ei.prototype.constructor = Ei, Ei.prototype.isSpriteMaterial = !0, Ei.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.color.copy(t.color), this.map = t.map, this.rotation = t.rotation, this
  }, Ti.prototype = Object.assign(Object.create(le.prototype), {
    constructor: Ti,
    isSprite: !0,
    raycast: (ti = new N, ei = new N, ii = new N, function(t, e) {
      ei.setFromMatrixPosition(this.matrixWorld), t.ray.closestPointToPoint(ei, ti), ii.setFromMatrixScale(this.matrixWorld);
      var i = ii.x * ii.y / 4;
      if (!(ei.distanceToSquared(ti) > i)) {
        var n = t.ray.origin.distanceTo(ti);
        n < t.near || n > t.far || e.push({
          distance: n,
          point: ti.clone(),
          face: null,
          object: this
        })
      }
    }),
    clone: function() {
      return new this.constructor(this.material).copy(this)
    }
  }), Si.prototype = Object.assign(Object.create(le.prototype), {
    constructor: Si,
    copy: function(t) {
      le.prototype.copy.call(this, t, !1);
      for (var e = t.levels, i = 0, n = e.length; i < n; i++) {
        var r = e[i];
        this.addLevel(r.object.clone(), r.distance)
      }
      return this
    },
    addLevel: function(t, e) {
      void 0 === e && (e = 0), e = Math.abs(e);
      for (var i = this.levels, n = 0; n < i.length && !(e < i[n].distance); n++);
      i.splice(n, 0, {
        distance: e,
        object: t
      }), this.add(t)
    },
    getObjectForDistance: function(t) {
      for (var e = this.levels, i = 1, n = e.length; i < n && !(t < e[i].distance); i++);
      return e[i - 1].object
    },
    raycast: (ni = new N, function(t, e) {
      ni.setFromMatrixPosition(this.matrixWorld);
      var i = t.ray.origin.distanceTo(ni);
      this.getObjectForDistance(i).raycast(t, e)
    }),
    update: function() {
      var t = new N,
        e = new N;
      return function(i) {
        var n = this.levels;
        if (n.length > 1) {
          t.setFromMatrixPosition(i.matrixWorld), e.setFromMatrixPosition(this.matrixWorld);
          var r = t.distanceTo(e);
          n[0].object.visible = !0;
          for (var a = 1, o = n.length; a < o && r >= n[a].distance; a++) n[a - 1].object.visible = !1, n[a].object.visible = !0;
          for (; a < o; a++) n[a].object.visible = !1
        }
      }
    }(),
    toJSON: function(t) {
      var e = le.prototype.toJSON.call(this, t);
      e.object.levels = [];
      for (var i = this.levels, n = 0, r = i.length; n < r; n++) {
        var a = i[n];
        e.object.levels.push({
          object: a.object.uuid,
          distance: a.distance
        })
      }
      return e
    }
  }), Object.assign(Ai.prototype, {
    calculateInverses: function() {
      this.boneInverses = [];
      for (var t = 0, e = this.bones.length; t < e; t++) {
        var i = new D;
        this.bones[t] && i.getInverse(this.bones[t].matrixWorld), this.boneInverses.push(i)
      }
    },
    pose: function() {
      var t, e, i;
      for (e = 0, i = this.bones.length; e < i; e++)(t = this.bones[e]) && t.matrixWorld.getInverse(this.boneInverses[e]);
      for (e = 0, i = this.bones.length; e < i; e++)(t = this.bones[e]) && (t.parent && t.parent.isBone ? (t.matrix.getInverse(t.parent.matrixWorld), t.matrix.multiply(t.matrixWorld)) : t.matrix.copy(t.matrixWorld), t.matrix.decompose(t.position, t.quaternion, t.scale))
    },
    update: (ri = new D, ai = new D, function() {
      for (var t = this.bones, e = this.boneInverses, i = this.boneMatrices, n = this.boneTexture, r = 0, a = t.length; r < a; r++) {
        var o = t[r] ? t[r].matrixWorld : ai;
        ri.multiplyMatrices(o, e[r]), ri.toArray(i, 16 * r)
      }
      void 0 !== n && (n.needsUpdate = !0)
    }),
    clone: function() {
      return new Ai(this.bones, this.boneInverses)
    }
  }), Ri.prototype = Object.assign(Object.create(le.prototype), {
    constructor: Ri,
    isBone: !0
  }), Li.prototype = Object.assign(Object.create(qe.prototype), {
    constructor: Li,
    isSkinnedMesh: !0,
    initBones: function() {
      var t, e, i, n, r = [];
      if (this.geometry && void 0 !== this.geometry.bones) {
        for (i = 0, n = this.geometry.bones.length; i < n; i++) e = this.geometry.bones[i], t = new Ri, r.push(t), t.name = e.name, t.position.fromArray(e.pos), t.quaternion.fromArray(e.rotq), void 0 !== e.scl && t.scale.fromArray(e.scl);
        for (i = 0, n = this.geometry.bones.length; i < n; i++) - 1 !== (e = this.geometry.bones[i]).parent && null !== e.parent && void 0 !== r[e.parent] ? r[e.parent].add(r[i]) : this.add(r[i])
      }
      return this.updateMatrixWorld(!0), r
    },
    bind: function(t, e) {
      this.skeleton = t, void 0 === e && (this.updateMatrixWorld(!0), this.skeleton.calculateInverses(), e = this.matrixWorld), this.bindMatrix.copy(e), this.bindMatrixInverse.getInverse(e)
    },
    pose: function() {
      this.skeleton.pose()
    },
    normalizeSkinWeights: function() {
      var t, e;
      if (this.geometry && this.geometry.isGeometry)
        for (e = 0; e < this.geometry.skinWeights.length; e++) {
          var i = this.geometry.skinWeights[e];
          (t = 1 / i.manhattanLength()) != 1 / 0 ? i.multiplyScalar(t) : i.set(1, 0, 0, 0)
        } else if (this.geometry && this.geometry.isBufferGeometry) {
          var n = new G,
            r = this.geometry.attributes.skinWeight;
          for (e = 0; e < r.count; e++) n.x = r.getX(e), n.y = r.getY(e), n.z = r.getZ(e), n.w = r.getW(e), (t = 1 / n.manhattanLength()) != 1 / 0 ? n.multiplyScalar(t) : n.set(1, 0, 0, 0), r.setXYZW(e, n.x, n.y, n.z, n.w)
        }
    },
    updateMatrixWorld: function(t) {
      qe.prototype.updateMatrixWorld.call(this, t), "attached" === this.bindMode ? this.bindMatrixInverse.getInverse(this.matrixWorld) : "detached" === this.bindMode ? this.bindMatrixInverse.getInverse(this.bindMatrix) : console.warn("THREE.SkinnedMesh: Unrecognized bindMode: " + this.bindMode)
    },
    clone: function() {
      return new this.constructor(this.geometry, this.material).copy(this)
    }
  }), Pi.prototype = Object.create(Yt.prototype), Pi.prototype.constructor = Pi, Pi.prototype.isLineBasicMaterial = !0, Pi.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.color.copy(t.color), this.linewidth = t.linewidth, this.linecap = t.linecap, this.linejoin = t.linejoin, this
  }, Ci.prototype = Object.assign(Object.create(le.prototype), {
    constructor: Ci,
    isLine: !0,
    raycast: function() {
      var t = new D,
        e = new je,
        i = new Kt;
      return function(n, r) {
        var a = n.linePrecision,
          o = a * a,
          s = this.geometry,
          c = this.matrixWorld;
        if (null === s.boundingSphere && s.computeBoundingSphere(), i.copy(s.boundingSphere), i.applyMatrix4(c), !1 !== n.ray.intersectsSphere(i)) {
          t.getInverse(c), e.copy(n.ray).applyMatrix4(t);
          var h = new N,
            l = new N,
            u = new N,
            p = new N,
            d = this && this.isLineSegments ? 2 : 1;
          if (s.isBufferGeometry) {
            var f = s.index,
              m = s.attributes.position.array;
            if (null !== f)
              for (var g = f.array, v = 0, y = g.length - 1; v < y; v += d) {
                var x = g[v],
                  b = g[v + 1];
                h.fromArray(m, 3 * x), l.fromArray(m, 3 * b), e.distanceSqToSegment(h, l, p, u) > o || (p.applyMatrix4(this.matrixWorld), (M = n.ray.origin.distanceTo(p)) < n.near || M > n.far || r.push({
                  distance: M,
                  point: u.clone().applyMatrix4(this.matrixWorld),
                  index: v,
                  face: null,
                  faceIndex: null,
                  object: this
                }))
              } else
                for (v = 0, y = m.length / 3 - 1; v < y; v += d) h.fromArray(m, 3 * v), l.fromArray(m, 3 * v + 3), e.distanceSqToSegment(h, l, p, u) > o || (p.applyMatrix4(this.matrixWorld), (M = n.ray.origin.distanceTo(p)) < n.near || M > n.far || r.push({
                  distance: M,
                  point: u.clone().applyMatrix4(this.matrixWorld),
                  index: v,
                  face: null,
                  faceIndex: null,
                  object: this
                }))
          } else if (s.isGeometry) {
            var _ = s.vertices,
              w = _.length;
            for (v = 0; v < w - 1; v += d) {
              var M;
              e.distanceSqToSegment(_[v], _[v + 1], p, u) > o || (p.applyMatrix4(this.matrixWorld), (M = n.ray.origin.distanceTo(p)) < n.near || M > n.far || r.push({
                distance: M,
                point: u.clone().applyMatrix4(this.matrixWorld),
                index: v,
                face: null,
                faceIndex: null,
                object: this
              }))
            }
          }
        }
      }
    }(),
    clone: function() {
      return new this.constructor(this.geometry, this.material).copy(this)
    }
  }), Ii.prototype = Object.assign(Object.create(Ci.prototype), {
    constructor: Ii,
    isLineSegments: !0
  }), Ui.prototype = Object.assign(Object.create(Ci.prototype), {
    constructor: Ui,
    isLineLoop: !0
  }), Di.prototype = Object.create(Yt.prototype), Di.prototype.constructor = Di, Di.prototype.isPointsMaterial = !0, Di.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.color.copy(t.color), this.map = t.map, this.size = t.size, this.sizeAttenuation = t.sizeAttenuation, this
  }, Oi.prototype = Object.assign(Object.create(le.prototype), {
    constructor: Oi,
    isPoints: !0,
    raycast: function() {
      var t = new D,
        e = new je,
        i = new Kt;
      return function(n, r) {
        var a = this,
          o = this.geometry,
          s = this.matrixWorld,
          c = n.params.Points.threshold;
        if (null === o.boundingSphere && o.computeBoundingSphere(), i.copy(o.boundingSphere), i.applyMatrix4(s), i.radius += c, !1 !== n.ray.intersectsSphere(i)) {
          t.getInverse(s), e.copy(n.ray).applyMatrix4(t);
          var h = c / ((this.scale.x + this.scale.y + this.scale.z) / 3),
            l = h * h,
            u = new N;
          if (o.isBufferGeometry) {
            var p = o.index,
              d = o.attributes.position.array;
            if (null !== p)
              for (var f = p.array, m = 0, g = f.length; m < g; m++) {
                var v = f[m];
                u.fromArray(d, 3 * v), b(u, v)
              } else {
                m = 0;
                for (var y = d.length / 3; m < y; m++) u.fromArray(d, 3 * m), b(u, m)
              }
          } else {
            var x = o.vertices;
            for (m = 0, y = x.length; m < y; m++) b(x[m], m)
          }
        }

        function b(t, i) {
          var o = e.distanceSqToPoint(t);
          if (o < l) {
            var c = e.closestPointToPoint(t);
            c.applyMatrix4(s);
            var h = n.ray.origin.distanceTo(c);
            if (h < n.near || h > n.far) return;
            r.push({
              distance: h,
              distanceToRay: Math.sqrt(o),
              point: c.clone(),
              index: i,
              face: null,
              object: a
            })
          }
        }
      }
    }(),
    clone: function() {
      return new this.constructor(this.geometry, this.material).copy(this)
    }
  }), Ni.prototype = Object.assign(Object.create(le.prototype), {
    constructor: Ni
  }), Bi.prototype = Object.create(z.prototype), Bi.prototype.constructor = Bi, Fi.prototype = Object.create(z.prototype), Fi.prototype.constructor = Fi, Fi.prototype.isCompressedTexture = !0, zi.prototype = Object.create(z.prototype), zi.prototype.constructor = zi, zi.prototype.isDepthTexture = !0, Gi.prototype = Object.create(Be.prototype), Gi.prototype.constructor = Gi, Hi.prototype = Object.create(ge.prototype), Hi.prototype.constructor = Hi, Vi.prototype = Object.create(Be.prototype), Vi.prototype.constructor = Vi, ki.prototype = Object.create(ge.prototype), ki.prototype.constructor = ki, ji.prototype = Object.create(Be.prototype), ji.prototype.constructor = ji, Wi.prototype = Object.create(ge.prototype), Wi.prototype.constructor = Wi, Xi.prototype = Object.create(ji.prototype), Xi.prototype.constructor = Xi, qi.prototype = Object.create(ge.prototype), qi.prototype.constructor = qi, Yi.prototype = Object.create(ji.prototype), Yi.prototype.constructor = Yi, Zi.prototype = Object.create(ge.prototype), Zi.prototype.constructor = Zi, Ji.prototype = Object.create(ji.prototype), Ji.prototype.constructor = Ji, Qi.prototype = Object.create(ge.prototype), Qi.prototype.constructor = Qi, Ki.prototype = Object.create(ji.prototype), Ki.prototype.constructor = Ki, $i.prototype = Object.create(ge.prototype), $i.prototype.constructor = $i, tn.prototype = Object.create(Be.prototype), tn.prototype.constructor = tn, en.prototype = Object.create(ge.prototype), en.prototype.constructor = en, nn.prototype = Object.create(Be.prototype), nn.prototype.constructor = nn, rn.prototype = Object.create(ge.prototype), rn.prototype.constructor = rn, an.prototype = Object.create(Be.prototype), an.prototype.constructor = an;
  var on = {
    area: function(t) {
      for (var e = t.length, i = 0, n = e - 1, r = 0; r < e; n = r++) i += t[n].x * t[r].y - t[r].x * t[n].y;
      return .5 * i
    },
    triangulate: function() {
      function t(t, e, i, n, r, a) {
        var o, s, c, h, l, u, p, d, f, m, g, v, y, x, b, _, w;
        if (s = t[a[e]].x, c = t[a[e]].y, h = t[a[i]].x, l = t[a[i]].y, u = t[a[n]].x, (h - s) * ((p = t[a[n]].y) - c) - (l - c) * (u - s) <= 0) return !1;
        for (m = u - h, g = p - l, v = s - u, y = c - p, x = h - s, b = l - c, o = 0; o < r; o++)
          if (d = t[a[o]].x, f = t[a[o]].y, !(d === s && f === c || d === h && f === l || d === u && f === p) && (_ = x * (f - c) - b * (d - s), w = v * (f - p) - y * (d - u), m * (f - l) - g * (d - h) >= -Number.EPSILON && w >= -Number.EPSILON && _ >= -Number.EPSILON)) return !1;
        return !0
      }
      return function(e, i) {
        var n = e.length;
        if (n < 3) return null;
        var r, a, o, s = [],
          c = [],
          h = [];
        if (on.area(e) > 0)
          for (a = 0; a < n; a++) c[a] = a;
        else
          for (a = 0; a < n; a++) c[a] = n - 1 - a;
        var l = n,
          u = 2 * l;
        for (a = l - 1; l > 2;) {
          if (u-- <= 0) return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"), i ? h : s;
          if (l <= (r = a) && (r = 0), l <= (a = r + 1) && (a = 0), l <= (o = a + 1) && (o = 0), t(e, r, a, o, l, c)) {
            var p, d, f, m, g;
            for (p = c[r], d = c[a], f = c[o], s.push([e[p], e[d], e[f]]), h.push([c[r], c[a], c[o]]), m = a, g = a + 1; g < l; m++, g++) c[m] = c[g];
            u = 2 * --l
          }
        }
        return i ? h : s
      }
    }(),
    triangulateShape: function(t, e) {
      function i(t) {
        var e = t.length;
        e > 2 && t[e - 1].equals(t[0]) && t.pop()
      }

      function n(t, e, i) {
        return t.x !== e.x ? t.x < e.x ? t.x <= i.x && i.x <= e.x : e.x <= i.x && i.x <= t.x : t.y < e.y ? t.y <= i.y && i.y <= e.y : e.y <= i.y && i.y <= t.y
      }

      function r(t, e, i, r, a) {
        var o = e.x - t.x,
          s = e.y - t.y,
          c = r.x - i.x,
          h = r.y - i.y,
          l = t.x - i.x,
          u = t.y - i.y,
          p = s * c - o * h,
          d = s * l - o * u;
        if (Math.abs(p) > Number.EPSILON) {
          var f;
          if (p > 0) {
            if (d < 0 || d > p) return [];
            if ((f = h * l - c * u) < 0 || f > p) return []
          } else {
            if (d > 0 || d < p) return [];
            if ((f = h * l - c * u) > 0 || f < p) return []
          }
          if (0 === f) return !a || 0 !== d && d !== p ? [t] : [];
          if (f === p) return !a || 0 !== d && d !== p ? [e] : [];
          if (0 === d) return [i];
          if (d === p) return [r];
          var m = f / p;
          return [{
            x: t.x + m * o,
            y: t.y + m * s
          }]
        }
        if (0 !== d || h * l != c * u) return [];
        var g, v, y, x, b, _, w, M, E = 0 === o && 0 === s,
          T = 0 === c && 0 === h;
        return E && T ? t.x !== i.x || t.y !== i.y ? [] : [t] : E ? n(i, r, t) ? [t] : [] : T ? n(t, e, i) ? [i] : [] : (0 !== o ? (t.x < e.x ? (g = t, y = t.x, v = e, x = e.x) : (g = e, y = e.x, v = t, x = t.x), i.x < r.x ? (b = i, w = i.x, _ = r, M = r.x) : (b = r, w = r.x, _ = i, M = i.x)) : (t.y < e.y ? (g = t, y = t.y, v = e, x = e.y) : (g = e, y = e.y, v = t, x = t.y), i.y < r.y ? (b = i, w = i.y, _ = r, M = r.y) : (b = r, w = r.y, _ = i, M = i.y)), y <= w ? x < w ? [] : x === w ? a ? [] : [b] : x <= M ? [b, v] : [b, _] : y > M ? [] : y === M ? a ? [] : [g] : x <= M ? [g, v] : [g, _])
      }

      function a(t, e, i, n) {
        var r = e.x - t.x,
          a = e.y - t.y,
          o = i.x - t.x,
          s = i.y - t.y,
          c = n.x - t.x,
          h = n.y - t.y,
          l = r * s - a * o,
          u = r * h - a * c;
        if (Math.abs(l) > Number.EPSILON) {
          var p = c * s - h * o;
          return l > 0 ? u >= 0 && p >= 0 : u >= 0 || p >= 0
        }
        return u > 0
      }
      i(t), e.forEach(i);
      for (var o, s, c, h, l, u, p = {}, d = t.concat(), f = 0, m = e.length; f < m; f++) Array.prototype.push.apply(d, e[f]);
      for (o = 0, s = d.length; o < s; o++) void 0 !== p[l = d[o].x + ":" + d[o].y] && console.warn("THREE.ShapeUtils: Duplicate point", l, o), p[l] = o;
      var g = function(t, e) {
          var i, n = t.concat();

          function o(t, e) {
            var r = n.length - 1,
              o = t - 1;
            o < 0 && (o = r);
            var s = t + 1;
            s > r && (s = 0);
            var c = a(n[t], n[o], n[s], i[e]);
            if (!c) return !1;
            var h = i.length - 1,
              l = e - 1;
            l < 0 && (l = h);
            var u = e + 1;
            return u > h && (u = 0), !!(c = a(i[e], i[l], i[u], n[t]))
          }

          function s(t, e) {
            var i, a;
            for (i = 0; i < n.length; i++)
              if (a = i + 1, a %= n.length, r(t, e, n[i], n[a], !0).length > 0) return !0;
            return !1
          }
          var c = [];

          function h(t, i) {
            var n, a, o, s;
            for (n = 0; n < c.length; n++)
              for (a = e[c[n]], o = 0; o < a.length; o++)
                if (s = o + 1, s %= a.length, r(t, i, a[o], a[s], !0).length > 0) return !0;
            return !1
          }
          for (var l, u, p, d, f, m, g, v, y, x, b = [], _ = 0, w = e.length; _ < w; _++) c.push(_);
          for (var M = 0, E = 2 * c.length; c.length > 0;) {
            if (--E < 0) {
              console.log('THREE.ShapeUtils: Infinite Loop! Holes left:" + indepHoles.length + ", Probably Hole outside Shape!');
              break
            }
            for (u = M; u < n.length; u++) {
              for (p = n[u], l = -1, _ = 0; _ < c.length; _++)
                if (f = c[_], void 0 === b[m = p.x + ":" + p.y + ":" + f]) {
                  i = e[f];
                  for (var T = 0; T < i.length; T++)
                    if (d = i[T], o(u, T) && !s(p, d) && !h(p, d)) {
                      l = T, c.splice(_, 1), g = n.slice(0, u + 1), v = n.slice(u), y = i.slice(l), x = i.slice(0, l + 1), n = g.concat(y).concat(x).concat(v), M = u;
                      break
                    } if (l >= 0) break;
                  b[m] = !0
                } if (l >= 0) break
            }
          }
          return n
        }(t, e),
        v = on.triangulate(g, !1);
      for (o = 0, s = v.length; o < s; o++)
        for (h = v[o], c = 0; c < 3; c++) void 0 !== (u = p[l = h[c].x + ":" + h[c].y]) && (h[c] = u);
      return v.concat()
    },
    isClockWise: function(t) {
      return on.area(t) < 0
    }
  };

  function sn(t, e) {
    ge.call(this), this.type = "ExtrudeGeometry", this.parameters = {
      shapes: t,
      options: e
    }, this.fromBufferGeometry(new cn(t, e)), this.mergeVertices()
  }

  function cn(t, e) {
    void 0 !== t && (Be.call(this), this.type = "ExtrudeBufferGeometry", t = Array.isArray(t) ? t : [t], this.addShapeList(t, e), this.computeVertexNormals())
  }

  function hn(t, e) {
    ge.call(this), this.type = "TextGeometry", this.parameters = {
      text: t,
      parameters: e
    }, this.fromBufferGeometry(new ln(t, e)), this.mergeVertices()
  }

  function ln(t, e) {
    var i = (e = e || {}).font;
    if (!i || !i.isFont) return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."), new ge;
    var n = i.generateShapes(t, e.size, e.curveSegments);
    e.amount = void 0 !== e.height ? e.height : 50, void 0 === e.bevelThickness && (e.bevelThickness = 10), void 0 === e.bevelSize && (e.bevelSize = 8), void 0 === e.bevelEnabled && (e.bevelEnabled = !1), cn.call(this, n, e), this.type = "TextBufferGeometry"
  }

  function un(t, e, i, n, r, a, o) {
    ge.call(this), this.type = "SphereGeometry", this.parameters = {
      radius: t,
      widthSegments: e,
      heightSegments: i,
      phiStart: n,
      phiLength: r,
      thetaStart: a,
      thetaLength: o
    }, this.fromBufferGeometry(new pn(t, e, i, n, r, a, o)), this.mergeVertices()
  }

  function pn(t, e, i, n, r, a, o) {
    Be.call(this), this.type = "SphereBufferGeometry", this.parameters = {
      radius: t,
      widthSegments: e,
      heightSegments: i,
      phiStart: n,
      phiLength: r,
      thetaStart: a,
      thetaLength: o
    }, t = t || 1, e = Math.max(3, Math.floor(e) || 8), i = Math.max(2, Math.floor(i) || 6), n = void 0 !== n ? n : 0, r = void 0 !== r ? r : 2 * Math.PI;
    var s, c, h = (a = void 0 !== a ? a : 0) + (o = void 0 !== o ? o : Math.PI),
      l = 0,
      u = [],
      p = new N,
      d = new N,
      f = [],
      m = [],
      g = [],
      v = [];
    for (c = 0; c <= i; c++) {
      var y = [],
        x = c / i;
      for (s = 0; s <= e; s++) {
        var b = s / e;
        p.x = -t * Math.cos(n + b * r) * Math.sin(a + x * o), p.y = t * Math.cos(a + x * o), p.z = t * Math.sin(n + b * r) * Math.sin(a + x * o), m.push(p.x, p.y, p.z), d.set(p.x, p.y, p.z).normalize(), g.push(d.x, d.y, d.z), v.push(b, 1 - x), y.push(l++)
      }
      u.push(y)
    }
    for (c = 0; c < i; c++)
      for (s = 0; s < e; s++) {
        var _ = u[c][s + 1],
          w = u[c][s],
          M = u[c + 1][s],
          E = u[c + 1][s + 1];
        (0 !== c || a > 0) && f.push(_, w, E), (c !== i - 1 || h < Math.PI) && f.push(w, M, E)
      }
    this.setIndex(f), this.addAttribute("position", new Te(m, 3)), this.addAttribute("normal", new Te(g, 3)), this.addAttribute("uv", new Te(v, 2))
  }

  function dn(t, e, i, n, r, a) {
    ge.call(this), this.type = "RingGeometry", this.parameters = {
      innerRadius: t,
      outerRadius: e,
      thetaSegments: i,
      phiSegments: n,
      thetaStart: r,
      thetaLength: a
    }, this.fromBufferGeometry(new fn(t, e, i, n, r, a)), this.mergeVertices()
  }

  function fn(t, e, i, n, r, a) {
    Be.call(this), this.type = "RingBufferGeometry", this.parameters = {
      innerRadius: t,
      outerRadius: e,
      thetaSegments: i,
      phiSegments: n,
      thetaStart: r,
      thetaLength: a
    }, t = t || .5, e = e || 1, r = void 0 !== r ? r : 0, a = void 0 !== a ? a : 2 * Math.PI, i = void 0 !== i ? Math.max(3, i) : 8;
    var o, s, c, h = [],
      l = [],
      u = [],
      p = [],
      d = t,
      f = (e - t) / (n = void 0 !== n ? Math.max(1, n) : 1),
      m = new N,
      g = new U;
    for (s = 0; s <= n; s++) {
      for (c = 0; c <= i; c++) o = r + c / i * a, m.x = d * Math.cos(o), m.y = d * Math.sin(o), l.push(m.x, m.y, m.z), u.push(0, 0, 1), g.x = (m.x / e + 1) / 2, g.y = (m.y / e + 1) / 2, p.push(g.x, g.y);
      d += f
    }
    for (s = 0; s < n; s++) {
      var v = s * (i + 1);
      for (c = 0; c < i; c++) {
        var y = o = c + v,
          x = o + i + 1,
          b = o + i + 2,
          _ = o + 1;
        h.push(y, x, _), h.push(x, b, _)
      }
    }
    this.setIndex(h), this.addAttribute("position", new Te(l, 3)), this.addAttribute("normal", new Te(u, 3)), this.addAttribute("uv", new Te(p, 2))
  }

  function mn(t, e, i, n) {
    ge.call(this), this.type = "LatheGeometry", this.parameters = {
      points: t,
      segments: e,
      phiStart: i,
      phiLength: n
    }, this.fromBufferGeometry(new gn(t, e, i, n)), this.mergeVertices()
  }

  function gn(t, e, i, n) {
    Be.call(this), this.type = "LatheBufferGeometry", this.parameters = {
      points: t,
      segments: e,
      phiStart: i,
      phiLength: n
    }, e = Math.floor(e) || 12, i = i || 0, n = n || 2 * Math.PI, n = I.clamp(n, 0, 2 * Math.PI);
    var r, a, o, s = [],
      c = [],
      h = [],
      l = 1 / e,
      u = new N,
      p = new U;
    for (a = 0; a <= e; a++) {
      var d = i + a * l * n,
        f = Math.sin(d),
        m = Math.cos(d);
      for (o = 0; o <= t.length - 1; o++) u.x = t[o].x * f, u.y = t[o].y, u.z = t[o].x * m, c.push(u.x, u.y, u.z), p.x = a / e, p.y = o / (t.length - 1), h.push(p.x, p.y)
    }
    for (a = 0; a < e; a++)
      for (o = 0; o < t.length - 1; o++) {
        var g = r = o + a * t.length,
          v = r + t.length,
          y = r + t.length + 1,
          x = r + 1;
        s.push(g, v, x), s.push(v, y, x)
      }
    if (this.setIndex(s), this.addAttribute("position", new Te(c, 3)), this.addAttribute("uv", new Te(h, 2)), this.computeVertexNormals(), n === 2 * Math.PI) {
      var b = this.attributes.normal.array,
        _ = new N,
        w = new N,
        M = new N;
      for (r = e * t.length * 3, a = 0, o = 0; a < t.length; a++, o += 3) _.x = b[o + 0], _.y = b[o + 1], _.z = b[o + 2], w.x = b[r + o + 0], w.y = b[r + o + 1], w.z = b[r + o + 2], M.addVectors(_, w).normalize(), b[o + 0] = b[r + o + 0] = M.x, b[o + 1] = b[r + o + 1] = M.y, b[o + 2] = b[r + o + 2] = M.z
    }
  }

  function vn(e, i) {
    ge.call(this), this.type = "ShapeGeometry", "object" == t(i) && (console.warn("THREE.ShapeGeometry: Options parameter has been removed."), i = i.curveSegments), this.parameters = {
      shapes: e,
      curveSegments: i
    }, this.fromBufferGeometry(new yn(e, i)), this.mergeVertices()
  }

  function yn(t, e) {
    Be.call(this), this.type = "ShapeBufferGeometry", this.parameters = {
      shapes: t,
      curveSegments: e
    }, e = e || 12;
    var i = [],
      n = [],
      r = [],
      a = [],
      o = 0,
      s = 0;
    if (!1 === Array.isArray(t)) h(t);
    else
      for (var c = 0; c < t.length; c++) h(t[c]), this.addGroup(o, s, c), o += s, s = 0;

    function h(t) {
      var o, c, h, l = n.length / 3,
        u = t.extractPoints(e),
        p = u.shape,
        d = u.holes;
      if (!1 === on.isClockWise(p))
        for (p = p.reverse(), o = 0, c = d.length; o < c; o++) h = d[o], !0 === on.isClockWise(h) && (d[o] = h.reverse());
      var f = on.triangulateShape(p, d);
      for (o = 0, c = d.length; o < c; o++) h = d[o], p = p.concat(h);
      for (o = 0, c = p.length; o < c; o++) {
        var m = p[o];
        n.push(m.x, m.y, 0), r.push(0, 0, 1), a.push(m.x, m.y)
      }
      for (o = 0, c = f.length; o < c; o++) {
        var g = f[o],
          v = g[0] + l,
          y = g[1] + l,
          x = g[2] + l;
        i.push(v, y, x), s += 3
      }
    }
    this.setIndex(i), this.addAttribute("position", new Te(n, 3)), this.addAttribute("normal", new Te(r, 3)), this.addAttribute("uv", new Te(a, 2))
  }

  function xn(t, e) {
    Be.call(this), this.type = "EdgesGeometry", this.parameters = {
      thresholdAngle: e
    }, e = void 0 !== e ? e : 1;
    var i, n, r, a, o = [],
      s = Math.cos(I.DEG2RAD * e),
      c = [0, 0],
      h = {},
      l = ["a", "b", "c"];
    t.isBufferGeometry ? (a = new ge).fromBufferGeometry(t) : a = t.clone(), a.mergeVertices(), a.computeFaceNormals();
    for (var u = a.vertices, p = a.faces, d = 0, f = p.length; d < f; d++)
      for (var m = p[d], g = 0; g < 3; g++) i = m[l[g]], n = m[l[(g + 1) % 3]], c[0] = Math.min(i, n), c[1] = Math.max(i, n), void 0 === h[r = c[0] + "," + c[1]] ? h[r] = {
        index1: c[0],
        index2: c[1],
        face1: d,
        face2: void 0
      } : h[r].face2 = d;
    for (r in h) {
      var v = h[r];
      if (void 0 === v.face2 || p[v.face1].normal.dot(p[v.face2].normal) <= s) {
        var y = u[v.index1];
        o.push(y.x, y.y, y.z), y = u[v.index2], o.push(y.x, y.y, y.z)
      }
    }
    this.addAttribute("position", new Te(o, 3))
  }

  function bn(t, e, i, n, r, a, o, s) {
    ge.call(this), this.type = "CylinderGeometry", this.parameters = {
      radiusTop: t,
      radiusBottom: e,
      height: i,
      radialSegments: n,
      heightSegments: r,
      openEnded: a,
      thetaStart: o,
      thetaLength: s
    }, this.fromBufferGeometry(new _n(t, e, i, n, r, a, o, s)), this.mergeVertices()
  }

  function _n(t, e, i, n, r, a, o, s) {
    Be.call(this), this.type = "CylinderBufferGeometry", this.parameters = {
      radiusTop: t,
      radiusBottom: e,
      height: i,
      radialSegments: n,
      heightSegments: r,
      openEnded: a,
      thetaStart: o,
      thetaLength: s
    };
    var c = this;
    t = void 0 !== t ? t : 1, e = void 0 !== e ? e : 1, i = i || 1, n = Math.floor(n) || 8, r = Math.floor(r) || 1, a = void 0 !== a && a, o = void 0 !== o ? o : 0, s = void 0 !== s ? s : 2 * Math.PI;
    var h = [],
      l = [],
      u = [],
      p = [],
      d = 0,
      f = [],
      m = i / 2,
      g = 0;

    function v(i) {
      var r, a, f, v = new U,
        y = new N,
        x = 0,
        b = !0 === i ? t : e,
        _ = !0 === i ? 1 : -1;
      for (a = d, r = 1; r <= n; r++) l.push(0, m * _, 0), u.push(0, _, 0), p.push(.5, .5), d++;
      for (f = d, r = 0; r <= n; r++) {
        var w = r / n * s + o,
          M = Math.cos(w),
          E = Math.sin(w);
        y.x = b * E, y.y = m * _, y.z = b * M, l.push(y.x, y.y, y.z), u.push(0, _, 0), v.x = .5 * M + .5, v.y = .5 * E * _ + .5, p.push(v.x, v.y), d++
      }
      for (r = 0; r < n; r++) {
        var T = a + r,
          S = f + r;
        !0 === i ? h.push(S, S + 1, T) : h.push(S + 1, S, T), x += 3
      }
      c.addGroup(g, x, !0 === i ? 1 : 2), g += x
    }! function() {
      var a, v, y = new N,
        x = new N,
        b = 0,
        _ = (e - t) / i;
      for (v = 0; v <= r; v++) {
        var w = [],
          M = v / r,
          E = M * (e - t) + t;
        for (a = 0; a <= n; a++) {
          var T = a / n,
            S = T * s + o,
            A = Math.sin(S),
            R = Math.cos(S);
          x.x = E * A, x.y = -M * i + m, x.z = E * R, l.push(x.x, x.y, x.z), y.set(A, _, R).normalize(), u.push(y.x, y.y, y.z), p.push(T, 1 - M), w.push(d++)
        }
        f.push(w)
      }
      for (a = 0; a < n; a++)
        for (v = 0; v < r; v++) {
          var L = f[v][a],
            P = f[v + 1][a],
            C = f[v + 1][a + 1],
            I = f[v][a + 1];
          h.push(L, P, I), h.push(P, C, I), b += 6
        }
      c.addGroup(g, b, 0), g += b
    }(), !1 === a && (t > 0 && v(!0), e > 0 && v(!1)), this.setIndex(h), this.addAttribute("position", new Te(l, 3)), this.addAttribute("normal", new Te(u, 3)), this.addAttribute("uv", new Te(p, 2))
  }

  function wn(t, e, i, n, r, a, o) {
    bn.call(this, 0, t, e, i, n, r, a, o), this.type = "ConeGeometry", this.parameters = {
      radius: t,
      height: e,
      radialSegments: i,
      heightSegments: n,
      openEnded: r,
      thetaStart: a,
      thetaLength: o
    }
  }

  function Mn(t, e, i, n, r, a, o) {
    _n.call(this, 0, t, e, i, n, r, a, o), this.type = "ConeBufferGeometry", this.parameters = {
      radius: t,
      height: e,
      radialSegments: i,
      heightSegments: n,
      openEnded: r,
      thetaStart: a,
      thetaLength: o
    }
  }

  function En(t, e, i, n) {
    ge.call(this), this.type = "CircleGeometry", this.parameters = {
      radius: t,
      segments: e,
      thetaStart: i,
      thetaLength: n
    }, this.fromBufferGeometry(new Tn(t, e, i, n)), this.mergeVertices()
  }

  function Tn(t, e, i, n) {
    Be.call(this), this.type = "CircleBufferGeometry", this.parameters = {
      radius: t,
      segments: e,
      thetaStart: i,
      thetaLength: n
    }, t = t || 1, e = void 0 !== e ? Math.max(3, e) : 8, i = void 0 !== i ? i : 0, n = void 0 !== n ? n : 2 * Math.PI;
    var r, a, o = [],
      s = [],
      c = [],
      h = [],
      l = new N,
      u = new U;
    for (s.push(0, 0, 0), c.push(0, 0, 1), h.push(.5, .5), a = 0, r = 3; a <= e; a++, r += 3) {
      var p = i + a / e * n;
      l.x = t * Math.cos(p), l.y = t * Math.sin(p), s.push(l.x, l.y, l.z), c.push(0, 0, 1), u.x = (s[r] / t + 1) / 2, u.y = (s[r + 1] / t + 1) / 2, h.push(u.x, u.y)
    }
    for (r = 1; r <= e; r++) o.push(r, r + 1, 0);
    this.setIndex(o), this.addAttribute("position", new Te(s, 3)), this.addAttribute("normal", new Te(c, 3)), this.addAttribute("uv", new Te(h, 2))
  }
  sn.prototype = Object.create(ge.prototype), sn.prototype.constructor = sn, cn.prototype = Object.create(Be.prototype), cn.prototype.constructor = cn, cn.prototype.getArrays = function() {
    var t = this.getAttribute("position"),
      e = t ? Array.prototype.slice.call(t.array) : [],
      i = this.getAttribute("uv"),
      n = i ? Array.prototype.slice.call(i.array) : [],
      r = this.index;
    return {
      position: e,
      uv: n,
      index: r ? Array.prototype.slice.call(r.array) : []
    }
  }, cn.prototype.addShapeList = function(t, e) {
    var i = t.length;
    e.arrays = this.getArrays();
    for (var n = 0; n < i; n++) {
      var r = t[n];
      this.addShape(r, e)
    }
    this.setIndex(e.arrays.index), this.addAttribute("position", new Te(e.arrays.position, 3)), this.addAttribute("uv", new Te(e.arrays.uv, 2))
  }, cn.prototype.addShape = function(t, e) {
    var i, n, r, a, o, s, c, h, l = e.arrays ? e.arrays : this.getArrays(),
      u = l.position,
      p = l.index,
      d = l.uv,
      f = [],
      m = void 0 !== e.amount ? e.amount : 100,
      g = void 0 !== e.bevelThickness ? e.bevelThickness : 6,
      v = void 0 !== e.bevelSize ? e.bevelSize : g - 2,
      y = void 0 !== e.bevelSegments ? e.bevelSegments : 3,
      x = void 0 === e.bevelEnabled || e.bevelEnabled,
      b = void 0 !== e.curveSegments ? e.curveSegments : 12,
      _ = void 0 !== e.steps ? e.steps : 1,
      w = e.extrudePath,
      M = !1,
      E = void 0 !== e.UVGenerator ? e.UVGenerator : sn.WorldUVGenerator;
    w && (i = w.getSpacedPoints(_), M = !0, x = !1, n = void 0 !== e.frames ? e.frames : w.computeFrenetFrames(_, !1), r = new N, a = new N, o = new N), x || (y = 0, g = 0, v = 0);
    var T = this,
      S = t.extractPoints(b),
      A = S.shape,
      R = S.holes;
    if (!on.isClockWise(A))
      for (A = A.reverse(), c = 0, h = R.length; c < h; c++) s = R[c], on.isClockWise(s) && (R[c] = s.reverse());
    var L = on.triangulateShape(A, R),
      P = A;
    for (c = 0, h = R.length; c < h; c++) s = R[c], A = A.concat(s);

    function C(t, e, i) {
      return e || console.error("THREE.ExtrudeGeometry: vec does not exist"), e.clone().multiplyScalar(i).add(t)
    }
    var I, D, O, B, F, z, G = A.length,
      H = L.length;

    function V(t, e, i) {
      var n, r, a, o = t.x - e.x,
        s = t.y - e.y,
        c = i.x - t.x,
        h = i.y - t.y,
        l = o * o + s * s,
        u = o * h - s * c;
      if (Math.abs(u) > Number.EPSILON) {
        var p = Math.sqrt(l),
          d = Math.sqrt(c * c + h * h),
          f = e.x - s / p,
          m = e.y + o / p,
          g = ((i.x - h / d - f) * h - (i.y + c / d - m) * c) / (o * h - s * c),
          v = (n = f + o * g - t.x) * n + (r = m + s * g - t.y) * r;
        if (v <= 2) return new U(n, r);
        a = Math.sqrt(v / 2)
      } else {
        var y = !1;
        o > Number.EPSILON ? c > Number.EPSILON && (y = !0) : o < -Number.EPSILON ? c < -Number.EPSILON && (y = !0) : Math.sign(s) === Math.sign(h) && (y = !0), y ? (n = -s, r = o, a = Math.sqrt(l)) : (n = o, r = s, a = Math.sqrt(l / 2))
      }
      return new U(n / a, r / a)
    }
    for (var k = [], j = 0, W = P.length, X = W - 1, q = j + 1; j < W; j++, X++, q++) X === W && (X = 0), q === W && (q = 0), k[j] = V(P[j], P[X], P[q]);
    var Y, Z, J = [],
      Q = k.concat();
    for (c = 0, h = R.length; c < h; c++) {
      for (s = R[c], Y = [], j = 0, X = (W = s.length) - 1, q = j + 1; j < W; j++, X++, q++) X === W && (X = 0), q === W && (q = 0), Y[j] = V(s[j], s[X], s[q]);
      J.push(Y), Q = Q.concat(Y)
    }
    for (I = 0; I < y; I++) {
      for (O = I / y, B = g * Math.cos(O * Math.PI / 2), D = v * Math.sin(O * Math.PI / 2), j = 0, W = P.length; j < W; j++) $((F = C(P[j], k[j], D)).x, F.y, -B);
      for (c = 0, h = R.length; c < h; c++)
        for (s = R[c], Y = J[c], j = 0, W = s.length; j < W; j++) $((F = C(s[j], Y[j], D)).x, F.y, -B)
    }
    for (D = v, j = 0; j < G; j++) F = x ? C(A[j], Q[j], D) : A[j], M ? (a.copy(n.normals[0]).multiplyScalar(F.x), r.copy(n.binormals[0]).multiplyScalar(F.y), o.copy(i[0]).add(a).add(r), $(o.x, o.y, o.z)) : $(F.x, F.y, 0);
    for (Z = 1; Z <= _; Z++)
      for (j = 0; j < G; j++) F = x ? C(A[j], Q[j], D) : A[j], M ? (a.copy(n.normals[Z]).multiplyScalar(F.x), r.copy(n.binormals[Z]).multiplyScalar(F.y), o.copy(i[Z]).add(a).add(r), $(o.x, o.y, o.z)) : $(F.x, F.y, m / _ * Z);
    for (I = y - 1; I >= 0; I--) {
      for (O = I / y, B = g * Math.cos(O * Math.PI / 2), D = v * Math.sin(O * Math.PI / 2), j = 0, W = P.length; j < W; j++) $((F = C(P[j], k[j], D)).x, F.y, m + B);
      for (c = 0, h = R.length; c < h; c++)
        for (s = R[c], Y = J[c], j = 0, W = s.length; j < W; j++) F = C(s[j], Y[j], D), M ? $(F.x, F.y + i[_ - 1].y, i[_ - 1].x + B) : $(F.x, F.y, m + B)
    }

    function K(t, e) {
      var i, n;
      for (j = t.length; --j >= 0;) {
        i = j, (n = j - 1) < 0 && (n = t.length - 1);
        var r = 0,
          a = _ + 2 * y;
        for (r = 0; r < a; r++) {
          var o = G * r,
            s = G * (r + 1);
          et(e + i + o, e + n + o, e + n + s, e + i + s)
        }
      }
    }

    function $(t, e, i) {
      f.push(t), f.push(e), f.push(i)
    }

    function tt(t, e, i) {
      it(t), it(e), it(i);
      var n = u.length / 3,
        r = E.generateTopUV(T, u, n - 3, n - 2, n - 1);
      nt(r[0]), nt(r[1]), nt(r[2])
    }

    function et(t, e, i, n) {
      it(t), it(e), it(n), it(e), it(i), it(n);
      var r = u.length / 3,
        a = E.generateSideWallUV(T, u, r - 6, r - 3, r - 2, r - 1);
      nt(a[0]), nt(a[1]), nt(a[3]), nt(a[1]), nt(a[2]), nt(a[3])
    }

    function it(t) {
      p.push(u.length / 3), u.push(f[3 * t + 0]), u.push(f[3 * t + 1]), u.push(f[3 * t + 2])
    }

    function nt(t) {
      d.push(t.x), d.push(t.y)
    }! function() {
      var t = u.length / 3;
      if (x) {
        var i = 0,
          n = G * i;
        for (j = 0; j < H; j++) tt((z = L[j])[2] + n, z[1] + n, z[0] + n);
        for (n = G * (i = _ + 2 * y), j = 0; j < H; j++) tt((z = L[j])[0] + n, z[1] + n, z[2] + n)
      } else {
        for (j = 0; j < H; j++) tt((z = L[j])[2], z[1], z[0]);
        for (j = 0; j < H; j++) tt((z = L[j])[0] + G * _, z[1] + G * _, z[2] + G * _)
      }
      T.addGroup(t, u.length / 3 - t, void 0 !== e.material ? e.material : 0)
    }(),
    function() {
      var t = u.length / 3,
        i = 0;
      for (K(P, i), i += P.length, c = 0, h = R.length; c < h; c++) K(s = R[c], i), i += s.length;
      T.addGroup(t, u.length / 3 - t, void 0 !== e.extrudeMaterial ? e.extrudeMaterial : 1)
    }(), e.arrays || (this.setIndex(p), this.addAttribute("position", new Te(u, 3)), this.addAttribute("uv", new Te(e.arrays.uv, 2)))
  }, sn.WorldUVGenerator = {
    generateTopUV: function(t, e, i, n, r) {
      var a = e[3 * i],
        o = e[3 * i + 1],
        s = e[3 * n],
        c = e[3 * n + 1],
        h = e[3 * r],
        l = e[3 * r + 1];
      return [new U(a, o), new U(s, c), new U(h, l)]
    },
    generateSideWallUV: function(t, e, i, n, r, a) {
      var o = e[3 * i],
        s = e[3 * i + 1],
        c = e[3 * i + 2],
        h = e[3 * n],
        l = e[3 * n + 1],
        u = e[3 * n + 2],
        p = e[3 * r],
        d = e[3 * r + 1],
        f = e[3 * r + 2],
        m = e[3 * a],
        g = e[3 * a + 1],
        v = e[3 * a + 2];
      return Math.abs(s - l) < .01 ? [new U(o, 1 - c), new U(h, 1 - u), new U(p, 1 - f), new U(m, 1 - v)] : [new U(s, 1 - c), new U(l, 1 - u), new U(d, 1 - f), new U(g, 1 - v)]
    }
  }, hn.prototype = Object.create(ge.prototype), hn.prototype.constructor = hn, ln.prototype = Object.create(cn.prototype), ln.prototype.constructor = ln, un.prototype = Object.create(ge.prototype), un.prototype.constructor = un, pn.prototype = Object.create(Be.prototype), pn.prototype.constructor = pn, dn.prototype = Object.create(ge.prototype), dn.prototype.constructor = dn, fn.prototype = Object.create(Be.prototype), fn.prototype.constructor = fn, mn.prototype = Object.create(ge.prototype), mn.prototype.constructor = mn, gn.prototype = Object.create(Be.prototype), gn.prototype.constructor = gn, vn.prototype = Object.create(ge.prototype), vn.prototype.constructor = vn, yn.prototype = Object.create(Be.prototype), yn.prototype.constructor = yn, xn.prototype = Object.create(Be.prototype), xn.prototype.constructor = xn, bn.prototype = Object.create(ge.prototype), bn.prototype.constructor = bn, _n.prototype = Object.create(Be.prototype), _n.prototype.constructor = _n, wn.prototype = Object.create(bn.prototype), wn.prototype.constructor = wn, Mn.prototype = Object.create(_n.prototype), Mn.prototype.constructor = Mn, En.prototype = Object.create(ge.prototype), En.prototype.constructor = En, Tn.prototype = Object.create(Be.prototype), Tn.prototype.constructor = Tn;
  var Sn = Object.freeze({
    WireframeGeometry: Gi,
    ParametricGeometry: Hi,
    ParametricBufferGeometry: Vi,
    TetrahedronGeometry: Wi,
    TetrahedronBufferGeometry: Xi,
    OctahedronGeometry: qi,
    OctahedronBufferGeometry: Yi,
    IcosahedronGeometry: Zi,
    IcosahedronBufferGeometry: Ji,
    DodecahedronGeometry: Qi,
    DodecahedronBufferGeometry: Ki,
    PolyhedronGeometry: ki,
    PolyhedronBufferGeometry: ji,
    TubeGeometry: $i,
    TubeBufferGeometry: tn,
    TorusKnotGeometry: en,
    TorusKnotBufferGeometry: nn,
    TorusGeometry: rn,
    TorusBufferGeometry: an,
    TextGeometry: hn,
    TextBufferGeometry: ln,
    SphereGeometry: un,
    SphereBufferGeometry: pn,
    RingGeometry: dn,
    RingBufferGeometry: fn,
    PlaneGeometry: Ge,
    PlaneBufferGeometry: He,
    LatheGeometry: mn,
    LatheBufferGeometry: gn,
    ShapeGeometry: vn,
    ShapeBufferGeometry: yn,
    ExtrudeGeometry: sn,
    ExtrudeBufferGeometry: cn,
    EdgesGeometry: xn,
    ConeGeometry: wn,
    ConeBufferGeometry: Mn,
    CylinderGeometry: bn,
    CylinderBufferGeometry: _n,
    CircleGeometry: En,
    CircleBufferGeometry: Tn,
    BoxGeometry: Fe,
    BoxBufferGeometry: ze
  });

  function An(t) {
    Yt.call(this), this.type = "ShadowMaterial", this.color = new Ct(0), this.opacity = 1, this.lights = !0, this.transparent = !0, this.setValues(t)
  }

  function Rn(t) {
    ke.call(this, t), this.type = "RawShaderMaterial"
  }

  function Ln(t) {
    Yt.call(this), this.defines = {
      STANDARD: ""
    }, this.type = "MeshStandardMaterial", this.color = new Ct(16777215), this.roughness = .5, this.metalness = .5, this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new Ct(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalScale = new U(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.roughnessMap = null, this.metalnessMap = null, this.alphaMap = null, this.envMap = null, this.envMapIntensity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(t)
  }

  function Pn(t) {
    Ln.call(this), this.defines = {
      PHYSICAL: ""
    }, this.type = "MeshPhysicalMaterial", this.reflectivity = .5, this.clearCoat = 0, this.clearCoatRoughness = 0, this.setValues(t)
  }

  function Cn(t) {
    Yt.call(this), this.type = "MeshPhongMaterial", this.color = new Ct(16777215), this.specular = new Ct(1118481), this.shininess = 30, this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new Ct(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalScale = new U(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = 0, this.reflectivity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(t)
  }

  function In(t) {
    Cn.call(this), this.defines = {
      TOON: ""
    }, this.type = "MeshToonMaterial", this.gradientMap = null, this.setValues(t)
  }

  function Un(t) {
    Yt.call(this), this.type = "MeshNormalMaterial", this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalScale = new U(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(t)
  }

  function Dn(t) {
    Yt.call(this), this.type = "MeshLambertMaterial", this.color = new Ct(16777215), this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new Ct(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = 0, this.reflectivity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(t)
  }

  function On(t) {
    Pi.call(this), this.type = "LineDashedMaterial", this.scale = 1, this.dashSize = 3, this.gapSize = 1, this.setValues(t)
  }
  An.prototype = Object.create(Yt.prototype), An.prototype.constructor = An, An.prototype.isShadowMaterial = !0, Rn.prototype = Object.create(ke.prototype), Rn.prototype.constructor = Rn, Rn.prototype.isRawShaderMaterial = !0, Ln.prototype = Object.create(Yt.prototype), Ln.prototype.constructor = Ln, Ln.prototype.isMeshStandardMaterial = !0, Ln.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.defines = {
      STANDARD: ""
    }, this.color.copy(t.color), this.roughness = t.roughness, this.metalness = t.metalness, this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.emissive.copy(t.emissive), this.emissiveMap = t.emissiveMap, this.emissiveIntensity = t.emissiveIntensity, this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.roughnessMap = t.roughnessMap, this.metalnessMap = t.metalnessMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.envMapIntensity = t.envMapIntensity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this.morphNormals = t.morphNormals, this
  }, Pn.prototype = Object.create(Ln.prototype), Pn.prototype.constructor = Pn, Pn.prototype.isMeshPhysicalMaterial = !0, Pn.prototype.copy = function(t) {
    return Ln.prototype.copy.call(this, t), this.defines = {
      PHYSICAL: ""
    }, this.reflectivity = t.reflectivity, this.clearCoat = t.clearCoat, this.clearCoatRoughness = t.clearCoatRoughness, this
  }, Cn.prototype = Object.create(Yt.prototype), Cn.prototype.constructor = Cn, Cn.prototype.isMeshPhongMaterial = !0, Cn.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.color.copy(t.color), this.specular.copy(t.specular), this.shininess = t.shininess, this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.emissive.copy(t.emissive), this.emissiveMap = t.emissiveMap, this.emissiveIntensity = t.emissiveIntensity, this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.specularMap = t.specularMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.combine = t.combine, this.reflectivity = t.reflectivity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this.morphNormals = t.morphNormals, this
  }, In.prototype = Object.create(Cn.prototype), In.prototype.constructor = In, In.prototype.isMeshToonMaterial = !0, In.prototype.copy = function(t) {
    return Cn.prototype.copy.call(this, t), this.gradientMap = t.gradientMap, this
  }, Un.prototype = Object.create(Yt.prototype), Un.prototype.constructor = Un, Un.prototype.isMeshNormalMaterial = !0, Un.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this.morphNormals = t.morphNormals, this
  }, Dn.prototype = Object.create(Yt.prototype), Dn.prototype.constructor = Dn, Dn.prototype.isMeshLambertMaterial = !0, Dn.prototype.copy = function(t) {
    return Yt.prototype.copy.call(this, t), this.color.copy(t.color), this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.emissive.copy(t.emissive), this.emissiveMap = t.emissiveMap, this.emissiveIntensity = t.emissiveIntensity, this.specularMap = t.specularMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.combine = t.combine, this.reflectivity = t.reflectivity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this.skinning = t.skinning, this.morphTargets = t.morphTargets, this.morphNormals = t.morphNormals, this
  }, On.prototype = Object.create(Pi.prototype), On.prototype.constructor = On, On.prototype.isLineDashedMaterial = !0, On.prototype.copy = function(t) {
    return Pi.prototype.copy.call(this, t), this.scale = t.scale, this.dashSize = t.dashSize, this.gapSize = t.gapSize, this
  };
  var Nn = Object.freeze({
      ShadowMaterial: An,
      SpriteMaterial: Ei,
      RawShaderMaterial: Rn,
      ShaderMaterial: ke,
      PointsMaterial: Di,
      MeshPhysicalMaterial: Pn,
      MeshStandardMaterial: Ln,
      MeshPhongMaterial: Cn,
      MeshToonMaterial: In,
      MeshNormalMaterial: Un,
      MeshLambertMaterial: Dn,
      MeshDepthMaterial: Zt,
      MeshDistanceMaterial: Jt,
      MeshBasicMaterial: Ve,
      LineDashedMaterial: On,
      LineBasicMaterial: Pi,
      Material: Yt
    }),
    Bn = {
      enabled: !1,
      files: {},
      add: function(t, e) {
        !1 !== this.enabled && (this.files[t] = e)
      },
      get: function(t) {
        if (!1 !== this.enabled) return this.files[t]
      },
      remove: function(t) {
        delete this.files[t]
      },
      clear: function() {
        this.files = {}
      }
    };

  function Fn(t, e, i) {
    var n = this,
      r = !1,
      a = 0,
      o = 0;
    this.onStart = void 0, this.onLoad = t, this.onProgress = e, this.onError = i, this.itemStart = function(t) {
      o++, !1 === r && void 0 !== n.onStart && n.onStart(t, a, o), r = !0
    }, this.itemEnd = function(t) {
      a++, void 0 !== n.onProgress && n.onProgress(t, a, o), a === o && (r = !1, void 0 !== n.onLoad && n.onLoad())
    }, this.itemError = function(t) {
      void 0 !== n.onError && n.onError(t)
    }
  }
  var zn = new Fn,
    Gn = {};

  function Hn(t) {
    this.manager = void 0 !== t ? t : zn
  }

  function Vn(t) {
    this.manager = void 0 !== t ? t : zn, this._parser = null
  }

  function kn(t) {
    this.manager = void 0 !== t ? t : zn, this._parser = null
  }

  function jn(t) {
    this.manager = void 0 !== t ? t : zn
  }

  function Wn(t) {
    this.manager = void 0 !== t ? t : zn
  }

  function Xn(t) {
    this.manager = void 0 !== t ? t : zn
  }

  function qn(t, e) {
    le.call(this), this.type = "Light", this.color = new Ct(t), this.intensity = void 0 !== e ? e : 1, this.receiveShadow = void 0
  }

  function Yn(t, e, i) {
    qn.call(this, t, i), this.type = "HemisphereLight", this.castShadow = void 0, this.position.copy(le.DefaultUp), this.updateMatrix(), this.groundColor = new Ct(e)
  }

  function Zn(t) {
    this.camera = t, this.bias = 0, this.radius = 1, this.mapSize = new U(512, 512), this.map = null, this.matrix = new D
  }

  function Jn() {
    Zn.call(this, new gi(50, 1, .5, 500))
  }

  function Qn(t, e, i, n, r, a) {
    qn.call(this, t, e), this.type = "SpotLight", this.position.copy(le.DefaultUp), this.updateMatrix(), this.target = new le, Object.defineProperty(this, "power", {
      get: function() {
        return this.intensity * Math.PI
      },
      set: function(t) {
        this.intensity = t / Math.PI
      }
    }), this.distance = void 0 !== i ? i : 0, this.angle = void 0 !== n ? n : Math.PI / 3, this.penumbra = void 0 !== r ? r : 0, this.decay = void 0 !== a ? a : 1, this.shadow = new Jn
  }

  function Kn(t, e, i, n) {
    qn.call(this, t, e), this.type = "PointLight", Object.defineProperty(this, "power", {
      get: function() {
        return 4 * this.intensity * Math.PI
      },
      set: function(t) {
        this.intensity = t / (4 * Math.PI)
      }
    }), this.distance = void 0 !== i ? i : 0, this.decay = void 0 !== n ? n : 1, this.shadow = new Zn(new gi(90, 1, .5, 500))
  }

  function $n() {
    Zn.call(this, new pe(-5, 5, 5, -5, .5, 500))
  }

  function tr(t, e) {
    qn.call(this, t, e), this.type = "DirectionalLight", this.position.copy(le.DefaultUp), this.updateMatrix(), this.target = new le, this.shadow = new $n
  }

  function er(t, e) {
    qn.call(this, t, e), this.type = "AmbientLight", this.castShadow = void 0
  }

  function ir(t, e, i, n) {
    qn.call(this, t, e), this.type = "RectAreaLight", this.position.set(0, 1, 0), this.updateMatrix(), this.width = void 0 !== i ? i : 10, this.height = void 0 !== n ? n : 10
  }
  Object.assign(Hn.prototype, {
    load: function(t, e, i, n) {
      void 0 === t && (t = ""), void 0 !== this.path && (t = this.path + t);
      var r = this,
        a = Bn.get(t);
      if (void 0 !== a) return r.manager.itemStart(t), setTimeout((function() {
        e && e(a), r.manager.itemEnd(t)
      }), 0), a;
      if (void 0 === Gn[t]) {
        var o = t.match(/^data:(.*?)(;base64)?,(.*)$/);
        if (o) {
          var s = o[1],
            c = !!o[2],
            h = o[3];
          h = window.decodeURIComponent(h), c && (h = window.atob(h));
          try {
            var l, u = (this.responseType || "").toLowerCase();
            switch (u) {
              case "arraybuffer":
              case "blob":
                for (var p = new Uint8Array(h.length), d = 0; d < h.length; d++) p[d] = h.charCodeAt(d);
                l = "blob" === u ? new Blob([p.buffer], {
                  type: s
                }) : p.buffer;
                break;
              case "document":
                var f = new DOMParser;
                l = f.parseFromString(h, s);
                break;
              case "json":
                l = JSON.parse(h);
                break;
              default:
                l = h
            }
            window.setTimeout((function() {
              e && e(l), r.manager.itemEnd(t)
            }), 0)
          } catch (e) {
            window.setTimeout((function() {
              n && n(e), r.manager.itemEnd(t), r.manager.itemError(t)
            }), 0)
          }
        } else {
          Gn[t] = [], Gn[t].push({
            onLoad: e,
            onProgress: i,
            onError: n
          });
          var m = new XMLHttpRequest;
          for (var g in m.open("GET", t, !0), m.addEventListener("load", (function(e) {
              var i = e.target.response;
              Bn.add(t, i);
              var n = Gn[t];
              if (delete Gn[t], 200 === this.status) {
                for (var a = 0, o = n.length; a < o; a++)(s = n[a]).onLoad && s.onLoad(i);
                r.manager.itemEnd(t)
              } else if (0 === this.status) {
                for (console.warn("THREE.FileLoader: HTTP Status 0 received."), a = 0, o = n.length; a < o; a++)(s = n[a]).onLoad && s.onLoad(i);
                r.manager.itemEnd(t)
              } else {
                for (a = 0, o = n.length; a < o; a++) {
                  var s;
                  (s = n[a]).onError && s.onError(e)
                }
                r.manager.itemEnd(t), r.manager.itemError(t)
              }
            }), !1), m.addEventListener("progress", (function(e) {
              for (var i = Gn[t], n = 0, r = i.length; n < r; n++) {
                var a = i[n];
                a.onProgress && a.onProgress(e)
              }
            }), !1), m.addEventListener("error", (function(e) {
              for (var i = Gn[t], n = 0, a = i.length; n < a; n++) {
                var o = i[n];
                o.onError && o.onError(e)
              }
              r.manager.itemEnd(t), r.manager.itemError(t)
            }), !1), void 0 !== this.responseType && (m.responseType = this.responseType), void 0 !== this.withCredentials && (m.withCredentials = this.withCredentials), m.overrideMimeType && m.overrideMimeType(void 0 !== this.mimeType ? this.mimeType : "text/plain"), this.requestHeader) m.setRequestHeader(g, this.requestHeader[g]);
          m.send(null)
        }
        return r.manager.itemStart(t), m
      }
      Gn[t].push({
        onLoad: e,
        onProgress: i,
        onError: n
      })
    },
    setPath: function(t) {
      return this.path = t, this
    },
    setResponseType: function(t) {
      return this.responseType = t, this
    },
    setWithCredentials: function(t) {
      return this.withCredentials = t, this
    },
    setMimeType: function(t) {
      return this.mimeType = t, this
    },
    setRequestHeader: function(t) {
      return this.requestHeader = t, this
    }
  }), Object.assign(Vn.prototype, {
    load: function(t, e, i, n) {
      var r = this,
        a = [],
        o = new Fi;
      o.image = a;
      var s = new Hn(this.manager);

      function c(c) {
        s.load(t[c], (function(t) {
          var i = r._parser(t, !0);
          a[c] = {
            width: i.width,
            height: i.height,
            format: i.format,
            mipmaps: i.mipmaps
          }, 6 === (h += 1) && (1 === i.mipmapCount && (o.minFilter = _), o.format = i.format, o.needsUpdate = !0, e && e(o))
        }), i, n)
      }
      if (s.setPath(this.path), s.setResponseType("arraybuffer"), Array.isArray(t))
        for (var h = 0, l = 0, u = t.length; l < u; ++l) c(l);
      else s.load(t, (function(t) {
        var i = r._parser(t, !0);
        if (i.isCubemap)
          for (var n = i.mipmaps.length / i.mipmapCount, s = 0; s < n; s++) {
            a[s] = {
              mipmaps: []
            };
            for (var c = 0; c < i.mipmapCount; c++) a[s].mipmaps.push(i.mipmaps[s * i.mipmapCount + c]), a[s].format = i.format, a[s].width = i.width, a[s].height = i.height
          } else o.image.width = i.width, o.image.height = i.height, o.mipmaps = i.mipmaps;
        1 === i.mipmapCount && (o.minFilter = _), o.format = i.format, o.needsUpdate = !0, e && e(o)
      }), i, n);
      return o
    },
    setPath: function(t) {
      return this.path = t, this
    }
  }), Object.assign(kn.prototype, {
    load: function(t, e, i, n) {
      var r = this,
        a = new k,
        o = new Hn(this.manager);
      return o.setResponseType("arraybuffer"), o.load(t, (function(t) {
        var i = r._parser(t);
        i && (void 0 !== i.image ? a.image = i.image : void 0 !== i.data && (a.image.width = i.width, a.image.height = i.height, a.image.data = i.data), a.wrapS = void 0 !== i.wrapS ? i.wrapS : y, a.wrapT = void 0 !== i.wrapT ? i.wrapT : y, a.magFilter = void 0 !== i.magFilter ? i.magFilter : _, a.minFilter = void 0 !== i.minFilter ? i.minFilter : w, a.anisotropy = void 0 !== i.anisotropy ? i.anisotropy : 1, void 0 !== i.format && (a.format = i.format), void 0 !== i.type && (a.type = i.type), void 0 !== i.mipmaps && (a.mipmaps = i.mipmaps), 1 === i.mipmapCount && (a.minFilter = _), a.needsUpdate = !0, e && e(a, i))
      }), i, n), a
    }
  }), Object.assign(jn.prototype, {
    crossOrigin: "Anonymous",
    load: function(t, e, i, n) {
      void 0 === t && (t = ""), void 0 !== this.path && (t = this.path + t);
      var r = this,
        a = Bn.get(t);
      if (void 0 !== a) return r.manager.itemStart(t), setTimeout((function() {
        e && e(a), r.manager.itemEnd(t)
      }), 0), a;
      var o = document.createElement("img");
      return o.addEventListener("load", (function() {
        Bn.add(t, this), e && e(this), r.manager.itemEnd(t)
      }), !1), o.addEventListener("error", (function(e) {
        n && n(e), r.manager.itemEnd(t), r.manager.itemError(t)
      }), !1), "data:" !== t.substr(0, 5) && void 0 !== this.crossOrigin && (o.crossOrigin = this.crossOrigin), r.manager.itemStart(t), o.src = t, o
    },
    setCrossOrigin: function(t) {
      return this.crossOrigin = t, this
    },
    setPath: function(t) {
      return this.path = t, this
    }
  }), Object.assign(Wn.prototype, {
    crossOrigin: "Anonymous",
    load: function(t, e, i, n) {
      var r = new j,
        a = new jn(this.manager);
      a.setCrossOrigin(this.crossOrigin), a.setPath(this.path);
      var o = 0;

      function s(i) {
        a.load(t[i], (function(t) {
          r.images[i] = t, 6 == ++o && (r.needsUpdate = !0, e && e(r))
        }), void 0, n)
      }
      for (var c = 0; c < t.length; ++c) s(c);
      return r
    },
    setCrossOrigin: function(t) {
      return this.crossOrigin = t, this
    },
    setPath: function(t) {
      return this.path = t, this
    }
  }), Object.assign(Xn.prototype, {
    crossOrigin: "Anonymous",
    load: function(t, e, i, n) {
      var r = new jn(this.manager);
      r.setCrossOrigin(this.crossOrigin), r.setPath(this.path);
      var a = new z;
      return a.image = r.load(t, (function() {
        var i = t.search(/\.(jpg|jpeg)$/) > 0 || 0 === t.search(/^data\:image\/jpeg/);
        a.format = i ? S : A, a.needsUpdate = !0, void 0 !== e && e(a)
      }), i, n), a
    },
    setCrossOrigin: function(t) {
      return this.crossOrigin = t, this
    },
    setPath: function(t) {
      return this.path = t, this
    }
  }), qn.prototype = Object.assign(Object.create(le.prototype), {
    constructor: qn,
    isLight: !0,
    copy: function(t) {
      return le.prototype.copy.call(this, t), this.color.copy(t.color), this.intensity = t.intensity, this
    },
    toJSON: function(t) {
      var e = le.prototype.toJSON.call(this, t);
      return e.object.color = this.color.getHex(), e.object.intensity = this.intensity, void 0 !== this.groundColor && (e.object.groundColor = this.groundColor.getHex()), void 0 !== this.distance && (e.object.distance = this.distance), void 0 !== this.angle && (e.object.angle = this.angle), void 0 !== this.decay && (e.object.decay = this.decay), void 0 !== this.penumbra && (e.object.penumbra = this.penumbra), void 0 !== this.shadow && (e.object.shadow = this.shadow.toJSON()), e
    }
  }), Yn.prototype = Object.assign(Object.create(qn.prototype), {
    constructor: Yn,
    isHemisphereLight: !0,
    copy: function(t) {
      return qn.prototype.copy.call(this, t), this.groundColor.copy(t.groundColor), this
    }
  }), Object.assign(Zn.prototype, {
    copy: function(t) {
      return this.camera = t.camera.clone(), this.bias = t.bias, this.radius = t.radius, this.mapSize.copy(t.mapSize), this
    },
    clone: function() {
      return (new this.constructor).copy(this)
    },
    toJSON: function() {
      var t = {};
      return 0 !== this.bias && (t.bias = this.bias), 1 !== this.radius && (t.radius = this.radius), 512 === this.mapSize.x && 512 === this.mapSize.y || (t.mapSize = this.mapSize.toArray()), t.camera = this.camera.toJSON(!1).object, delete t.camera.matrix, t
    }
  }), Jn.prototype = Object.assign(Object.create(Zn.prototype), {
    constructor: Jn,
    isSpotLightShadow: !0,
    update: function(t) {
      var e = this.camera,
        i = 2 * I.RAD2DEG * t.angle,
        n = this.mapSize.width / this.mapSize.height,
        r = t.distance || e.far;
      i === e.fov && n === e.aspect && r === e.far || (e.fov = i, e.aspect = n, e.far = r, e.updateProjectionMatrix())
    }
  }), Qn.prototype = Object.assign(Object.create(qn.prototype), {
    constructor: Qn,
    isSpotLight: !0,
    copy: function(t) {
      return qn.prototype.copy.call(this, t), this.distance = t.distance, this.angle = t.angle, this.penumbra = t.penumbra, this.decay = t.decay, this.target = t.target.clone(), this.shadow = t.shadow.clone(), this
    }
  }), Kn.prototype = Object.assign(Object.create(qn.prototype), {
    constructor: Kn,
    isPointLight: !0,
    copy: function(t) {
      return qn.prototype.copy.call(this, t), this.distance = t.distance, this.decay = t.decay, this.shadow = t.shadow.clone(), this
    }
  }), $n.prototype = Object.assign(Object.create(Zn.prototype), {
    constructor: $n
  }), tr.prototype = Object.assign(Object.create(qn.prototype), {
    constructor: tr,
    isDirectionalLight: !0,
    copy: function(t) {
      return qn.prototype.copy.call(this, t), this.target = t.target.clone(), this.shadow = t.shadow.clone(), this
    }
  }), er.prototype = Object.assign(Object.create(qn.prototype), {
    constructor: er,
    isAmbientLight: !0
  }), ir.prototype = Object.assign(Object.create(qn.prototype), {
    constructor: ir,
    isRectAreaLight: !0,
    copy: function(t) {
      return qn.prototype.copy.call(this, t), this.width = t.width, this.height = t.height, this
    },
    toJSON: function(t) {
      var e = qn.prototype.toJSON.call(this, t);
      return e.object.width = this.width, e.object.height = this.height, e
    }
  });
  var nr, rr = {
    arraySlice: function(t, e, i) {
      return rr.isTypedArray(t) ? new t.constructor(t.subarray(e, void 0 !== i ? i : t.length)) : t.slice(e, i)
    },
    convertArray: function(t, e, i) {
      return !t || !i && t.constructor === e ? t : "number" == typeof e.BYTES_PER_ELEMENT ? new e(t) : Array.prototype.slice.call(t)
    },
    isTypedArray: function(t) {
      return ArrayBuffer.isView(t) && !(t instanceof DataView)
    },
    getKeyframeOrder: function(t) {
      for (var e = t.length, i = new Array(e), n = 0; n !== e; ++n) i[n] = n;
      return i.sort((function(e, i) {
        return t[e] - t[i]
      })), i
    },
    sortedArray: function(t, e, i) {
      for (var n = t.length, r = new t.constructor(n), a = 0, o = 0; o !== n; ++a)
        for (var s = i[a] * e, c = 0; c !== e; ++c) r[o++] = t[s + c];
      return r
    },
    flattenJSON: function(t, e, i, n) {
      for (var r = 1, a = t[0]; void 0 !== a && void 0 === a[n];) a = t[r++];
      if (void 0 !== a) {
        var o = a[n];
        if (void 0 !== o)
          if (Array.isArray(o))
            do {
              void 0 !== (o = a[n]) && (e.push(a.time), i.push.apply(i, o)), a = t[r++]
            } while (void 0 !== a);
          else if (void 0 !== o.toArray)
          do {
            void 0 !== (o = a[n]) && (e.push(a.time), o.toArray(i, i.length)), a = t[r++]
          } while (void 0 !== a);
        else
          do {
            void 0 !== (o = a[n]) && (e.push(a.time), i.push(o)), a = t[r++]
          } while (void 0 !== a)
      }
    }
  };

  function ar(t, e, i, n) {
    this.parameterPositions = t, this._cachedIndex = 0, this.resultBuffer = void 0 !== n ? n : new e.constructor(i), this.sampleValues = e, this.valueSize = i
  }

  function or(t, e, i, n) {
    ar.call(this, t, e, i, n), this._weightPrev = -0, this._offsetPrev = -0, this._weightNext = -0, this._offsetNext = -0
  }

  function sr(t, e, i, n) {
    ar.call(this, t, e, i, n)
  }

  function cr(t, e, i, n) {
    ar.call(this, t, e, i, n)
  }

  function hr(t, e, i, n) {
    if (void 0 === t) throw new Error("track name is undefined");
    if (void 0 === e || 0 === e.length) throw new Error("no keyframes in track named " + t);
    this.name = t, this.times = rr.convertArray(e, this.TimeBufferType), this.values = rr.convertArray(i, this.ValueBufferType), this.setInterpolation(n || this.DefaultInterpolation), this.validate(), this.optimize()
  }

  function lr(t, e, i, n) {
    hr.call(this, t, e, i, n)
  }

  function ur(t, e, i, n) {
    ar.call(this, t, e, i, n)
  }

  function pr(t, e, i, n) {
    hr.call(this, t, e, i, n)
  }

  function dr(t, e, i, n) {
    hr.call(this, t, e, i, n)
  }

  function fr(t, e, i, n) {
    hr.call(this, t, e, i, n)
  }

  function mr(t, e, i) {
    hr.call(this, t, e, i)
  }

  function gr(t, e, i, n) {
    hr.call(this, t, e, i, n)
  }

  function vr(t, e, i, n) {
    hr.apply(this, t, e, i, n)
  }

  function yr(t, e, i) {
    this.name = t, this.tracks = i, this.duration = void 0 !== e ? e : -1, this.uuid = I.generateUUID(), this.duration < 0 && this.resetDuration(), this.optimize()
  }

  function xr(t) {
    this.manager = void 0 !== t ? t : zn, this.textures = {}
  }

  function br(t) {
    this.manager = void 0 !== t ? t : zn
  }
  Object.assign(ar.prototype, {
      evaluate: function(t) {
        var e = this.parameterPositions,
          i = this._cachedIndex,
          n = e[i],
          r = e[i - 1];
        t: {
          e: {
            var a;i: {
              n: if (!(t < n)) {
                for (var o = i + 2;;) {
                  if (void 0 === n) {
                    if (t < r) break n;
                    return i = e.length, this._cachedIndex = i, this.afterEnd_(i - 1, t, r)
                  }
                  if (i === o) break;
                  if (r = n, t < (n = e[++i])) break e
                }
                a = e.length;
                break i
              }if (t >= r) break t;
              var s = e[1];
              for (t < s && (i = 2, r = s), o = i - 2;;) {
                if (void 0 === r) return this._cachedIndex = 0, this.beforeStart_(0, t, n);
                if (i === o) break;
                if (n = r, t >= (r = e[--i - 1])) break e
              }
              a = i,
              i = 0
            }
            for (; i < a;) {
              var c = i + a >>> 1;
              t < e[c] ? a = c : i = c + 1
            }
            if (n = e[i], void 0 === (r = e[i - 1])) return this._cachedIndex = 0,
            this.beforeStart_(0, t, n);
            if (void 0 === n) return i = e.length,
            this._cachedIndex = i,
            this.afterEnd_(i - 1, r, t)
          }
          this._cachedIndex = i,
          this.intervalChanged_(i, r, n)
        }
        return this.interpolate_(i, r, t, n)
      },
      settings: null,
      DefaultSettings_: {},
      getSettings_: function() {
        return this.settings || this.DefaultSettings_
      },
      copySampleValue_: function(t) {
        for (var e = this.resultBuffer, i = this.sampleValues, n = this.valueSize, r = t * n, a = 0; a !== n; ++a) e[a] = i[r + a];
        return e
      },
      interpolate_: function() {
        throw new Error("call to abstract method")
      },
      intervalChanged_: function() {}
    }), //!\ DECLARE ALIAS AFTER assign prototype !
    Object.assign(ar.prototype, {
      beforeStart_: ar.prototype.copySampleValue_,
      afterEnd_: ar.prototype.copySampleValue_
    }), or.prototype = Object.assign(Object.create(ar.prototype), {
      constructor: or,
      DefaultSettings_: {
        endingStart: P,
        endingEnd: P
      },
      intervalChanged_: function(t, e, i) {
        var n = this.parameterPositions,
          r = t - 2,
          a = t + 1,
          o = n[r],
          s = n[a];
        if (void 0 === o) switch (this.getSettings_().endingStart) {
          case 2401:
            r = t, o = 2 * e - i;
            break;
          case 2402:
            o = e + n[r = n.length - 2] - n[r + 1];
            break;
          default:
            r = t, o = i
        }
        if (void 0 === s) switch (this.getSettings_().endingEnd) {
          case 2401:
            a = t, s = 2 * i - e;
            break;
          case 2402:
            a = 1, s = i + n[1] - n[0];
            break;
          default:
            a = t - 1, s = e
        }
        var c = .5 * (i - e),
          h = this.valueSize;
        this._weightPrev = c / (e - o), this._weightNext = c / (s - i), this._offsetPrev = r * h, this._offsetNext = a * h
      },
      interpolate_: function(t, e, i, n) {
        for (var r = this.resultBuffer, a = this.sampleValues, o = this.valueSize, s = t * o, c = s - o, h = this._offsetPrev, l = this._offsetNext, u = this._weightPrev, p = this._weightNext, d = (i - e) / (n - e), f = d * d, m = f * d, g = -u * m + 2 * u * f - u * d, v = (1 + u) * m + (-1.5 - 2 * u) * f + (-.5 + u) * d + 1, y = (-1 - p) * m + (1.5 + p) * f + .5 * d, x = p * m - p * f, b = 0; b !== o; ++b) r[b] = g * a[h + b] + v * a[c + b] + y * a[s + b] + x * a[l + b];
        return r
      }
    }), sr.prototype = Object.assign(Object.create(ar.prototype), {
      constructor: sr,
      interpolate_: function(t, e, i, n) {
        for (var r = this.resultBuffer, a = this.sampleValues, o = this.valueSize, s = t * o, c = s - o, h = (i - e) / (n - e), l = 1 - h, u = 0; u !== o; ++u) r[u] = a[c + u] * l + a[s + u] * h;
        return r
      }
    }), cr.prototype = Object.assign(Object.create(ar.prototype), {
      constructor: cr,
      interpolate_: function(t) {
        return this.copySampleValue_(t - 1)
      }
    }), nr = {
      TimeBufferType: Float32Array,
      ValueBufferType: Float32Array,
      DefaultInterpolation: 2301,
      InterpolantFactoryMethodDiscrete: function(t) {
        return new cr(this.times, this.values, this.getValueSize(), t)
      },
      InterpolantFactoryMethodLinear: function(t) {
        return new sr(this.times, this.values, this.getValueSize(), t)
      },
      InterpolantFactoryMethodSmooth: function(t) {
        return new or(this.times, this.values, this.getValueSize(), t)
      },
      setInterpolation: function(t) {
        var e;
        switch (t) {
          case 2300:
            e = this.InterpolantFactoryMethodDiscrete;
            break;
          case 2301:
            e = this.InterpolantFactoryMethodLinear;
            break;
          case 2302:
            e = this.InterpolantFactoryMethodSmooth
        }
        if (void 0 !== e) this.createInterpolant = e;
        else {
          var i = "unsupported interpolation for " + this.ValueTypeName + " keyframe track named " + this.name;
          if (void 0 === this.createInterpolant) {
            if (t === this.DefaultInterpolation) throw new Error(i);
            this.setInterpolation(this.DefaultInterpolation)
          }
          console.warn("THREE.KeyframeTrackPrototype:", i)
        }
      },
      getInterpolation: function() {
        switch (this.createInterpolant) {
          case this.InterpolantFactoryMethodDiscrete:
            return 2300;
          case this.InterpolantFactoryMethodLinear:
            return 2301;
          case this.InterpolantFactoryMethodSmooth:
            return 2302
        }
      },
      getValueSize: function() {
        return this.values.length / this.times.length
      },
      shift: function(t) {
        if (0 !== t)
          for (var e = this.times, i = 0, n = e.length; i !== n; ++i) e[i] += t;
        return this
      },
      scale: function(t) {
        if (1 !== t)
          for (var e = this.times, i = 0, n = e.length; i !== n; ++i) e[i] *= t;
        return this
      },
      trim: function(t, e) {
        for (var i = this.times, n = i.length, r = 0, a = n - 1; r !== n && i[r] < t;) ++r;
        for (; - 1 !== a && i[a] > e;) --a;
        if (++a, 0 !== r || a !== n) {
          r >= a && (r = (a = Math.max(a, 1)) - 1);
          var o = this.getValueSize();
          this.times = rr.arraySlice(i, r, a), this.values = rr.arraySlice(this.values, r * o, a * o)
        }
        return this
      },
      validate: function() {
        var t = !0,
          e = this.getValueSize();
        e - Math.floor(e) != 0 && (console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.", this), t = !1);
        var i = this.times,
          n = this.values,
          r = i.length;
        0 === r && (console.error("THREE.KeyframeTrackPrototype: Track is empty.", this), t = !1);
        for (var a = null, o = 0; o !== r; o++) {
          var s = i[o];
          if ("number" == typeof s && isNaN(s)) {
            console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.", this, o, s), t = !1;
            break
          }
          if (null !== a && a > s) {
            console.error("THREE.KeyframeTrackPrototype: Out of order keys.", this, o, s, a), t = !1;
            break
          }
          a = s
        }
        if (void 0 !== n && rr.isTypedArray(n)) {
          o = 0;
          for (var c = n.length; o !== c; ++o) {
            var h = n[o];
            if (isNaN(h)) {
              console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.", this, o, h), t = !1;
              break
            }
          }
        }
        return t
      },
      optimize: function() {
        for (var t = this.times, e = this.values, i = this.getValueSize(), n = 2302 === this.getInterpolation(), r = 1, a = t.length - 1, o = 1; o < a; ++o) {
          var s = !1,
            c = t[o];
          if (c !== t[o + 1] && (1 !== o || c !== c[0]))
            if (n) s = !0;
            else
              for (var h = o * i, l = h - i, u = h + i, p = 0; p !== i; ++p) {
                var d = e[h + p];
                if (d !== e[l + p] || d !== e[u + p]) {
                  s = !0;
                  break
                }
              }
          if (s) {
            if (o !== r) {
              t[r] = t[o];
              var f = o * i,
                m = r * i;
              for (p = 0; p !== i; ++p) e[m + p] = e[f + p]
            }++r
          }
        }
        if (a > 0) {
          for (t[r] = t[a], f = a * i, m = r * i, p = 0; p !== i; ++p) e[m + p] = e[f + p];
          ++r
        }
        return r !== t.length && (this.times = rr.arraySlice(t, 0, r), this.values = rr.arraySlice(e, 0, r * i)), this
      }
    }, lr.prototype = Object.assign(Object.create(nr), {
      constructor: lr,
      ValueTypeName: "vector"
    }), ur.prototype = Object.assign(Object.create(ar.prototype), {
      constructor: ur,
      interpolate_: function(t, e, i, n) {
        for (var r = this.resultBuffer, a = this.sampleValues, o = this.valueSize, s = t * o, c = (i - e) / (n - e), h = s + o; s !== h; s += 4) O.slerpFlat(r, 0, a, s - o, a, s, c);
        return r
      }
    }), pr.prototype = Object.assign(Object.create(nr), {
      constructor: pr,
      ValueTypeName: "quaternion",
      DefaultInterpolation: 2301,
      InterpolantFactoryMethodLinear: function(t) {
        return new ur(this.times, this.values, this.getValueSize(), t)
      },
      InterpolantFactoryMethodSmooth: void 0
    }), dr.prototype = Object.assign(Object.create(nr), {
      constructor: dr,
      ValueTypeName: "number"
    }), fr.prototype = Object.assign(Object.create(nr), {
      constructor: fr,
      ValueTypeName: "string",
      ValueBufferType: Array,
      DefaultInterpolation: 2300,
      InterpolantFactoryMethodLinear: void 0,
      InterpolantFactoryMethodSmooth: void 0
    }), mr.prototype = Object.assign(Object.create(nr), {
      constructor: mr,
      ValueTypeName: "bool",
      ValueBufferType: Array,
      DefaultInterpolation: 2300,
      InterpolantFactoryMethodLinear: void 0,
      InterpolantFactoryMethodSmooth: void 0
    }), gr.prototype = Object.assign(Object.create(nr), {
      constructor: gr,
      ValueTypeName: "color"
    }), vr.prototype = nr, nr.constructor = vr, Object.assign(vr, {
      parse: function(t) {
        if (void 0 === t.type) throw new Error("track type undefined, can not parse");
        var e = vr._getTrackTypeForValueTypeName(t.type);
        if (void 0 === t.times) {
          var i = [],
            n = [];
          rr.flattenJSON(t.keys, i, n, "value"), t.times = i, t.values = n
        }
        return void 0 !== e.parse ? e.parse(t) : new e(t.name, t.times, t.values, t.interpolation)
      },
      toJSON: function(t) {
        var e, i = t.constructor;
        if (void 0 !== i.toJSON) e = i.toJSON(t);
        else {
          e = {
            name: t.name,
            times: rr.convertArray(t.times, Array),
            values: rr.convertArray(t.values, Array)
          };
          var n = t.getInterpolation();
          n !== t.DefaultInterpolation && (e.interpolation = n)
        }
        return e.type = t.ValueTypeName, e
      },
      _getTrackTypeForValueTypeName: function(t) {
        switch (t.toLowerCase()) {
          case "scalar":
          case "double":
          case "float":
          case "number":
          case "integer":
            return dr;
          case "vector":
          case "vector2":
          case "vector3":
          case "vector4":
            return lr;
          case "color":
            return gr;
          case "quaternion":
            return pr;
          case "bool":
          case "boolean":
            return mr;
          case "string":
            return fr
        }
        throw new Error("Unsupported typeName: " + t)
      }
    }), Object.assign(yr, {
      parse: function(t) {
        for (var e = [], i = t.tracks, n = 1 / (t.fps || 1), r = 0, a = i.length; r !== a; ++r) e.push(vr.parse(i[r]).scale(n));
        return new yr(t.name, t.duration, e)
      },
      toJSON: function(t) {
        for (var e = [], i = t.tracks, n = {
            name: t.name,
            duration: t.duration,
            tracks: e
          }, r = 0, a = i.length; r !== a; ++r) e.push(vr.toJSON(i[r]));
        return n
      },
      CreateFromMorphTargetSequence: function(t, e, i, n) {
        for (var r = e.length, a = [], o = 0; o < r; o++) {
          var s = [],
            c = [];
          s.push((o + r - 1) % r, o, (o + 1) % r), c.push(0, 1, 0);
          var h = rr.getKeyframeOrder(s);
          s = rr.sortedArray(s, 1, h), c = rr.sortedArray(c, 1, h), n || 0 !== s[0] || (s.push(r), c.push(c[0])), a.push(new dr(".morphTargetInfluences[" + e[o].name + "]", s, c).scale(1 / i))
        }
        return new yr(t, -1, a)
      },
      findByName: function(t, e) {
        var i = t;
        if (!Array.isArray(t)) {
          var n = t;
          i = n.geometry && n.geometry.animations || n.animations
        }
        for (var r = 0; r < i.length; r++)
          if (i[r].name === e) return i[r];
        return null
      },
      CreateClipsFromMorphTargetSequences: function(t, e, i) {
        for (var n = {}, r = /^([\w-]*?)([\d]+)$/, a = 0, o = t.length; a < o; a++) {
          var s = t[a],
            c = s.name.match(r);
          if (c && c.length > 1) {
            var h = n[u = c[1]];
            h || (n[u] = h = []), h.push(s)
          }
        }
        var l = [];
        for (var u in n) l.push(yr.CreateFromMorphTargetSequence(u, n[u], e, i));
        return l
      },
      parseAnimation: function(t, e) {
        if (!t) return console.error("THREE.AnimationClip: No animation in JSONLoader data."), null;
        for (var i = function(t, e, i, n, r) {
            if (0 !== i.length) {
              var a = [],
                o = [];
              rr.flattenJSON(i, a, o, n), 0 !== a.length && r.push(new t(e, a, o))
            }
          }, n = [], r = t.name || "default", a = t.length || -1, o = t.fps || 30, s = t.hierarchy || [], c = 0; c < s.length; c++) {
          var h = s[c].keys;
          if (h && 0 !== h.length)
            if (h[0].morphTargets) {
              for (var l = {}, u = 0; u < h.length; u++)
                if (h[u].morphTargets)
                  for (var p = 0; p < h[u].morphTargets.length; p++) l[h[u].morphTargets[p]] = -1;
              for (var d in l) {
                var f = [],
                  m = [];
                for (p = 0; p !== h[u].morphTargets.length; ++p) {
                  var g = h[u];
                  f.push(g.time), m.push(g.morphTarget === d ? 1 : 0)
                }
                n.push(new dr(".morphTargetInfluence[" + d + "]", f, m))
              }
              a = l.length * (o || 1)
            } else {
              var v = ".bones[" + e[c].name + "]";
              i(lr, v + ".position", h, "pos", n), i(pr, v + ".quaternion", h, "rot", n), i(lr, v + ".scale", h, "scl", n)
            }
        }
        return 0 === n.length ? null : new yr(r, a, n)
      }
    }), Object.assign(yr.prototype, {
      resetDuration: function() {
        for (var t = 0, e = 0, i = this.tracks.length; e !== i; ++e) {
          var n = this.tracks[e];
          t = Math.max(t, n.times[n.times.length - 1])
        }
        this.duration = t
      },
      trim: function() {
        for (var t = 0; t < this.tracks.length; t++) this.tracks[t].trim(0, this.duration);
        return this
      },
      optimize: function() {
        for (var t = 0; t < this.tracks.length; t++) this.tracks[t].optimize();
        return this
      }
    }), Object.assign(xr.prototype, {
      load: function(t, e, i, n) {
        var r = this;
        new Hn(r.manager).load(t, (function(t) {
          e(r.parse(JSON.parse(t)))
        }), i, n)
      },
      setTextures: function(t) {
        this.textures = t
      },
      parse: function(t) {
        var e = this.textures;

        function i(t) {
          return void 0 === e[t] && console.warn("THREE.MaterialLoader: Undefined texture", t), e[t]
        }
        var n = new Nn[t.type];
        if (void 0 !== t.uuid && (n.uuid = t.uuid), void 0 !== t.name && (n.name = t.name), void 0 !== t.color && n.color.setHex(t.color), void 0 !== t.roughness && (n.roughness = t.roughness), void 0 !== t.metalness && (n.metalness = t.metalness), void 0 !== t.emissive && n.emissive.setHex(t.emissive), void 0 !== t.specular && n.specular.setHex(t.specular), void 0 !== t.shininess && (n.shininess = t.shininess), void 0 !== t.clearCoat && (n.clearCoat = t.clearCoat), void 0 !== t.clearCoatRoughness && (n.clearCoatRoughness = t.clearCoatRoughness), void 0 !== t.uniforms && (n.uniforms = t.uniforms), void 0 !== t.vertexShader && (n.vertexShader = t.vertexShader), void 0 !== t.fragmentShader && (n.fragmentShader = t.fragmentShader), void 0 !== t.vertexColors && (n.vertexColors = t.vertexColors), void 0 !== t.fog && (n.fog = t.fog), void 0 !== t.flatShading && (n.flatShading = t.flatShading), void 0 !== t.blending && (n.blending = t.blending), void 0 !== t.side && (n.side = t.side), void 0 !== t.opacity && (n.opacity = t.opacity), void 0 !== t.transparent && (n.transparent = t.transparent), void 0 !== t.alphaTest && (n.alphaTest = t.alphaTest), void 0 !== t.depthTest && (n.depthTest = t.depthTest), void 0 !== t.depthWrite && (n.depthWrite = t.depthWrite), void 0 !== t.colorWrite && (n.colorWrite = t.colorWrite), void 0 !== t.wireframe && (n.wireframe = t.wireframe), void 0 !== t.wireframeLinewidth && (n.wireframeLinewidth = t.wireframeLinewidth), void 0 !== t.wireframeLinecap && (n.wireframeLinecap = t.wireframeLinecap), void 0 !== t.wireframeLinejoin && (n.wireframeLinejoin = t.wireframeLinejoin), void 0 !== t.rotation && (n.rotation = t.rotation), 1 !== t.linewidth && (n.linewidth = t.linewidth), void 0 !== t.dashSize && (n.dashSize = t.dashSize), void 0 !== t.gapSize && (n.gapSize = t.gapSize), void 0 !== t.scale && (n.scale = t.scale), void 0 !== t.skinning && (n.skinning = t.skinning), void 0 !== t.morphTargets && (n.morphTargets = t.morphTargets), void 0 !== t.dithering && (n.dithering = t.dithering), void 0 !== t.visible && (n.visible = t.visible), void 0 !== t.userData && (n.userData = t.userData), void 0 !== t.shading && (n.flatShading = 1 === t.shading), void 0 !== t.size && (n.size = t.size), void 0 !== t.sizeAttenuation && (n.sizeAttenuation = t.sizeAttenuation), void 0 !== t.map && (n.map = i(t.map)), void 0 !== t.alphaMap && (n.alphaMap = i(t.alphaMap), n.transparent = !0), void 0 !== t.bumpMap && (n.bumpMap = i(t.bumpMap)), void 0 !== t.bumpScale && (n.bumpScale = t.bumpScale), void 0 !== t.normalMap && (n.normalMap = i(t.normalMap)), void 0 !== t.normalScale) {
          var r = t.normalScale;
          !1 === Array.isArray(r) && (r = [r, r]), n.normalScale = (new U).fromArray(r)
        }
        return void 0 !== t.displacementMap && (n.displacementMap = i(t.displacementMap)), void 0 !== t.displacementScale && (n.displacementScale = t.displacementScale), void 0 !== t.displacementBias && (n.displacementBias = t.displacementBias), void 0 !== t.roughnessMap && (n.roughnessMap = i(t.roughnessMap)), void 0 !== t.metalnessMap && (n.metalnessMap = i(t.metalnessMap)), void 0 !== t.emissiveMap && (n.emissiveMap = i(t.emissiveMap)), void 0 !== t.emissiveIntensity && (n.emissiveIntensity = t.emissiveIntensity), void 0 !== t.specularMap && (n.specularMap = i(t.specularMap)), void 0 !== t.envMap && (n.envMap = i(t.envMap)), void 0 !== t.reflectivity && (n.reflectivity = t.reflectivity), void 0 !== t.lightMap && (n.lightMap = i(t.lightMap)), void 0 !== t.lightMapIntensity && (n.lightMapIntensity = t.lightMapIntensity), void 0 !== t.aoMap && (n.aoMap = i(t.aoMap)), void 0 !== t.aoMapIntensity && (n.aoMapIntensity = t.aoMapIntensity), void 0 !== t.gradientMap && (n.gradientMap = i(t.gradientMap)), n
      }
    }), Object.assign(br.prototype, {
      load: function(t, e, i, n) {
        var r = this;
        new Hn(r.manager).load(t, (function(t) {
          e(r.parse(JSON.parse(t)))
        }), i, n)
      },
      parse: function(t) {
        var e = new Be,
          i = t.data.index;
        if (void 0 !== i) {
          var n = new Tr[i.type](i.array);
          e.setIndex(new ve(n, 1))
        }
        var r = t.data.attributes;
        for (var a in r) {
          var o = r[a];
          n = new Tr[o.type](o.array), e.addAttribute(a, new ve(n, o.itemSize, o.normalized))
        }
        var s = t.data.groups || t.data.drawcalls || t.data.offsets;
        if (void 0 !== s)
          for (var c = 0, h = s.length; c !== h; ++c) {
            var l = s[c];
            e.addGroup(l.start, l.count, l.materialIndex)
          }
        var u = t.data.boundingSphere;
        if (void 0 !== u) {
          var p = new N;
          void 0 !== u.center && p.fromArray(u.center), e.boundingSphere = new Kt(p, u.radius)
        }
        return e
      }
    });
  var _r, wr, Mr, Er, Tr = {
    Int8Array: Int8Array,
    Uint8Array: Uint8Array,
    Uint8ClampedArray: "undefined" != typeof Uint8ClampedArray ? Uint8ClampedArray : Uint8Array,
    Int16Array: Int16Array,
    Uint16Array: Uint16Array,
    Int32Array: Int32Array,
    Uint32Array: Uint32Array,
    Float32Array: Float32Array,
    Float64Array: Float64Array
  };

  function Sr() {
    this.onLoadStart = function() {}, this.onLoadProgress = function() {}, this.onLoadComplete = function() {}
  }

  function Ar(t) {
    "boolean" == typeof t && (console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."), t = void 0), this.manager = void 0 !== t ? t : zn, this.withCredentials = !1
  }

  function Rr(t) {
    this.manager = void 0 !== t ? t : zn, this.texturePath = ""
  }
  Sr.Handlers = {
    handlers: [],
    add: function(t, e) {
      this.handlers.push(t, e)
    },
    get: function(t) {
      for (var e = this.handlers, i = 0, n = e.length; i < n; i += 2) {
        var r = e[i],
          a = e[i + 1];
        if (r.test(t)) return a
      }
      return null
    }
  }, Object.assign(Sr.prototype, {
    crossOrigin: void 0,
    extractUrlBase: function(t) {
      var e = t.split("/");
      return 1 === e.length ? "./" : (e.pop(), e.join("/") + "/")
    },
    initMaterials: function(t, e, i) {
      for (var n = [], r = 0; r < t.length; ++r) n[r] = this.createMaterial(t[r], e, i);
      return n
    },
    createMaterial: (_r = {
      NoBlending: 0,
      NormalBlending: 1,
      AdditiveBlending: 2,
      SubtractiveBlending: 3,
      MultiplyBlending: 4,
      CustomBlending: 5
    }, wr = new Ct, Mr = new Xn, Er = new xr, function(t, e, i) {
      var n = {};

      function r(t, r, a, o, s) {
        var c, h = e + t,
          l = Sr.Handlers.get(h);
        null !== l ? c = l.load(h) : (Mr.setCrossOrigin(i), c = Mr.load(h)), void 0 !== r && (c.repeat.fromArray(r), 1 !== r[0] && (c.wrapS = v), 1 !== r[1] && (c.wrapT = v)), void 0 !== a && c.offset.fromArray(a), void 0 !== o && ("repeat" === o[0] && (c.wrapS = v), "mirror" === o[0] && (c.wrapS = x), "repeat" === o[1] && (c.wrapT = v), "mirror" === o[1] && (c.wrapT = x)), void 0 !== s && (c.anisotropy = s);
        var u = I.generateUUID();
        return n[u] = c, u
      }
      var a = {
        uuid: I.generateUUID(),
        type: "MeshLambertMaterial"
      };
      for (var o in t) {
        var s = t[o];
        switch (o) {
          case "DbgColor":
          case "DbgIndex":
          case "opticalDensity":
          case "illumination":
            break;
          case "DbgName":
            a.name = s;
            break;
          case "blending":
            a.blending = _r[s];
            break;
          case "colorAmbient":
          case "mapAmbient":
            console.warn("THREE.Loader.createMaterial:", o, "is no longer supported.");
            break;
          case "colorDiffuse":
            a.color = wr.fromArray(s).getHex();
            break;
          case "colorSpecular":
            a.specular = wr.fromArray(s).getHex();
            break;
          case "colorEmissive":
            a.emissive = wr.fromArray(s).getHex();
            break;
          case "specularCoef":
            a.shininess = s;
            break;
          case "shading":
            "basic" === s.toLowerCase() && (a.type = "MeshBasicMaterial"), "phong" === s.toLowerCase() && (a.type = "MeshPhongMaterial"), "standard" === s.toLowerCase() && (a.type = "MeshStandardMaterial");
            break;
          case "mapDiffuse":
            a.map = r(s, t.mapDiffuseRepeat, t.mapDiffuseOffset, t.mapDiffuseWrap, t.mapDiffuseAnisotropy);
            break;
          case "mapDiffuseRepeat":
          case "mapDiffuseOffset":
          case "mapDiffuseWrap":
          case "mapDiffuseAnisotropy":
            break;
          case "mapEmissive":
            a.emissiveMap = r(s, t.mapEmissiveRepeat, t.mapEmissiveOffset, t.mapEmissiveWrap, t.mapEmissiveAnisotropy);
            break;
          case "mapEmissiveRepeat":
          case "mapEmissiveOffset":
          case "mapEmissiveWrap":
          case "mapEmissiveAnisotropy":
            break;
          case "mapLight":
            a.lightMap = r(s, t.mapLightRepeat, t.mapLightOffset, t.mapLightWrap, t.mapLightAnisotropy);
            break;
          case "mapLightRepeat":
          case "mapLightOffset":
          case "mapLightWrap":
          case "mapLightAnisotropy":
            break;
          case "mapAO":
            a.aoMap = r(s, t.mapAORepeat, t.mapAOOffset, t.mapAOWrap, t.mapAOAnisotropy);
            break;
          case "mapAORepeat":
          case "mapAOOffset":
          case "mapAOWrap":
          case "mapAOAnisotropy":
            break;
          case "mapBump":
            a.bumpMap = r(s, t.mapBumpRepeat, t.mapBumpOffset, t.mapBumpWrap, t.mapBumpAnisotropy);
            break;
          case "mapBumpScale":
            a.bumpScale = s;
            break;
          case "mapBumpRepeat":
          case "mapBumpOffset":
          case "mapBumpWrap":
          case "mapBumpAnisotropy":
            break;
          case "mapNormal":
            a.normalMap = r(s, t.mapNormalRepeat, t.mapNormalOffset, t.mapNormalWrap, t.mapNormalAnisotropy);
            break;
          case "mapNormalFactor":
            a.normalScale = [s, s];
            break;
          case "mapNormalRepeat":
          case "mapNormalOffset":
          case "mapNormalWrap":
          case "mapNormalAnisotropy":
            break;
          case "mapSpecular":
            a.specularMap = r(s, t.mapSpecularRepeat, t.mapSpecularOffset, t.mapSpecularWrap, t.mapSpecularAnisotropy);
            break;
          case "mapSpecularRepeat":
          case "mapSpecularOffset":
          case "mapSpecularWrap":
          case "mapSpecularAnisotropy":
            break;
          case "mapMetalness":
            a.metalnessMap = r(s, t.mapMetalnessRepeat, t.mapMetalnessOffset, t.mapMetalnessWrap, t.mapMetalnessAnisotropy);
            break;
          case "mapMetalnessRepeat":
          case "mapMetalnessOffset":
          case "mapMetalnessWrap":
          case "mapMetalnessAnisotropy":
            break;
          case "mapRoughness":
            a.roughnessMap = r(s, t.mapRoughnessRepeat, t.mapRoughnessOffset, t.mapRoughnessWrap, t.mapRoughnessAnisotropy);
            break;
          case "mapRoughnessRepeat":
          case "mapRoughnessOffset":
          case "mapRoughnessWrap":
          case "mapRoughnessAnisotropy":
            break;
          case "mapAlpha":
            a.alphaMap = r(s, t.mapAlphaRepeat, t.mapAlphaOffset, t.mapAlphaWrap, t.mapAlphaAnisotropy);
            break;
          case "mapAlphaRepeat":
          case "mapAlphaOffset":
          case "mapAlphaWrap":
          case "mapAlphaAnisotropy":
            break;
          case "flipSided":
            a.side = 1;
            break;
          case "doubleSided":
            a.side = 2;
            break;
          case "transparency":
            console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"), a.opacity = s;
            break;
          case "depthTest":
          case "depthWrite":
          case "colorWrite":
          case "opacity":
          case "reflectivity":
          case "transparent":
          case "visible":
          case "wireframe":
            a[o] = s;
            break;
          case "vertexColors":
            !0 === s && (a.vertexColors = 2), "face" === s && (a.vertexColors = 1);
            break;
          default:
            console.error("THREE.Loader.createMaterial: Unsupported", o, s)
        }
      }
      return "MeshBasicMaterial" === a.type && delete a.emissive, "MeshPhongMaterial" !== a.type && delete a.specular, a.opacity < 1 && (a.transparent = !0), Er.setTextures(n), Er.parse(a)
    })
  }), Object.assign(Ar.prototype, {
    load: function(t, e, i, n) {
      var r = this,
        a = this.texturePath && "string" == typeof this.texturePath ? this.texturePath : Sr.prototype.extractUrlBase(t),
        o = new Hn(this.manager);
      o.setWithCredentials(this.withCredentials), o.load(t, (function(i) {
        var n = JSON.parse(i),
          o = n.metadata;
        if (void 0 !== o) {
          var s = o.type;
          if (void 0 !== s) {
            if ("object" === s.toLowerCase()) return void console.error("THREE.JSONLoader: " + t + " should be loaded with THREE.ObjectLoader instead.");
            if ("scene" === s.toLowerCase()) return void console.error("THREE.JSONLoader: " + t + " should be loaded with THREE.SceneLoader instead.")
          }
        }
        var c = r.parse(n, a);
        e(c.geometry, c.materials)
      }), i, n)
    },
    setTexturePath: function(t) {
      this.texturePath = t
    },
    parse: function(t, e) {
      void 0 !== t.data && (t = t.data), void 0 !== t.scale ? t.scale = 1 / t.scale : t.scale = 1;
      var i = new ge;
      return function(t, e) {
          function i(t, e) {
            return t & 1 << e
          }
          var n, r, a, o, s, c, h, l, u, p, d, f, m, g, v, y, x, b, _, w, M, E, T, S, A, R = t.faces,
            L = t.vertices,
            P = t.normals,
            C = t.colors,
            I = t.scale,
            D = 0;
          if (void 0 !== t.uvs) {
            for (n = 0; n < t.uvs.length; n++) t.uvs[n].length && D++;
            for (n = 0; n < D; n++) e.faceVertexUvs[n] = []
          }
          for (o = 0, s = L.length; o < s;)(b = new N).x = L[o++] * I, b.y = L[o++] * I, b.z = L[o++] * I, e.vertices.push(b);
          for (o = 0, s = R.length; o < s;)
            if (d = i(p = R[o++], 0), f = i(p, 1), m = i(p, 3), g = i(p, 4), v = i(p, 5), y = i(p, 6), x = i(p, 7), d) {
              if ((w = new de).a = R[o], w.b = R[o + 1], w.c = R[o + 3], (M = new de).a = R[o + 1], M.b = R[o + 2], M.c = R[o + 3], o += 4, f && (u = R[o++], w.materialIndex = u, M.materialIndex = u), a = e.faces.length, m)
                for (n = 0; n < D; n++)
                  for (S = t.uvs[n], e.faceVertexUvs[n][a] = [], e.faceVertexUvs[n][a + 1] = [], r = 0; r < 4; r++) A = new U(S[2 * (l = R[o++])], S[2 * l + 1]), 2 !== r && e.faceVertexUvs[n][a].push(A), 0 !== r && e.faceVertexUvs[n][a + 1].push(A);
              if (g && (h = 3 * R[o++], w.normal.set(P[h++], P[h++], P[h]), M.normal.copy(w.normal)), v)
                for (n = 0; n < 4; n++) h = 3 * R[o++], T = new N(P[h++], P[h++], P[h]), 2 !== n && w.vertexNormals.push(T), 0 !== n && M.vertexNormals.push(T);
              if (y && (E = C[c = R[o++]], w.color.setHex(E), M.color.setHex(E)), x)
                for (n = 0; n < 4; n++) E = C[c = R[o++]], 2 !== n && w.vertexColors.push(new Ct(E)), 0 !== n && M.vertexColors.push(new Ct(E));
              e.faces.push(w), e.faces.push(M)
            } else {
              if ((_ = new de).a = R[o++], _.b = R[o++], _.c = R[o++], f && (u = R[o++], _.materialIndex = u), a = e.faces.length, m)
                for (n = 0; n < D; n++)
                  for (S = t.uvs[n], e.faceVertexUvs[n][a] = [], r = 0; r < 3; r++) A = new U(S[2 * (l = R[o++])], S[2 * l + 1]), e.faceVertexUvs[n][a].push(A);
              if (g && (h = 3 * R[o++], _.normal.set(P[h++], P[h++], P[h])), v)
                for (n = 0; n < 3; n++) h = 3 * R[o++], T = new N(P[h++], P[h++], P[h]), _.vertexNormals.push(T);
              if (y && (c = R[o++], _.color.setHex(C[c])), x)
                for (n = 0; n < 3; n++) c = R[o++], _.vertexColors.push(new Ct(C[c]));
              e.faces.push(_)
            }
        }(t, i),
        function(t, e) {
          var i = void 0 !== t.influencesPerVertex ? t.influencesPerVertex : 2;
          if (t.skinWeights)
            for (var n = 0, r = t.skinWeights.length; n < r; n += i) {
              var a = t.skinWeights[n],
                o = i > 1 ? t.skinWeights[n + 1] : 0,
                s = i > 2 ? t.skinWeights[n + 2] : 0,
                c = i > 3 ? t.skinWeights[n + 3] : 0;
              e.skinWeights.push(new G(a, o, s, c))
            }
          if (t.skinIndices)
            for (n = 0, r = t.skinIndices.length; n < r; n += i) {
              var h = t.skinIndices[n],
                l = i > 1 ? t.skinIndices[n + 1] : 0,
                u = i > 2 ? t.skinIndices[n + 2] : 0,
                p = i > 3 ? t.skinIndices[n + 3] : 0;
              e.skinIndices.push(new G(h, l, u, p))
            }
          e.bones = t.bones, e.bones && e.bones.length > 0 && (e.skinWeights.length !== e.skinIndices.length || e.skinIndices.length !== e.vertices.length) && console.warn("When skinning, number of vertices (" + e.vertices.length + "), skinIndices (" + e.skinIndices.length + "), and skinWeights (" + e.skinWeights.length + ") should match.")
        }(t, i),
        function(t, e) {
          var i = t.scale;
          if (void 0 !== t.morphTargets)
            for (var n = 0, r = t.morphTargets.length; n < r; n++) {
              e.morphTargets[n] = {}, e.morphTargets[n].name = t.morphTargets[n].name, e.morphTargets[n].vertices = [];
              for (var a = e.morphTargets[n].vertices, o = t.morphTargets[n].vertices, s = 0, c = o.length; s < c; s += 3) {
                var h = new N;
                h.x = o[s] * i, h.y = o[s + 1] * i, h.z = o[s + 2] * i, a.push(h)
              }
            }
          if (void 0 !== t.morphColors && t.morphColors.length > 0) {
            console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');
            var l = e.faces,
              u = t.morphColors[0].colors;
            for (n = 0, r = l.length; n < r; n++) l[n].color.fromArray(u, 3 * n)
          }
        }(t, i),
        function(t, e) {
          var i = [],
            n = [];
          void 0 !== t.animation && n.push(t.animation), void 0 !== t.animations && (t.animations.length ? n = n.concat(t.animations) : n.push(t.animations));
          for (var r = 0; r < n.length; r++) {
            var a = yr.parseAnimation(n[r], e.bones);
            a && i.push(a)
          }
          if (e.morphTargets) {
            var o = yr.CreateClipsFromMorphTargetSequences(e.morphTargets, 10);
            i = i.concat(o)
          }
          i.length > 0 && (e.animations = i)
        }(t, i), i.computeFaceNormals(), i.computeBoundingSphere(), void 0 === t.materials || 0 === t.materials.length ? {
          geometry: i
        } : {
          geometry: i,
          materials: Sr.prototype.initMaterials(t.materials, e, this.crossOrigin)
        }
    }
  }), Object.assign(Rr.prototype, {
    load: function(t, e, i, n) {
      "" === this.texturePath && (this.texturePath = t.substring(0, t.lastIndexOf("/") + 1));
      var r = this;
      new Hn(r.manager).load(t, (function(i) {
        var a = null;
        try {
          a = JSON.parse(i)
        } catch (e) {
          return void 0 !== n && n(e), void console.error("THREE:ObjectLoader: Can't parse " + t + ".", e.message)
        }
        var o = a.metadata;
        void 0 !== o && void 0 !== o.type && "geometry" !== o.type.toLowerCase() ? r.parse(a, e) : console.error("THREE.ObjectLoader: Can't load " + t + ". Use THREE.JSONLoader instead.")
      }), i, n)
    },
    setTexturePath: function(t) {
      this.texturePath = t
    },
    setCrossOrigin: function(t) {
      this.crossOrigin = t
    },
    parse: function(t, e) {
      var i = this.parseGeometries(t.geometries),
        n = this.parseImages(t.images, (function() {
          void 0 !== e && e(o)
        })),
        r = this.parseTextures(t.textures, n),
        a = this.parseMaterials(t.materials, r),
        o = this.parseObject(t.object, i, a);
      return t.animations && (o.animations = this.parseAnimations(t.animations)), void 0 !== t.images && 0 !== t.images.length || void 0 !== e && e(o), o
    },
    parseGeometries: function(t) {
      var e = {};
      if (void 0 !== t)
        for (var i = new Ar, n = new br, r = 0, a = t.length; r < a; r++) {
          var o, s = t[r];
          switch (s.type) {
            case "PlaneGeometry":
            case "PlaneBufferGeometry":
              o = new Sn[s.type](s.width, s.height, s.widthSegments, s.heightSegments);
              break;
            case "BoxGeometry":
            case "BoxBufferGeometry":
            case "CubeGeometry":
              o = new Sn[s.type](s.width, s.height, s.depth, s.widthSegments, s.heightSegments, s.depthSegments);
              break;
            case "CircleGeometry":
            case "CircleBufferGeometry":
              o = new Sn[s.type](s.radius, s.segments, s.thetaStart, s.thetaLength);
              break;
            case "CylinderGeometry":
            case "CylinderBufferGeometry":
              o = new Sn[s.type](s.radiusTop, s.radiusBottom, s.height, s.radialSegments, s.heightSegments, s.openEnded, s.thetaStart, s.thetaLength);
              break;
            case "ConeGeometry":
            case "ConeBufferGeometry":
              o = new Sn[s.type](s.radius, s.height, s.radialSegments, s.heightSegments, s.openEnded, s.thetaStart, s.thetaLength);
              break;
            case "SphereGeometry":
            case "SphereBufferGeometry":
              o = new Sn[s.type](s.radius, s.widthSegments, s.heightSegments, s.phiStart, s.phiLength, s.thetaStart, s.thetaLength);
              break;
            case "DodecahedronGeometry":
            case "DodecahedronBufferGeometry":
            case "IcosahedronGeometry":
            case "IcosahedronBufferGeometry":
            case "OctahedronGeometry":
            case "OctahedronBufferGeometry":
            case "TetrahedronGeometry":
            case "TetrahedronBufferGeometry":
              o = new Sn[s.type](s.radius, s.detail);
              break;
            case "RingGeometry":
            case "RingBufferGeometry":
              o = new Sn[s.type](s.innerRadius, s.outerRadius, s.thetaSegments, s.phiSegments, s.thetaStart, s.thetaLength);
              break;
            case "TorusGeometry":
            case "TorusBufferGeometry":
              o = new Sn[s.type](s.radius, s.tube, s.radialSegments, s.tubularSegments, s.arc);
              break;
            case "TorusKnotGeometry":
            case "TorusKnotBufferGeometry":
              o = new Sn[s.type](s.radius, s.tube, s.tubularSegments, s.radialSegments, s.p, s.q);
              break;
            case "LatheGeometry":
            case "LatheBufferGeometry":
              o = new Sn[s.type](s.points, s.segments, s.phiStart, s.phiLength);
              break;
            case "PolyhedronGeometry":
            case "PolyhedronBufferGeometry":
              o = new Sn[s.type](s.vertices, s.indices, s.radius, s.details);
              break;
            case "BufferGeometry":
              o = n.parse(s);
              break;
            case "Geometry":
              o = i.parse(s, this.texturePath).geometry;
              break;
            default:
              console.warn('THREE.ObjectLoader: Unsupported geometry type "' + s.type + '"');
              continue
          }
          o.uuid = s.uuid, void 0 !== s.name && (o.name = s.name), e[s.uuid] = o
        }
      return e
    },
    parseMaterials: function(t, e) {
      var i = {};
      if (void 0 !== t) {
        var n = new xr;
        n.setTextures(e);
        for (var r = 0, a = t.length; r < a; r++) {
          var o = t[r];
          if ("MultiMaterial" === o.type) {
            for (var s = [], c = 0; c < o.materials.length; c++) s.push(n.parse(o.materials[c]));
            i[o.uuid] = s
          } else i[o.uuid] = n.parse(o)
        }
      }
      return i
    },
    parseAnimations: function(t) {
      for (var e = [], i = 0; i < t.length; i++) {
        var n = yr.parse(t[i]);
        e.push(n)
      }
      return e
    },
    parseImages: function(t, e) {
      var i = this,
        n = {};

      function r(t) {
        return i.manager.itemStart(t), a.load(t, (function() {
          i.manager.itemEnd(t)
        }), void 0, (function() {
          i.manager.itemEnd(t), i.manager.itemError(t)
        }))
      }
      if (void 0 !== t && t.length > 0) {
        var a = new jn(new Fn(e));
        a.setCrossOrigin(this.crossOrigin);
        for (var o = 0, s = t.length; o < s; o++) {
          var c = t[o],
            h = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url) ? c.url : i.texturePath + c.url;
          n[c.uuid] = r(h)
        }
      }
      return n
    },
    parseTextures: function(t, e) {
      function i(t, e) {
        return "number" == typeof t ? t : (console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.", t), e[t])
      }
      var n = {};
      if (void 0 !== t)
        for (var r = 0, a = t.length; r < a; r++) {
          var o = t[r];
          void 0 === o.image && console.warn('THREE.ObjectLoader: No "image" specified for', o.uuid), void 0 === e[o.image] && console.warn("THREE.ObjectLoader: Undefined image", o.image);
          var s = new z(e[o.image]);
          s.needsUpdate = !0, s.uuid = o.uuid, void 0 !== o.name && (s.name = o.name), void 0 !== o.mapping && (s.mapping = i(o.mapping, Lr)), void 0 !== o.offset && s.offset.fromArray(o.offset), void 0 !== o.repeat && s.repeat.fromArray(o.repeat), void 0 !== o.center && s.center.fromArray(o.center), void 0 !== o.rotation && (s.rotation = o.rotation), void 0 !== o.wrap && (s.wrapS = i(o.wrap[0], Pr), s.wrapT = i(o.wrap[1], Pr)), void 0 !== o.minFilter && (s.minFilter = i(o.minFilter, Cr)), void 0 !== o.magFilter && (s.magFilter = i(o.magFilter, Cr)), void 0 !== o.anisotropy && (s.anisotropy = o.anisotropy), void 0 !== o.flipY && (s.flipY = o.flipY), n[o.uuid] = s
        }
      return n
    },
    parseObject: function() {
      var t = new D;
      return function(e, i, n) {
        var r;

        function a(t) {
          return void 0 === i[t] && console.warn("THREE.ObjectLoader: Undefined geometry", t), i[t]
        }

        function o(t) {
          if (void 0 !== t) {
            if (Array.isArray(t)) {
              for (var e = [], i = 0, r = t.length; i < r; i++) {
                var a = t[i];
                void 0 === n[a] && console.warn("THREE.ObjectLoader: Undefined material", a), e.push(n[a])
              }
              return e
            }
            return void 0 === n[t] && console.warn("THREE.ObjectLoader: Undefined material", t), n[t]
          }
        }
        switch (e.type) {
          case "Scene":
            r = new wi, void 0 !== e.background && Number.isInteger(e.background) && (r.background = new Ct(e.background)), void 0 !== e.fog && ("Fog" === e.fog.type ? r.fog = new _i(e.fog.color, e.fog.near, e.fog.far) : "FogExp2" === e.fog.type && (r.fog = new bi(e.fog.color, e.fog.density)));
            break;
          case "PerspectiveCamera":
            r = new gi(e.fov, e.aspect, e.near, e.far), void 0 !== e.focus && (r.focus = e.focus), void 0 !== e.zoom && (r.zoom = e.zoom), void 0 !== e.filmGauge && (r.filmGauge = e.filmGauge), void 0 !== e.filmOffset && (r.filmOffset = e.filmOffset), void 0 !== e.view && (r.view = Object.assign({}, e.view));
            break;
          case "OrthographicCamera":
            r = new pe(e.left, e.right, e.top, e.bottom, e.near, e.far);
            break;
          case "AmbientLight":
            r = new er(e.color, e.intensity);
            break;
          case "DirectionalLight":
            r = new tr(e.color, e.intensity);
            break;
          case "PointLight":
            r = new Kn(e.color, e.intensity, e.distance, e.decay);
            break;
          case "RectAreaLight":
            r = new ir(e.color, e.intensity, e.width, e.height);
            break;
          case "SpotLight":
            r = new Qn(e.color, e.intensity, e.distance, e.angle, e.penumbra, e.decay);
            break;
          case "HemisphereLight":
            r = new Yn(e.color, e.groundColor, e.intensity);
            break;
          case "SkinnedMesh":
            console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");
          case "Mesh":
            var s = a(e.geometry),
              c = o(e.material);
            r = s.bones && s.bones.length > 0 ? new Li(s, c) : new qe(s, c);
            break;
          case "LOD":
            r = new Si;
            break;
          case "Line":
            r = new Ci(a(e.geometry), o(e.material), e.mode);
            break;
          case "LineLoop":
            r = new Ui(a(e.geometry), o(e.material));
            break;
          case "LineSegments":
            r = new Ii(a(e.geometry), o(e.material));
            break;
          case "PointCloud":
          case "Points":
            r = new Oi(a(e.geometry), o(e.material));
            break;
          case "Sprite":
            r = new Ti(o(e.material));
            break;
          case "Group":
            r = new Ni;
            break;
          default:
            r = new le
        }
        if (r.uuid = e.uuid, void 0 !== e.name && (r.name = e.name), void 0 !== e.matrix ? (t.fromArray(e.matrix), t.decompose(r.position, r.quaternion, r.scale)) : (void 0 !== e.position && r.position.fromArray(e.position), void 0 !== e.rotation && r.rotation.fromArray(e.rotation), void 0 !== e.quaternion && r.quaternion.fromArray(e.quaternion), void 0 !== e.scale && r.scale.fromArray(e.scale)), void 0 !== e.castShadow && (r.castShadow = e.castShadow), void 0 !== e.receiveShadow && (r.receiveShadow = e.receiveShadow), e.shadow && (void 0 !== e.shadow.bias && (r.shadow.bias = e.shadow.bias), void 0 !== e.shadow.radius && (r.shadow.radius = e.shadow.radius), void 0 !== e.shadow.mapSize && r.shadow.mapSize.fromArray(e.shadow.mapSize), void 0 !== e.shadow.camera && (r.shadow.camera = this.parseObject(e.shadow.camera))), void 0 !== e.visible && (r.visible = e.visible), void 0 !== e.userData && (r.userData = e.userData), void 0 !== e.children)
          for (var h = e.children, l = 0; l < h.length; l++) r.add(this.parseObject(h[l], i, n));
        if ("LOD" === e.type)
          for (var u = e.levels, p = 0; p < u.length; p++) {
            var d = u[p],
              f = r.getObjectByProperty("uuid", d.object);
            void 0 !== f && r.addLevel(f, d.distance)
          }
        return r
      }
    }()
  });
  var Lr = {
      UVMapping: 300,
      CubeReflectionMapping: 301,
      CubeRefractionMapping: 302,
      EquirectangularReflectionMapping: 303,
      EquirectangularRefractionMapping: 304,
      SphericalReflectionMapping: 305,
      CubeUVReflectionMapping: 306,
      CubeUVRefractionMapping: 307
    },
    Pr = {
      RepeatWrapping: v,
      ClampToEdgeWrapping: y,
      MirroredRepeatWrapping: x
    },
    Cr = {
      NearestFilter: b,
      NearestMipMapNearestFilter: 1004,
      NearestMipMapLinearFilter: 1005,
      LinearFilter: _,
      LinearMipMapNearestFilter: 1007,
      LinearMipMapLinearFilter: w
    };

  function Ir(t, e, i, n, r) {
    var a = .5 * (n - e),
      o = .5 * (r - i),
      s = t * t;
    return (2 * i - 2 * n + a + o) * (t * s) + (-3 * i + 3 * n - 2 * a - o) * s + a * t + i
  }

  function Ur(t, e, i, n) {
    return function(t, e) {
      var i = 1 - t;
      return i * i * e
    }(t, e) + function(t, e) {
      return 2 * (1 - t) * t * e
    }(t, i) + function(t, e) {
      return t * t * e
    }(t, n)
  }

  function Dr(t, e, i, n, r) {
    return function(t, e) {
      var i = 1 - t;
      return i * i * i * e
    }(t, e) + function(t, e) {
      var i = 1 - t;
      return 3 * i * i * t * e
    }(t, i) + function(t, e) {
      return 3 * (1 - t) * t * t * e
    }(t, n) + function(t, e) {
      return t * t * t * e
    }(t, r)
  }

  function Or() {
    this.arcLengthDivisions = 200
  }

  function Nr(t, e) {
    Or.call(this), this.v1 = t, this.v2 = e
  }

  function Br() {
    Or.call(this), this.curves = [], this.autoClose = !1
  }

  function Fr(t, e, i, n, r, a, o, s) {
    Or.call(this), this.aX = t, this.aY = e, this.xRadius = i, this.yRadius = n, this.aStartAngle = r, this.aEndAngle = a, this.aClockwise = o, this.aRotation = s || 0
  }

  function zr(t) {
    Or.call(this), this.points = void 0 === t ? [] : t
  }

  function Gr(t, e, i, n) {
    Or.call(this), this.v0 = t, this.v1 = e, this.v2 = i, this.v3 = n
  }

  function Hr(t, e, i) {
    Or.call(this), this.v0 = t, this.v1 = e, this.v2 = i
  }
  Object.assign(Or.prototype, {
    getPoint: function() {
      return console.warn("THREE.Curve: .getPoint() not implemented."), null
    },
    getPointAt: function(t, e) {
      var i = this.getUtoTmapping(t);
      return this.getPoint(i, e)
    },
    getPoints: function(t) {
      void 0 === t && (t = 5);
      for (var e = [], i = 0; i <= t; i++) e.push(this.getPoint(i / t));
      return e
    },
    getSpacedPoints: function(t) {
      void 0 === t && (t = 5);
      for (var e = [], i = 0; i <= t; i++) e.push(this.getPointAt(i / t));
      return e
    },
    getLength: function() {
      var t = this.getLengths();
      return t[t.length - 1]
    },
    getLengths: function(t) {
      if (void 0 === t && (t = this.arcLengthDivisions), this.cacheArcLengths && this.cacheArcLengths.length === t + 1 && !this.needsUpdate) return this.cacheArcLengths;
      this.needsUpdate = !1;
      var e, i, n = [],
        r = this.getPoint(0),
        a = 0;
      for (n.push(0), i = 1; i <= t; i++) a += (e = this.getPoint(i / t)).distanceTo(r), n.push(a), r = e;
      return this.cacheArcLengths = n, n
    },
    updateArcLengths: function() {
      this.needsUpdate = !0, this.getLengths()
    },
    getUtoTmapping: function(t, e) {
      var i, n = this.getLengths(),
        r = 0,
        a = n.length;
      i = e || t * n[a - 1];
      for (var o, s = 0, c = a - 1; s <= c;)
        if ((o = n[r = Math.floor(s + (c - s) / 2)] - i) < 0) s = r + 1;
        else {
          if (!(o > 0)) {
            c = r;
            break
          }
          c = r - 1
        } if (n[r = c] === i) return r / (a - 1);
      var h = n[r];
      return (r + (i - h) / (n[r + 1] - h)) / (a - 1)
    },
    getTangent: function(t) {
      var e = t - 1e-4,
        i = t + 1e-4;
      e < 0 && (e = 0), i > 1 && (i = 1);
      var n = this.getPoint(e);
      return this.getPoint(i).clone().sub(n).normalize()
    },
    getTangentAt: function(t) {
      var e = this.getUtoTmapping(t);
      return this.getTangent(e)
    },
    computeFrenetFrames: function(t, e) {
      var i, n, r, a = new N,
        o = [],
        s = [],
        c = [],
        h = new N,
        l = new D;
      for (i = 0; i <= t; i++) n = i / t, o[i] = this.getTangentAt(n), o[i].normalize();
      s[0] = new N, c[0] = new N;
      var u = Number.MAX_VALUE,
        p = Math.abs(o[0].x),
        d = Math.abs(o[0].y),
        f = Math.abs(o[0].z);
      for (p <= u && (u = p, a.set(1, 0, 0)), d <= u && (u = d, a.set(0, 1, 0)), f <= u && a.set(0, 0, 1), h.crossVectors(o[0], a).normalize(), s[0].crossVectors(o[0], h), c[0].crossVectors(o[0], s[0]), i = 1; i <= t; i++) s[i] = s[i - 1].clone(), c[i] = c[i - 1].clone(), h.crossVectors(o[i - 1], o[i]), h.length() > Number.EPSILON && (h.normalize(), r = Math.acos(I.clamp(o[i - 1].dot(o[i]), -1, 1)), s[i].applyMatrix4(l.makeRotationAxis(h, r))), c[i].crossVectors(o[i], s[i]);
      if (!0 === e)
        for (r = Math.acos(I.clamp(s[0].dot(s[t]), -1, 1)), r /= t, o[0].dot(h.crossVectors(s[0], s[t])) > 0 && (r = -r), i = 1; i <= t; i++) s[i].applyMatrix4(l.makeRotationAxis(o[i], r * i)), c[i].crossVectors(o[i], s[i]);
      return {
        tangents: o,
        normals: s,
        binormals: c
      }
    }
  }), Nr.prototype = Object.create(Or.prototype), Nr.prototype.constructor = Nr, Nr.prototype.isLineCurve = !0, Nr.prototype.getPoint = function(t, e) {
    var i = e || new U;
    return 1 === t ? i.copy(this.v2) : (i.copy(this.v2).sub(this.v1), i.multiplyScalar(t).add(this.v1)), i
  }, Nr.prototype.getPointAt = function(t, e) {
    return this.getPoint(t, e)
  }, Nr.prototype.getTangent = function() {
    return this.v2.clone().sub(this.v1).normalize()
  }, Br.prototype = Object.assign(Object.create(Or.prototype), {
    constructor: Br,
    add: function(t) {
      this.curves.push(t)
    },
    closePath: function() {
      var t = this.curves[0].getPoint(0),
        e = this.curves[this.curves.length - 1].getPoint(1);
      t.equals(e) || this.curves.push(new Nr(e, t))
    },
    getPoint: function(t) {
      for (var e = t * this.getLength(), i = this.getCurveLengths(), n = 0; n < i.length;) {
        if (i[n] >= e) {
          var r = i[n] - e,
            a = this.curves[n],
            o = a.getLength(),
            s = 0 === o ? 0 : 1 - r / o;
          return a.getPointAt(s)
        }
        n++
      }
      return null
    },
    getLength: function() {
      var t = this.getCurveLengths();
      return t[t.length - 1]
    },
    updateArcLengths: function() {
      this.needsUpdate = !0, this.cacheLengths = null, this.getCurveLengths()
    },
    getCurveLengths: function() {
      if (this.cacheLengths && this.cacheLengths.length === this.curves.length) return this.cacheLengths;
      for (var t = [], e = 0, i = 0, n = this.curves.length; i < n; i++) e += this.curves[i].getLength(), t.push(e);
      return this.cacheLengths = t, t
    },
    getSpacedPoints: function(t) {
      void 0 === t && (t = 40);
      for (var e = [], i = 0; i <= t; i++) e.push(this.getPoint(i / t));
      return this.autoClose && e.push(e[0]), e
    },
    getPoints: function(t) {
      t = t || 12;
      for (var e, i = [], n = 0, r = this.curves; n < r.length; n++)
        for (var a = r[n], o = a && a.isEllipseCurve ? 2 * t : a && a.isLineCurve ? 1 : a && a.isSplineCurve ? t * a.points.length : t, s = a.getPoints(o), c = 0; c < s.length; c++) {
          var h = s[c];
          e && e.equals(h) || (i.push(h), e = h)
        }
      return this.autoClose && i.length > 1 && !i[i.length - 1].equals(i[0]) && i.push(i[0]), i
    }
  }), Fr.prototype = Object.create(Or.prototype), Fr.prototype.constructor = Fr, Fr.prototype.isEllipseCurve = !0, Fr.prototype.getPoint = function(t, e) {
    for (var i = e || new U, n = 2 * Math.PI, r = this.aEndAngle - this.aStartAngle, a = Math.abs(r) < Number.EPSILON; r < 0;) r += n;
    for (; r > n;) r -= n;
    r < Number.EPSILON && (r = a ? 0 : n), !0 !== this.aClockwise || a || (r === n ? r = -n : r -= n);
    var o = this.aStartAngle + t * r,
      s = this.aX + this.xRadius * Math.cos(o),
      c = this.aY + this.yRadius * Math.sin(o);
    if (0 !== this.aRotation) {
      var h = Math.cos(this.aRotation),
        l = Math.sin(this.aRotation),
        u = s - this.aX,
        p = c - this.aY;
      s = u * h - p * l + this.aX, c = u * l + p * h + this.aY
    }
    return i.set(s, c)
  }, zr.prototype = Object.create(Or.prototype), zr.prototype.constructor = zr, zr.prototype.isSplineCurve = !0, zr.prototype.getPoint = function(t, e) {
    var i = e || new U,
      n = this.points,
      r = (n.length - 1) * t,
      a = Math.floor(r),
      o = r - a,
      s = n[0 === a ? a : a - 1],
      c = n[a],
      h = n[a > n.length - 2 ? n.length - 1 : a + 1],
      l = n[a > n.length - 3 ? n.length - 1 : a + 2];
    return i.set(Ir(o, s.x, c.x, h.x, l.x), Ir(o, s.y, c.y, h.y, l.y)), i
  }, Gr.prototype = Object.create(Or.prototype), Gr.prototype.constructor = Gr, Gr.prototype.isCubicBezierCurve = !0, Gr.prototype.getPoint = function(t, e) {
    var i = e || new U,
      n = this.v0,
      r = this.v1,
      a = this.v2,
      o = this.v3;
    return i.set(Dr(t, n.x, r.x, a.x, o.x), Dr(t, n.y, r.y, a.y, o.y)), i
  }, Hr.prototype = Object.create(Or.prototype), Hr.prototype.constructor = Hr, Hr.prototype.isQuadraticBezierCurve = !0, Hr.prototype.getPoint = function(t, e) {
    var i = e || new U,
      n = this.v0,
      r = this.v1,
      a = this.v2;
    return i.set(Ur(t, n.x, r.x, a.x), Ur(t, n.y, r.y, a.y)), i
  };
  var Vr, kr = Object.assign(Object.create(Br.prototype), {
    fromPoints: function(t) {
      this.moveTo(t[0].x, t[0].y);
      for (var e = 1, i = t.length; e < i; e++) this.lineTo(t[e].x, t[e].y)
    },
    moveTo: function(t, e) {
      this.currentPoint.set(t, e)
    },
    lineTo: function(t, e) {
      var i = new Nr(this.currentPoint.clone(), new U(t, e));
      this.curves.push(i), this.currentPoint.set(t, e)
    },
    quadraticCurveTo: function(t, e, i, n) {
      var r = new Hr(this.currentPoint.clone(), new U(t, e), new U(i, n));
      this.curves.push(r), this.currentPoint.set(i, n)
    },
    bezierCurveTo: function(t, e, i, n, r, a) {
      var o = new Gr(this.currentPoint.clone(), new U(t, e), new U(i, n), new U(r, a));
      this.curves.push(o), this.currentPoint.set(r, a)
    },
    splineThru: function(t) {
      var e = new zr([this.currentPoint.clone()].concat(t));
      this.curves.push(e), this.currentPoint.copy(t[t.length - 1])
    },
    arc: function(t, e, i, n, r, a) {
      var o = this.currentPoint.x,
        s = this.currentPoint.y;
      this.absarc(t + o, e + s, i, n, r, a)
    },
    absarc: function(t, e, i, n, r, a) {
      this.absellipse(t, e, i, i, n, r, a)
    },
    ellipse: function(t, e, i, n, r, a, o, s) {
      var c = this.currentPoint.x,
        h = this.currentPoint.y;
      this.absellipse(t + c, e + h, i, n, r, a, o, s)
    },
    absellipse: function(t, e, i, n, r, a, o, s) {
      var c = new Fr(t, e, i, n, r, a, o, s);
      if (this.curves.length > 0) {
        var h = c.getPoint(0);
        h.equals(this.currentPoint) || this.lineTo(h.x, h.y)
      }
      this.curves.push(c);
      var l = c.getPoint(1);
      this.currentPoint.copy(l)
    }
  });

  function jr(t) {
    Br.call(this), this.currentPoint = new U, t && this.fromPoints(t)
  }

  function Wr() {
    jr.apply(this, arguments), this.holes = []
  }

  function Xr() {
    this.subPaths = [], this.currentPath = null
  }

  function qr(t) {
    this.data = t
  }

  function Yr(t) {
    this.manager = void 0 !== t ? t : zn
  }
  jr.prototype = kr, kr.constructor = jr, Wr.prototype = Object.assign(Object.create(kr), {
    constructor: Wr,
    getPointsHoles: function(t) {
      for (var e = [], i = 0, n = this.holes.length; i < n; i++) e[i] = this.holes[i].getPoints(t);
      return e
    },
    extractAllPoints: function(t) {
      return {
        shape: this.getPoints(t),
        holes: this.getPointsHoles(t)
      }
    },
    extractPoints: function(t) {
      return this.extractAllPoints(t)
    }
  }), Object.assign(Xr.prototype, {
    moveTo: function(t, e) {
      this.currentPath = new jr, this.subPaths.push(this.currentPath), this.currentPath.moveTo(t, e)
    },
    lineTo: function(t, e) {
      this.currentPath.lineTo(t, e)
    },
    quadraticCurveTo: function(t, e, i, n) {
      this.currentPath.quadraticCurveTo(t, e, i, n)
    },
    bezierCurveTo: function(t, e, i, n, r, a) {
      this.currentPath.bezierCurveTo(t, e, i, n, r, a)
    },
    splineThru: function(t) {
      this.currentPath.splineThru(t)
    },
    toShapes: function(t, e) {
      function i(t) {
        for (var e = [], i = 0, n = t.length; i < n; i++) {
          var r = t[i],
            a = new Wr;
          a.curves = r.curves, e.push(a)
        }
        return e
      }

      function n(t, e) {
        for (var i = e.length, n = !1, r = i - 1, a = 0; a < i; r = a++) {
          var o = e[r],
            s = e[a],
            c = s.x - o.x,
            h = s.y - o.y;
          if (Math.abs(h) > Number.EPSILON) {
            if (h < 0 && (o = e[a], c = -c, s = e[r], h = -h), t.y < o.y || t.y > s.y) continue;
            if (t.y === o.y) {
              if (t.x === o.x) return !0
            } else {
              var l = h * (t.x - o.x) - c * (t.y - o.y);
              if (0 === l) return !0;
              if (l < 0) continue;
              n = !n
            }
          } else {
            if (t.y !== o.y) continue;
            if (s.x <= t.x && t.x <= o.x || o.x <= t.x && t.x <= s.x) return !0
          }
        }
        return n
      }
      var r = on.isClockWise,
        a = this.subPaths;
      if (0 === a.length) return [];
      if (!0 === e) return i(a);
      var o, s, c, h = [];
      if (1 === a.length) return s = a[0], (c = new Wr).curves = s.curves, h.push(c), h;
      var l = !r(a[0].getPoints());
      l = t ? !l : l;
      var u, p, d = [],
        f = [],
        m = [],
        g = 0;
      f[g] = void 0, m[g] = [];
      for (var v = 0, y = a.length; v < y; v++) o = r(u = (s = a[v]).getPoints()), (o = t ? !o : o) ? (!l && f[g] && g++, f[g] = {
        s: new Wr,
        p: u
      }, f[g].s.curves = s.curves, l && g++, m[g] = []) : m[g].push({
        h: s,
        p: u[0]
      });
      if (!f[0]) return i(a);
      if (f.length > 1) {
        for (var x = !1, b = [], _ = 0, w = f.length; _ < w; _++) d[_] = [];
        for (_ = 0, w = f.length; _ < w; _++)
          for (var M = m[_], E = 0; E < M.length; E++) {
            for (var T = M[E], S = !0, A = 0; A < f.length; A++) n(T.p, f[A].p) && (_ !== A && b.push({
              froms: _,
              tos: A,
              hole: E
            }), S ? (S = !1, d[A].push(T)) : x = !0);
            S && d[_].push(T)
          }
        b.length > 0 && (x || (m = d))
      }
      v = 0;
      for (var R = f.length; v < R; v++) {
        c = f[v].s, h.push(c);
        for (var L = 0, P = (p = m[v]).length; L < P; L++) c.holes.push(p[L].h)
      }
      return h
    }
  }), Object.assign(qr.prototype, {
    isFont: !0,
    generateShapes: function(t, e, i) {
      function n(t, e, n, a) {
        var o = r.glyphs[t] || r.glyphs["?"];
        if (o) {
          var s, c, h, l, u, p, d, f, m, g, v, y = new Xr,
            x = [];
          if (o.o)
            for (var b = o._cachedOutline || (o._cachedOutline = o.o.split(" ")), _ = 0, w = b.length; _ < w;) switch (b[_++]) {
              case "m":
                s = b[_++] * e + n, c = b[_++] * e + a, y.moveTo(s, c);
                break;
              case "l":
                s = b[_++] * e + n, c = b[_++] * e + a, y.lineTo(s, c);
                break;
              case "q":
                if (h = b[_++] * e + n, l = b[_++] * e + a, d = b[_++] * e + n, f = b[_++] * e + a, y.quadraticCurveTo(d, f, h, l), v = x[x.length - 1]) {
                  u = v.x, p = v.y;
                  for (var M = 1; M <= i; M++) Ur(E = M / i, u, d, h), Ur(E, p, f, l)
                }
                break;
              case "b":
                if (h = b[_++] * e + n, l = b[_++] * e + a, d = b[_++] * e + n, f = b[_++] * e + a, m = b[_++] * e + n, g = b[_++] * e + a, y.bezierCurveTo(d, f, m, g, h, l), v = x[x.length - 1])
                  for (u = v.x, p = v.y, M = 1; M <= i; M++) {
                    var E;
                    Dr(E = M / i, u, d, m, h), Dr(E, p, f, g, l)
                  }
            }
          return {
            offsetX: o.ha * e,
            path: y
          }
        }
      }
      void 0 === e && (e = 100), void 0 === i && (i = 4);
      for (var r = this.data, a = function(t) {
          for (var i = String(t).split(""), a = e / r.resolution, o = (r.boundingBox.yMax - r.boundingBox.yMin + r.underlineThickness) * a, s = 0, c = 0, h = [], l = 0; l < i.length; l++) {
            var u = i[l];
            if ("\n" === u) s = 0, c -= o;
            else {
              var p = n(u, a, s, c);
              s += p.offsetX, h.push(p.path)
            }
          }
          return h
        }(t), o = [], s = 0, c = a.length; s < c; s++) Array.prototype.push.apply(o, a[s].toShapes());
      return o
    }
  }), Object.assign(Yr.prototype, {
    load: function(t, e, i, n) {
      var r;
      new Hn(this.manager);
      try {
        r = JSON.parse(t)
      } catch (e) {
        console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."), r = JSON.parse(t.substring(65, t.length - 2))
      }
      var a = this.parse(r);
      e && e(a)
    },
    parse: function(t) {
      return new qr(t)
    },
    setPath: function(t) {
      return this.path = t, this
    }
  });
  var Zr, Jr, Qr, Kr, $r, ta, ea, ia, na, ra, aa, oa, sa, ca, ha, la, ua = {
    getContext: function() {
      return void 0 === Vr && (Vr = new(window.AudioContext || window.webkitAudioContext)), Vr
    },
    setContext: function(t) {
      Vr = t
    }
  };

  function pa(t) {
    this.manager = void 0 !== t ? t : zn
  }

  function da() {
    this.type = "StereoCamera", this.aspect = 1, this.eyeSep = .064, this.cameraL = new gi, this.cameraL.layers.enable(1), this.cameraL.matrixAutoUpdate = !1, this.cameraR = new gi, this.cameraR.layers.enable(2), this.cameraR.matrixAutoUpdate = !1
  }

  function fa(t, e, i) {
    le.call(this), this.type = "CubeCamera";
    var n = new gi(90, 1, t, e);
    n.up.set(0, -1, 0), n.lookAt(new N(1, 0, 0)), this.add(n);
    var r = new gi(90, 1, t, e);
    r.up.set(0, -1, 0), r.lookAt(new N(-1, 0, 0)), this.add(r);
    var a = new gi(90, 1, t, e);
    a.up.set(0, 0, 1), a.lookAt(new N(0, 1, 0)), this.add(a);
    var o = new gi(90, 1, t, e);
    o.up.set(0, 0, -1), o.lookAt(new N(0, -1, 0)), this.add(o);
    var s = new gi(90, 1, t, e);
    s.up.set(0, -1, 0), s.lookAt(new N(0, 0, 1)), this.add(s);
    var c = new gi(90, 1, t, e);
    c.up.set(0, -1, 0), c.lookAt(new N(0, 0, -1)), this.add(c);
    var h = {
      format: S,
      magFilter: _,
      minFilter: _
    };
    this.renderTarget = new V(i, i, h), this.renderTarget.texture.name = "CubeCamera", this.update = function(t, e) {
      null === this.parent && this.updateMatrixWorld();
      var i = this.renderTarget,
        h = i.texture.generateMipmaps;
      i.texture.generateMipmaps = !1, i.activeCubeFace = 0, t.render(e, n, i), i.activeCubeFace = 1, t.render(e, r, i), i.activeCubeFace = 2, t.render(e, a, i), i.activeCubeFace = 3, t.render(e, o, i), i.activeCubeFace = 4, t.render(e, s, i), i.texture.generateMipmaps = h, i.activeCubeFace = 5, t.render(e, c, i), t.setRenderTarget(null)
    }, this.clear = function(t, e, i, n) {
      for (var r = this.renderTarget, a = 0; a < 6; a++) r.activeCubeFace = a, t.setRenderTarget(r), t.clear(e, i, n);
      t.setRenderTarget(null)
    }
  }

  function ma() {
    le.call(this), this.type = "AudioListener", this.context = ua.getContext(), this.gain = this.context.createGain(), this.gain.connect(this.context.destination), this.filter = null
  }

  function ga(t) {
    le.call(this), this.type = "Audio", this.context = t.context, this.gain = this.context.createGain(), this.gain.connect(t.getInput()), this.autoplay = !1, this.buffer = null, this.loop = !1, this.startTime = 0, this.offset = 0, this.playbackRate = 1, this.isPlaying = !1, this.hasPlaybackControl = !0, this.sourceType = "empty", this.filters = []
  }

  function va(t) {
    ga.call(this, t), this.panner = this.context.createPanner(), this.panner.connect(this.gain)
  }

  function ya(t, e) {
    this.analyser = t.context.createAnalyser(), this.analyser.fftSize = void 0 !== e ? e : 2048, this.data = new Uint8Array(this.analyser.frequencyBinCount), t.getOutput().connect(this.analyser)
  }

  function xa(t, e, i) {
    this.binding = t, this.valueSize = i;
    var n, r = Float64Array;
    switch (e) {
      case "quaternion":
        n = this._slerp;
        break;
      case "string":
      case "bool":
        r = Array, n = this._select;
        break;
      default:
        n = this._lerp
    }
    this.buffer = new r(4 * i), this._mixBufferRegion = n, this.cumulativeWeight = 0, this.useCount = 0, this.referenceCount = 0
  }

  function ba(t, e, i) {
    var n = i || _a.parseTrackName(e);
    this._targetGroup = t, this._bindings = t.subscribe_(e, n)
  }

  function _a(t, e, i) {
    this.path = e, this.parsedPath = i || _a.parseTrackName(e), this.node = _a.findNode(t, this.parsedPath.nodeName) || t, this.rootNode = t
  }

  function wa() {
    this.uuid = I.generateUUID(), this._objects = Array.prototype.slice.call(arguments), this.nCachedObjects_ = 0;
    var t = {};
    this._indicesByUUID = t;
    for (var e = 0, i = arguments.length; e !== i; ++e) t[arguments[e].uuid] = e;
    this._paths = [], this._parsedPaths = [], this._bindings = [], this._bindingsIndicesByPath = {};
    var n = this;
    this.stats = {
      objects: {
        get total() {
          return n._objects.length
        },
        get inUse() {
          return this.total - n.nCachedObjects_
        }
      },
      get bindingsPerObject() {
        return n._bindings.length
      }
    }
  }

  function Ma(t, e, i) {
    this._mixer = t, this._clip = e, this._localRoot = i || null;
    for (var n = e.tracks, r = n.length, a = new Array(r), o = {
        endingStart: P,
        endingEnd: P
      }, s = 0; s !== r; ++s) {
      var c = n[s].createInterpolant(null);
      a[s] = c, c.settings = o
    }
    this._interpolantSettings = o, this._interpolants = a, this._propertyBindings = new Array(r), this._cacheIndex = null, this._byClipCacheIndex = null, this._timeScaleInterpolant = null, this._weightInterpolant = null, this.loop = 2201, this._loopCount = -1, this._startTime = null, this.time = 0, this.timeScale = 1, this._effectiveTimeScale = 1, this.weight = 1, this._effectiveWeight = 1, this.repetitions = 1 / 0, this.paused = !1, this.enabled = !0, this.clampWhenFinished = !1, this.zeroSlopeAtStart = !0, this.zeroSlopeAtEnd = !0
  }

  function Ea(t) {
    this._root = t, this._initMemoryManager(), this._accuIndex = 0, this.time = 0, this.timeScale = 1
  }

  function Ta(t) {
    "string" == typeof t && (console.warn("THREE.Uniform: Type parameter is no longer needed."), t = arguments[1]), this.value = t
  }

  function Sa() {
    Be.call(this), this.type = "InstancedBufferGeometry", this.maxInstancedCount = void 0
  }

  function Aa(t, e, i, n) {
    this.uuid = I.generateUUID(), this.data = t, this.itemSize = e, this.offset = i, this.normalized = !0 === n
  }

  function Ra(t, e) {
    this.uuid = I.generateUUID(), this.array = t, this.stride = e, this.count = void 0 !== t ? t.length / e : 0, this.dynamic = !1, this.updateRange = {
      offset: 0,
      count: -1
    }, this.onUploadCallback = function() {}, this.version = 0
  }

  function La(t, e, i) {
    Ra.call(this, t, e), this.meshPerAttribute = i || 1
  }

  function Pa(t, e, i) {
    ve.call(this, t, e), this.meshPerAttribute = i || 1
  }

  function Ca(t, e, i, n) {
    this.ray = new je(t, e), this.near = i || 0, this.far = n || 1 / 0, this.params = {
      Mesh: {},
      Line: {},
      LOD: {},
      Points: {
        threshold: 1
      },
      Sprite: {}
    }, Object.defineProperties(this.params, {
      PointCloud: {
        get: function() {
          return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."), this.Points
        }
      }
    })
  }

  function Ia(t, e) {
    return t.distance - e.distance
  }

  function Ua(t, e, i, n) {
    if (!1 !== t.visible && (t.raycast(e, i), !0 === n))
      for (var r = t.children, a = 0, o = r.length; a < o; a++) Ua(r[a], e, i, !0)
  }

  function Da(t) {
    this.autoStart = void 0 === t || t, this.startTime = 0, this.oldTime = 0, this.elapsedTime = 0, this.running = !1
  }

  function Oa(t, e, i) {
    return this.radius = void 0 !== t ? t : 1, this.phi = void 0 !== e ? e : 0, this.theta = void 0 !== i ? i : 0, this
  }

  function Na(t, e, i) {
    return this.radius = void 0 !== t ? t : 1, this.theta = void 0 !== e ? e : 0, this.y = void 0 !== i ? i : 0, this
  }

  function Ba(t) {
    le.call(this), this.material = t, this.render = function() {}
  }

  function Fa(t, e, i, n) {
    this.object = t, this.size = void 0 !== e ? e : 1;
    var r = void 0 !== i ? i : 16711680,
      a = void 0 !== n ? n : 1,
      o = 0,
      s = this.object.geometry;
    s && s.isGeometry ? o = 3 * s.faces.length : s && s.isBufferGeometry && (o = s.attributes.normal.count);
    var c = new Be,
      h = new Te(2 * o * 3, 3);
    c.addAttribute("position", h), Ii.call(this, c, new Pi({
      color: r,
      linewidth: a
    })), this.matrixAutoUpdate = !1, this.update()
  }

  function za(t, e) {
    le.call(this), this.light = t, this.light.updateMatrixWorld(), this.matrix = t.matrixWorld, this.matrixAutoUpdate = !1, this.color = e;
    for (var i = new Be, n = [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, -1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, -1, 1], r = 0, a = 1; r < 32; r++, a++) {
      var o = r / 32 * Math.PI * 2,
        s = a / 32 * Math.PI * 2;
      n.push(Math.cos(o), Math.sin(o), 1, Math.cos(s), Math.sin(s), 1)
    }
    i.addAttribute("position", new Te(n, 3));
    var c = new Pi({
      fog: !1
    });
    this.cone = new Ii(i, c), this.add(this.cone), this.update()
  }

  function Ga(t) {
    for (var e = function t(e) {
        var i = [];
        e && e.isBone && i.push(e);
        for (var n = 0; n < e.children.length; n++) i.push.apply(i, t(e.children[n]));
        return i
      }(t), i = new Be, n = [], r = [], a = new Ct(0, 0, 1), o = new Ct(0, 1, 0), s = 0; s < e.length; s++) {
      var c = e[s];
      c.parent && c.parent.isBone && (n.push(0, 0, 0), n.push(0, 0, 0), r.push(a.r, a.g, a.b), r.push(o.r, o.g, o.b))
    }
    i.addAttribute("position", new Te(n, 3)), i.addAttribute("color", new Te(r, 3));
    var h = new Pi({
      vertexColors: 2,
      depthTest: !1,
      depthWrite: !1,
      transparent: !0
    });
    Ii.call(this, i, h), this.root = t, this.bones = e, this.matrix = t.matrixWorld, this.matrixAutoUpdate = !1
  }

  function Ha(t, e, i) {
    this.light = t, this.light.updateMatrixWorld(), this.color = i;
    var n = new pn(e, 4, 2),
      r = new Ve({
        wireframe: !0,
        fog: !1
      });
    qe.call(this, n, r), this.matrix = this.light.matrixWorld, this.matrixAutoUpdate = !1, this.update()
  }

  function Va(t, e) {
    le.call(this), this.light = t, this.light.updateMatrixWorld(), this.matrix = t.matrixWorld, this.matrixAutoUpdate = !1, this.color = e;
    var i = new Pi({
        fog: !1
      }),
      n = new Be;
    n.addAttribute("position", new ve(new Float32Array(15), 3)), this.line = new Ci(n, i), this.add(this.line), this.update()
  }

  function ka(t, e, i) {
    le.call(this), this.light = t, this.light.updateMatrixWorld(), this.matrix = t.matrixWorld, this.matrixAutoUpdate = !1, this.color = i;
    var n = new Yi(e);
    n.rotateY(.5 * Math.PI), this.material = new Ve({
      wireframe: !0,
      fog: !1
    }), void 0 === this.color && (this.material.vertexColors = 2);
    var r = n.getAttribute("position"),
      a = new Float32Array(3 * r.count);
    n.addAttribute("color", new ve(a, 3)), this.add(new qe(n, this.material)), this.update()
  }

  function ja(t, e, i, n) {
    t = t || 10, e = e || 10, i = new Ct(void 0 !== i ? i : 4473924), n = new Ct(void 0 !== n ? n : 8947848);
    for (var r = e / 2, a = t / e, o = t / 2, s = [], c = [], h = 0, l = 0, u = -o; h <= e; h++, u += a) {
      s.push(-o, 0, u, o, 0, u), s.push(u, 0, -o, u, 0, o);
      var p = h === r ? i : n;
      p.toArray(c, l), l += 3, p.toArray(c, l), l += 3, p.toArray(c, l), l += 3, p.toArray(c, l), l += 3
    }
    var d = new Be;
    d.addAttribute("position", new Te(s, 3)), d.addAttribute("color", new Te(c, 3));
    var f = new Pi({
      vertexColors: 2
    });
    Ii.call(this, d, f)
  }

  function Wa(t, e, i, n, r, a) {
    t = t || 10, e = e || 16, i = i || 8, n = n || 64, r = new Ct(void 0 !== r ? r : 4473924), a = new Ct(void 0 !== a ? a : 8947848);
    var o, s, c, h, l, u, p, d = [],
      f = [];
    for (h = 0; h <= e; h++) c = h / e * (2 * Math.PI), o = Math.sin(c) * t, s = Math.cos(c) * t, d.push(0, 0, 0), d.push(o, 0, s), p = 1 & h ? r : a, f.push(p.r, p.g, p.b), f.push(p.r, p.g, p.b);
    for (h = 0; h <= i; h++)
      for (p = 1 & h ? r : a, u = t - t / i * h, l = 0; l < n; l++) c = l / n * (2 * Math.PI), o = Math.sin(c) * u, s = Math.cos(c) * u, d.push(o, 0, s), f.push(p.r, p.g, p.b), c = (l + 1) / n * (2 * Math.PI), o = Math.sin(c) * u, s = Math.cos(c) * u, d.push(o, 0, s), f.push(p.r, p.g, p.b);
    var m = new Be;
    m.addAttribute("position", new Te(d, 3)), m.addAttribute("color", new Te(f, 3));
    var g = new Pi({
      vertexColors: 2
    });
    Ii.call(this, m, g)
  }

  function Xa(t, e, i, n) {
    this.object = t, this.size = void 0 !== e ? e : 1;
    var r = void 0 !== i ? i : 16776960,
      a = void 0 !== n ? n : 1,
      o = 0,
      s = this.object.geometry;
    s && s.isGeometry ? o = s.faces.length : console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");
    var c = new Be,
      h = new Te(2 * o * 3, 3);
    c.addAttribute("position", h), Ii.call(this, c, new Pi({
      color: r,
      linewidth: a
    })), this.matrixAutoUpdate = !1, this.update()
  }

  function qa(t, e, i) {
    le.call(this), this.light = t, this.light.updateMatrixWorld(), this.matrix = t.matrixWorld, this.matrixAutoUpdate = !1, this.color = i, void 0 === e && (e = 1);
    var n = new Be;
    n.addAttribute("position", new Te([-e, e, 0, e, e, 0, e, -e, 0, -e, -e, 0, -e, e, 0], 3));
    var r = new Pi({
      fog: !1
    });
    this.lightPlane = new Ci(n, r), this.add(this.lightPlane), (n = new Be).addAttribute("position", new Te([0, 0, 0, 0, 0, 1], 3)), this.targetLine = new Ci(n, r), this.add(this.targetLine), this.update()
  }

  function Ya(t) {
    var e = new Be,
      i = new Pi({
        color: 16777215,
        vertexColors: 1
      }),
      n = [],
      r = [],
      a = {},
      o = new Ct(16755200),
      s = new Ct(16711680),
      c = new Ct(43775),
      h = new Ct(16777215),
      l = new Ct(3355443);

    function u(t, e, i) {
      p(t, i), p(e, i)
    }

    function p(t, e) {
      n.push(0, 0, 0), r.push(e.r, e.g, e.b), void 0 === a[t] && (a[t] = []), a[t].push(n.length / 3 - 1)
    }
    u("n1", "n2", o), u("n2", "n4", o), u("n4", "n3", o), u("n3", "n1", o), u("f1", "f2", o), u("f2", "f4", o), u("f4", "f3", o), u("f3", "f1", o), u("n1", "f1", o), u("n2", "f2", o), u("n3", "f3", o), u("n4", "f4", o), u("p", "n1", s), u("p", "n2", s), u("p", "n3", s), u("p", "n4", s), u("u1", "u2", c), u("u2", "u3", c), u("u3", "u1", c), u("c", "t", h), u("p", "c", l), u("cn1", "cn2", l), u("cn3", "cn4", l), u("cf1", "cf2", l), u("cf3", "cf4", l), e.addAttribute("position", new Te(n, 3)), e.addAttribute("color", new Te(r, 3)), Ii.call(this, e, i), this.camera = t, this.camera.updateProjectionMatrix && this.camera.updateProjectionMatrix(), this.matrix = t.matrixWorld, this.matrixAutoUpdate = !1, this.pointMap = a, this.update()
  }

  function Za(t, e) {
    this.object = t, void 0 === e && (e = 16776960);
    var i = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]),
      n = new Float32Array(24),
      r = new Be;
    r.setIndex(new ve(i, 1)), r.addAttribute("position", new ve(n, 3)), Ii.call(this, r, new Pi({
      color: e
    })), this.matrixAutoUpdate = !1, this.update()
  }

  function Ja(t, e) {
    this.type = "Box3Helper", this.box = t;
    var i = void 0 !== e ? e : 16776960,
      n = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]),
      r = new Be;
    r.setIndex(new ve(n, 1)), r.addAttribute("position", new Te([1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1], 3)), Ii.call(this, r, new Pi({
      color: i
    })), this.geometry.computeBoundingSphere()
  }

  function Qa(t, e, i) {
    this.type = "PlaneHelper", this.plane = t, this.size = void 0 === e ? 1 : e;
    var n = void 0 !== i ? i : 16776960,
      r = new Be;
    r.addAttribute("position", new Te([1, -1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0], 3)), r.computeBoundingSphere(), Ci.call(this, r, new Pi({
      color: n
    }));
    var a = new Be;
    a.addAttribute("position", new Te([1, 1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, 1, -1, 1], 3)), a.computeBoundingSphere(), this.add(new qe(a, new Ve({
      color: n,
      opacity: .2,
      transparent: !0,
      depthWrite: !1
    })))
  }

  function Ka(t, e, i, n, r, a) {
    le.call(this), void 0 === n && (n = 16776960), void 0 === i && (i = 1), void 0 === r && (r = .2 * i), void 0 === a && (a = .2 * r), void 0 === sa && ((sa = new Be).addAttribute("position", new Te([0, 0, 0, 0, 1, 0], 3)), (ca = new _n(0, .5, 1, 5, 1)).translate(0, -.5, 0)), this.position.copy(e), this.line = new Ci(sa, new Pi({
      color: n
    })), this.line.matrixAutoUpdate = !1, this.add(this.line), this.cone = new qe(ca, new Ve({
      color: n
    })), this.cone.matrixAutoUpdate = !1, this.add(this.cone), this.setDirection(t), this.setLength(i, r, a)
  }

  function $a(t) {
    var e = [0, 0, 0, t = t || 1, 0, 0, 0, 0, 0, 0, t, 0, 0, 0, 0, 0, 0, t],
      i = new Be;
    i.addAttribute("position", new Te(e, 3)), i.addAttribute("color", new Te([1, 0, 0, 1, .6, 0, 0, 1, 0, .6, 1, 0, 0, 0, 1, 0, .6, 1], 3));
    var n = new Pi({
      vertexColors: 2
    });
    Ii.call(this, i, n)
  }

  function to() {
    var t = 0,
      e = 0,
      i = 0,
      n = 0;

    function r(r, a, o, s) {
      t = r, e = o, i = -3 * r + 3 * a - 2 * o - s, n = 2 * r - 2 * a + o + s
    }
    return {
      initCatmullRom: function(t, e, i, n, a) {
        r(e, i, a * (i - t), a * (n - e))
      },
      initNonuniformCatmullRom: function(t, e, i, n, a, o, s) {
        var c = (e - t) / a - (i - t) / (a + o) + (i - e) / o,
          h = (i - e) / o - (n - e) / (o + s) + (n - i) / s;
        r(e, i, c *= o, h *= o)
      },
      calc: function(r) {
        var a = r * r;
        return t + e * r + i * a + n * (a * r)
      }
    }
  }
  Object.assign(pa.prototype, {
      load: function(t, e, i, n) {
        var r = new Hn(this.manager);
        r.setResponseType("arraybuffer"), r.load(t, (function(t) {
          ua.getContext().decodeAudioData(t, (function(t) {
            e(t)
          }))
        }), i, n)
      }
    }), Object.assign(da.prototype, {
      update: (na = new D, ra = new D, function(t) {
        if (Zr !== this || Jr !== t.focus || Qr !== t.fov || Kr !== t.aspect * this.aspect || $r !== t.near || ta !== t.far || ea !== t.zoom || ia !== this.eyeSep) {
          Zr = this, Jr = t.focus, Qr = t.fov, Kr = t.aspect * this.aspect, $r = t.near, ta = t.far, ea = t.zoom;
          var e, i, n = t.projectionMatrix.clone(),
            r = (ia = this.eyeSep / 2) * $r / Jr,
            a = $r * Math.tan(I.DEG2RAD * Qr * .5) / ea;
          ra.elements[12] = -ia, na.elements[12] = ia, e = -a * Kr + r, i = a * Kr + r, n.elements[0] = 2 * $r / (i - e), n.elements[8] = (i + e) / (i - e), this.cameraL.projectionMatrix.copy(n), e = -a * Kr - r, i = a * Kr - r, n.elements[0] = 2 * $r / (i - e), n.elements[8] = (i + e) / (i - e), this.cameraR.projectionMatrix.copy(n)
        }
        this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(ra), this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(na)
      })
    }), fa.prototype = Object.create(le.prototype), fa.prototype.constructor = fa, ma.prototype = Object.assign(Object.create(le.prototype), {
      constructor: ma,
      getInput: function() {
        return this.gain
      },
      removeFilter: function() {
        null !== this.filter && (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination), this.gain.connect(this.context.destination), this.filter = null)
      },
      getFilter: function() {
        return this.filter
      },
      setFilter: function(t) {
        null !== this.filter ? (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination)) : this.gain.disconnect(this.context.destination), this.filter = t, this.gain.connect(this.filter), this.filter.connect(this.context.destination)
      },
      getMasterVolume: function() {
        return this.gain.gain.value
      },
      setMasterVolume: function(t) {
        this.gain.gain.value = t
      },
      updateMatrixWorld: function() {
        var t = new N,
          e = new O,
          i = new N,
          n = new N;
        return function(r) {
          le.prototype.updateMatrixWorld.call(this, r);
          var a = this.context.listener,
            o = this.up;
          this.matrixWorld.decompose(t, e, i), n.set(0, 0, -1).applyQuaternion(e), a.positionX ? (a.positionX.setValueAtTime(t.x, this.context.currentTime), a.positionY.setValueAtTime(t.y, this.context.currentTime), a.positionZ.setValueAtTime(t.z, this.context.currentTime), a.forwardX.setValueAtTime(n.x, this.context.currentTime), a.forwardY.setValueAtTime(n.y, this.context.currentTime), a.forwardZ.setValueAtTime(n.z, this.context.currentTime), a.upX.setValueAtTime(o.x, this.context.currentTime), a.upY.setValueAtTime(o.y, this.context.currentTime), a.upZ.setValueAtTime(o.z, this.context.currentTime)) : (a.setPosition(t.x, t.y, t.z), a.setOrientation(n.x, n.y, n.z, o.x, o.y, o.z))
        }
      }()
    }), ga.prototype = Object.assign(Object.create(le.prototype), {
      constructor: ga,
      getOutput: function() {
        return this.gain
      },
      setNodeSource: function(t) {
        return this.hasPlaybackControl = !1, this.sourceType = "audioNode", this.source = t, this.connect(), this
      },
      setBuffer: function(t) {
        return this.buffer = t, this.sourceType = "buffer", this.autoplay && this.play(), this
      },
      play: function() {
        if (!0 !== this.isPlaying) {
          if (!1 !== this.hasPlaybackControl) {
            var t = this.context.createBufferSource();
            return t.buffer = this.buffer, t.loop = this.loop, t.onended = this.onEnded.bind(this), t.playbackRate.setValueAtTime(this.playbackRate, this.startTime), this.startTime = this.context.currentTime, t.start(this.startTime, this.offset), this.isPlaying = !0, this.source = t, this.connect()
          }
          console.warn("THREE.Audio: this Audio has no playback control.")
        } else console.warn("THREE.Audio: Audio is already playing.")
      },
      pause: function() {
        if (!1 !== this.hasPlaybackControl) return !0 === this.isPlaying && (this.source.stop(), this.offset += (this.context.currentTime - this.startTime) * this.playbackRate, this.isPlaying = !1), this;
        console.warn("THREE.Audio: this Audio has no playback control.")
      },
      stop: function() {
        if (!1 !== this.hasPlaybackControl) return this.source.stop(), this.offset = 0, this.isPlaying = !1, this;
        console.warn("THREE.Audio: this Audio has no playback control.")
      },
      connect: function() {
        if (this.filters.length > 0) {
          this.source.connect(this.filters[0]);
          for (var t = 1, e = this.filters.length; t < e; t++) this.filters[t - 1].connect(this.filters[t]);
          this.filters[this.filters.length - 1].connect(this.getOutput())
        } else this.source.connect(this.getOutput());
        return this
      },
      disconnect: function() {
        if (this.filters.length > 0) {
          this.source.disconnect(this.filters[0]);
          for (var t = 1, e = this.filters.length; t < e; t++) this.filters[t - 1].disconnect(this.filters[t]);
          this.filters[this.filters.length - 1].disconnect(this.getOutput())
        } else this.source.disconnect(this.getOutput());
        return this
      },
      getFilters: function() {
        return this.filters
      },
      setFilters: function(t) {
        return t || (t = []), !0 === this.isPlaying ? (this.disconnect(), this.filters = t, this.connect()) : this.filters = t, this
      },
      getFilter: function() {
        return this.getFilters()[0]
      },
      setFilter: function(t) {
        return this.setFilters(t ? [t] : [])
      },
      setPlaybackRate: function(t) {
        if (!1 !== this.hasPlaybackControl) return this.playbackRate = t, !0 === this.isPlaying && this.source.playbackRate.setValueAtTime(this.playbackRate, this.context.currentTime), this;
        console.warn("THREE.Audio: this Audio has no playback control.")
      },
      getPlaybackRate: function() {
        return this.playbackRate
      },
      onEnded: function() {
        this.isPlaying = !1
      },
      getLoop: function() {
        return !1 === this.hasPlaybackControl ? (console.warn("THREE.Audio: this Audio has no playback control."), !1) : this.loop
      },
      setLoop: function(t) {
        if (!1 !== this.hasPlaybackControl) return this.loop = t, !0 === this.isPlaying && (this.source.loop = this.loop), this;
        console.warn("THREE.Audio: this Audio has no playback control.")
      },
      getVolume: function() {
        return this.gain.gain.value
      },
      setVolume: function(t) {
        return this.gain.gain.value = t, this
      }
    }), va.prototype = Object.assign(Object.create(ga.prototype), {
      constructor: va,
      getOutput: function() {
        return this.panner
      },
      getRefDistance: function() {
        return this.panner.refDistance
      },
      setRefDistance: function(t) {
        this.panner.refDistance = t
      },
      getRolloffFactor: function() {
        return this.panner.rolloffFactor
      },
      setRolloffFactor: function(t) {
        this.panner.rolloffFactor = t
      },
      getDistanceModel: function() {
        return this.panner.distanceModel
      },
      setDistanceModel: function(t) {
        this.panner.distanceModel = t
      },
      getMaxDistance: function() {
        return this.panner.maxDistance
      },
      setMaxDistance: function(t) {
        this.panner.maxDistance = t
      },
      updateMatrixWorld: function() {
        var t = new N;
        return function(e) {
          le.prototype.updateMatrixWorld.call(this, e), t.setFromMatrixPosition(this.matrixWorld), this.panner.setPosition(t.x, t.y, t.z)
        }
      }()
    }), Object.assign(ya.prototype, {
      getFrequencyData: function() {
        return this.analyser.getByteFrequencyData(this.data), this.data
      },
      getAverageFrequency: function() {
        for (var t = 0, e = this.getFrequencyData(), i = 0; i < e.length; i++) t += e[i];
        return t / e.length
      }
    }), Object.assign(xa.prototype, {
      accumulate: function(t, e) {
        var i = this.buffer,
          n = this.valueSize,
          r = t * n + n,
          a = this.cumulativeWeight;
        if (0 === a) {
          for (var o = 0; o !== n; ++o) i[r + o] = i[o];
          a = e
        } else {
          var s = e / (a += e);
          this._mixBufferRegion(i, r, 0, s, n)
        }
        this.cumulativeWeight = a
      },
      apply: function(t) {
        var e = this.valueSize,
          i = this.buffer,
          n = t * e + e,
          r = this.cumulativeWeight,
          a = this.binding;
        if (this.cumulativeWeight = 0, r < 1) {
          var o = 3 * e;
          this._mixBufferRegion(i, n, o, 1 - r, e)
        }
        for (var s = e, c = e + e; s !== c; ++s)
          if (i[s] !== i[s + e]) {
            a.setValue(i, n);
            break
          }
      },
      saveOriginalState: function() {
        var t = this.binding,
          e = this.buffer,
          i = this.valueSize,
          n = 3 * i;
        t.getValue(e, n);
        for (var r = i, a = n; r !== a; ++r) e[r] = e[n + r % i];
        this.cumulativeWeight = 0
      },
      restoreOriginalState: function() {
        var t = 3 * this.valueSize;
        this.binding.setValue(this.buffer, t)
      },
      _select: function(t, e, i, n, r) {
        if (n >= .5)
          for (var a = 0; a !== r; ++a) t[e + a] = t[i + a]
      },
      _slerp: function(t, e, i, n) {
        O.slerpFlat(t, e, t, e, t, i, n)
      },
      _lerp: function(t, e, i, n, r) {
        for (var a = 1 - n, o = 0; o !== r; ++o) {
          var s = e + o;
          t[s] = t[s] * a + t[i + o] * n
        }
      }
    }), Object.assign(ba.prototype, {
      getValue: function(t, e) {
        this.bind();
        var i = this._targetGroup.nCachedObjects_,
          n = this._bindings[i];
        void 0 !== n && n.getValue(t, e)
      },
      setValue: function(t, e) {
        for (var i = this._bindings, n = this._targetGroup.nCachedObjects_, r = i.length; n !== r; ++n) i[n].setValue(t, e)
      },
      bind: function() {
        for (var t = this._bindings, e = this._targetGroup.nCachedObjects_, i = t.length; e !== i; ++e) t[e].bind()
      },
      unbind: function() {
        for (var t = this._bindings, e = this._targetGroup.nCachedObjects_, i = t.length; e !== i; ++e) t[e].unbind()
      }
    }), Object.assign(_a, {
      Composite: ba,
      create: function(t, e, i) {
        return t && t.isAnimationObjectGroup ? new _a.Composite(t, e, i) : new _a(t, e, i)
      },
      sanitizeNodeName: function(t) {
        return t.replace(/\s/g, "_").replace(/[^\w-]/g, "")
      },
      parseTrackName: (aa = new RegExp("^" + /((?:[\w-]+[\/:])*)/.source + /([\w-\.]+)?/.source + /(?:\.([\w-]+)(?:\[(.+)\])?)?/.source + /\.([\w-]+)(?:\[(.+)\])?/.source + "$"), oa = ["material", "materials", "bones"], function(t) {
        var e = aa.exec(t);
        if (!e) throw new Error("PropertyBinding: Cannot parse trackName: " + t);
        var i = {
            nodeName: e[2],
            objectName: e[3],
            objectIndex: e[4],
            propertyName: e[5],
            propertyIndex: e[6]
          },
          n = i.nodeName && i.nodeName.lastIndexOf(".");
        if (void 0 !== n && -1 !== n) {
          var r = i.nodeName.substring(n + 1); - 1 !== oa.indexOf(r) && (i.nodeName = i.nodeName.substring(0, n), i.objectName = r)
        }
        if (null === i.propertyName || 0 === i.propertyName.length) throw new Error("PropertyBinding: can not parse propertyName from trackName: " + t);
        return i
      }),
      findNode: function(t, e) {
        if (!e || "" === e || "root" === e || "." === e || -1 === e || e === t.name || e === t.uuid) return t;
        if (t.skeleton) {
          var i = function(t) {
            for (var i = 0; i < t.bones.length; i++) {
              var n = t.bones[i];
              if (n.name === e) return n
            }
            return null
          }(t.skeleton);
          if (i) return i
        }
        if (t.children) {
          var n = function t(i) {
            for (var n = 0; n < i.length; n++) {
              var r = i[n];
              if (r.name === e || r.uuid === e) return r;
              var a = t(r.children);
              if (a) return a
            }
            return null
          }(t.children);
          if (n) return n
        }
        return null
      }
    }), Object.assign(_a.prototype, {
      _getValue_unavailable: function() {},
      _setValue_unavailable: function() {},
      BindingType: {
        Direct: 0,
        EntireArray: 1,
        ArrayElement: 2,
        HasFromToArray: 3
      },
      Versioning: {
        None: 0,
        NeedsUpdate: 1,
        MatrixWorldNeedsUpdate: 2
      },
      GetterByBindingType: [function(t, e) {
        t[e] = this.node[this.propertyName]
      }, function(t, e) {
        for (var i = this.resolvedProperty, n = 0, r = i.length; n !== r; ++n) t[e++] = i[n]
      }, function(t, e) {
        t[e] = this.resolvedProperty[this.propertyIndex]
      }, function(t, e) {
        this.resolvedProperty.toArray(t, e)
      }],
      SetterByBindingTypeAndVersioning: [
        [function(t, e) {
          this.targetObject[this.propertyName] = t[e]
        }, function(t, e) {
          this.targetObject[this.propertyName] = t[e], this.targetObject.needsUpdate = !0
        }, function(t, e) {
          this.targetObject[this.propertyName] = t[e], this.targetObject.matrixWorldNeedsUpdate = !0
        }],
        [function(t, e) {
          for (var i = this.resolvedProperty, n = 0, r = i.length; n !== r; ++n) i[n] = t[e++]
        }, function(t, e) {
          for (var i = this.resolvedProperty, n = 0, r = i.length; n !== r; ++n) i[n] = t[e++];
          this.targetObject.needsUpdate = !0
        }, function(t, e) {
          for (var i = this.resolvedProperty, n = 0, r = i.length; n !== r; ++n) i[n] = t[e++];
          this.targetObject.matrixWorldNeedsUpdate = !0
        }],
        [function(t, e) {
          this.resolvedProperty[this.propertyIndex] = t[e]
        }, function(t, e) {
          this.resolvedProperty[this.propertyIndex] = t[e], this.targetObject.needsUpdate = !0
        }, function(t, e) {
          this.resolvedProperty[this.propertyIndex] = t[e], this.targetObject.matrixWorldNeedsUpdate = !0
        }],
        [function(t, e) {
          this.resolvedProperty.fromArray(t, e)
        }, function(t, e) {
          this.resolvedProperty.fromArray(t, e), this.targetObject.needsUpdate = !0
        }, function(t, e) {
          this.resolvedProperty.fromArray(t, e), this.targetObject.matrixWorldNeedsUpdate = !0
        }]
      ],
      getValue: function(t, e) {
        this.bind(), this.getValue(t, e)
      },
      setValue: function(t, e) {
        this.bind(), this.setValue(t, e)
      },
      bind: function() {
        var t = this.node,
          e = this.parsedPath,
          i = e.objectName,
          n = e.propertyName,
          r = e.propertyIndex;
        if (t || (t = _a.findNode(this.rootNode, e.nodeName) || this.rootNode, this.node = t), this.getValue = this._getValue_unavailable, this.setValue = this._setValue_unavailable, t) {
          if (i) {
            var a = e.objectIndex;
            switch (i) {
              case "materials":
                if (!t.material) return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.", this);
                if (!t.material.materials) return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.", this);
                t = t.material.materials;
                break;
              case "bones":
                if (!t.skeleton) return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.", this);
                t = t.skeleton.bones;
                for (var o = 0; o < t.length; o++)
                  if (t[o].name === a) {
                    a = o;
                    break
                  } break;
              default:
                if (void 0 === t[i]) return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.", this);
                t = t[i]
            }
            if (void 0 !== a) {
              if (void 0 === t[a]) return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.", this, t);
              t = t[a]
            }
          }
          var s = t[n];
          if (void 0 !== s) {
            var c = this.Versioning.None;
            void 0 !== t.needsUpdate ? (c = this.Versioning.NeedsUpdate, this.targetObject = t) : void 0 !== t.matrixWorldNeedsUpdate && (c = this.Versioning.MatrixWorldNeedsUpdate, this.targetObject = t);
            var h = this.BindingType.Direct;
            if (void 0 !== r) {
              if ("morphTargetInfluences" === n) {
                if (!t.geometry) return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.", this);
                if (t.geometry.isBufferGeometry) {
                  if (!t.geometry.morphAttributes) return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.", this);
                  for (o = 0; o < this.node.geometry.morphAttributes.position.length; o++)
                    if (t.geometry.morphAttributes.position[o].name === r) {
                      r = o;
                      break
                    }
                } else {
                  if (!t.geometry.morphTargets) return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.", this);
                  for (o = 0; o < this.node.geometry.morphTargets.length; o++)
                    if (t.geometry.morphTargets[o].name === r) {
                      r = o;
                      break
                    }
                }
              }
              h = this.BindingType.ArrayElement, this.resolvedProperty = s, this.propertyIndex = r
            } else void 0 !== s.fromArray && void 0 !== s.toArray ? (h = this.BindingType.HasFromToArray, this.resolvedProperty = s) : Array.isArray(s) ? (h = this.BindingType.EntireArray, this.resolvedProperty = s) : this.propertyName = n;
            this.getValue = this.GetterByBindingType[h], this.setValue = this.SetterByBindingTypeAndVersioning[h][c]
          } else {
            var l = e.nodeName;
            console.error("THREE.PropertyBinding: Trying to update property for track: " + l + "." + n + " but it wasn't found.", t)
          }
        } else console.error("THREE.PropertyBinding: Trying to update node for track: " + this.path + " but it wasn't found.")
      },
      unbind: function() {
        this.node = null, this.getValue = this._getValue_unbound, this.setValue = this._setValue_unbound
      }
    }), //!\ DECLARE ALIAS AFTER assign prototype !
    Object.assign(_a.prototype, {
      _getValue_unbound: _a.prototype.getValue,
      _setValue_unbound: _a.prototype.setValue
    }), Object.assign(wa.prototype, {
      isAnimationObjectGroup: !0,
      add: function() {
        for (var t = this._objects, e = t.length, i = this.nCachedObjects_, n = this._indicesByUUID, r = this._paths, a = this._parsedPaths, o = this._bindings, s = o.length, c = 0, h = arguments.length; c !== h; ++c) {
          var l = arguments[c],
            u = l.uuid,
            p = n[u],
            d = void 0;
          if (void 0 === p) {
            p = e++, n[u] = p, t.push(l);
            for (var f = 0, m = s; f !== m; ++f) o[f].push(new _a(l, r[f], a[f]))
          } else if (p < i) {
            d = t[p];
            var g = --i,
              v = t[g];
            for (n[v.uuid] = p, t[p] = v, n[u] = g, t[g] = l, f = 0, m = s; f !== m; ++f) {
              var y = o[f],
                x = y[g],
                b = y[p];
              y[p] = x, void 0 === b && (b = new _a(l, r[f], a[f])), y[g] = b
            }
          } else t[p] !== d && console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")
        }
        this.nCachedObjects_ = i
      },
      remove: function() {
        for (var t = this._objects, e = this.nCachedObjects_, i = this._indicesByUUID, n = this._bindings, r = n.length, a = 0, o = arguments.length; a !== o; ++a) {
          var s = arguments[a],
            c = s.uuid,
            h = i[c];
          if (void 0 !== h && h >= e) {
            var l = e++,
              u = t[l];
            i[u.uuid] = h, t[h] = u, i[c] = l, t[l] = s;
            for (var p = 0, d = r; p !== d; ++p) {
              var f = n[p],
                m = f[l],
                g = f[h];
              f[h] = m, f[l] = g
            }
          }
        }
        this.nCachedObjects_ = e
      },
      uncache: function() {
        for (var t = this._objects, e = t.length, i = this.nCachedObjects_, n = this._indicesByUUID, r = this._bindings, a = r.length, o = 0, s = arguments.length; o !== s; ++o) {
          var c = arguments[o].uuid,
            h = n[c];
          if (void 0 !== h)
            if (delete n[c], h < i) {
              var l = --i,
                u = t[l],
                p = t[v = --e];
              n[u.uuid] = h, t[h] = u, n[p.uuid] = l, t[l] = p, t.pop();
              for (var d = 0, f = a; d !== f; ++d) {
                var m = (y = r[d])[l],
                  g = y[v];
                y[h] = m, y[l] = g, y.pop()
              }
            } else {
              var v;
              for (n[(p = t[v = --e]).uuid] = h, t[h] = p, t.pop(), d = 0, f = a; d !== f; ++d) {
                var y;
                (y = r[d])[h] = y[v], y.pop()
              }
            }
        }
        this.nCachedObjects_ = i
      },
      subscribe_: function(t, e) {
        var i = this._bindingsIndicesByPath,
          n = i[t],
          r = this._bindings;
        if (void 0 !== n) return r[n];
        var a = this._paths,
          o = this._parsedPaths,
          s = this._objects,
          c = s.length,
          h = this.nCachedObjects_,
          l = new Array(c);
        n = r.length, i[t] = n, a.push(t), o.push(e), r.push(l);
        for (var u = h, p = s.length; u !== p; ++u) {
          var d = s[u];
          l[u] = new _a(d, t, e)
        }
        return l
      },
      unsubscribe_: function(t) {
        var e = this._bindingsIndicesByPath,
          i = e[t];
        if (void 0 !== i) {
          var n = this._paths,
            r = this._parsedPaths,
            a = this._bindings,
            o = a.length - 1,
            s = a[o];
          e[t[o]] = i, a[i] = s, a.pop(), r[i] = r[o], r.pop(), n[i] = n[o], n.pop()
        }
      }
    }), Object.assign(Ma.prototype, {
      play: function() {
        return this._mixer._activateAction(this), this
      },
      stop: function() {
        return this._mixer._deactivateAction(this), this.reset()
      },
      reset: function() {
        return this.paused = !1, this.enabled = !0, this.time = 0, this._loopCount = -1, this._startTime = null, this.stopFading().stopWarping()
      },
      isRunning: function() {
        return this.enabled && !this.paused && 0 !== this.timeScale && null === this._startTime && this._mixer._isActiveAction(this)
      },
      isScheduled: function() {
        return this._mixer._isActiveAction(this)
      },
      startAt: function(t) {
        return this._startTime = t, this
      },
      setLoop: function(t, e) {
        return this.loop = t, this.repetitions = e, this
      },
      setEffectiveWeight: function(t) {
        return this.weight = t, this._effectiveWeight = this.enabled ? t : 0, this.stopFading()
      },
      getEffectiveWeight: function() {
        return this._effectiveWeight
      },
      fadeIn: function(t) {
        return this._scheduleFading(t, 0, 1)
      },
      fadeOut: function(t) {
        return this._scheduleFading(t, 1, 0)
      },
      crossFadeFrom: function(t, e, i) {
        if (t.fadeOut(e), this.fadeIn(e), i) {
          var n = this._clip.duration,
            r = t._clip.duration,
            a = r / n,
            o = n / r;
          t.warp(1, a, e), this.warp(o, 1, e)
        }
        return this
      },
      crossFadeTo: function(t, e, i) {
        return t.crossFadeFrom(this, e, i)
      },
      stopFading: function() {
        var t = this._weightInterpolant;
        return null !== t && (this._weightInterpolant = null, this._mixer._takeBackControlInterpolant(t)), this
      },
      setEffectiveTimeScale: function(t) {
        return this.timeScale = t, this._effectiveTimeScale = this.paused ? 0 : t, this.stopWarping()
      },
      getEffectiveTimeScale: function() {
        return this._effectiveTimeScale
      },
      setDuration: function(t) {
        return this.timeScale = this._clip.duration / t, this.stopWarping()
      },
      syncWith: function(t) {
        return this.time = t.time, this.timeScale = t.timeScale, this.stopWarping()
      },
      halt: function(t) {
        return this.warp(this._effectiveTimeScale, 0, t)
      },
      warp: function(t, e, i) {
        var n = this._mixer,
          r = n.time,
          a = this._timeScaleInterpolant,
          o = this.timeScale;
        null === a && (a = n._lendControlInterpolant(), this._timeScaleInterpolant = a);
        var s = a.parameterPositions,
          c = a.sampleValues;
        return s[0] = r, s[1] = r + i, c[0] = t / o, c[1] = e / o, this
      },
      stopWarping: function() {
        var t = this._timeScaleInterpolant;
        return null !== t && (this._timeScaleInterpolant = null, this._mixer._takeBackControlInterpolant(t)), this
      },
      getMixer: function() {
        return this._mixer
      },
      getClip: function() {
        return this._clip
      },
      getRoot: function() {
        return this._localRoot || this._mixer._root
      },
      _update: function(t, e, i, n) {
        if (this.enabled) {
          var r = this._startTime;
          if (null !== r) {
            var a = (t - r) * i;
            if (a < 0 || 0 === i) return;
            this._startTime = null, e = i * a
          }
          e *= this._updateTimeScale(t);
          var o = this._updateTime(e),
            s = this._updateWeight(t);
          if (s > 0)
            for (var c = this._interpolants, h = this._propertyBindings, l = 0, u = c.length; l !== u; ++l) c[l].evaluate(o), h[l].accumulate(n, s)
        } else this._updateWeight(t)
      },
      _updateWeight: function(t) {
        var e = 0;
        if (this.enabled) {
          e = this.weight;
          var i = this._weightInterpolant;
          if (null !== i) {
            var n = i.evaluate(t)[0];
            e *= n, t > i.parameterPositions[1] && (this.stopFading(), 0 === n && (this.enabled = !1))
          }
        }
        return this._effectiveWeight = e, e
      },
      _updateTimeScale: function(t) {
        var e = 0;
        if (!this.paused) {
          e = this.timeScale;
          var i = this._timeScaleInterpolant;
          null !== i && (e *= i.evaluate(t)[0], t > i.parameterPositions[1] && (this.stopWarping(), 0 === e ? this.paused = !0 : this.timeScale = e))
        }
        return this._effectiveTimeScale = e, e
      },
      _updateTime: function(t) {
        var e = this.time + t;
        if (0 === t) return e;
        var i = this._clip.duration,
          n = this.loop,
          r = this._loopCount;
        if (2200 === n) {
          -1 === r && (this._loopCount = 0, this._setEndings(!0, !0, !1));
          t: {
            if (e >= i) e = i;
            else {
              if (!(e < 0)) break t;
              e = 0
            }
            this.clampWhenFinished ? this.paused = !0 : this.enabled = !1,
            this._mixer.dispatchEvent({
              type: "finished",
              action: this,
              direction: t < 0 ? -1 : 1
            })
          }
        } else {
          var a = 2202 === n;
          if (-1 === r && (t >= 0 ? (r = 0, this._setEndings(!0, 0 === this.repetitions, a)) : this._setEndings(0 === this.repetitions, !0, a)), e >= i || e < 0) {
            var o = Math.floor(e / i);
            e -= i * o, r += Math.abs(o);
            var s = this.repetitions - r;
            if (s < 0) this.clampWhenFinished ? this.paused = !0 : this.enabled = !1, e = t > 0 ? i : 0, this._mixer.dispatchEvent({
              type: "finished",
              action: this,
              direction: t > 0 ? 1 : -1
            });
            else {
              if (0 === s) {
                var c = t < 0;
                this._setEndings(c, !c, a)
              } else this._setEndings(!1, !1, a);
              this._loopCount = r, this._mixer.dispatchEvent({
                type: "loop",
                action: this,
                loopDelta: o
              })
            }
          }
          if (a && 1 == (1 & r)) return this.time = e, i - e
        }
        return this.time = e, e
      },
      _setEndings: function(t, e, i) {
        var n = this._interpolantSettings;
        i ? (n.endingStart = 2401, n.endingEnd = 2401) : (n.endingStart = t ? this.zeroSlopeAtStart ? 2401 : P : 2402, n.endingEnd = e ? this.zeroSlopeAtEnd ? 2401 : P : 2402)
      },
      _scheduleFading: function(t, e, i) {
        var n = this._mixer,
          r = n.time,
          a = this._weightInterpolant;
        null === a && (a = n._lendControlInterpolant(), this._weightInterpolant = a);
        var o = a.parameterPositions,
          s = a.sampleValues;
        return o[0] = r, s[0] = e, o[1] = r + t, s[1] = i, this
      }
    }), Object.assign(Ea.prototype, i.prototype, {
      _bindAction: function(t, e) {
        var i = t._localRoot || this._root,
          n = t._clip.tracks,
          r = n.length,
          a = t._propertyBindings,
          o = t._interpolants,
          s = i.uuid,
          c = this._bindingsByRootAndName,
          h = c[s];
        void 0 === h && (h = {}, c[s] = h);
        for (var l = 0; l !== r; ++l) {
          var u = n[l],
            p = u.name,
            d = h[p];
          if (void 0 !== d) a[l] = d;
          else {
            if (void 0 !== (d = a[l])) {
              null === d._cacheIndex && (++d.referenceCount, this._addInactiveBinding(d, s, p));
              continue
            }
            var f = e && e._propertyBindings[l].binding.parsedPath;
            ++(d = new xa(_a.create(i, p, f), u.ValueTypeName, u.getValueSize())).referenceCount, this._addInactiveBinding(d, s, p), a[l] = d
          }
          o[l].resultBuffer = d.buffer
        }
      },
      _activateAction: function(t) {
        if (!this._isActiveAction(t)) {
          if (null === t._cacheIndex) {
            var e = (t._localRoot || this._root).uuid,
              i = t._clip.uuid,
              n = this._actionsByClip[i];
            this._bindAction(t, n && n.knownActions[0]), this._addInactiveAction(t, i, e)
          }
          for (var r = t._propertyBindings, a = 0, o = r.length; a !== o; ++a) {
            var s = r[a];
            0 == s.useCount++ && (this._lendBinding(s), s.saveOriginalState())
          }
          this._lendAction(t)
        }
      },
      _deactivateAction: function(t) {
        if (this._isActiveAction(t)) {
          for (var e = t._propertyBindings, i = 0, n = e.length; i !== n; ++i) {
            var r = e[i];
            0 == --r.useCount && (r.restoreOriginalState(), this._takeBackBinding(r))
          }
          this._takeBackAction(t)
        }
      },
      _initMemoryManager: function() {
        this._actions = [], this._nActiveActions = 0, this._actionsByClip = {}, this._bindings = [], this._nActiveBindings = 0, this._bindingsByRootAndName = {}, this._controlInterpolants = [], this._nActiveControlInterpolants = 0;
        var t = this;
        this.stats = {
          actions: {
            get total() {
              return t._actions.length
            },
            get inUse() {
              return t._nActiveActions
            }
          },
          bindings: {
            get total() {
              return t._bindings.length
            },
            get inUse() {
              return t._nActiveBindings
            }
          },
          controlInterpolants: {
            get total() {
              return t._controlInterpolants.length
            },
            get inUse() {
              return t._nActiveControlInterpolants
            }
          }
        }
      },
      _isActiveAction: function(t) {
        var e = t._cacheIndex;
        return null !== e && e < this._nActiveActions
      },
      _addInactiveAction: function(t, e, i) {
        var n = this._actions,
          r = this._actionsByClip,
          a = r[e];
        if (void 0 === a) a = {
          knownActions: [t],
          actionByRoot: {}
        }, t._byClipCacheIndex = 0, r[e] = a;
        else {
          var o = a.knownActions;
          t._byClipCacheIndex = o.length, o.push(t)
        }
        t._cacheIndex = n.length, n.push(t), a.actionByRoot[i] = t
      },
      _removeInactiveAction: function(t) {
        var e = this._actions,
          i = e[e.length - 1],
          n = t._cacheIndex;
        i._cacheIndex = n, e[n] = i, e.pop(), t._cacheIndex = null;
        var r = t._clip.uuid,
          a = this._actionsByClip,
          o = a[r],
          s = o.knownActions,
          c = s[s.length - 1],
          h = t._byClipCacheIndex;
        c._byClipCacheIndex = h, s[h] = c, s.pop(), t._byClipCacheIndex = null, delete o.actionByRoot[(t._localRoot || this._root).uuid], 0 === s.length && delete a[r], this._removeInactiveBindingsForAction(t)
      },
      _removeInactiveBindingsForAction: function(t) {
        for (var e = t._propertyBindings, i = 0, n = e.length; i !== n; ++i) {
          var r = e[i];
          0 == --r.referenceCount && this._removeInactiveBinding(r)
        }
      },
      _lendAction: function(t) {
        var e = this._actions,
          i = t._cacheIndex,
          n = this._nActiveActions++,
          r = e[n];
        t._cacheIndex = n, e[n] = t, r._cacheIndex = i, e[i] = r
      },
      _takeBackAction: function(t) {
        var e = this._actions,
          i = t._cacheIndex,
          n = --this._nActiveActions,
          r = e[n];
        t._cacheIndex = n, e[n] = t, r._cacheIndex = i, e[i] = r
      },
      _addInactiveBinding: function(t, e, i) {
        var n = this._bindingsByRootAndName,
          r = n[e],
          a = this._bindings;
        void 0 === r && (r = {}, n[e] = r), r[i] = t, t._cacheIndex = a.length, a.push(t)
      },
      _removeInactiveBinding: function(t) {
        var e = this._bindings,
          i = t.binding,
          n = i.rootNode.uuid,
          r = i.path,
          a = this._bindingsByRootAndName,
          o = a[n],
          s = e[e.length - 1],
          c = t._cacheIndex;
        s._cacheIndex = c, e[c] = s, e.pop(), delete o[r];
        t: {
          for (var h in o) break t;delete a[n]
        }
      },
      _lendBinding: function(t) {
        var e = this._bindings,
          i = t._cacheIndex,
          n = this._nActiveBindings++,
          r = e[n];
        t._cacheIndex = n, e[n] = t, r._cacheIndex = i, e[i] = r
      },
      _takeBackBinding: function(t) {
        var e = this._bindings,
          i = t._cacheIndex,
          n = --this._nActiveBindings,
          r = e[n];
        t._cacheIndex = n, e[n] = t, r._cacheIndex = i, e[i] = r
      },
      _lendControlInterpolant: function() {
        var t = this._controlInterpolants,
          e = this._nActiveControlInterpolants++,
          i = t[e];
        return void 0 === i && ((i = new sr(new Float32Array(2), new Float32Array(2), 1, this._controlInterpolantsResultBuffer)).__cacheIndex = e, t[e] = i), i
      },
      _takeBackControlInterpolant: function(t) {
        var e = this._controlInterpolants,
          i = t.__cacheIndex,
          n = --this._nActiveControlInterpolants,
          r = e[n];
        t.__cacheIndex = n, e[n] = t, r.__cacheIndex = i, e[i] = r
      },
      _controlInterpolantsResultBuffer: new Float32Array(1),
      clipAction: function(t, e) {
        var i = e || this._root,
          n = i.uuid,
          r = "string" == typeof t ? yr.findByName(i, t) : t,
          a = null !== r ? r.uuid : t,
          o = this._actionsByClip[a],
          s = null;
        if (void 0 !== o) {
          var c = o.actionByRoot[n];
          if (void 0 !== c) return c;
          s = o.knownActions[0], null === r && (r = s._clip)
        }
        if (null === r) return null;
        var h = new Ma(this, r, e);
        return this._bindAction(h, s), this._addInactiveAction(h, a, n), h
      },
      existingAction: function(t, e) {
        var i = e || this._root,
          n = i.uuid,
          r = "string" == typeof t ? yr.findByName(i, t) : t,
          a = r ? r.uuid : t,
          o = this._actionsByClip[a];
        return void 0 !== o && o.actionByRoot[n] || null
      },
      stopAllAction: function() {
        var t = this._actions,
          e = this._nActiveActions,
          i = this._bindings,
          n = this._nActiveBindings;
        this._nActiveActions = 0, this._nActiveBindings = 0;
        for (var r = 0; r !== e; ++r) t[r].reset();
        for (r = 0; r !== n; ++r) i[r].useCount = 0;
        return this
      },
      update: function(t) {
        t *= this.timeScale;
        for (var e = this._actions, i = this._nActiveActions, n = this.time += t, r = Math.sign(t), a = this._accuIndex ^= 1, o = 0; o !== i; ++o) e[o]._update(n, t, r, a);
        var s = this._bindings,
          c = this._nActiveBindings;
        for (o = 0; o !== c; ++o) s[o].apply(a);
        return this
      },
      getRoot: function() {
        return this._root
      },
      uncacheClip: function(t) {
        var e = this._actions,
          i = t.uuid,
          n = this._actionsByClip,
          r = n[i];
        if (void 0 !== r) {
          for (var a = r.knownActions, o = 0, s = a.length; o !== s; ++o) {
            var c = a[o];
            this._deactivateAction(c);
            var h = c._cacheIndex,
              l = e[e.length - 1];
            c._cacheIndex = null, c._byClipCacheIndex = null, l._cacheIndex = h, e[h] = l, e.pop(), this._removeInactiveBindingsForAction(c)
          }
          delete n[i]
        }
      },
      uncacheRoot: function(t) {
        var e = t.uuid,
          i = this._actionsByClip;
        for (var n in i) {
          var r = i[n].actionByRoot[e];
          void 0 !== r && (this._deactivateAction(r), this._removeInactiveAction(r))
        }
        var a = this._bindingsByRootAndName[e];
        if (void 0 !== a)
          for (var o in a) {
            var s = a[o];
            s.restoreOriginalState(), this._removeInactiveBinding(s)
          }
      },
      uncacheAction: function(t, e) {
        var i = this.existingAction(t, e);
        null !== i && (this._deactivateAction(i), this._removeInactiveAction(i))
      }
    }), Ta.prototype.clone = function() {
      return new Ta(void 0 === this.value.clone ? this.value : this.value.clone())
    }, Sa.prototype = Object.assign(Object.create(Be.prototype), {
      constructor: Sa,
      isInstancedBufferGeometry: !0,
      copy: function(t) {
        return Be.prototype.copy.call(this, t), this.maxInstancedCount = t.maxInstancedCount, this
      },
      clone: function() {
        return (new this.constructor).copy(this)
      }
    }), Object.defineProperties(Aa.prototype, {
      count: {
        get: function() {
          return this.data.count
        }
      },
      array: {
        get: function() {
          return this.data.array
        }
      }
    }), Object.assign(Aa.prototype, {
      isInterleavedBufferAttribute: !0,
      setX: function(t, e) {
        return this.data.array[t * this.data.stride + this.offset] = e, this
      },
      setY: function(t, e) {
        return this.data.array[t * this.data.stride + this.offset + 1] = e, this
      },
      setZ: function(t, e) {
        return this.data.array[t * this.data.stride + this.offset + 2] = e, this
      },
      setW: function(t, e) {
        return this.data.array[t * this.data.stride + this.offset + 3] = e, this
      },
      getX: function(t) {
        return this.data.array[t * this.data.stride + this.offset]
      },
      getY: function(t) {
        return this.data.array[t * this.data.stride + this.offset + 1]
      },
      getZ: function(t) {
        return this.data.array[t * this.data.stride + this.offset + 2]
      },
      getW: function(t) {
        return this.data.array[t * this.data.stride + this.offset + 3]
      },
      setXY: function(t, e, i) {
        return t = t * this.data.stride + this.offset, this.data.array[t + 0] = e, this.data.array[t + 1] = i, this
      },
      setXYZ: function(t, e, i, n) {
        return t = t * this.data.stride + this.offset, this.data.array[t + 0] = e, this.data.array[t + 1] = i, this.data.array[t + 2] = n, this
      },
      setXYZW: function(t, e, i, n, r) {
        return t = t * this.data.stride + this.offset, this.data.array[t + 0] = e, this.data.array[t + 1] = i, this.data.array[t + 2] = n, this.data.array[t + 3] = r, this
      }
    }), Object.defineProperty(Ra.prototype, "needsUpdate", {
      set: function(t) {
        !0 === t && this.version++
      }
    }), Object.assign(Ra.prototype, {
      isInterleavedBuffer: !0,
      setArray: function(t) {
        if (Array.isArray(t)) throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
        this.count = void 0 !== t ? t.length / this.stride : 0, this.array = t
      },
      setDynamic: function(t) {
        return this.dynamic = t, this
      },
      copy: function(t) {
        return this.array = new t.array.constructor(t.array), this.count = t.count, this.stride = t.stride, this.dynamic = t.dynamic, this
      },
      copyAt: function(t, e, i) {
        t *= this.stride, i *= e.stride;
        for (var n = 0, r = this.stride; n < r; n++) this.array[t + n] = e.array[i + n];
        return this
      },
      set: function(t, e) {
        return void 0 === e && (e = 0), this.array.set(t, e), this
      },
      clone: function() {
        return (new this.constructor).copy(this)
      },
      onUpload: function(t) {
        return this.onUploadCallback = t, this
      }
    }), La.prototype = Object.assign(Object.create(Ra.prototype), {
      constructor: La,
      isInstancedInterleavedBuffer: !0,
      copy: function(t) {
        return Ra.prototype.copy.call(this, t), this.meshPerAttribute = t.meshPerAttribute, this
      }
    }), Pa.prototype = Object.assign(Object.create(ve.prototype), {
      constructor: Pa,
      isInstancedBufferAttribute: !0,
      copy: function(t) {
        return ve.prototype.copy.call(this, t), this.meshPerAttribute = t.meshPerAttribute, this
      }
    }), Object.assign(Ca.prototype, {
      linePrecision: 1,
      set: function(t, e) {
        this.ray.set(t, e)
      },
      setFromCamera: function(t, e) {
        e && e.isPerspectiveCamera ? (this.ray.origin.setFromMatrixPosition(e.matrixWorld), this.ray.direction.set(t.x, t.y, .5).unproject(e).sub(this.ray.origin).normalize()) : e && e.isOrthographicCamera ? (this.ray.origin.set(t.x, t.y, (e.near + e.far) / (e.near - e.far)).unproject(e), this.ray.direction.set(0, 0, -1).transformDirection(e.matrixWorld)) : console.error("THREE.Raycaster: Unsupported camera type.")
      },
      intersectObject: function(t, e) {
        var i = [];
        return Ua(t, this, i, e), i.sort(Ia), i
      },
      intersectObjects: function(t, e) {
        var i = [];
        if (!1 === Array.isArray(t)) return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."), i;
        for (var n = 0, r = t.length; n < r; n++) Ua(t[n], this, i, e);
        return i.sort(Ia), i
      }
    }), Object.assign(Da.prototype, {
      start: function() {
        this.startTime = ("undefined" == typeof performance ? Date : performance).now(), this.oldTime = this.startTime, this.elapsedTime = 0, this.running = !0
      },
      stop: function() {
        this.getElapsedTime(), this.running = !1, this.autoStart = !1
      },
      getElapsedTime: function() {
        return this.getDelta(), this.elapsedTime
      },
      getDelta: function() {
        var t = 0;
        if (this.autoStart && !this.running) return this.start(), 0;
        if (this.running) {
          var e = ("undefined" == typeof performance ? Date : performance).now();
          t = (e - this.oldTime) / 1e3, this.oldTime = e, this.elapsedTime += t
        }
        return t
      }
    }), Object.assign(Oa.prototype, {
      set: function(t, e, i) {
        return this.radius = t, this.phi = e, this.theta = i, this
      },
      clone: function() {
        return (new this.constructor).copy(this)
      },
      copy: function(t) {
        return this.radius = t.radius, this.phi = t.phi, this.theta = t.theta, this
      },
      makeSafe: function() {
        return this.phi = Math.max(1e-6, Math.min(Math.PI - 1e-6, this.phi)), this
      },
      setFromVector3: function(t) {
        return this.radius = t.length(), 0 === this.radius ? (this.theta = 0, this.phi = 0) : (this.theta = Math.atan2(t.x, t.z), this.phi = Math.acos(I.clamp(t.y / this.radius, -1, 1))), this
      }
    }), Object.assign(Na.prototype, {
      set: function(t, e, i) {
        return this.radius = t, this.theta = e, this.y = i, this
      },
      clone: function() {
        return (new this.constructor).copy(this)
      },
      copy: function(t) {
        return this.radius = t.radius, this.theta = t.theta, this.y = t.y, this
      },
      setFromVector3: function(t) {
        return this.radius = Math.sqrt(t.x * t.x + t.z * t.z), this.theta = Math.atan2(t.x, t.z), this.y = t.y, this
      }
    }), Ba.prototype = Object.create(le.prototype), Ba.prototype.constructor = Ba, Ba.prototype.isImmediateRenderObject = !0, Fa.prototype = Object.create(Ii.prototype), Fa.prototype.constructor = Fa, Fa.prototype.update = function() {
      var t = new N,
        e = new N,
        i = new B;
      return function() {
        var n = ["a", "b", "c"];
        this.object.updateMatrixWorld(!0), i.getNormalMatrix(this.object.matrixWorld);
        var r = this.object.matrixWorld,
          a = this.geometry.attributes.position,
          o = this.object.geometry;
        if (o && o.isGeometry)
          for (var s = o.vertices, c = o.faces, h = 0, l = 0, u = c.length; l < u; l++)
            for (var p = c[l], d = 0, f = p.vertexNormals.length; d < f; d++) {
              var m = s[p[n[d]]],
                g = p.vertexNormals[d];
              t.copy(m).applyMatrix4(r), e.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t), a.setXYZ(h, t.x, t.y, t.z), h += 1, a.setXYZ(h, e.x, e.y, e.z), h += 1
            } else if (o && o.isBufferGeometry) {
              var v = o.attributes.position,
                y = o.attributes.normal;
              for (h = 0, d = 0, f = v.count; d < f; d++) t.set(v.getX(d), v.getY(d), v.getZ(d)).applyMatrix4(r), e.set(y.getX(d), y.getY(d), y.getZ(d)), e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t), a.setXYZ(h, t.x, t.y, t.z), h += 1, a.setXYZ(h, e.x, e.y, e.z), h += 1
            } a.needsUpdate = !0
      }
    }(), za.prototype = Object.create(le.prototype), za.prototype.constructor = za, za.prototype.dispose = function() {
      this.cone.geometry.dispose(), this.cone.material.dispose()
    }, za.prototype.update = function() {
      var t = new N,
        e = new N;
      return function() {
        this.light.updateMatrixWorld();
        var i = this.light.distance ? this.light.distance : 1e3,
          n = i * Math.tan(this.light.angle);
        this.cone.scale.set(n, n, i), t.setFromMatrixPosition(this.light.matrixWorld), e.setFromMatrixPosition(this.light.target.matrixWorld), this.cone.lookAt(e.sub(t)), void 0 !== this.color ? this.cone.material.color.set(this.color) : this.cone.material.color.copy(this.light.color)
      }
    }(), Ga.prototype = Object.create(Ii.prototype), Ga.prototype.constructor = Ga, Ga.prototype.updateMatrixWorld = function() {
      var t = new N,
        e = new D,
        i = new D;
      return function(n) {
        var r = this.bones,
          a = this.geometry,
          o = a.getAttribute("position");
        i.getInverse(this.root.matrixWorld);
        for (var s = 0, c = 0; s < r.length; s++) {
          var h = r[s];
          h.parent && h.parent.isBone && (e.multiplyMatrices(i, h.matrixWorld), t.setFromMatrixPosition(e), o.setXYZ(c, t.x, t.y, t.z), e.multiplyMatrices(i, h.parent.matrixWorld), t.setFromMatrixPosition(e), o.setXYZ(c + 1, t.x, t.y, t.z), c += 2)
        }
        a.getAttribute("position").needsUpdate = !0, le.prototype.updateMatrixWorld.call(this, n)
      }
    }(), Ha.prototype = Object.create(qe.prototype), Ha.prototype.constructor = Ha, Ha.prototype.dispose = function() {
      this.geometry.dispose(), this.material.dispose()
    }, Ha.prototype.update = function() {
      void 0 !== this.color ? this.material.color.set(this.color) : this.material.color.copy(this.light.color)
    }, Va.prototype = Object.create(le.prototype), Va.prototype.constructor = Va, Va.prototype.dispose = function() {
      this.children[0].geometry.dispose(), this.children[0].material.dispose()
    }, Va.prototype.update = function() {
      var t = .5 * this.light.width,
        e = .5 * this.light.height,
        i = this.line.geometry.attributes.position,
        n = i.array;
      n[0] = t, n[1] = -e, n[2] = 0, n[3] = t, n[4] = e, n[5] = 0, n[6] = -t, n[7] = e, n[8] = 0, n[9] = -t, n[10] = -e, n[11] = 0, n[12] = t, n[13] = -e, n[14] = 0, i.needsUpdate = !0, void 0 !== this.color ? this.line.material.color.set(this.color) : this.line.material.color.copy(this.light.color)
    }, ka.prototype = Object.create(le.prototype), ka.prototype.constructor = ka, ka.prototype.dispose = function() {
      this.children[0].geometry.dispose(), this.children[0].material.dispose()
    }, ka.prototype.update = function() {
      var t = new N,
        e = new Ct,
        i = new Ct;
      return function() {
        var n = this.children[0];
        if (void 0 !== this.color) this.material.color.set(this.color);
        else {
          var r = n.geometry.getAttribute("color");
          e.copy(this.light.color), i.copy(this.light.groundColor);
          for (var a = 0, o = r.count; a < o; a++) {
            var s = a < o / 2 ? e : i;
            r.setXYZ(a, s.r, s.g, s.b)
          }
          r.needsUpdate = !0
        }
        n.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())
      }
    }(), ja.prototype = Object.create(Ii.prototype), ja.prototype.constructor = ja, Wa.prototype = Object.create(Ii.prototype), Wa.prototype.constructor = Wa, Xa.prototype = Object.create(Ii.prototype), Xa.prototype.constructor = Xa, Xa.prototype.update = function() {
      var t = new N,
        e = new N,
        i = new B;
      return function() {
        this.object.updateMatrixWorld(!0), i.getNormalMatrix(this.object.matrixWorld);
        for (var n = this.object.matrixWorld, r = this.geometry.attributes.position, a = this.object.geometry, o = a.vertices, s = a.faces, c = 0, h = 0, l = s.length; h < l; h++) {
          var u = s[h],
            p = u.normal;
          t.copy(o[u.a]).add(o[u.b]).add(o[u.c]).divideScalar(3).applyMatrix4(n), e.copy(p).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t), r.setXYZ(c, t.x, t.y, t.z), c += 1, r.setXYZ(c, e.x, e.y, e.z), c += 1
        }
        r.needsUpdate = !0
      }
    }(), qa.prototype = Object.create(le.prototype), qa.prototype.constructor = qa, qa.prototype.dispose = function() {
      this.lightPlane.geometry.dispose(), this.lightPlane.material.dispose(), this.targetLine.geometry.dispose(), this.targetLine.material.dispose()
    }, qa.prototype.update = function() {
      var t = new N,
        e = new N,
        i = new N;
      return function() {
        t.setFromMatrixPosition(this.light.matrixWorld), e.setFromMatrixPosition(this.light.target.matrixWorld), i.subVectors(e, t), this.lightPlane.lookAt(i), void 0 !== this.color ? (this.lightPlane.material.color.set(this.color), this.targetLine.material.color.set(this.color)) : (this.lightPlane.material.color.copy(this.light.color), this.targetLine.material.color.copy(this.light.color)), this.targetLine.lookAt(i), this.targetLine.scale.z = i.length()
      }
    }(), Ya.prototype = Object.create(Ii.prototype), Ya.prototype.constructor = Ya, Ya.prototype.update = function() {
      var t, e, i = new N,
        n = new ue;

      function r(r, a, o, s) {
        i.set(a, o, s).unproject(n);
        var c = e[r];
        if (void 0 !== c)
          for (var h = t.getAttribute("position"), l = 0, u = c.length; l < u; l++) h.setXYZ(c[l], i.x, i.y, i.z)
      }
      return function() {
        t = this.geometry, e = this.pointMap, n.projectionMatrix.copy(this.camera.projectionMatrix), r("c", 0, 0, -1), r("t", 0, 0, 1), r("n1", -1, -1, -1), r("n2", 1, -1, -1), r("n3", -1, 1, -1), r("n4", 1, 1, -1), r("f1", -1, -1, 1), r("f2", 1, -1, 1), r("f3", -1, 1, 1), r("f4", 1, 1, 1), r("u1", .7, 1.1, -1), r("u2", -.7, 1.1, -1), r("u3", 0, 2, -1), r("cf1", -1, 0, 1), r("cf2", 1, 0, 1), r("cf3", 0, -1, 1), r("cf4", 0, 1, 1), r("cn1", -1, 0, -1), r("cn2", 1, 0, -1), r("cn3", 0, -1, -1), r("cn4", 0, 1, -1), t.getAttribute("position").needsUpdate = !0
      }
    }(), Za.prototype = Object.create(Ii.prototype), Za.prototype.constructor = Za, Za.prototype.update = function() {
      var t = new Qt;
      return function(e) {
        if (void 0 !== e && console.warn("THREE.BoxHelper: .update() has no longer arguments."), void 0 !== this.object && t.setFromObject(this.object), !t.isEmpty()) {
          var i = t.min,
            n = t.max,
            r = this.geometry.attributes.position,
            a = r.array;
          a[0] = n.x, a[1] = n.y, a[2] = n.z, a[3] = i.x, a[4] = n.y, a[5] = n.z, a[6] = i.x, a[7] = i.y, a[8] = n.z, a[9] = n.x, a[10] = i.y, a[11] = n.z, a[12] = n.x, a[13] = n.y, a[14] = i.z, a[15] = i.x, a[16] = n.y, a[17] = i.z, a[18] = i.x, a[19] = i.y, a[20] = i.z, a[21] = n.x, a[22] = i.y, a[23] = i.z, r.needsUpdate = !0, this.geometry.computeBoundingSphere()
        }
      }
    }(), Za.prototype.setFromObject = function(t) {
      return this.object = t, this.update(), this
    }, Ja.prototype = Object.create(Ii.prototype), Ja.prototype.constructor = Ja, Ja.prototype.updateMatrixWorld = function(t) {
      var e = this.box;
      e.isEmpty() || (e.getCenter(this.position), e.getSize(this.scale), this.scale.multiplyScalar(.5), le.prototype.updateMatrixWorld.call(this, t))
    }, Qa.prototype = Object.create(Ci.prototype), Qa.prototype.constructor = Qa, Qa.prototype.updateMatrixWorld = function(t) {
      var e = -this.plane.constant;
      Math.abs(e) < 1e-8 && (e = 1e-8), this.scale.set(.5 * this.size, .5 * this.size, e), this.lookAt(this.plane.normal), le.prototype.updateMatrixWorld.call(this, t)
    }, Ka.prototype = Object.create(le.prototype), Ka.prototype.constructor = Ka, Ka.prototype.setDirection = (la = new N, function(t) {
      t.y > .99999 ? this.quaternion.set(0, 0, 0, 1) : t.y < -.99999 ? this.quaternion.set(1, 0, 0, 0) : (la.set(t.z, 0, -t.x).normalize(), ha = Math.acos(t.y), this.quaternion.setFromAxisAngle(la, ha))
    }), Ka.prototype.setLength = function(t, e, i) {
      void 0 === e && (e = .2 * t), void 0 === i && (i = .2 * e), this.line.scale.set(1, Math.max(0, t - e), 1), this.line.updateMatrix(), this.cone.scale.set(i, e, i), this.cone.position.y = t, this.cone.updateMatrix()
    }, Ka.prototype.setColor = function(t) {
      this.line.material.color.copy(t), this.cone.material.color.copy(t)
    }, $a.prototype = Object.create(Ii.prototype), $a.prototype.constructor = $a;
  var eo = new N,
    io = new to,
    no = new to,
    ro = new to;

  function ao(t) {
    Or.call(this), t.length < 2 && console.warn("THREE.CatmullRomCurve3: Points array needs at least two entries."), this.points = t || [], this.closed = !1
  }

  function oo(t, e, i, n) {
    Or.call(this), this.v0 = t, this.v1 = e, this.v2 = i, this.v3 = n
  }

  function so(t, e, i) {
    Or.call(this), this.v0 = t, this.v1 = e, this.v2 = i
  }

  function co(t, e) {
    Or.call(this), this.v1 = t, this.v2 = e
  }

  function ho(t, e, i, n, r, a) {
    Fr.call(this, t, e, i, i, n, r, a)
  }
  ao.prototype = Object.create(Or.prototype), ao.prototype.constructor = ao, ao.prototype.isCatmullRomCurve3 = !0, ao.prototype.getPoint = function(t, e) {
    var i, n, r, a, o = e || new N,
      s = this.points,
      c = s.length,
      h = (c - (this.closed ? 0 : 1)) * t,
      l = Math.floor(h),
      u = h - l;
    if (this.closed ? l += l > 0 ? 0 : (Math.floor(Math.abs(l) / s.length) + 1) * s.length : 0 === u && l === c - 1 && (l = c - 2, u = 1), this.closed || l > 0 ? i = s[(l - 1) % c] : (eo.subVectors(s[0], s[1]).add(s[0]), i = eo), n = s[l % c], r = s[(l + 1) % c], this.closed || l + 2 < c ? a = s[(l + 2) % c] : (eo.subVectors(s[c - 1], s[c - 2]).add(s[c - 1]), a = eo), void 0 === this.type || "centripetal" === this.type || "chordal" === this.type) {
      var p = "chordal" === this.type ? .5 : .25,
        d = Math.pow(i.distanceToSquared(n), p),
        f = Math.pow(n.distanceToSquared(r), p),
        m = Math.pow(r.distanceToSquared(a), p);
      f < 1e-4 && (f = 1), d < 1e-4 && (d = f), m < 1e-4 && (m = f), io.initNonuniformCatmullRom(i.x, n.x, r.x, a.x, d, f, m), no.initNonuniformCatmullRom(i.y, n.y, r.y, a.y, d, f, m), ro.initNonuniformCatmullRom(i.z, n.z, r.z, a.z, d, f, m)
    } else if ("catmullrom" === this.type) {
      var g = void 0 !== this.tension ? this.tension : .5;
      io.initCatmullRom(i.x, n.x, r.x, a.x, g), no.initCatmullRom(i.y, n.y, r.y, a.y, g), ro.initCatmullRom(i.z, n.z, r.z, a.z, g)
    }
    return o.set(io.calc(u), no.calc(u), ro.calc(u)), o
  }, oo.prototype = Object.create(Or.prototype), oo.prototype.constructor = oo, oo.prototype.isCubicBezierCurve3 = !0, oo.prototype.getPoint = function(t, e) {
    var i = e || new N,
      n = this.v0,
      r = this.v1,
      a = this.v2,
      o = this.v3;
    return i.set(Dr(t, n.x, r.x, a.x, o.x), Dr(t, n.y, r.y, a.y, o.y), Dr(t, n.z, r.z, a.z, o.z)), i
  }, so.prototype = Object.create(Or.prototype), so.prototype.constructor = so, so.prototype.isQuadraticBezierCurve3 = !0, so.prototype.getPoint = function(t, e) {
    var i = e || new N,
      n = this.v0,
      r = this.v1,
      a = this.v2;
    return i.set(Ur(t, n.x, r.x, a.x), Ur(t, n.y, r.y, a.y), Ur(t, n.z, r.z, a.z)), i
  }, co.prototype = Object.create(Or.prototype), co.prototype.constructor = co, co.prototype.isLineCurve3 = !0, co.prototype.getPoint = function(t, e) {
    var i = e || new N;
    return 1 === t ? i.copy(this.v2) : (i.copy(this.v2).sub(this.v1), i.multiplyScalar(t).add(this.v1)), i
  }, co.prototype.getPointAt = function(t, e) {
    return this.getPoint(t, e)
  }, ho.prototype = Object.create(Fr.prototype), ho.prototype.constructor = ho, ho.prototype.isArcCurve = !0;
  var lo = {
    createMultiMaterialObject: function(t, e) {
      for (var i = new Ni, n = 0, r = e.length; n < r; n++) i.add(new qe(t, e[n]));
      return i
    },
    detach: function(t, e, i) {
      t.applyMatrix(e.matrixWorld), e.remove(t), i.add(t)
    },
    attach: function(t, e, i) {
      t.applyMatrix((new D).getInverse(i.matrixWorld)), e.remove(t), i.add(t)
    }
  };

  function uo(t) {
    console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."), ao.call(this, t), this.type = "catmullrom", this.closed = !0
  }

  function po(t) {
    console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."), ao.call(this, t), this.type = "catmullrom"
  }

  function fo(t) {
    console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."), ao.call(this, t), this.type = "catmullrom"
  }
  Or.create = function(t, e) {
    return console.log("THREE.Curve.create() has been deprecated"), t.prototype = Object.create(Or.prototype), t.prototype.constructor = t, t.prototype.getPoint = e, t
  }, Object.assign(Br.prototype, {
    createPointsGeometry: function(t) {
      console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
      var e = this.getPoints(t);
      return this.createGeometry(e)
    },
    createSpacedPointsGeometry: function(t) {
      console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
      var e = this.getSpacedPoints(t);
      return this.createGeometry(e)
    },
    createGeometry: function(t) {
      console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
      for (var e = new ge, i = 0, n = t.length; i < n; i++) {
        var r = t[i];
        e.vertices.push(new N(r.x, r.y, r.z || 0))
      }
      return e
    }
  }), uo.prototype = Object.create(ao.prototype), po.prototype = Object.create(ao.prototype), fo.prototype = Object.create(ao.prototype), Object.assign(fo.prototype, {
    initFromArray: function() {
      console.error("THREE.Spline: .initFromArray() has been removed.")
    },
    getControlPointsArray: function() {
      console.error("THREE.Spline: .getControlPointsArray() has been removed.")
    },
    reparametrizeByArcLength: function() {
      console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")
    }
  }), ja.prototype.setColors = function() {
    console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")
  }, Ga.prototype.update = function() {
    console.error("THREE.SkeletonHelper: update() no longer needs to be called.")
  }, Object.assign(Nt.prototype, {
    center: function(t) {
      return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."), this.getCenter(t)
    },
    empty: function() {
      return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."), this.isEmpty()
    },
    isIntersectionBox: function(t) {
      return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(t)
    },
    size: function(t) {
      return console.warn("THREE.Box2: .size() has been renamed to .getSize()."), this.getSize(t)
    }
  }), Object.assign(Qt.prototype, {
    center: function(t) {
      return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."), this.getCenter(t)
    },
    empty: function() {
      return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."), this.isEmpty()
    },
    isIntersectionBox: function(t) {
      return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(t)
    },
    isIntersectionSphere: function(t) {
      return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(t)
    },
    size: function(t) {
      return console.warn("THREE.Box3: .size() has been renamed to .getSize()."), this.getSize(t)
    }
  }), We.prototype.center = function(t) {
    return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."), this.getCenter(t)
  }, Object.assign(I, {
    random16: function() {
      return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."), Math.random()
    },
    nearestPowerOfTwo: function(t) {
      return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."), I.floorPowerOfTwo(t)
    },
    nextPowerOfTwo: function(t) {
      return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."), I.ceilPowerOfTwo(t)
    }
  }), Object.assign(B.prototype, {
    flattenToArrayOffset: function(t, e) {
      return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."), this.toArray(t, e)
    },
    multiplyVector3: function(t) {
      return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."), t.applyMatrix3(this)
    },
    multiplyVector3Array: function() {
      console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")
    },
    applyToBuffer: function(t) {
      return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."), this.applyToBufferAttribute(t)
    },
    applyToVector3Array: function() {
      console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")
    }
  }), Object.assign(D.prototype, {
    extractPosition: function(t) {
      return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."), this.copyPosition(t)
    },
    flattenToArrayOffset: function(t, e) {
      return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."), this.toArray(t, e)
    },
    getPosition: function() {
      var t;
      return function() {
        return void 0 === t && (t = new N), console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."), t.setFromMatrixColumn(this, 3)
      }
    }(),
    setRotationFromQuaternion: function(t) {
      return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."), this.makeRotationFromQuaternion(t)
    },
    multiplyToArray: function() {
      console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")
    },
    multiplyVector3: function(t) {
      return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."), t.applyMatrix4(this)
    },
    multiplyVector4: function(t) {
      return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."), t.applyMatrix4(this)
    },
    multiplyVector3Array: function() {
      console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")
    },
    rotateAxis: function(t) {
      console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."), t.transformDirection(this)
    },
    crossVector: function(t) {
      return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."), t.applyMatrix4(this)
    },
    translate: function() {
      console.error("THREE.Matrix4: .translate() has been removed.")
    },
    rotateX: function() {
      console.error("THREE.Matrix4: .rotateX() has been removed.")
    },
    rotateY: function() {
      console.error("THREE.Matrix4: .rotateY() has been removed.")
    },
    rotateZ: function() {
      console.error("THREE.Matrix4: .rotateZ() has been removed.")
    },
    rotateByAxis: function() {
      console.error("THREE.Matrix4: .rotateByAxis() has been removed.")
    },
    applyToBuffer: function(t) {
      return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."), this.applyToBufferAttribute(t)
    },
    applyToVector3Array: function() {
      console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")
    },
    makeFrustum: function(t, e, i, n, r, a) {
      return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."), this.makePerspective(t, e, n, i, r, a)
    }
  }), $t.prototype.isIntersectionLine = function(t) {
    return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."), this.intersectsLine(t)
  }, O.prototype.multiplyVector3 = function(t) {
    return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."), t.applyQuaternion(this)
  }, Object.assign(je.prototype, {
    isIntersectionBox: function(t) {
      return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(t)
    },
    isIntersectionPlane: function(t) {
      return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."), this.intersectsPlane(t)
    },
    isIntersectionSphere: function(t) {
      return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(t)
    }
  }), Object.assign(Wr.prototype, {
    extrude: function(t) {
      return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."), new sn(this, t)
    },
    makeGeometry: function(t) {
      return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."), new vn(this, t)
    }
  }), Object.assign(U.prototype, {
    fromAttribute: function(t, e, i) {
      return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(t, e, i)
    },
    distanceToManhattan: function(t) {
      return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."), this.manhattanDistanceTo(t)
    },
    lengthManhattan: function() {
      return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength()
    }
  }), Object.assign(N.prototype, {
    setEulerFromRotationMatrix: function() {
      console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")
    },
    setEulerFromQuaternion: function() {
      console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")
    },
    getPositionFromMatrix: function(t) {
      return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."), this.setFromMatrixPosition(t)
    },
    getScaleFromMatrix: function(t) {
      return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."), this.setFromMatrixScale(t)
    },
    getColumnFromMatrix: function(t, e) {
      return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."), this.setFromMatrixColumn(e, t)
    },
    applyProjection: function(t) {
      return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."), this.applyMatrix4(t)
    },
    fromAttribute: function(t, e, i) {
      return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(t, e, i)
    },
    distanceToManhattan: function(t) {
      return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."), this.manhattanDistanceTo(t)
    },
    lengthManhattan: function() {
      return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength()
    }
  }), Object.assign(G.prototype, {
    fromAttribute: function(t, e, i) {
      return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(t, e, i)
    },
    lengthManhattan: function() {
      return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength()
    }
  }), ge.prototype.computeTangents = function() {
    console.warn("THREE.Geometry: .computeTangents() has been removed.")
  }, Object.assign(le.prototype, {
    getChildByName: function(t) {
      return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."), this.getObjectByName(t)
    },
    renderDepth: function() {
      console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")
    },
    translate: function(t, e) {
      return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."), this.translateOnAxis(e, t)
    }
  }), Object.defineProperties(le.prototype, {
    eulerOrder: {
      get: function() {
        return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order
      },
      set: function(t) {
        console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order = t
      }
    },
    useQuaternion: {
      get: function() {
        console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
      },
      set: function() {
        console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
      }
    }
  }), Object.defineProperties(Si.prototype, {
    objects: {
      get: function() {
        return console.warn("THREE.LOD: .objects has been renamed to .levels."), this.levels
      }
    }
  }), Object.defineProperty(Ai.prototype, "useVertexTexture", {
    get: function() {
      console.warn("THREE.Skeleton: useVertexTexture has been removed.")
    },
    set: function() {
      console.warn("THREE.Skeleton: useVertexTexture has been removed.")
    }
  }), Object.defineProperty(Or.prototype, "__arcLengthDivisions", {
    get: function() {
      return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."), this.arcLengthDivisions
    },
    set: function(t) {
      console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."), this.arcLengthDivisions = t
    }
  }), gi.prototype.setLens = function(t, e) {
    console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."), void 0 !== e && (this.filmGauge = e), this.setFocalLength(t)
  }, Object.defineProperties(qn.prototype, {
    onlyShadow: {
      set: function() {
        console.warn("THREE.Light: .onlyShadow has been removed.")
      }
    },
    shadowCameraFov: {
      set: function(t) {
        console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."), this.shadow.camera.fov = t
      }
    },
    shadowCameraLeft: {
      set: function(t) {
        console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."), this.shadow.camera.left = t
      }
    },
    shadowCameraRight: {
      set: function(t) {
        console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."), this.shadow.camera.right = t
      }
    },
    shadowCameraTop: {
      set: function(t) {
        console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."), this.shadow.camera.top = t
      }
    },
    shadowCameraBottom: {
      set: function(t) {
        console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."), this.shadow.camera.bottom = t
      }
    },
    shadowCameraNear: {
      set: function(t) {
        console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."), this.shadow.camera.near = t
      }
    },
    shadowCameraFar: {
      set: function(t) {
        console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."), this.shadow.camera.far = t
      }
    },
    shadowCameraVisible: {
      set: function() {
        console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")
      }
    },
    shadowBias: {
      set: function(t) {
        console.warn("THREE.Light: .shadowBias is now .shadow.bias."), this.shadow.bias = t
      }
    },
    shadowDarkness: {
      set: function() {
        console.warn("THREE.Light: .shadowDarkness has been removed.")
      }
    },
    shadowMapWidth: {
      set: function(t) {
        console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."), this.shadow.mapSize.width = t
      }
    },
    shadowMapHeight: {
      set: function(t) {
        console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."), this.shadow.mapSize.height = t
      }
    }
  }), Object.defineProperties(ve.prototype, {
    length: {
      get: function() {
        return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."), this.array.length
      }
    }
  }), Object.assign(Be.prototype, {
    addIndex: function(t) {
      console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."), this.setIndex(t)
    },
    addDrawCall: function(t, e, i) {
      void 0 !== i && console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."), console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."), this.addGroup(t, e)
    },
    clearDrawCalls: function() {
      console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."), this.clearGroups()
    },
    computeTangents: function() {
      console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")
    },
    computeOffsets: function() {
      console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")
    }
  }), Object.defineProperties(Be.prototype, {
    drawcalls: {
      get: function() {
        return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."), this.groups
      }
    },
    offsets: {
      get: function() {
        return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."), this.groups
      }
    }
  }), Object.defineProperties(Ta.prototype, {
    dynamic: {
      set: function() {
        console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")
      }
    },
    onUpdate: {
      value: function() {
        return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."), this
      }
    }
  }), Object.defineProperties(Yt.prototype, {
    wrapAround: {
      get: function() {
        console.warn("THREE.Material: .wrapAround has been removed.")
      },
      set: function() {
        console.warn("THREE.Material: .wrapAround has been removed.")
      }
    },
    wrapRGB: {
      get: function() {
        return console.warn("THREE.Material: .wrapRGB has been removed."), new Ct
      }
    },
    shading: {
      get: function() {
        console.error("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead.")
      },
      set: function(t) {
        console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."), this.flatShading = 1 === t
      }
    }
  }), Object.defineProperties(Cn.prototype, {
    metal: {
      get: function() {
        return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."), !1
      },
      set: function() {
        console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")
      }
    }
  }), Object.defineProperties(ke.prototype, {
    derivatives: {
      get: function() {
        return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives
      },
      set: function(t) {
        console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives = t
      }
    }
  }), Object.assign(xi.prototype, {
    getCurrentRenderTarget: function() {
      return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."), this.getRenderTarget()
    },
    getMaxAnisotropy: function() {
      return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."), this.capabilities.getMaxAnisotropy()
    },
    getPrecision: function() {
      return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."), this.capabilities.precision
    },
    resetGLState: function() {
      return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."), this.state.reset()
    },
    supportsFloatTextures: function() {
      return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."), this.extensions.get("OES_texture_float")
    },
    supportsHalfFloatTextures: function() {
      return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."), this.extensions.get("OES_texture_half_float")
    },
    supportsStandardDerivatives: function() {
      return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."), this.extensions.get("OES_standard_derivatives")
    },
    supportsCompressedTextureS3TC: function() {
      return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."), this.extensions.get("WEBGL_compressed_texture_s3tc")
    },
    supportsCompressedTexturePVRTC: function() {
      return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."), this.extensions.get("WEBGL_compressed_texture_pvrtc")
    },
    supportsBlendMinMax: function() {
      return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."), this.extensions.get("EXT_blend_minmax")
    },
    supportsVertexTextures: function() {
      return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."), this.capabilities.vertexTextures
    },
    supportsInstancedArrays: function() {
      return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."), this.extensions.get("ANGLE_instanced_arrays")
    },
    enableScissorTest: function(t) {
      console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."), this.setScissorTest(t)
    },
    initMaterial: function() {
      console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")
    },
    addPrePlugin: function() {
      console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")
    },
    addPostPlugin: function() {
      console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")
    },
    updateShadowMap: function() {
      console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")
    }
  }), Object.defineProperties(xi.prototype, {
    shadowMapEnabled: {
      get: function() {
        return this.shadowMap.enabled
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."), this.shadowMap.enabled = t
      }
    },
    shadowMapType: {
      get: function() {
        return this.shadowMap.type
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."), this.shadowMap.type = t
      }
    },
    shadowMapCullFace: {
      get: function() {
        return this.shadowMap.cullFace
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."), this.shadowMap.cullFace = t
      }
    }
  }), Object.defineProperties(ee.prototype, {
    cullFace: {
      get: function() {
        return this.renderReverseSided ? 2 : 1
      },
      set: function(t) {
        var e = 1 !== t;
        console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to " + e + "."), this.renderReverseSided = e
      }
    }
  }), Object.defineProperties(H.prototype, {
    wrapS: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS = t
      }
    },
    wrapT: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT = t
      }
    },
    magFilter: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter = t
      }
    },
    minFilter: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter = t
      }
    },
    anisotropy: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy = t
      }
    },
    offset: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset = t
      }
    },
    repeat: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat = t
      }
    },
    format: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format = t
      }
    },
    type: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type = t
      }
    },
    generateMipmaps: {
      get: function() {
        return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps
      },
      set: function(t) {
        console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps = t
      }
    }
  }), ga.prototype.load = function(t) {
    console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");
    var e = this;
    return (new pa).load(t, (function(t) {
      e.setBuffer(t)
    })), this
  }, ya.prototype.getData = function() {
    return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."), this.getFrequencyData()
  }, fa.prototype.updateCubeMap = function(t, e) {
    return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."), this.update(t, e)
  };
  var mo = {
      merge: function(t, e, i) {
        var n;
        console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."), e.isMesh && (e.matrixAutoUpdate && e.updateMatrix(), n = e.matrix, e = e.geometry), t.merge(e, n, i)
      },
      center: function(t) {
        return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."), t.center()
      }
    },
    go = {
      crossOrigin: void 0,
      loadTexture: function(t, e, i, n) {
        console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");
        var r = new Xn;
        r.setCrossOrigin(this.crossOrigin);
        var a = r.load(t, i, void 0, n);
        return e && (a.mapping = e), a
      },
      loadTextureCube: function(t, e, i, n) {
        console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
        var r = new Wn;
        r.setCrossOrigin(this.crossOrigin);
        var a = r.load(t, i, void 0, n);
        return e && (a.mapping = e), a
      },
      loadCompressedTexture: function() {
        console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")
      },
      loadCompressedTextureCube: function() {
        console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")
      }
    };
  e.WebGLRenderTargetCube = V, e.WebGLRenderTarget = H, e.WebGLRenderer = xi, e.ShaderLib = Ot, e.UniformsLib = It, e.UniformsUtils = Ut, e.ShaderChunk = Dt, e.FogExp2 = bi, e.Fog = _i, e.Scene = wi, e.LensFlare = Mi, e.Sprite = Ti, e.LOD = Si, e.SkinnedMesh = Li, e.Skeleton = Ai, e.Bone = Ri, e.Mesh = qe, e.LineSegments = Ii, e.LineLoop = Ui, e.Line = Ci, e.Points = Oi, e.Group = Ni, e.VideoTexture = Bi, e.DataTexture = k, e.CompressedTexture = Fi, e.CubeTexture = j, e.CanvasTexture = Ft, e.DepthTexture = zi, e.Texture = z, e.CompressedTextureLoader = Vn, e.DataTextureLoader = kn, e.CubeTextureLoader = Wn, e.TextureLoader = Xn, e.ObjectLoader = Rr, e.MaterialLoader = xr, e.BufferGeometryLoader = br, e.DefaultLoadingManager = zn, e.LoadingManager = Fn, e.JSONLoader = Ar, e.ImageLoader = jn, e.FontLoader = Yr, e.FileLoader = Hn, e.Loader = Sr, e.Cache = Bn, e.AudioLoader = pa, e.SpotLightShadow = Jn, e.SpotLight = Qn, e.PointLight = Kn, e.RectAreaLight = ir, e.HemisphereLight = Yn, e.DirectionalLightShadow = $n, e.DirectionalLight = tr, e.AmbientLight = er, e.LightShadow = Zn, e.Light = qn, e.StereoCamera = da, e.PerspectiveCamera = gi, e.OrthographicCamera = pe, e.CubeCamera = fa, e.ArrayCamera = vi, e.Camera = ue, e.AudioListener = ma, e.PositionalAudio = va, e.AudioContext = ua, e.AudioAnalyser = ya, e.Audio = ga, e.VectorKeyframeTrack = lr, e.StringKeyframeTrack = fr, e.QuaternionKeyframeTrack = pr, e.NumberKeyframeTrack = dr, e.ColorKeyframeTrack = gr, e.BooleanKeyframeTrack = mr, e.PropertyMixer = xa, e.PropertyBinding = _a, e.KeyframeTrack = vr, e.AnimationUtils = rr, e.AnimationObjectGroup = wa, e.AnimationMixer = Ea, e.AnimationClip = yr, e.Uniform = Ta, e.InstancedBufferGeometry = Sa, e.BufferGeometry = Be, e.Geometry = ge, e.InterleavedBufferAttribute = Aa, e.InstancedInterleavedBuffer = La, e.InterleavedBuffer = Ra, e.InstancedBufferAttribute = Pa, e.Face3 = de, e.Object3D = le, e.Raycaster = Ca, e.Layers = re, e.EventDispatcher = i, e.Clock = Da, e.QuaternionLinearInterpolant = ur, e.LinearInterpolant = sr, e.DiscreteInterpolant = cr, e.CubicInterpolant = or, e.Interpolant = ar, e.Triangle = Xe, e.Math = I, e.Spherical = Oa, e.Cylindrical = Na, e.Plane = $t, e.Frustum = te, e.Sphere = Kt, e.Ray = je, e.Matrix4 = D, e.Matrix3 = B, e.Box3 = Qt, e.Box2 = Nt, e.Line3 = We, e.Euler = ne, e.Vector4 = G, e.Vector3 = N, e.Vector2 = U, e.Quaternion = O, e.Color = Ct, e.ImmediateRenderObject = Ba, e.VertexNormalsHelper = Fa, e.SpotLightHelper = za, e.SkeletonHelper = Ga, e.PointLightHelper = Ha, e.RectAreaLightHelper = Va, e.HemisphereLightHelper = ka, e.GridHelper = ja, e.PolarGridHelper = Wa, e.FaceNormalsHelper = Xa, e.DirectionalLightHelper = qa, e.CameraHelper = Ya, e.BoxHelper = Za, e.Box3Helper = Ja, e.PlaneHelper = Qa, e.ArrowHelper = Ka, e.AxesHelper = $a, e.CatmullRomCurve3 = ao, e.CubicBezierCurve3 = oo, e.QuadraticBezierCurve3 = so, e.LineCurve3 = co, e.ArcCurve = ho, e.EllipseCurve = Fr, e.SplineCurve = zr, e.CubicBezierCurve = Gr, e.QuadraticBezierCurve = Hr, e.LineCurve = Nr, e.Shape = Wr, e.Path = jr, e.ShapePath = Xr, e.Font = qr, e.CurvePath = Br, e.Curve = Or, e.ShapeUtils = on, e.SceneUtils = lo, e.WebGLUtils = yi, e.WireframeGeometry = Gi, e.ParametricGeometry = Hi, e.ParametricBufferGeometry = Vi, e.TetrahedronGeometry = Wi, e.TetrahedronBufferGeometry = Xi, e.OctahedronGeometry = qi, e.OctahedronBufferGeometry = Yi, e.IcosahedronGeometry = Zi, e.IcosahedronBufferGeometry = Ji, e.DodecahedronGeometry = Qi, e.DodecahedronBufferGeometry = Ki, e.PolyhedronGeometry = ki, e.PolyhedronBufferGeometry = ji, e.TubeGeometry = $i, e.TubeBufferGeometry = tn, e.TorusKnotGeometry = en, e.TorusKnotBufferGeometry = nn, e.TorusGeometry = rn, e.TorusBufferGeometry = an, e.TextGeometry = hn, e.TextBufferGeometry = ln, e.SphereGeometry = un, e.SphereBufferGeometry = pn, e.RingGeometry = dn, e.RingBufferGeometry = fn, e.PlaneGeometry = Ge, e.PlaneBufferGeometry = He, e.LatheGeometry = mn, e.LatheBufferGeometry = gn, e.ShapeGeometry = vn, e.ShapeBufferGeometry = yn, e.ExtrudeGeometry = sn, e.ExtrudeBufferGeometry = cn, e.EdgesGeometry = xn, e.ConeGeometry = wn, e.ConeBufferGeometry = Mn, e.CylinderGeometry = bn, e.CylinderBufferGeometry = _n, e.CircleGeometry = En, e.CircleBufferGeometry = Tn, e.BoxGeometry = Fe, e.BoxBufferGeometry = ze, e.ShadowMaterial = An, e.SpriteMaterial = Ei, e.RawShaderMaterial = Rn, e.ShaderMaterial = ke, e.PointsMaterial = Di, e.MeshPhysicalMaterial = Pn, e.MeshStandardMaterial = Ln, e.MeshPhongMaterial = Cn, e.MeshToonMaterial = In, e.MeshNormalMaterial = Un, e.MeshLambertMaterial = Dn, e.MeshDepthMaterial = Zt, e.MeshDistanceMaterial = Jt, e.MeshBasicMaterial = Ve, e.LineDashedMaterial = On, e.LineBasicMaterial = Pi, e.Material = Yt, e.Float64BufferAttribute = Se, e.Float32BufferAttribute = Te, e.Uint32BufferAttribute = Ee, e.Int32BufferAttribute = Me, e.Uint16BufferAttribute = we, e.Int16BufferAttribute = _e, e.Uint8ClampedBufferAttribute = be, e.Uint8BufferAttribute = xe, e.Int8BufferAttribute = ye, e.BufferAttribute = ve, e.REVISION = g, e.MOUSE = {
    LEFT: 0,
    MIDDLE: 1,
    RIGHT: 2
  }, e.CullFaceNone = 0, e.CullFaceBack = 1, e.CullFaceFront = 2, e.CullFaceFrontBack = 3, e.FrontFaceDirectionCW = 0, e.FrontFaceDirectionCCW = 1, e.BasicShadowMap = 0, e.PCFShadowMap = 1, e.PCFSoftShadowMap = 2, e.FrontSide = 0, e.BackSide = 1, e.DoubleSide = 2, e.FlatShading = 1, e.SmoothShading = 2, e.NoColors = 0, e.FaceColors = 1, e.VertexColors = 2, e.NoBlending = 0, e.NormalBlending = 1, e.AdditiveBlending = 2, e.SubtractiveBlending = 3, e.MultiplyBlending = 4, e.CustomBlending = 5, e.AddEquation = 100, e.SubtractEquation = 101, e.ReverseSubtractEquation = 102, e.MinEquation = 103, e.MaxEquation = 104, e.ZeroFactor = 200, e.OneFactor = 201, e.SrcColorFactor = 202, e.OneMinusSrcColorFactor = 203, e.SrcAlphaFactor = 204, e.OneMinusSrcAlphaFactor = 205, e.DstAlphaFactor = 206, e.OneMinusDstAlphaFactor = 207, e.DstColorFactor = 208, e.OneMinusDstColorFactor = 209, e.SrcAlphaSaturateFactor = 210, e.NeverDepth = 0, e.AlwaysDepth = 1, e.LessDepth = 2, e.LessEqualDepth = 3, e.EqualDepth = 4, e.GreaterEqualDepth = 5, e.GreaterDepth = 6, e.NotEqualDepth = 7, e.MultiplyOperation = 0, e.MixOperation = 1, e.AddOperation = 2, e.NoToneMapping = 0, e.LinearToneMapping = 1, e.ReinhardToneMapping = 2, e.Uncharted2ToneMapping = 3, e.CineonToneMapping = 4, e.UVMapping = 300, e.CubeReflectionMapping = 301, e.CubeRefractionMapping = 302, e.EquirectangularReflectionMapping = 303, e.EquirectangularRefractionMapping = 304, e.SphericalReflectionMapping = 305, e.CubeUVReflectionMapping = 306, e.CubeUVRefractionMapping = 307, e.RepeatWrapping = v, e.ClampToEdgeWrapping = y, e.MirroredRepeatWrapping = x, e.NearestFilter = b, e.NearestMipMapNearestFilter = 1004, e.NearestMipMapLinearFilter = 1005, e.LinearFilter = _, e.LinearMipMapNearestFilter = 1007, e.LinearMipMapLinearFilter = w, e.UnsignedByteType = 1009, e.ByteType = 1010, e.ShortType = 1011, e.UnsignedShortType = M, e.IntType = 1013, e.UnsignedIntType = 1014, e.FloatType = E, e.HalfFloatType = 1016, e.UnsignedShort4444Type = 1017, e.UnsignedShort5551Type = 1018, e.UnsignedShort565Type = 1019, e.UnsignedInt248Type = T, e.AlphaFormat = 1021, e.RGBFormat = S, e.RGBAFormat = A, e.LuminanceFormat = 1024, e.LuminanceAlphaFormat = 1025, e.RGBEFormat = 1023, e.DepthFormat = R, e.DepthStencilFormat = L, e.RGB_S3TC_DXT1_Format = 2001, e.RGBA_S3TC_DXT1_Format = 2002, e.RGBA_S3TC_DXT3_Format = 2003, e.RGBA_S3TC_DXT5_Format = 2004, e.RGB_PVRTC_4BPPV1_Format = 2100, e.RGB_PVRTC_2BPPV1_Format = 2101, e.RGBA_PVRTC_4BPPV1_Format = 2102, e.RGBA_PVRTC_2BPPV1_Format = 2103, e.RGB_ETC1_Format = 2151, e.LoopOnce = 2200, e.LoopRepeat = 2201, e.LoopPingPong = 2202, e.InterpolateDiscrete = 2300, e.InterpolateLinear = 2301, e.InterpolateSmooth = 2302, e.ZeroCurvatureEnding = P, e.ZeroSlopeEnding = 2401, e.WrapAroundEnding = 2402, e.TrianglesDrawMode = 0, e.TriangleStripDrawMode = 1, e.TriangleFanDrawMode = 2, e.LinearEncoding = C, e.sRGBEncoding = 3001, e.GammaEncoding = 3007, e.RGBEEncoding = 3002, e.LogLuvEncoding = 3003, e.RGBM7Encoding = 3004, e.RGBM16Encoding = 3005, e.RGBDEncoding = 3006, e.BasicDepthPacking = 3200, e.RGBADepthPacking = 3201, e.CubeGeometry = Fe, e.Face4 = function(t, e, i, n, r, a, o) {
    return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."), new de(t, e, i, r, a, o)
  }, e.LineStrip = 0, e.LinePieces = 1, e.MeshFaceMaterial = function(t) {
    return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."), t
  }, e.MultiMaterial = function(t) {
    return void 0 === t && (t = []), console.warn("THREE.MultiMaterial has been removed. Use an Array instead."), t.isMultiMaterial = !0, t.materials = t, t.clone = function() {
      return t.slice()
    }, t
  }, e.PointCloud = function(t, e) {
    return console.warn("THREE.PointCloud has been renamed to THREE.Points."), new Oi(t, e)
  }, e.Particle = function(t) {
    return console.warn("THREE.Particle has been renamed to THREE.Sprite."), new Ti(t)
  }, e.ParticleSystem = function(t, e) {
    return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."), new Oi(t, e)
  }, e.PointCloudMaterial = function(t) {
    return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."), new Di(t)
  }, e.ParticleBasicMaterial = function(t) {
    return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."), new Di(t)
  }, e.ParticleSystemMaterial = function(t) {
    return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."), new Di(t)
  }, e.Vertex = function(t, e, i) {
    return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."), new N(t, e, i)
  }, e.DynamicBufferAttribute = function(t, e) {
    return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."), new ve(t, e).setDynamic(!0)
  }, e.Int8Attribute = function(t, e) {
    return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."), new ye(t, e)
  }, e.Uint8Attribute = function(t, e) {
    return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."), new xe(t, e)
  }, e.Uint8ClampedAttribute = function(t, e) {
    return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."), new be(t, e)
  }, e.Int16Attribute = function(t, e) {
    return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."), new _e(t, e)
  }, e.Uint16Attribute = function(t, e) {
    return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."), new we(t, e)
  }, e.Int32Attribute = function(t, e) {
    return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."), new Me(t, e)
  }, e.Uint32Attribute = function(t, e) {
    return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."), new Ee(t, e)
  }, e.Float32Attribute = function(t, e) {
    return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."), new Te(t, e)
  }, e.Float64Attribute = function(t, e) {
    return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."), new Se(t, e)
  }, e.ClosedSplineCurve3 = uo, e.SplineCurve3 = po, e.Spline = fo, e.AxisHelper = function(t) {
    return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."), new $a(t)
  }, e.BoundingBoxHelper = function(t, e) {
    return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."), new Za(t, e)
  }, e.EdgesHelper = function(t, e) {
    return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."), new Ii(new xn(t.geometry), new Pi({
      color: void 0 !== e ? e : 16777215
    }))
  }, e.WireframeHelper = function(t, e) {
    return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."), new Ii(new Gi(t.geometry), new Pi({
      color: void 0 !== e ? e : 16777215
    }))
  }, e.XHRLoader = function(t) {
    return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."), new Hn(t)
  }, e.BinaryTextureLoader = function(t) {
    return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."), new kn(t)
  }, e.GeometryUtils = mo, e.ImageUtils = go, e.Projector = function() {
    console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."), this.projectVector = function(t, e) {
      console.warn("THREE.Projector: .projectVector() is now vector.project()."), t.project(e)
    }, this.unprojectVector = function(t, e) {
      console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."), t.unproject(e)
    }, this.pickingRay = function() {
      console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")
    }
  }, e.CanvasRenderer = function() {
    console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"), this.domElement = document.createElement("canvas"), this.clear = function() {}, this.render = function() {}, this.setClearColor = function() {}, this.setSize = function() {}
  }, Object.defineProperty(e, "__esModule", {
    value: !0
  })
}));
},{"../../@babel/runtime/helpers/typeof":30}],71:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = {
    Linear: function(t, n, e, u) {
      return e * t / u + n
    },
    Quad: {
      easeIn: function(t, n, e, u) {
        return e * (t /= u) * t + n
      },
      easeOut: function(t, n, e, u) {
        return -e * (t /= u) * (t - 2) + n
      },
      easeInOut: function(t, n, e, u) {
        return (t /= u / 2) < 1 ? e / 2 * t * t + n : -e / 2 * (--t * (t - 2) - 1) + n
      }
    },
    Cubic: {
      easeIn: function(t, n, e, u) {
        return e * (t /= u) * t * t + n
      },
      easeOut: function(t, n, e, u) {
        return e * ((t = t / u - 1) * t * t + 1) + n
      },
      easeInOut: function(t, n, e, u) {
        return (t /= u / 2) < 1 ? e / 2 * t * t * t + n : e / 2 * ((t -= 2) * t * t + 2) + n
      }
    },
    Quart: {
      easeIn: function(t, n, e, u) {
        return e * (t /= u) * t * t * t + n
      },
      easeOut: function(t, n, e, u) {
        return -e * ((t = t / u - 1) * t * t * t - 1) + n
      },
      easeInOut: function(t, n, e, u) {
        return (t /= u / 2) < 1 ? e / 2 * t * t * t * t + n : -e / 2 * ((t -= 2) * t * t * t - 2) + n
      }
    },
    Quint: {
      easeIn: function(t, n, e, u) {
        return e * (t /= u) * t * t * t * t + n
      },
      easeOut: function(t, n, e, u) {
        return e * ((t = t / u - 1) * t * t * t * t + 1) + n
      },
      easeInOut: function(t, n, e, u) {
        return (t /= u / 2) < 1 ? e / 2 * t * t * t * t * t + n : e / 2 * ((t -= 2) * t * t * t * t + 2) + n
      }
    },
    Sine: {
      easeIn: function(t, n, e, u) {
        return -e * Math.cos(t / u * (Math.PI / 2)) + e + n
      },
      easeOut: function(t, n, e, u) {
        return e * Math.sin(t / u * (Math.PI / 2)) + n
      },
      easeInOut: function(t, n, e, u) {
        return -e / 2 * (Math.cos(Math.PI * t / u) - 1) + n
      }
    },
    Expo: {
      easeIn: function(t, n, e, u) {
        return 0 == t ? n : e * Math.pow(2, 10 * (t / u - 1)) + n
      },
      easeOut: function(t, n, e, u) {
        return t == u ? n + e : e * (1 - Math.pow(2, -10 * t / u)) + n
      },
      easeInOut: function(t, n, e, u) {
        return 0 == t ? n : t == u ? n + e : (t /= u / 2) < 1 ? e / 2 * Math.pow(2, 10 * (t - 1)) + n : e / 2 * (2 - Math.pow(2, -10 * --t)) + n
      }
    },
    Circ: {
      easeIn: function(t, n, e, u) {
        return -e * (Math.sqrt(1 - (t /= u) * t) - 1) + n
      },
      easeOut: function(t, n, e, u) {
        return e * Math.sqrt(1 - (t = t / u - 1) * t) + n
      },
      easeInOut: function(t, n, e, u) {
        return (t /= u / 2) < 1 ? -e / 2 * (Math.sqrt(1 - t * t) - 1) + n : e / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + n
      }
    },
    Elastic: {
      easeIn: function(t, n, e, u, a, r) {
        var o;
        return 0 == t ? n : 1 == (t /= u) ? n + e : (void 0 === r && (r = .3 * u), !a || a < Math.abs(e) ? (o = r / 4, a = e) : o = r / (2 * Math.PI) * Math.asin(e / a), -a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * u - o) * (2 * Math.PI) / r) + n)
      },
      easeOut: function(t, n, e, u, a, r) {
        var o;
        return 0 == t ? n : 1 == (t /= u) ? n + e : (void 0 === r && (r = .3 * u), !a || a < Math.abs(e) ? (a = e, o = r / 4) : o = r / (2 * Math.PI) * Math.asin(e / a), a * Math.pow(2, -10 * t) * Math.sin((t * u - o) * (2 * Math.PI) / r) + e + n)
      },
      easeInOut: function(t, n, e, u, a, r) {
        var o;
        return 0 == t ? n : 2 == (t /= u / 2) ? n + e : (void 0 === r && (r = u * (.3 * 1.5)), !a || a < Math.abs(e) ? (a = e, o = r / 4) : o = r / (2 * Math.PI) * Math.asin(e / a), t < 1 ? a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * u - o) * (2 * Math.PI) / r) * -.5 + n : a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * u - o) * (2 * Math.PI) / r) * .5 + e + n)
      }
    },
    Back: {
      easeIn: function(t, n, e, u, a) {
        return void 0 === a && (a = 1.70158), e * (t /= u) * t * ((a + 1) * t - a) + n
      },
      easeOut: function(t, n, e, u, a) {
        return void 0 === a && (a = 1.70158), e * ((t = t / u - 1) * t * ((a + 1) * t + a) + 1) + n
      },
      easeInOut: function(t, n, e, u, a) {
        return void 0 === a && (a = 1.70158), (t /= u / 2) < 1 ? e / 2 * (t * t * ((1 + (a *= 1.525)) * t - a)) + n : e / 2 * ((t -= 2) * t * ((1 + (a *= 1.525)) * t + a) + 2) + n
      }
    },
    Bounce: {
      easeIn: function(n, e, u, a) {
        return u - t.Bounce.easeOut(a - n, 0, u, a) + e
      },
      easeOut: function(t, n, e, u) {
        return (t /= u) < 1 / 2.75 ? e * (7.5625 * t * t) + n : t < 2 / 2.75 ? e * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + n : t < 2.5 / 2.75 ? e * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + n : e * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + n
      },
      easeInOut: function(n, e, u, a) {
        return n < a / 2 ? .5 * t.Bounce.easeIn(2 * n, 0, u, a) + e : .5 * t.Bounce.easeOut(2 * n - a, 0, u, a) + .5 * u + e
      }
    }
  },
  n = t;
exports.default = n;
},{}],72:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.changeCanvasType = function(e) {
  p = e
}, exports.create使用rInfoButton = function(e, n, t, o) {
  var i = t.x,
    c = t.y,
    u = t.width,
    s = t.height;
  if (x[e]) return void w(e);
  var a = p;
  d(!1, !1).catch((function() {
    if (a === p) {
      var t = (0, r.getSystemInfo)(),
        f = t.screenWidth / r.DESIGN_WIDTH,
        h = t.screenHeight / r.DESIGN_HEIGHT,
        l = 0,
        I = 0,
        g = 0;
      t.screenWidth / t.screenHeight < r.DESIGN_WIDTH / r.DESIGN_HEIGHT && (l = (t.screenHeight - r.DESIGN_HEIGHT * t.screenWidth / r.DESIGN_WIDTH) / 2, h = t.screenWidth / r.DESIGN_WIDTH, I = i - r.DESIGN_WIDTH / 2), t.screenWidth / t.screenHeight > r.DESIGN_WIDTH / r.DESIGN_HEIGHT && (g = t.screenWidth / (r.DESIGN_WIDTH * t.screenHeight / r.DESIGN_HEIGHT), I = (i - r.DESIGN_WIDTH / 2) / g), x[e] = 0 === n ? wx.create使用rInfoButton({
        type: "image",
        style: {
          left: (r.DESIGN_WIDTH / 2 + I) * f - u * h / 2,
          top: l + c * h - s * h / 2,
          width: u * h,
          height: s * h,
          backgroundColor: "rgba(255, 0, 0, 0)"
        }
      }) : wx.create使用rInfoButton({
        type: "image",
        style: {
          left: i * h,
          top: c * h,
          width: u * h,
          height: s * h,
          backgroundColor: "rgba(255, 0, 0, 0)"
        }
      }), x[e].onTap((function(e) {
        e.errMsg.indexOf(":ok") > -1 && e.rawData && (v(), o && o())
      }))
    }
  }))
}, exports.getAuth使用rInfo = d, exports.getAuthWxFriendInteraction = function() {
  var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
  return I("WxFriendInteraction", e)
}, exports.hide使用rInfoButton = function() {
  for (var e in x) x[e] && x[e].hide()
}, exports.needAuthorization = h, exports.requirePrivacyAuthorize = f, exports.scope = void 0, exports.show使用rInfoButton = w;
var e, n = require("../../@babel/runtime/helpers/regeneratorRuntime"),
  t = require("../../@babel/runtime/helpers/asyncToGenerator"),
  r = require("../config"),
  o = (e = require("../lib/mue/eventcenter")) && e.__esModule ? e : {
    default: e
  };
var i = {
  WxFriendInteraction: !1,
  userInfo: !1
};
exports.scope = i;
var c = {
    WxFriendInteraction: "需要先授权微信朋友关系",
    userInfo: "需要先授权用户信息"
  },
  u = {
    WxFriendInteraction: null,
    userInfo: null
  },
  s = !1,
  a = 0;

function f() {
  return new Promise((function(e, n) {
    wx.requirePrivacyAuthorize ? Date.now() - a < 3e3 ? n() : (a = Date.now(), wx.requirePrivacyAuthorize({
      success: function() {
        e("")
      },
      fail: function() {
        n()
      }
    })) : n()
  }))
}

function h() {
  return new Promise((function(e, n) {
    wx.getPrivacySetting || n(""), wx.getPrivacySetting({
      success: function(t) {
        t.needAuthorization ? e("") : n()
      },
      fail: function() {
        n()
      }
    })
  }))
}

function l(e, n, t, r, o) {
  wx.authorize({
    scope: "scope.".concat(e)
  }).then((function() {
    r("")
  })).catch((function(i) {
    i.errMsg.indexOf("not authorized in gap") > -1 && (s ? wx.showToast({
      icon: "none",
      title: "授权失败，请稍后再试"
    }) : (s = !0, wx.getPrivacySetting({
      success: function(e) {
        e.needAuthorization || wx.showToast({
          icon: "none",
          title: "授权失败，请稍后再试"
        })
      }
    }))), i.errMsg.indexOf("auth deny") > -1 && t && !1 === n ? wx.showModal({
      content: c[e],
      confirmText: "去授权",
      success: function(n) {
        n.confirm ? wx.openSetting({
          success: function(n) {
            !0 === n.authSetting["scope.".concat(e)] ? r("") : o()
          },
          fail: function() {
            o()
          }
        }) : o()
      },
      fail: function() {
        o()
      }
    }) : o()
  }))
}

function I(e) {
  return g.apply(this, arguments)
}

function g() {
  return (g = t(n().mark((function e(t) {
    var o, c, s, a = arguments;
    return n().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          return o = !(a.length > 1 && void 0 !== a[1]) || a[1], c = !(a.length > 2 && void 0 !== a[2]) || a[2], console.log("!!! getAuth", t, o, c), e.next = 5, (0, r.getSetting)(!0);
        case 5:
          if (s = e.sent, console.log("!!! getAuth res", s), !u[t]) {
            e.next = 9;
            break
          }
          return e.abrupt("return", u[t]);
        case 9:
          return u[t] = new Promise((function(e, n) {
            var r = s.authSetting["scope.".concat(t)];
            !0 !== r ? h().then((function() {
              c ? f().then((function() {
                l(t, r, o, e, n)
              })).catch((function() {
                n()
              })) : n()
            })).catch((function() {
              l(t, r, o, e, n)
            })) : e("")
          })).then((function() {
            return i[t] = !0, Promise.resolve("")
          })).catch((function() {
            return i[t] = !1, Promise.reject()
          })).finally((function() {
            u[t] = null
          })), e.abrupt("return", u[t]);
        case 11:
        case "end":
          return e.stop()
      }
    }), e)
  })))).apply(this, arguments)
}

function d() {
  var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0],
    n = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
  return I("userInfo", e, n)
}
var p = null;
var x = {};

function v() {
  for (var e in x) x[e] && (x[e].destroy(), x[e] = null)
}

function w(e) {
  x[e].show()
}
o.default.on(r.EVENT.INIT_SETTING_COMPLETE, (function() {
  console.log("!!! EventCenter.on getAuth使用rInfo"), d(!1, !1).then((function() {
    v()
  }))
}));
},{"../../@babel/runtime/helpers/asyncToGenerator":6,"../../@babel/runtime/helpers/regeneratorRuntime":22,"../config":37,"../lib/mue/eventcenter":67}],73:[function(require,module,exports){
// OFFLINE MODE - All API calls disabled, return mock data immediately
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0, exports.upLoadVerifyPic = function(e) {
  // OFFLINE: disabled
  console.log('[OFFLINE] upLoadVerifyPic disabled');
  if (e.complete) e.complete();
}, exports.upLoadVerifySubmit = function(e) {
  // OFFLINE: disabled
  console.log('[OFFLINE] upLoadVerifySubmit disabled');
  if (e.complete) e.complete();
};

var e = require("../../@babel/runtime/helpers/objectSpread2"),
  t = require("../../@babel/runtime/helpers/typeof"),
  a = require("../../@babel/runtime/helpers/classCallCheck"),
  s = require("../../@babel/runtime/helpers/createClass"),
  o = d(require("../store/session")),
  n = d(require("../store/storage")),
  i = require("../util/encryption"),
  r = require("./../config"),
  u = d(require("../lib/mue/eventcenter"));

function d(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

var c = "https://mp.weixin.qq.com",
  l = function() {
    function d() {
      a(this, d)
    }
    return s(d, null, [{
      key: "onServerConfigForbid",
      value: function(e) {
        this.emmitServerConfigForbid = e
      }
    }, {
      key: "get使用rInfo",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: return mock user info
        console.log('[OFFLINE] get使用rInfo - returning mock data');
        var mockData = {
          nickname: 'Player',
          headimg: 'res/ava.png',
          open_id: 'offline_player_' + Date.now()
        };
        e(mockData);
        n.default.saveMy使用rInfo(mockData);
        return Promise.resolve(mockData);
      }
    }, {
      key: "login",
      value: function() {
        // OFFLINE: return mock login
        console.log('[OFFLINE] login - returning mock session');
        var mockCode = 'offline_session_' + Date.now();
        o.default.setLoginState(mockCode);
        this.loginPromise = Promise.resolve(mockCode);
        return this.loginPromise;
      }
    }, {
      key: "requestLogin",
      value: function(e) {
        e = e || function() {};
        // OFFLINE: always succeed
        console.log('[OFFLINE] requestLogin - success');
        e(!0);
      }
    }, {
      key: "requestFriends本次得分",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: return empty 位好友 list
        console.log('[OFFLINE] requestFriends本次得分 - returning empty list');
        var mockData = {
          user_info: [],
          my_user_info: {
            nickname: 'Player',
            headimg: 'res/ava.png',
            week_best_score: 0,
            history_best_score: 0
          }
        };
        e(!0, mockData);
        return Promise.resolve(mockData);
      }
    }, {
      key: "requestSettlement",
      value: function() {
        var score = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0,
          times = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,
          callback = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : function() {},
          gameData = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {};
        // OFFLINE: always succeed with no ban
        console.log('[OFFLINE] requestSettlement - score:', score);
        var mockResponse = {
          week_best_score: score,
          history_best_score: score,
          cheater_status: 0,
          appeal_status: 0
        };
        callback(!0, { banType: 0 }, mockResponse);
      }
    }, {
      key: "requestCreateGame",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] requestCreateGame - disabled');
        e(!1, "Offline mode");
      }
    }, {
      key: "reGetSessionId",
      value: function(e, t) {
        // OFFLINE: just call callback with success
        console.log('[OFFLINE] reGetSessionId');
        if (t) t(!0);
      }
    }, {
      key: "requestInit",
      value: function(e) {
        // OFFLINE: emit init response with empty config
        console.log('[OFFLINE] requestInit - emitting empty config');
        u.default.emit(r.EVENT.INITRESPONSE, { version: 1 });
      }
    }, {
      key: "requestServerInit",
      value: function(e) {
        // OFFLINE: disabled
        console.log('[OFFLINE] requestServerInit - disabled');
      }
    }, {
      key: "requestMmpayBonus",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] requestMmpayBonus - disabled');
        e(!1);
      }
    }, {
      key: "getGroup本次得分",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] getGroup本次得分 - disabled');
        e(!1);
      }
    }, {
      key: "createPK",
      value: function(e, t) {
        // OFFLINE: disabled
        console.log('[OFFLINE] createPK - disabled');
        return Promise.reject();
      }
    }, {
      key: "getBattleData",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] getBattleData - disabled');
        e(!1);
      }
    }, {
      key: "updatepkinfo",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] updatepkinfo - disabled');
        e(!1);
      }
    }, {
      key: "quitGame",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: always succeed
        console.log('[OFFLINE] quitGame');
        e(!0);
      }
    }, {
      key: "syncop",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] syncop - disabled');
        e(!1);
      }
    }, {
      key: "sendReport",
      value: function() {
        // OFFLINE: disabled
        console.log('[OFFLINE] sendReport - disabled');
      }
    }, {
      key: "sendEggReport",
      value: function(e) {
        // OFFLINE: disabled
        console.log('[OFFLINE] sendEggReport - disabled');
      }
    }, {
      key: "badReport",
      value: function(e, t) {
        // OFFLINE: disabled
        console.log('[OFFLINE] badReport - disabled');
      }
    }, {
      key: "logReport",
      value: function(e) {
        // OFFLINE: disabled
        console.log('[OFFLINE] logReport - disabled');
      }
    }, {
      key: "requestBadjs",
      value: function(e, t) {
        // OFFLINE: disabled
        console.log('[OFFLINE] requestBadjs - disabled');
      }
    }, {
      key: "sendServerError",
      value: function(e) {
        // OFFLINE: disabled
        console.log('[OFFLINE] sendServerError - disabled');
      }
    }, {
      key: "createRouterId",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] createRouterId - disabled');
        e(!1, "offline");
      }
    }, {
      key: "getWeeklyPlayBack",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
        // OFFLINE: disabled
        console.log('[OFFLINE] getWeeklyPlayBack - disabled');
        e(!1);
      }
    }, {
      key: "getFriendPlayBack",
      value: function(e) {
        // OFFLINE: disabled
        console.log('[OFFLINE] getFriendPlayBack - disabled');
        return Promise.reject();
      }
    }, {
      key: "getOpenPlaybackData",
      value: function() {
        // OFFLINE: disabled
        console.log('[OFFLINE] getOpenPlaybackData - disabled');
        return Promise.reject();
      }
    }, {
      key: "syncSelectedBottleSkin",
      value: function(e) {
        // OFFLINE: always succeed
        console.log('[OFFLINE] syncSelectedBottleSkin');
        return Promise.resolve();
      }
    }, {
      key: "getBottleSkinShopData",
      value: function() {
        // OFFLINE: return empty shop
        console.log('[OFFLINE] getBottleSkinShopData - returning empty');
        return Promise.resolve({
          can使用SkinIdList: [],
          bottleSkinShopList: []
        });
      }
    }, {
      key: "get使用rProfile",
      value: function(e) {
        // OFFLINE: disabled
        console.log('[OFFLINE] get使用rProfile - disabled');
        return Promise.reject();
      }
    }, {
      key: "sendLikeTo",
      value: function(e) {
        // OFFLINE: disabled
        console.log('[OFFLINE] sendLikeTo - disabled');
        return Promise.reject();
      }
    }, {
      key: "requestWithId",
      value: function(t) {
        // OFFLINE: call fail callback
        console.log('[OFFLINE] requestWithId - disabled');
        if (t.fail) t.fail("offline mode");
      }
    }, {
      key: "requestWithIdPromise",
      value: function() {
        // OFFLINE: reject
        console.log('[OFFLINE] requestWithIdPromise - disabled');
        return Promise.reject("offline mode");
      }
    }, {
      key: "requestMsg",
      value: function(e) {
        console.log('[OFFLINE] requestMsg - disabled');
        return Promise.reject();
      }
    }, {
      key: "requestMsgRedPot",
      value: function() {
        console.log('[OFFLINE] requestMsgRedPot - disabled');
        return Promise.reject();
      }
    }, {
      key: "getproperty",
      value: function() {
        console.log('[OFFLINE] getproperty - disabled');
        return Promise.resolve({ property_list: [] });
      }
    }, {
      key: "useproperty",
      value: function(e) {
        console.log('[OFFLINE] useproperty - disabled');
        return Promise.reject();
      }
    }, {
      key: "revertproperty",
      value: function(e) {
        console.log('[OFFLINE] revertproperty - disabled');
        return Promise.reject();
      }
    }, {
      key: "getGiftData",
      value: function(e) {
        console.log('[OFFLINE] getGiftData - disabled');
        return Promise.reject();
      }
    }, {
      key: "getSkin",
      value: function(e) {
        console.log('[OFFLINE] getSkin - disabled');
        return Promise.reject();
      }
    }, {
      key: "getBlock",
      value: function(e) {
        console.log('[OFFLINE] getBlock - disabled');
        return Promise.reject();
      }
    }, {
      key: "getAdReward",
      value: function() {
        console.log('[OFFLINE] getAdReward - disabled');
        return Promise.reject();
      }
    }, {
      key: "showBannerAd",
      value: function() {
        console.log('[OFFLINE] showBannerAd - disabled');
        return Promise.reject();
      }
    }, {
      key: "sceneLogin",
      value: function(e) {
        console.log('[OFFLINE] sceneLogin - returning mock');
        if (e) e({ ad_reward_quota: 0, ad_banner_quota: 0 });
      }
    }, {
      key: "requestWithEncryptedData",
      value: function() {
        console.log('[OFFLINE] requestWithEncryptedData - disabled');
        return Promise.reject("offline mode");
      }
    }, {
      key: "getActivityId",
      value: function() {
        console.log('[OFFLINE] getActivityId - disabled');
        return Promise.reject();
      }
    }, {
      key: "sendChatToolMsg",
      value: function() {
        console.log('[OFFLINE] sendChatToolMsg - disabled');
        return Promise.reject();
      }
    }]), d
  }();

function f(e, t, a) {
  var s = {};
  return a.map((function(e) {
    s[e.item_id] = e.poster_min
  })), e.bottle_skin = s[e.bottle_skin_id], t.map((function(e) {
    e.bottle_skin = s[e.bottle_skin_id]
  })), {
    my_user_info: e,
    user_info: t
  }
}

function g(e, t) {
  var a = t ? e + "(" + t + ")" : e;
  console.log('[OFFLINE] showModal:', a);
}

function m() {
  var e, t, a, s = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
  try {
    e = JSON.parse(s.resources) || {}
  } catch (t) {
    e = {}
  }
  return s.expire_time && (a = Math.floor(Date.now() / 1e3), t = s.expire_time - a), {
    display_info: e.display_info || {},
    img: e.display_info && e.display_info.poster,
    use_status: s.useble || 0,
    unlock_wording: e.display_info && e.display_info.unlock_wording,
    left_time: t,
    expire_time: s.expire_time,
    type: e.type,
    id: s.item_id,
    property: e.property
  }
}
exports.default = l;

},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/objectSpread2":20,"../../@babel/runtime/helpers/typeof":30,"../lib/mue/eventcenter":67,"../store/session":127,"../store/storage":128,"../util/encryption":137,"./../config":37}],74:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../../@babel/runtime/helpers/classCallCheck"),
  e = require("../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(e) {
      t(this, i), this.optionReport = e.report || function() {}, this.duration = e.duration || 7e3, this.logMessage = "", this.logMaxLength = e.logMaxLength || 5e3, this.timeout = null, this.haveReport = 0
    }
    return e(i, [{
      key: "start",
      value: function() {
        var t = this;
        this.timeout || this.haveReport || (this.timeout = setTimeout((function() {
          t.report()
        }), this.duration))
      }
    }, {
      key: "pulse",
      value: function() {
        var t = this;
        this.timeout && (this.rpClearTimeout(), this.timeout = setTimeout((function() {
          t.report()
        }), this.duration))
      }
    }, {
      key: "stop",
      value: function() {
        this.rpClearTimeout()
      }
    }, {
      key: "rpClearTimeout",
      value: function() {
        this.timeout && (clearTimeout(this.timeout), this.timeout = null)
      }
    }, {
      key: "report",
      value: function() {
        this.haveReport = 1, this.optionReport(this.logMessage), this.logMessage = ""
      }
    }, {
      key: "log",
      value: function() {
        for (var t = arguments.length, e = new Array(t), i = 0; i < t; i++) e[i] = arguments[i];
        var o = e.join(";;;");
        if (o) {
          this.logMessage += o;
          var s = this.logMessage.length;
          if (s > this.logMaxLength) {
            var r = s - this.logMaxLength;
            this.logMessage = this.logMessage.slice(r, s)
          }
        }
      }
    }]), i
  }();
exports.default = i;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8}],75:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = o(require("./network")),
  r = require("../config"),
  s = o(require("../lib/mue/eventcenter"));

function o(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var a = function() {
  function o() {
    e(this, o), this.timeOut = null, this.reportList = [], this.pkState = {
      isGroup: 0,
      score: 0
    }, this.singleState = 0, this.observeState = {
      startTime: 0,
      success: 0
    }, this.playerState = {
      startTime: 0,
      maxAudience: 0
    }, this.gameStartTime = 0;
    try {
      var t = (0, r.getSystemInfo)();
      this.clientInfo = {
        platform: t.platform,
        brand: t.brand,
        model: t.model,
        system: t.system,
        host: t.host
      }
    } catch (e) {
      console.log(e)
    }
    this.relayGameStartTime = 0, this.bindEvent()
  }
  return t(o, [{
    key: "bindEvent",
    value: function() {
      var e = this;
      s.default.on(r.EVENT.CREATE_RELAY_ROOM_FAIL, (function(t, i) {
        e.reportCreateRelayRoom(i)
      })), s.default.on(r.EVENT.RP_JOIN_RELAY_ROOM_AGAIN, (function(t, i) {
        e.reportPlayGameAgain({
          result: i.res
        })
      })), s.default.on(r.EVENT.RP_JOIN_RELAY_ROOM, (function(t, i) {
        e.reportJoinRelayRoom(i)
      })), s.default.on(r.EVENT.RP_RELAY_START, (function(t, i) {
        e.relayGameStartTime = e.getTime(), e.reportRelayStart(i), e.sendReport()
      })), s.default.on(r.EVENT.RP_RELAY_GAME_END, (function(t, i) {
        var r = 0;
        e.relayGameStartTime && (r = e.getTime() - e.relayGameStartTime), i.duration = r, e.reportRelayEnd(i)
      })), s.default.on(r.EVENT.CLOSE_HIGHEST_MODEL, (function(t, i) {
        var r = i.id;
        "history" == r && e.historyClose(), "week" == r && e.weekBestClose()
      })), s.default.on(r.EVENT.JUMP_AD, (function(t, i) {
        e.rpClickAdCard(i)
      })), s.default.on(r.EVENT.JUMP_AD_GG, (function(t, i) {
        e.rpJumpH5GameOver()
      }))
    }
  }, {
    key: "getTime",
    value: function() {
      var e = Date.now();
      return e = Math.floor(e / 1e3)
    }
  }, {
    key: "enterReport",
    value: function(e) {
      if (this.gameStartTime = this.getTime(), e) {
        var t = {
          ts: this.getTime(),
          type: 0,
          scene: e
        };
        this.reportList.push(t)
      }
    }
  }, {
    key: "quitReport",
    value: function() {
      if (this.gameStartTime) {
        var e = {
          ts: this.getTime(),
          type: 1,
          duration: this.getTime() - this.gameStartTime
        };
        this.reportList.push(e)
      }
    }
  }, {
    key: "playGameReport",
    value: function(e, t, i) {
      var r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1;
      if (this.singleState) {
        var s = {
          ts: this.getTime(),
          type: 2,
          score: e,
          best_score: t,
          break_record: e > t ? 1 : 0,
          duration: this.getTime() - this.singleState,
          times: i,
          using_prop: r
        };
        this.reportList.push(s), this.singleState = 0
      }
    }
  }, {
    key: "addEggBlockReport",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
        t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
        r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
        s = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {},
        o = [];
      for (var a in e) e[a = parseInt(a)] && o.push({
        id: a,
        count: e[a],
        type: 0
      }), t[a] && o.push({
        id: a,
        count: t[a],
        type: 1
      }), r[a] && o.push({
        id: a,
        count: r[a],
        type: 2
      }), s[a] && o.push({
        id: a,
        count: s[a],
        type: 3
      });
      i.default.sendEggReport(o)
    }
  }, {
    key: "playGameReportStart",
    value: function() {
      this.singleState = this.getTime()
    }
  }, {
    key: "shareAudienceReport",
    value: function(e) {
      var t = {
        ts: this.getTime(),
        type: 3,
        is_group: e
      };
      this.reportList.push(t)
    }
  }, {
    key: "playAudienceReport",
    value: function() {
      if (this.playerState.startTime) {
        var e = {
          ts: this.getTime(),
          type: 4,
          duration: this.getTime() - this.playerState.startTime,
          max_audience: this.playerState.maxAudience
        };
        this.reportList.push(e), this.playerState.startTime = 0, this.playerState.maxAudience = 0
      }
    }
  }, {
    key: "playAudienceReportStart",
    value: function() {
      this.playerState.startTime = this.getTime()
    }
  }, {
    key: "playAudienceReportMaxPeople",
    value: function(e) {
      this.playerState.maxAudience < e && (this.playerState.maxAudience = e)
    }
  }, {
    key: "joinAudienceReport",
    value: function() {
      var e = 0 == this.observeState.startTime ? 0 : this.getTime() - this.observeState.startTime,
        t = {
          ts: this.getTime(),
          type: 5,
          duration: e,
          join_audience_success: this.observeState.success
        };
      this.reportList.push(t), this.observeState.startTime = 0, this.observeState.success = 0
    }
  }, {
    key: "joinAudienceReportStart",
    value: function() {
      this.observeState.startTime = this.getTime(), this.observeState.success = 1
    }
  }, {
    key: "shareGroupReport",
    value: function(e) {
      var t = {
        ts: this.getTime(),
        type: 6,
        is_group: e
      };
      this.reportList.push(t)
    }
  }, {
    key: "sharePKReport",
    value: function(e) {
      var t = {
        ts: this.getTime(),
        type: 7,
        is_group: e
      };
      this.reportList.push(t)
    }
  }, {
    key: "joinPKReport",
    value: function(e) {
      var t = {
        ts: this.getTime(),
        type: 8,
        is_group: e
      };
      this.reportList.push(t)
    }
  }, {
    key: "playPKReport",
    value: function(e) {
      var t = 0;
      e == this.pkState.score && (t = 1), e > this.pkState.score && (t = 3);
      var i = {
        ts: this.getTime(),
        type: 9,
        is_group: this.pkState.isGroup,
        result: t
      };
      this.reportList.push(i)
    }
  }, {
    key: "playPKReportStart",
    value: function(e) {
      this.pkState.isGroup = e
    }
  }, {
    key: "playPK本次得分",
    value: function(e) {
      this.pkState.score = e
    }
  }, {
    key: "resetPKReport",
    value: function() {
      this.pkState.isGroup = 0, this.pkState.score = 0
    }
  }, {
    key: "gameBeginReport",
    value: function() {
      var e = {
        ts: this.getTime(),
        type: 10
      };
      this.reportList.push(e)
    }
  }, {
    key: "reportGotoRelayMode",
    value: function() {
      var e = {
        ts: this.getTime(),
        type: 11
      };
      this.reportList.push(e)
    }
  }, {
    key: "reportCreateRelayRoom",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
        t = e.result,
        i = void 0 === t ? 0 : t,
        r = {
          ts: this.getTime(),
          type: 12,
          result: i
        };
      this.reportList.push(r)
    }
  }, {
    key: "reportJoinRelayRoom",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
        t = e.scene,
        i = void 0 === t ? 1 : t,
        r = e.result,
        s = void 0 === r ? 0 : r,
        o = {
          ts: this.getTime(),
          type: 13,
          scene: i,
          result: s
        };
      this.reportList.push(o)
    }
  }, {
    key: "reportRelayStart",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
        t = e.result,
        i = void 0 === t ? 0 : t,
        r = {
          ts: this.getTime(),
          type: 14,
          result: i
        };
      this.reportList.push(r)
    }
  }, {
    key: "reportRelayEnd",
    value: function(e) {
      var t = e.jielong_score,
        i = e.player_num,
        r = e.max_audience,
        s = e.difficulty,
        o = e.duration,
        a = {
          ts: this.getTime(),
          type: 15,
          player_num: i,
          max_audience: r,
          difficulty: s,
          jielong_score: t,
          duration: o
        };
      this.reportList.push(a)
    }
  }, {
    key: "reportPlayGameAgain",
    value: function(e) {
      var t = e.result,
        i = {
          ts: this.getTime(),
          type: 16,
          result: t
        };
      this.reportList.push(i)
    }
  }, {
    key: "clickStartPageRankBtn",
    value: function() {
      var e = {
        ts: this.getTime(),
        type: 21
      };
      this.reportList.push(e)
    }
  }, {
    key: "clickSingleSettlementPageRankBtn",
    value: function() {
      var e = {
        ts: this.getTime(),
        type: 22
      };
      this.reportList.push(e)
    }
  }, {
    key: "clickReviewBtn",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1,
        t = {
          ts: this.getTime(),
          type: 23,
          result: e
        };
      this.reportList.push(t)
    }
  }, {
    key: "singleBackStart",
    value: function() {
      this.record(24)
    }
  }, {
    key: "relayBackStart",
    value: function() {
      this.record(25)
    }
  }, {
    key: "historyBest",
    value: function() {
      this.record(26)
    }
  }, {
    key: "weekBest",
    value: function() {
      this.record(27)
    }
  }, {
    key: "history分享",
    value: function() {
      this.record(28)
    }
  }, {
    key: "weekBest分享",
    value: function() {
      this.record(29)
    }
  }, {
    key: "historyClose",
    value: function() {
      this.record(30)
    }
  }, {
    key: "weekBestClose",
    value: function() {
      this.record(31)
    }
  }, {
    key: "reportStartPage",
    value: function() {
      this.record(32)
    }
  }, {
    key: "rpWatchRelay",
    value: function() {
      this.record(33)
    }
  }, {
    key: "rpLike",
    value: function(e) {
      var t = e.open_user_id,
        i = void 0 === t ? "" : t,
        r = e.praise_over_limit,
        s = void 0 === r ? 1 : r,
        o = e.result,
        a = {
          open_user_id: i,
          praise_over_limit: s,
          result: void 0 === o ? 0 : o,
          type: 34,
          ts: this.getTime()
        };
      this.reportList.push(a)
    }
  }, {
    key: "rpSingleSettlePlayAgain",
    value: function() {
      this.record(35)
    }
  }, {
    key: "rpSingleSettleRankReview",
    value: function() {
      this.record(36)
    }
  }, {
    key: "rpSingleSettleRank分享Group",
    value: function() {
      this.record(37)
    }
  }, {
    key: "rpSingleSettleRankCloseRank",
    value: function() {
      this.record(38)
    }
  }, {
    key: "rpGetSkinSettle",
    value: function() {
      this.record(39)
    }
  }, {
    key: "rpGetSkinSettleClickSkin",
    value: function() {
      this.record(40)
    }
  }, {
    key: "rpGetSkinShowOff",
    value: function() {
      this.record(41)
    }
  }, {
    key: "rpGetSkin分享Goods",
    value: function() {
      this.record(42)
    }
  }, {
    key: "rpPlayerClickPlayAgain",
    value: function() {
      this.record(43)
    }
  }, {
    key: "rpRelayClickCard分享",
    value: function() {
      this.record(44)
    }
  }, {
    key: "rpRelayClickSunCode",
    value: function() {
      this.record(45)
    }
  }, {
    key: "rpStartPageClickFriendInfo",
    value: function() {
      this.record(46)
    }
  }, {
    key: "rpStartPageFriendInfoLike",
    value: function() {
      this.record(47)
    }
  }, {
    key: "rpStartPageFriendReview",
    value: function() {
      this.record(48)
    }
  }, {
    key: "rpStartPageGroup分享",
    value: function() {
      this.record(49)
    }
  }, {
    key: "rpStartPageRankClose",
    value: function() {
      this.record(50)
    }
  }, {
    key: "rpSkinInfo",
    value: function() {
      this.record(51)
    }
  }, {
    key: "rpMsgBox",
    value: function() {
      this.record(52)
    }
  }, {
    key: "rpShowAdCard",
    value: function() {
      this.record(53)
    }
  }, {
    key: "rpClickAdCard",
    value: function() {
      this.record(54)
    }
  }, {
    key: "rpClickSingleStartPage",
    value: function() {
      this.record(55)
    }
  }, {
    key: "rpClickObserve分享",
    value: function() {
      this.record(56)
    }
  }, {
    key: "rpClick分享Battle",
    value: function() {
      this.record(57)
    }
  }, {
    key: "rpClick分享Observe",
    value: function() {
      this.record(58)
    }
  }, {
    key: "rpGoProfileByMsgBox",
    value: function() {
      this.record(59)
    }
  }, {
    key: "rpGoSkinBySkinCenter",
    value: function() {
      this.record(60)
    }
  }, {
    key: "rpClickProfile",
    value: function(e) {
      this.record(61), e ? this.record(65) : this.record(66)
    }
  }, {
    key: "rpClickComeInSkin分享",
    value: function() {
      this.record(62)
    }
  }, {
    key: "rpGameOverOnlike",
    value: function() {
      this.record(63)
    }
  }, {
    key: "rpGameOverClickFriendInfo",
    value: function() {
      this.record(64)
    }
  }, {
    key: "rpAdGameOver",
    value: function() {
      this.record(67)
    }
  }, {
    key: "rpJumpH5GameOver",
    value: function() {
      this.record(68)
    }
  }, {
    key: "record",
    value: function(e) {
      if ("number" == typeof e) {
        var t = {
          ts: this.getTime(),
          type: e
        };
        this.reportList.push(t)
      }
    }
  }, {
    key: "best分享",
    value: function(e) {
      e && ("week" == e && this.weekBest分享(), "history" == e && this.history分享())
    }
  }, {
    key: "sendReport",
    value: function() {
      this.reportList.length && (i.default.sendReport(this.reportList, this.clientInfo), this.reportList = [])
    }
  }, {
    key: "clearTimer",
    value: function() {
      this.timeOut && clearInterval(this.timeOut)
    }
  }, {
    key: "setTimer",
    value: function(e) {
      this.timeOut = setInterval(this.sendReport.bind(this), e)
    }
  }]), o
}();
exports.default = a;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/mue/eventcenter":67,"./network":73}],76:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  a = n(require("../store/session")),
  o = n(require("./network"));

function n(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var s = function() {
  function n(t) {
    var a = this;
    e(this, n), this.alive = !1, this.noErr = !1, this.game = t, this.handlers = {}, this.handleSocketErr = "", this.heartBeat = [], wx.onSocketOpen((function(e) {
      a.alive = !0, "relay" == a.game.mode ? a.game.gameCtrl.onSocketOpen() : a.joinGame()
    })), wx.onSocketClose((function(e) {
      "player" != a.game.mode || a.noErr || (o.default.quitGame(), a.game.gameCtrl.onSocketCloseErr()), "observe" != a.game.mode || a.noErr || a.game.gameCtrl.onSocketCloseErr(), "relay" != a.game.mode || a.noErr || a.game.gameCtrl.onSocketCloseErr(), a.alive = !1, console.log("Socket close", e, "是否正常关闭：", a.noErr)
    })), wx.onSocketError((function(e) {})), wx.onSocketMessage((function(e) {
      var t;
      a.cleanHeartBeat(), a.heartBeat.push(setTimeout(a.sendHeartBeat.bind(a), 5e3));
      try {
        t = JSON.parse(e.data)
      } catch (e) {
        return a.game.handleWxOnError({
          message: "socket receive wrong msg JSON.parse(res.data) error",
          stack: ""
        }), void wx.closeSocket()
      }
      t.cmd, 106 === t.cmd && a.handleACK(t), 101 === t.cmd && a.handleJoinGame(t), t.cmd, 108 === t.cmd && a.handlePeopleCome(t), 102 === t.cmd && a.receiveCommand(t), 109 == t.cmd && a.close(), 107 == t.cmd && a.handlePlayerOut(), 401 != t.cmd && 402 != t.cmd || a.handleRelayCMD(t)
    }))
  }
  return t(n, [{
    key: "cleanHeartBeat",
    value: function() {
      if (this.heartBeat.length)
        for (; this.heartBeat.length;) {
          var e = this.heartBeat.pop();
          clearTimeout(e)
        }
    }
  }, {
    key: "connectSocket",
    value: function() {
      var e = this;
      console.log("connectSocket"), wx.connectSocket({
        url: "wss://wxagame.weixin.qq.com",
        success: function() {
          console.log("wx.connectSocket success")
        },
        fail: function(t) {
          e.alive = !1
        }
      })
    }
  }, {
    key: "sendCommand",
    value: function(e, t) {
      var o = a.default.gameId,
        n = a.default.gameTicket;
      if (o && n && e)
        if ("string" == typeof o) {
          var s = {
            cmd: 102,
            i: o,
            n: e,
            k: n,
            o: [JSON.stringify(t)]
          };
          wx.sendSocketMessage({
            data: JSON.stringify(s)
          })
        } else console.warn("Socket send cmd need gameId")
    }
  }, {
    key: "sendNullCommand",
    value: function() {
      var e = a.default.gameId,
        t = a.default.gameTicket;
      if (e && t)
        if ("string" == typeof e) {
          var o = {
            cmd: 102,
            i: e,
            k: t,
            o: []
          };
          wx.sendSocketMessage({
            data: JSON.stringify(o)
          })
        } else console.warn("Socket send cmd need gameId")
    }
  }, {
    key: "getCommand",
    value: function(e) {}
  }, {
    key: "sendRelayCmd",
    value: function(e) {
      var t = this;
      if (this.game.gameModel.relayInfo.router_id && a.default.sessionId && e) {
        var o = JSON.stringify(e),
          n = {
            cmd: 401,
            router_id: this.game.gameModel.relayInfo.router_id,
            session_id: a.default.sessionId,
            fast: 1,
            data: o
          };
        wx.sendSocketMessage({
          data: JSON.stringify(n),
          fail: function(e) {
            e && e.errMsg && (e.errMsg.match(/WebSocket is not connected$/) && (t.alive = !1))
          }
        })
      }
    }
  }, {
    key: "onRelayCmdCome",
    value: function(e) {
      this.handleRelayCMD = e
    }
  }, {
    key: "onPeopleCome",
    value: function(e) {
      this.peopleCome = e
    }
  }, {
    key: "onReciveCommand",
    value: function(e) {
      this.observerMessage = e
    }
  }, {
    key: "onJoinSuccess",
    value: function(e) {
      this.joinSuccess = e
    }
  }, {
    key: "onPlayerOut",
    value: function(e) {
      this.playerOutHandler = e
    }
  }, {
    key: "receiveCommand",
    value: function(e) {
      "function" == typeof this.observerMessage && e.o && e.o[0] && e.o[0].o && this.observerMessage(e.n, JSON.parse(e.o[0].o))
    }
  }, {
    key: "handlePeopleCome",
    value: function(e) {
      "function" == typeof this.peopleCome && this.peopleCome(e)
    }
  }, {
    key: "receiveACK",
    value: function() {}
  }, {
    key: "joinGame",
    value: function() {
      var e = a.default.gameId;
      if (a.default.sessionId && e) {
        var t = {
          cmd: 101,
          game_id: e,
          fast: 1,
          session_id: a.default.sessionId
        };
        wx.sendSocketMessage({
          data: JSON.stringify(t)
        })
      }
    }
  }, {
    key: "handleACK",
    value: function(e) {
      this.handlers.ack && this.handlers.ack.forEach((function(t) {
        t(e)
      }))
    }
  }, {
    key: "handleJoinGame",
    value: function(e) {
      if ("observe" == this.game.mode) switch (e.ret) {
        case 0:
        case 2:
          this.joinSuccess(!0);
          break;
        default:
          this.joinSuccess(!1)
      } else 0 != e.ret ? this.joinSuccess(!1) : this.joinSuccess(!0)
    }
  }, {
    key: "sendHeartBeat",
    value: function() {
      if ("player" == this.game.mode) this.sendNullCommand();
      else {
        wx.sendSocketMessage({
          data: JSON.stringify({
            cmd: 104
          })
        })
      }
    }
  }, {
    key: "quitObserve",
    value: function() {
      if (this.alive) {
        var e = {
          cmd: 109,
          fast: 1,
          game_id: a.default.gameId,
          session_id: a.default.sessionId
        };
        wx.sendSocketMessage({
          data: JSON.stringify(e)
        })
      }
    }
  }, {
    key: "close",
    value: function() {
      var e = this;
      this.alive && (this.cleanHeartBeat(), this.noErr = !0, console.log("emmit close"), wx.closeSocket(), a.default.clear分享Ticket(), a.default.clearGameId(), setTimeout((function() {
        e.reset()
      }), 1e3))
    }
  }, {
    key: "onSocketErr",
    value: function(e) {
      this.handleSocketErr = e
    }
  }, {
    key: "reset",
    value: function() {
      this.noErr = !1
    }
  }, {
    key: "handlePlayerOut",
    value: function() {
      "function" == typeof this.playerOutHandler && this.playerOutHandler()
    }
  }]), n
}();
exports.default = s;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../store/session":127,"./network":73}],77:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(t) {
      e(this, i), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.viewer = this.game.viewer, this.name = "game"
    }
    return t(i, [{
      key: "show",
      value: function() {
        console.log("!!! BattleGamePage show"), this.UI.show本次得分(), this.UI.reset本次得分Pos(), this.UI.scoreText.changeStyle({
          textAlign: "left"
        }), this.UI.showChampion本次得分(this.model.champion本次得分)
      }
    }, {
      key: "hide",
      value: function() {
        console.log("!!! BattleGamePage hide"), this.UI.hide本次得分(), this.UI.hideChampion本次得分()
      }
    }]), i
  }();
exports.default = i;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],78:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  l = function() {
    function l(t) {
      e(this, l), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "battlePage"
    }
    return t(l, [{
      key: "show",
      value: function(e) {
        console.log("!!! battlePkPage show", e), this.full2D.showPkPage(e)
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), l
  }();
exports.default = l;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],79:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  s = require("../../../@babel/runtime/helpers/createClass"),
  t = function() {
    function t(s) {
      e(this, t), this.game = s, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "battlePage", this.score = 0
    }
    return s(t, [{
      key: "show",
      value: function(e) {
        e.score && (this.score = e.score), console.log("!!! battlePkRulePage show", e, this.score), e.score = this.score, this.full2D.showPkRulePage(e)
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), t
  }();
exports.default = t;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],80:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass");
require("../../lib/animation"),
  function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var n = i(t);
    if (n && n.has(e)) return n.get(e);
    var r = {},
      l = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var u in e)
      if ("default" !== u && Object.prototype.hasOwnProperty.call(e, u)) {
        var o = l ? Object.getOwnPropertyDescriptor(e, u) : null;
        o && (o.get || o.set) ? Object.defineProperty(r, u, o) : r[u] = e[u]
      } r.default = e, n && n.set(e, r)
  }(require("../../lib/three"));

function i(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    n = new WeakMap;
  return (i = function(e) {
    return e ? n : t
  })(e)
}
var n = function() {
  function i(t) {
    var n = t.game,
      r = t.onClick使用,
      l = t.onReturn;
    e(this, i), this.game = n, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.onReturn = l, this.onClick使用 = r
  }
  return t(i, [{
    key: "show",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [],
        t = arguments.length > 1 ? arguments[1] : void 0,
        i = {
          id: 0,
          img: "res/defaultBottlePoster.png",
          type: 0,
          unlock_wording: "",
          use_status: 1,
          property: {}
        },
        n = e.find((function(e) {
          return 0 === e.id
        }));
      n || (e = [i].concat(e)), this.full2D.showSkin({
        id: t,
        skin_list: e,
        onClick使用: this.onClick使用,
        onReturn: this.onReturn
      })
    }
  }, {
    key: "setSelectSkin",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null;
      this.full2D.updateSkin && this.full2D.updateSkin({
        id: e
      })
    }
  }, {
    key: "hide",
    value: function() {
      this.game.full2D.hide2D()
    }
  }]), i
}();
exports.default = n;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../lib/animation":66,"../../lib/three":70}],81:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0, require("../../@babel/runtime/helpers/Arrayincludes");
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = _(t);
    if (i && i.has(e)) return i.get(e);
    var a = {},
      s = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var n in e)
      if ("default" !== n && Object.prototype.hasOwnProperty.call(e, n)) {
        var r = s ? Object.getOwnPropertyDescriptor(e, n) : null;
        r && (r.get || r.set) ? Object.defineProperty(a, n, r) : a[n] = e[n]
      } a.default = e, i && i.set(e, a);
    return a
  }(require("../lib/three")),
  a = require("../config"),
  s = E(require("../text")),
  n = require("../lib/animation"),
  r = require("./pages2d/base"),
  o = require("./pages2d/start"),
  l = require("./pages2d/beginner"),
  h = require("./pages2d/lookers"),
  c = require("./pages2d/pk"),
  y = require("./pages2d/rank"),
  u = require("./pages2d/gg"),
  p = require("./pages2d/verify"),
  d = require("./pages2d/relay"),
  v = require("./pages2d/record"),
  T = require("./pages2d/profile"),
  f = require("./pages2d/msg"),
  g = require("./pages2d/skin"),
  k = require("./pages2d/shareskin"),
  m = E(require("../lib/mue/eventcenter")),
  w = E(require("./headimgAnimation")),
  A = require("../network/getAuth");

function E(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

function _(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (_ = function(e) {
    return e ? i : t
  })(e)
}
var S = window.devicePixelRatio > 2 ? 2 : window.devicePixelRatio,
  R = window.innerHeight < window.innerWidth ? window.innerHeight : window.innerWidth,
  x = window.innerHeight > window.innerWidth ? window.innerHeight : window.innerWidth,
  P = x * S,
  b = R * S,
  C = ["btn", "list1", "list2", "bg"],
  N = a.FRUSTUMSIZE,
  Y = (wx.loadFont("res/num.ttf"), !1);
wx.onGameLiveStateChange && wx.onGameLiveStateChange((function(e) {
  var t = "start" === e.state;
  Y !== t && (Y = t, m.default.emit(a.EVENT.LIVESTATECHANGE, {
    isLive: t
  }))
}));
var V = function() {
  function E(t) {
    var o = this;
    e(this, E), this.model = t.model, this.texture = {}, this.material = {}, this.geometry = {}, this.obj = {}, this.canvas = {}, this.context = {}, this._touchInfo = {
      trackingID: -1,
      maxDy: 0,
      maxDx: 0
    }, this.maxscroll = 0, this.options = Object.assign({}, {}, t), this.imgid = {
      btn: 0,
      bg: 0,
      list1: 0,
      list2: 0
    }, this.options.onGroup分享 = t.onGroup分享, this.options.friendRankReturn = t.friendRankReturn, this.options.groupPlayGame = t.groupPlayGame, this.options.onClick第= t.onClickRank, this.options.onClickReplay = t.onClickReplay, this.options.onClick分享 = t.onClick分享, this.options.onClickPkRule = t.onClickPkRule, this.options.onClickPure分享 = t.onClickPure分享, this.options.onClickStart = t.onClickStart, this.options.onShowFriend第= t.onShowFriendRank, this.options.onBattlePlay = t.onBattlePlay, this.options.onSubscribePk = t.onSubscribePk, this.options.onLookersStart = t.onLookersStart, this.options.newRelay = t.newRelay, this.options.outRelay1 = t.outRelay1, this.options.outRelay2 = t.outRelay2, this.options.startRelay = t.startRelay, this.options.shareRelay = t.shareRelay, this.options.shareRelayLive = t.shareRelayLive, this.options.replayRelay = t.replayRelay, this.options.skipRelayBeginner = t.skipRelayBeginner, this.options.getRelayQr = t.getRelayQr, this.options.quitRecord = t.quitRecord, m.default.on(a.EVENT.RELAYSTART, (function(e, t) {
      o.hide2D(), o.relayHeadImg || (o.relayHeadImg = new w.default), o.relayText || (o.relayText = new i.Object3D, o.turnText = new s.default("轮到你了！", {
        fillStyle: 4209243,
        chinese: !0,
        textAlign: "left"
      }), o.relayText.add(o.turnText.obj), o.outText = new s.default("被淘汰了！", {
        fillStyle: 4209243,
        chinese: !0,
        textAlign: "left"
      }), o.relayText.add(o.outText.obj), o.relayText.scale.set(1.5, 1.5, 1.5), o.relayText.position.x = -13.8, o.relayText.position.y = 11.5), o.options.camera.add(o.relayText), o.outText.obj.visible = !1, o.turnText.obj.visible = !1, o.relayHeadImg.set(t.playerlist), o.options.camera.add(o.relayHeadImg.obj), o.relayHeadImg.obj.position.x = -8.8, o.relayHeadImg.obj.position.y = 20, P / b < 736 / 414 && (o.relayHeadImg.obj.position.y = 14, o.relayText.position.y = 6), t.my_seat_no == t.now_player_seat_no && (o.turnText.obj.visible = !0, o.outText.obj.visible = !1)
    })), m.default.on(a.EVENT.SYNCSCENE, (function(e, t) {
      o.hide2D(), o.relayHeadImg || (o.relayHeadImg = new w.default), o.relayText || (o.relayText = new i.Object3D, o.turnText = new s.default("轮到你了！", {
        fillStyle: 4209243,
        chinese: !0,
        textAlign: "left"
      }), o.relayText.add(o.turnText.obj), o.outText = new s.default("被淘汰了！", {
        fillStyle: 4209243,
        chinese: !0,
        textAlign: "left"
      }), o.relayText.add(o.outText.obj), o.relayText.scale.set(1.5, 1.5, 1.5), o.relayText.position.x = -13.8, o.relayText.position.y = 11.5), o.options.camera.add(o.relayText);
      var a = t.serverData.playerlist;
      a = a.slice(t.serverData.now_player_index, a.length).concat(a.slice(0, t.serverData.now_player_index)), console.log("围观看到的头像1：", a, t.serverData.now_player_index), a = a.filter((function(e) {
        return 0 === e.rank
      })), console.log("围观看到的头像2：", a), o.options.camera.add(o.relayHeadImg.obj), o.relayHeadImg.obj.position.x = -8.8, o.relayHeadImg.obj.position.y = 20, t.serverData.my_seat_no == t.serverData.now_player_seat_no ? (o.turnText.obj.visible = !0, o.outText.obj.visible = !1, o.relayHeadImg.set(a, {
        timeout: !0
      })) : (o.turnText.obj.visible = !1, o.outText.obj.visible = !1, o.relayHeadImg.set(a))
    })), m.default.on(a.EVENT.ORDERRUNGAME, (function(e, t) {
      o.relayHeadImg || (o.relayHeadImg = new w.default), o.relayHeadImg.next(t), t.my_seat_no == t.now_player_seat_no ? (o.turnText.obj.visible = !0, o.outText.obj.visible = !1) : (o.turnText.obj.visible = !1, o.outText.obj.visible = !1)
    })), m.default.on(a.EVENT.PLAYERDIED, (function(e, t) {
      if (o.canvasType == r.CANVASTYPE.relayRoom) {
        o.outText.obj.visible = !0, o.turnText.obj.visible = !1;
        var i = t.playerlist.filter((function(e) {
          return 0 === e.rank
        }));
        t.my_seat_no == t.now_player_seat_no && i.length > 2 && o.showRelayGG({
          all_player: t.player_count,
          my_rank: t.player_rank
        })
      }
    })), m.default.on(a.EVENT.RECEIVEMINICODE, (function(e, t) {
      o.showRelayQr(t)
    })), m.default.on(a.EVENT.ENDGAME, (function(e, t) {
      var i;
      console.log("!!! ENDGAME", e, t), o.relayHeadImg && o.options.camera.remove(o.relayHeadImg.obj), o.relayText && o.options.camera.remove(o.relayText);
      var a = 0,
        s = t.my_seat_no,
        r = t.playerlist.find((function(e) {
          return e.seat_no === s
        }));
      r && r.rank >= 0 && (a = r.rank + 1), n.TweenAnimation.killAll(), o.showRelayRank({
        isLive: null === (i = GameGlobal.liveRooms) || void 0 === i ? void 0 : i.includes(t.room_id),
        room_owner_seat: t.room_owner_seat,
        th玩家: t.playerlist,
        my_seat_no: t.my_seat_no,
        my_rank: a,
        total_score: t.score
      })
    })), m.default.on(a.EVENT.RELAYMODEDESTROY, (function(e, t) {
      o.relayHeadImg && o.relayHeadImg.obj && (o.outText.obj.visible = o.turnText.obj.visible = !1, o.options.camera.remove(o.relayText), o.options.camera.remove(o.relayHeadImg.obj))
    })), m.default.on(a.EVENT.LIVESTATECHANGE, (function(e, t) {
      var i;
      o.opt.isLive = t.isLive, "relayRoom" === (null === (i = o.routesArr) || void 0 === i ? void 0 : i.slice(-1)[0]) && (0, d.drawRelayRoomPage)(o)
    })), wx.on分享InvitationToLiveRoom && wx.on分享InvitationToLiveRoom((function() {
      var e, t;
      if ("relayRoom" === (null === (e = o.routesArr) || void 0 === e ? void 0 : e.slice(-1)[0]) && null !== (t = o.model.relayInfo) && void 0 !== t && t.activity_id) {
        var i = o.model.relayInfo,
          s = i.room_id,
          n = i.activity_id,
          r = i.router_id,
          l = a.VERSION;
        return {
          title: "来跳1跳接龙",
          query: "is_live=true&room_id=".concat(s, "&mode=relay&router_id=").concat(encodeURIComponent(r), "&version=").concat(l, "&activity_id=").concat(n),
          activityId: n,
          templateInfo: {
            parameterList: [{
              name: "member_count",
              value: o.opt.th玩家.length
            }, {
              name: "room_limit",
              value: a.ROOM_LIMIT
            }]
          },
          subTitle: "".concat(o.opt.game_level_s, "难度")
        }
      }
      return {
        onError: function() {
          wx.showToast({
            icon: "none",
            title: "自动创建房间失败，请通过主页“多人游戏”手动创建房间并重试"
          })
        },
        promise: new Promise((function(e, t) {
          o.options.newRelay && o.options.newRelay(), m.default.on(a.EVENT.RELAYCREATEROOM, (function(t, i) {
            o.model.relayInfo.is_live_master = !0;
            var s = i.room_id,
              n = i.activity_id,
              r = i.router_id,
              l = a.VERSION,
              h = "is_live=true&room_id=".concat(s, "&mode=relay&router_id=").concat(encodeURIComponent(r), "&version=").concat(l, "&activity_id=").concat(n);
            e({
              title: "来跳1跳接龙",
              query: h,
              activityId: n,
              templateInfo: {
                parameterList: [{
                  name: "member_count",
                  value: "1"
                }, {
                  name: "room_limit",
                  value: a.ROOM_LIMIT
                }]
              },
              subTitle: "低难度"
            })
          }))
        }))
      }
    }))
  }
  return t(E, [{
    key: "showFriendRankList",
    value: function(e) {
      this.opt = e || {}, (0, y.drawFriendRankList)({
        self: this
      })
    }
  }, {
    key: "showGroupRankList",
    value: function(e, t) {
      (0, y.drawGroupRankList)(this, e, t)
    }
  }, {
    key: "showGameOverPage",
    value: function(e) {
      e = e || {}, this.opt = e, (0, u.routeGameOver)(this)
    }
  }, {
    key: "showStartPage",
    value: function(e) {
      r.DEBUGVIEW || (this.opt = e || {}, (0, o.drawStartPage)(this))
    }
  }, {
    key: "updateStartPage",
    value: function() {
      this.canvasType == r.CANVASTYPE.start && 1 != this.opt.hideRank&& (0, o.drawStartUpdate)(this)
    }
  }, {
    key: "showPkRulePage",
    value: function(e) {
      this.opt = e, (0, c.drawPkRulePage)({
        self: this
      })
    }
  }, {
    key: "showPkPage",
    value: function(e) {
      this.opt = e, (0, c.drawPkPage)({
        self: this
      })
    }
  }, {
    key: "showLookersPage",
    value: function(e) {
      this.opt = e, (0, h.drawLookersPage)({
        self: this
      })
    }
  }, {
    key: "showRecordPage",
    value: function(e) {
      this.opt = e, (0, v.drawRecordPage)({
        self: this
      })
    }
  }, {
    key: "showRecord分享Page",
    value: function(e) {
      this.opt = e, (0, v.drawRecord分享Page)(this)
    }
  }, {
    key: "showBeginnerPage",
    value: function() {
      (0, l.drawBeginnerPage)({
        self: this
      })
    }
  }, {
    key: "showRelayRoom",
    value: function(e, t) {
      this.relayOpt = e, (this.canvasType != r.CANVASTYPE.relayQr || t) && (this.opt = e, (0, d.drawRelayRoomPage)(this))
    }
  }, {
    key: "showRelayGG",
    value: function(e) {
      this.opt = e, (0, d.drawRelayGG)(this)
    }
  }, {
    key: "showRelaying",
    value: function(e) {
      this.opt = e, (0, d.drawRelaying)(this)
    }
  }, {
    key: "showRelayLookers",
    value: function(e) {
      this.opt = e, (0, d.drawRelayLookers)(this)
    }
  }, {
    key: "showRelayRank",
    value: function(e) {
      this.opt = e, (0, d.drawRelayRank)(this)
    }
  }, {
    key: "showRelayBeginner",
    value: function(e) {
      this.opt = e, (0, d.drawRelayBeginner)(this)
    }
  }, {
    key: "showRelayQr",
    value: function(e) {
      this.opt = e, (0, d.drawRelayQr)(this)
    }
  }, {
    key: "showProfile",
    value: function(e) {
      this.opt = e, (0, T.drawProfile)(this)
    }
  }, {
    key: "updateProfilePraise",
    value: function(e) {
      this.opt.praise_info = e.praise_info, e.propsData && (this.opt.propsData = e.propsData), (0, T.drawProfileUpdate)(this)
    }
  }, {
    key: "showMsgBox",
    value: function(e) {
      this.opt = e, (0, f.drawMsgBox)(this)
    }
  }, {
    key: "updateMsgBox",
    value: function(e) {
      this.canvasType == r.CANVASTYPE.msgBox && (this.opt.msg_list = this.opt.msg_list.concat(e), (0, f.updateMsgBox)(this))
    }
  }, {
    key: "showSkin",
    value: function(e) {
      this.opt = e, console.log(e), (0, g.drawSkin)(this)
    }
  }, {
    key: "updateSkin",
    value: function(e) {
      this.opt.new_id = e.id, (0, g.updateSkin使用Status)(this)
    }
  }, {
    key: "show分享Skin",
    value: function(e) {
      this.opt = e, (0, k.draw分享Skin)(this)
    }
  }, {
    key: "showGetNewSkin",
    value: function(e) {
      this.opt = e, (0, u.drawGetNewSkin)(this)
    }
  }, {
    key: "showJiLiAdGetPropPage",
    value: function(e) {
      this.opt = e, (0, u.drawJiLiAdGetPropPage)(this)
    }
  }, {
    key: "showMsgDetailType5",
    value: function(e) {
      this.opt = e, (0, f.drawMsgDetailType5)(this)
    }
  }, {
    key: "hide2D",
    value: function() {
      (0, r.hide)(this)
    }
  }, {
    key: "hide2DGradually",
    value: function() {
      if (!r.DEBUGVIEW)
        for (var e = this, t = 0; t < C.length; t++) this.obj[C[t]] && n.customAnimation.to(this.material[C[t]], 1, {
          opacity: 0,
          onComplete: function(t) {
            return function() {
              e.material[C[t]].opacity = 1, e.obj[C[t]].visible = !1, e.showState = !1, e.options.camera.remove(e.obj[C[t]])
            }
          }(t)
        })
    }
  }, {
    key: "_findDelta",
    value: function(e) {
      var t = this._touchInfo,
        i = e.touches[0] || e.changedTouches[0];
      return i ? {
        x: i.pageX - t.x,
        y: i.pageY - t.y
      } : null
    }
  }, {
    key: "doTouchStartEvent",
    value: function(e) {
      if (this.showState) {
        var t = e.changedTouches[0].pageX,
          i = e.changedTouches[0].pageY;
        if (this.startX = t, this.startY = i, this.canvasType == r.CANVASTYPE.friend第|| this.canvasType == r.CANVASTYPE.group第|| this.canvasType == r.CANVASTYPE.pk || this.canvasType == r.CANVASTYPE.relay第|| this.canvasType == r.CANVASTYPE.msgBox || this.canvasType == r.CANVASTYPE.shareSkin || this.canvasType == r.CANVASTYPE.pkRule) {
          var a = this._touchInfo,
            s = this.scrollHandler;
          if (!s) return;
          a.trackingID = "touch", a.x = e.touches[0].pageX, a.y = e.touches[0].pageY, a.maxDx = 0, a.maxDy = 0, a.historyX = [0], a.historyY = [0], a.historyTime = [+new Date], a.listener = s, s.onTouchStart && s.onTouchStart()
        } else this.canvasType == r.CANVASTYPE.gameOver ? (t = this._cxp(t), i = this._cyp(i), "skin" != this.opt.type && "tired" != this.opt.type && t > 207 && t < 360 && i > 540 && i < 660 && this._drawGameOverBtnClick()) : this.canvasType == r.CANVASTYPE.start && (t = this._cxp(t), i = this._cyp(i), t > 86 && t < 318 && i > 458 && i < 552 && this._drawStartClick())
      }
    }
  }, {
    key: "doTouchMoveEvent",
    value: function(e) {
      if (this.showState && (this.canvasType == r.CANVASTYPE.friend第|| this.canvasType == r.CANVASTYPE.group第|| this.canvasType == r.CANVASTYPE.pk || this.canvasType == r.CANVASTYPE.relay第|| this.canvasType == r.CANVASTYPE.msgBox || this.canvasType == r.CANVASTYPE.shareSkin)) {
        var t = this._touchInfo;
        if (-1 == t.trackingID) return;
        e.preventDefault();
        var i = this._findDelta(e);
        if (!i) return;
        t.maxDy = Math.max(t.maxDy, Math.abs(i.y)), t.maxDx = Math.max(t.maxDx, Math.abs(i.x));
        var a = +new Date;
        for (t.historyX.push(i.x), t.historyY.push(i.y), t.historyTime.push(a); t.historyTime.length > 10;) t.historyTime.shift(), t.historyX.shift(), t.historyY.shift();
        t.listener && t.listener.onTouchMove && t.listener.onTouchMove(i.x, i.y, a)
      }
    }
  }, {
    key: "doTouchEndEvent",
    value: function(e) {
      if (console.log("!!! doTouchEndEvent", this.canvasType), this.showState) {
        var t = e.changedTouches[0].pageX,
          i = e.changedTouches[0].pageY,
          a = i,
          s = !0;
        if (this.canvasType != r.CANVASTYPE.friend第&& this.canvasType != r.CANVASTYPE.group第&& this.canvasType != r.CANVASTYPE.pk && this.canvasType != r.CANVASTYPE.relay第&& this.canvasType != r.CANVASTYPE.msgBox && this.canvasType != r.CANVASTYPE.record && this.canvasType != r.CANVASTYPE.shareSkin || !(Math.abs(t - this.startX) > 5 || Math.abs(i - this.startY) > 5) || (s = !1), t = this._cxp(t), i = this._cyp(i), this.canvasType == r.CANVASTYPE.start && this._drawStartClickRevert(), s) {
          if (this.canvasType == r.CANVASTYPE.gameOver && !1 === (0, u.gameOverEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.group第&& !1 === (0, y.groupRankEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.friend第&& !1 === (0, y.friendRankEve)(this, t, i, this._cyp(a - this.lastScrollY))) return !1;
          if (this.canvasType == r.CANVASTYPE.start && !1 === (0, o.startEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.pk && !1 === (0, c.pkEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.pkRule && !1 === (0, c.pkRuleEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.lookers && !1 === (0, h.lookersEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.verify && !1 === (0, p.verifyEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.relayRoom && !1 === (0, d.relayRoomEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.relay第&& !1 === (0, d.relayRankEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.relayGG && !1 === (0, d.relayGGEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.relayBeginner && !1 === (0, d.relayBeginnerEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.relayQr && !1 === (0, d.relayQrEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.record && !1 === (0, v.recordEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.record分享 && !1 === (0, v.record分享Eve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.profile && !1 === (0, T.profileEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.msgBox && !1 === (0, f.msgBoxEve)(this, t, i, this._cyp(a - this.lastScrollY))) return !1;
          if (this.canvasType == r.CANVASTYPE.skinList && !1 === (0, g.skinListEve)(this, t, i, this._cyp(a - this.lastScrollY))) return !1;
          if (this.canvasType == r.CANVASTYPE.getNewSkin && !1 === (0, u.getNewSkinEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.shareSkin && !1 === (0, k.shareSkinEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.jiliProp && !1 === (0, u.drawJiLiAdGetPropPageEve)(this, t, i)) return !1;
          if (this.canvasType == r.CANVASTYPE.msgDetail5 && !1 === (0, f.drawMsgDetailType5Eve)(this, t, i)) return !1;
          this.canvasType == r.CANVASTYPE.gameOver && "tired" != this.opt.type && "skin" != this.opt.type && this._drawGameOverBtnClickRevert()
        } else {
          var n = this._touchInfo;
          if (-1 == n.trackingID) return;
          e.preventDefault();
          var l = this._findDelta(e);
          if (!l) return;
          var m = n.listener;
          n.trackingID = -1, n.listener = null;
          var w = {
            x: 0,
            y: 0
          };
          if (n.historyTime.length > 2)
            for (var A = n.historyTime.length - 1, E = n.historyTime[A], _ = n.historyX[A], S = n.historyY[A]; A > 0;) {
              A--;
              var R = E - n.historyTime[A];
              if (R > 30 && R < 50) {
                w.x = (_ - n.historyX[A]) / (R / 1e3), w.y = (S - n.historyY[A]) / (R / 1e3);
                break
              }
            }
          n.historyTime = [], n.historyX = [], n.historyY = [], m && m.onTouchEnd && m.onTouchEnd(l.x, l.y, w)
        }
      }
    }
  }, {
    key: "doClickEvent",
    value: function(e) {}
  }, {
    key: "updatePosition",
    value: function(e) {
      var t;
      e > 0 && (e = 0);
      var i = (0, r.cwh)(720) / P * N,
        a = (0, r.cwh)(720),
        s = 12;
      this.canvasType != r.CANVASTYPE.friend第&& this.canvasType != r.CANVASTYPE.group第|| (t = -(this._cy(157) + a / 2 - P / 2) / P * N), this.canvasType == r.CANVASTYPE.pk && (t = -(this._cy(437) + a / 2 - P / 2) / P * N), this.canvasType == r.CANVASTYPE.relay第&& (t = -(this._cy(404) + a / 2 - P / 2) / P * N, 1 != this.opt.my_rank && (t = -(this._cy(318) + a / 2 - P / 2) / P * N), this.opt.isOutDate && (t = -(this._cy(225) + a / 2 - P / 2) / P * N)), this.canvasType == r.CANVASTYPE.msgBox && (t = -(this._cy(136) + a / 2 - P / 2) / P * N, s = 8), this.canvasType == r.CANVASTYPE.shareSkin && (t = -(this._cy(278) + a / 2 - P / 2) / P * N);
      var n = Math.floor((t - N * e / x) / i);
      if (this.lastN != n && this.lastN - n < 0) n % 2 == 0 ? this._drawList((n + 1) * s, "list2") : this._drawList((n + 1) * s, "list1");
      else if (this.lastN != n && this.lastN - n > 0) {
        var o = n; - 1 == o && (o = 1), n % 2 == 0 ? this._drawList(n * s, "list1") : this._drawList(o * s, "list2")
      }
      n % 2 == 0 ? (this.obj.list1.position.y = t - N * e / x - n * i, this.obj.list2.position.y = t - N * e / x - (n + 1) * i) : (this.obj.list2.position.y = t - N * e / x - n * i, this.obj.list1.position.y = t - N * e / x - (n + 1) * i), this.lastN = n, this.lastScrollY = e, this.maxscroll = Math.min(this.lastScrollY, this.maxscroll)
    }
  }, {
    key: "_drawList",
    value: function(e, t) {
      this.canvasType != r.CANVASTYPE.pk ? this.canvasType == r.CANVASTYPE.friend第|| this.canvasType == r.CANVASTYPE.group第? (0, y.drawRankList)(this, e, t) : this.canvasType == r.CANVASTYPE.relayRoom ? (0, d.drawRelayList)(this, e, t) : this.canvasType == r.CANVASTYPE.msgBox ? (this.lastScrollY <= this.maxscroll && !this.pending && (this.pending = !0, this.opt.onEnd && this.opt.onEnd()), (0, f.drawMsgList)(this, e, t)) : this.canvasType == r.CANVASTYPE.shareSkin && (0, k.draw分享SkinList)(this, e, t) : (0, c.drawPkList)(this, e, t)
    }
  }, {
    key: "_drawAuthModal",
    value: function() {
      var e = this;
      this.needAuth = !0, this.context.btn.clearRect(this._cx(207), this._cy(355), (0, r.cwh)(320), (0, r.cwh)(144)), this._drawImageCenter("res/2d/auth.png", this._cx(207), this._cy(355), (0, r.cwh)(320), (0, r.cwh)(144), "btn", null, this.imgid.btn), (0, A.create使用rInfoButton)("多人游戏邀请", 0, {
        x: 287,
        y: 398,
        width: 160,
        height: 58
      }, (function() {
        e.options.skipRelayBeginner()
      }))
    }
  }, {
    key: "_drawGameOverBtnClick",
    value: function() {
      this.context.btn.clearRect(this._cx(140), this._cy(this.replayBtnPosy - 80), (0, r.cwh)(232), (0, r.cwh)(134)), this._drawImageCenter("res/replay.png", this._cx(256), this._cy(this.replayBtnPosy), (0, r.cwh)(190), (0, r.cwh)(75), "btn", null, this.imgid.btn)
    }
  }, {
    key: "_drawGameOverBtnClickRevert",
    value: function() {
      this.context.btn.clearRect(this._cx(140), this._cy(this.replayBtnPosy - 80), (0, r.cwh)(232), (0, r.cwh)(134)), this._drawImageCenter("res/replay.png", this._cx(256), this._cy(this.replayBtnPosy), (0, r.cwh)(212), (0, r.cwh)(84), "btn", null, this.imgid.btn)
    }
  }, {
    key: "_drawStartClick",
    value: function() {
      this.context.btn.clearRect(this._cx(91), this._cy(448), (0, r.cwh)(232), (0, r.cwh)(104)), this._drawImageCenter("res/play.png", this._cx(207), this._cy(505), (0, r.cwh)(190), (0, r.cwh)(75), "btn", null, this.imgid.btn)
    }
  }, {
    key: "_drawStartClickRevert",
    value: function() {
      this.context.btn.clearRect(this._cx(91), this._cy(448), (0, r.cwh)(232), (0, r.cwh)(104)), this._drawImageCenter("res/play.png", this._cx(207), this._cy(505), (0, r.cwh)(212), (0, r.cwh)(84), "btn", null, this.imgid.btn)
    }
  }, {
    key: "_cx",
    value: function(e) {
      var t = e * R / 414;
      return x / R < 736 / 414 && (t = e * x / 736 + (R - 414 * x / 736) / 2), t * S
    }
  }, {
    key: "_cy",
    value: function(e) {
      return (x / R > 736 / 414 ? e * R / 414 + (x - 736 * R / 414) / 2 : e * x / 736) * S
    }
  }, {
    key: "_cxp",
    value: function(e) {
      return x / R < 736 / 414 ? (e - (R - 414 * x / 736) / 2) / x * 736 : e / R * 414
    }
  }, {
    key: "_cyp",
    value: function(e) {
      return x / R > 736 / 414 ? (e - (x - 736 * R / 414) / 2) / R * 414 : e / x * 736
    }
  }, {
    key: "_drawImageCenter",
    value: function(e, t, i, a, s, n, o, l, h) {
      "/0" != e && "/96" != e && "/64" != e && e || (e = "res/ava.png");
      var c = new Image,
        y = this;
      c.onload = function() {
        y.imgid[n] == l && (y.context[n].drawImage(c, t - a / 2, i - s / 2, a, s), o && o(), h || (0, r.updatePlane)({
          self: y,
          type: n
        }))
      }, c.onerror = function() {
        o && o()
      }, c.src = e
    }
  }]), E
}();
exports.default = V;
},{"../../@babel/runtime/helpers/Arrayincludes":1,"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/animation":66,"../lib/mue/eventcenter":67,"../lib/three":70,"../network/getAuth":72,"../text":130,"./headimgAnimation":84,"./pages2d/base":89,"./pages2d/beginner":90,"./pages2d/gg":91,"./pages2d/lookers":92,"./pages2d/msg":93,"./pages2d/pk":94,"./pages2d/profile":95,"./pages2d/rank":96,"./pages2d/record":97,"./pages2d/relay":98,"./pages2d/shareskin":99,"./pages2d/skin":100,"./pages2d/start":101,"./pages2d/verify":102}],82:[function(require,module,exports){

},{}],83:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  s = function() {
    function s(t) {
      e(this, s), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "groupRankList"
    }
    return t(s, [{
      key: "show",
      value: function(e, t) {
        this.full2D.showGroupRankList(e, t)
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), s
  }();
exports.default = s;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],84:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var i, t = require("../../@babel/runtime/helpers/classCallCheck"),
  o = require("../../@babel/runtime/helpers/createClass"),
  e = function(i, t) {
    if (!t && i && i.__esModule) return i;
    if (null === i || "object" != typeof i && "function" != typeof i) return {
      default: i
    };
    var o = a(t);
    if (o && o.has(i)) return o.get(i);
    var e = {},
      s = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var r in i)
      if ("default" !== r && Object.prototype.hasOwnProperty.call(i, r)) {
        var n = s ? Object.getOwnPropertyDescriptor(i, r) : null;
        n && (n.get || n.set) ? Object.defineProperty(e, r, n) : e[r] = i[r]
      } e.default = i, o && o.set(i, e);
    return e
  }(require("../lib/three")),
  s = require("../lib/animation"),
  r = require("../config"),
  n = (i = require("../lib/mue/eventcenter")) && i.__esModule ? i : {
    default: i
  };

function a(i) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    o = new WeakMap;
  return (a = function(i) {
    return i ? o : t
  })(i)
}
var l = function() {
    function i(o, s) {
      t(this, i);
      var r = new e.Shape;
      r = this.roundedRect(r, -1.5, -1.5, 3, 3, .25);
      new e.Shape;
      var n = new e.ShapeGeometry(r);
      this.reMapUv(n), this.avatorFrame = new e.Mesh(n, new e.MeshBasicMaterial({
        transparent: !0,
        map: o,
        opacity: 1
      })), this.outer = new e.Mesh(n, new e.MeshBasicMaterial({
        transparent: !0,
        color: 16777215,
        opacity: 1
      })), this.outer.scale.set(1.05, 1.05, 1.05), this.outer.position.z = -.1, this.obj = new e.Object3D, this.obj.add(this.avatorFrame), this.obj.add(this.outer), this.id = s, this.waitingList = []
    }
    return o(i, [{
      key: "roundedRect",
      value: function(i, t, o, e, s, r) {
        return i.moveTo(t, o + r), i.lineTo(t, o + s - r), i.quadraticCurveTo(t, o + s, t + r, o + s), i.lineTo(t + e - r, o + s), i.quadraticCurveTo(t + e, o + s, t + e, o + s - r), i.lineTo(t + e, o + r), i.quadraticCurveTo(t + e, o, t + e - r, o), i.lineTo(t + r, o), i.quadraticCurveTo(t, o, t, o + r), i
      }
    }, {
      key: "reMapUv",
      value: function(i) {
        i.computeBoundingBox();
        var t = i.boundingBox.max,
          o = i.boundingBox.min,
          s = new e.Vector2(0 - o.x, 0 - o.y),
          r = new e.Vector2(t.x - o.x, t.y - o.y),
          n = i.faces;
        i.faceVertexUvs[0] = [];
        for (var a = 0; a < n.length; a++) {
          var l = i.vertices[n[a].a],
            c = i.vertices[n[a].b],
            h = i.vertices[n[a].c];
          i.faceVertexUvs[0].push([new e.Vector2((l.x + s.x) / r.x, (l.y + s.y) / r.y), new e.Vector2((c.x + s.x) / r.x, (c.y + s.y) / r.y), new e.Vector2((h.x + s.x) / r.x, (h.y + s.y) / r.y)])
        }
        i.uvsNeedUpdate = !0
      }
    }]), i
  }(),
  c = function() {
    function i() {
      t(this, i), this.obj = new e.Object3D, this.list = [], this.secondList = [];
      var o = new e.PlaneBufferGeometry(26, .76, 30);
      this.progress = new e.Object3D;
      var s = r.loader.load("res/progress2.png"),
        n = new e.CircleGeometry(.38, 15, 0, Math.PI);
      this.roundCircle = new e.Mesh(n, new e.MeshBasicMaterial({
        map: s
      })), this.roundCircleBack = new e.Mesh(n, new e.MeshBasicMaterial({
        transparent: !0,
        opacity: .08,
        color: 0
      })), this.secondRoundCircleBack = this.roundCircleBack.clone(), this.secondRoundCircle = this.roundCircle.clone(), this.backgroundBar = new e.Mesh(o, new e.MeshBasicMaterial({
        transparent: !0,
        opacity: .08,
        color: 0
      })), this.progressBar = new e.Object3D, this.progressBar.add(new e.Mesh(o, new e.MeshBasicMaterial({
        map: s,
        transparent: !0
      }))), this.progressShadow = new e.Mesh(new e.PlaneGeometry(26, .38), new e.MeshBasicMaterial({
        transparent: !0,
        color: 16777215,
        opacity: .08
      })), this.progressShadow.position.set(0, .19, .1), this.progressBar.add(this.progressShadow), this.progress.add(this.roundCircleBack), this.secondRoundCircleBack.position.z = this.roundCircleBack.position.z = this.backgroundBar.position.z = -.1, this.progress.add(this.secondRoundCircleBack), this.progress.add(this.backgroundBar), this.progress.add(this.progressBar), this.roundCircle.rotation.z = this.roundCircleBack.rotation.z = -Math.PI / 2, this.roundCircle.position.x = this.roundCircleBack.position.x = 13, this.secondRoundCircle = this.roundCircle.clone(), this.secondRoundCircle.rotation.z = this.secondRoundCircleBack.rotation.z = Math.PI / 2, this.secondRoundCircle.position.x = this.secondRoundCircleBack.position.x = -13, this.progress.add(this.roundCircle), this.progress.add(this.secondRoundCircle), this.progress.position.set(8.2, 3.25, 0), this.obj.add(this.progress), this.turnAudio = wx.createInnerAudioContext(), this.turnAudio.src = "res/turn.mp3"
    }
    return o(i, [{
      key: "set",
      value: function(i, t) {
        var o = this;
        this.destroy(), this.list = [];
        for (var e = 0, a = i.length; e < a; ++e) {
          "/0" != i[e].headimg && "/96" != i[e].headimg && "/64" != i[e].headimg && i[e].headimg || (i[e].headimg = "res/ava.png");
          var c = r.loader.load(i[e].headimg),
            h = new l(c, i[e].seat_no);
          this.obj.add(h.obj), h.obj.position.x = 4 * (e - 5 >= 1 ? e - 5 : e), 0 == e && (h.obj.scale.set(2.2, 2.2, 2.2), h.obj.position.set(-1.8, -1.8, 0)), e >= 6 && (h.obj.position.y = -3.5), this.list.push(h);
          var u = new l(c, i[e].seat_no);
          u.obj.visible = !1, this.obj.add(u.obj), this.secondList.push(u)
        }
        this.progressBar.scale.x = 1, this.progressBar.position.x = 0, this.roundCircle.position.x = 13, this.roundCircle.visible = !0, this.secondRoundCircle.visible = !0;
        var p = 5;
        t && t.timeout && (p = 1), s.customAnimation.to(this.progressBar.scale, p, {
          x: .01,
          name: "progress",
          onComplete: function() {
            o.progressBlinkTimer = setInterval((function() {
              o.roundCircle.visible = !o.roundCircle.visible, o.secondRoundCircle.visible = !o.secondRoundCircle.visible
            }), 800), t && t.noEmit || n.default.emitSync(r.EVENT.PROGRESSOVER)
          }
        }), s.customAnimation.to(this.progressBar.position, p, {
          x: -13,
          name: "progress"
        }), s.customAnimation.to(this.roundCircle.position, p, {
          x: -13,
          name: "progress"
        })
      }
    }, {
      key: "next",
      value: function(i, t) {
        var o = this;
        if (console.log("next111111"), this.progressBlinkTimer && (clearInterval(this.progressBlinkTimer), this.progressBlinkTimer = null), this.animating) return console.log("waitingList!!!!!!!!"), void this.waitingList.push(i);
        console.log("next22222222"), s.TweenAnimation.kill("progress"), this.roundCircle.visible = !0, this.secondRoundCircle.visible = !0, this.animating = !0;
        var e = this.list.shift(),
          a = this.secondList.shift();
        if (i && i.now_player_seat_no == e.id) return console.warn("data 重复的next 导致头像不匹配"), this.list.unshift(e), this.secondList.unshift(a), void(this.animating = !1);
        if (this.list[0]) {
          i && i.my_seat_no == i.now_player_seat_no && this.turnAudio.play(), i && this.currentDie(e.id, i.playerlist) && (e.died = !0);
          var l = .3;
          t && t.noAnimation && (l = .01), this.list[0].avatorFrame.material.opacity = .3, this.list[0].outer.material.opacity = .3, s.customAnimation.to(this.list[0].avatorFrame.material, l, {
            opacity: 1
          }), s.customAnimation.to(this.list[0].outer.material, l, {
            opacity: 1
          }), s.customAnimation.to(this.list[0].obj.scale, l, {
            x: 2.2,
            y: 2.2,
            z: 2.2
          }), s.customAnimation.to(this.list[0].obj.position, l, {
            x: -1.8,
            y: -1.8
          }), this.progressBar.scale.x = 1, this.progressBar.position.x = 0, this.roundCircle.position.x = 13, s.customAnimation.to(this.progressBar.scale, 5, {
            x: .01,
            name: "progress",
            onComplete: function() {
              console.log("fuck progress over"), o.progressBlinkTimer = setInterval((function() {
                o.roundCircle.visible = !o.roundCircle.visible, o.secondRoundCircle.visible = !o.secondRoundCircle.visible
              }), 800), i && n.default.emitSync(r.EVENT.PROGRESSOVER)
            }
          }), s.customAnimation.to(this.progressBar.position, 5, {
            x: -13,
            name: "progress"
          }), s.customAnimation.to(this.roundCircle.position, 5, {
            x: -13,
            name: "progress"
          });
          for (var c = 1, h = this.list.length; c < h; ++c)
            if (5 == c) {
              var u = this.list[5];
              u.obj.position.z = -1;
              var p = this.secondList[5];
              s.customAnimation.to(u.outer.material, l, {
                opacity: 0
              }), s.customAnimation.to(u.avatorFrame.material, l, {
                opacity: 0
              }), s.customAnimation.to(u.obj.position, l, {
                x: 0
              }), p.obj.visible = !0, p.outer.material.opacity = 0, p.avatorFrame.material.opacity = 0, p.obj.position.x = 24, p.obj.position.y = 0, s.customAnimation.to(p.obj.position, l, {
                x: p.obj.position.x - 4,
                onEnded: function() {
                  u.obj.position.x = p.obj.position.x, u.obj.position.y = p.obj.position.y, u.outer.material.opacity = 1, u.avatorFrame.material.opacity = 1, p.obj.visible = !1
                }
              }), s.customAnimation.to(p.avatorFrame.material, l, {
                opacity: 1
              }), s.customAnimation.to(p.outer.material, l, {
                opacity: 1
              })
            } else this.list[c].obj.position.z = 0, s.customAnimation.to(this.list[c].obj.position, l, {
              x: 4 * (c - 5 >= 1 ? c - 5 : c)
            });
          s.customAnimation.to(e.obj.position, l, {
            x: -8,
            onEnded: function() {
              if (o.animating = !1, o.waitingList.length > 0) {
                console.log("onComplete next");
                var i = o.waitingList.shift();
                o.next(i, {
                  noAnimation: !0
                })
              }
            }
          }), s.customAnimation.to(e.avatorFrame.material, l, {
            opacity: 0
          }), s.customAnimation.to(e.outer.material, l, {
            opacity: 0
          }), e.died ? (this.obj.remove(e.obj), this.obj.remove(a.obj)) : (a.obj.position.x = 4 * (this.list.length - 5 >= 1 ? this.list.length - 5 : this.list.length) + 4, console.log("secondFirstItem obj", a.obj.position.x, this.list.length), a.obj.position.y = this.list.length + 1 > 6 ? -3.5 : 0, a.avatorFrame.material.opacity = 0, a.outer.material.opacity = 0, a.obj.visible = !0, s.customAnimation.to(a.obj.position, l, {
            x: a.obj.position.x - 4,
            onEnded: function() {
              e.obj.scale.set(1, 1, 1), e.obj.position.x = a.obj.position.x, e.obj.position.y = a.obj.position.y, console.log("final", e.obj.position.x, e.obj.position.y), e.avatorFrame.material.opacity = 1, e.outer.material.opacity = 1, a.obj.visible = !1
            }
          }), s.customAnimation.to(a.avatorFrame.material, l, {
            opacity: 1
          }), s.customAnimation.to(a.outer.material, l, {
            opacity: 1
          }), this.list.push(e), this.secondList.push(a))
        } else this.animating = !1
      }
    }, {
      key: "currentJumperDie",
      value: function() {
        this.list[0].died = !0
      }
    }, {
      key: "currentDie",
      value: function(i, t) {
        console.log("id", i, t);
        for (var o = 0, e = t.length; o < e; ++o)
          if (t[o].seat_no == i && 0 != t[o].rank) return !0
      }
    }, {
      key: "destroy",
      value: function() {
        this.progressBlinkTimer && (clearInterval(this.progressBlinkTimer), this.progressBlinkTimer = null);
        for (var i = 0, t = this.list.length; i < t; ++i) this.list[i] && this.list[i].obj && this.list[i].obj.material && this.list[i].obj.material.map && this.list[i].obj.material.map.dispose(), this.obj.remove(this.list[i].obj);
        for (i = 0, t = this.secondList.length; i < t; ++i) this.secondList[i] && this.secondList[i].obj && this.secondList[i].obj.material && this.secondList[i].obj.material.map && this.secondList[i].obj.material.map.dispose(), this.obj.remove(this.secondList[i].obj);
        this.list = [], this.secondList = [], this.waitingList = [], this.animating = !1
      }
    }]), i
  }();
exports.default = c;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/animation":66,"../lib/mue/eventcenter":67,"../lib/three":70}],85:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = a(t);
    if (i && i.has(e)) return i.get(e);
    var n = {},
      r = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var s in e)
      if ("default" !== s && Object.prototype.hasOwnProperty.call(e, s)) {
        var o = r ? Object.getOwnPropertyDescriptor(e, s) : null;
        o && (o.get || o.set) ? Object.defineProperty(n, s, o) : n[s] = e[s]
      } n.default = e, i && i.set(e, n);
    return n
  }(require("../lib/three")),
  n = require("../config");
r(require("../store/storage")), r(require("../scroll/scrollHandler"));

function r(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

function a(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (a = function(e) {
    return e ? i : t
  })(e)
}
var s = window.devicePixelRatio > 2 ? 2 : window.devicePixelRatio,
  o = window.innerHeight < window.innerWidth ? window.innerHeight : window.innerWidth,
  h = window.innerHeight > window.innerWidth ? window.innerHeight : window.innerWidth,
  c = h * s,
  l = o * s,
  u = n.FRUSTUMSIZE,
  d = l / c * u,
  f = ["bg"],
  g = function() {
    function n(t) {
      e(this, n), this.texture = {}, this.material = {}, this.geometry = {}, this.obj = {}, this.canvas = {}, this.context = {}, this._touchInfo = {
        trackingID: -1,
        maxDy: 0,
        maxDx: 0
      }, this.cwidth = l, this.cheight = 75, this.options = Object.assign({}, {}, t), this._createPlane()
    }
    return t(n, [{
      key: "showLookers",
      value: function(e) {
        this.showState = !0, e = e || {}, this._drawLookers(e)
      }
    }, {
      key: "showLookers分享",
      value: function(e) {
        this.showState = !0, e = e || {}
      }
    }, {
      key: "hideLookers",
      value: function() {
        this.showState = !1;
        for (var e = 0; e < f.length; e++) this.obj[f[e]].visible = !1, this.options.camera.remove(this.obj[f[e]])
      }
    }, {
      key: "_drawLookers",
      value: function(e) {
        var t = this;
        console.warn("!!! _drawLookers", e);
        var i = this.context.bg;
        i.fillStyle = "pink", i.strokeStyle = "red", i.lineWidth = 2 * s, i.clearRect(0, 0, this._cx(414), this._cx(this.cheight));
        this.cheight;
        if (e.avaImg) {
          for (var n = l - e.avatar.length * this._cx(32), r = this, a = function() {
              var i = o * t._cx(36) + n;
              t._drawImageCenter(e.avatar[o], i, 75, r._cx(25), r._cx(25), "bg", (function() {
                r._drawImageCenter("res/2d/ava_square.png", i, 75, r._cx(26), r._cx(26), "bg")
              }))
            }, o = 0; o < e.avatar.length; o++) a();
          i.fillStyle = "rgba(0,0,0,0.56)", i.font = this._cf(14), i.textAlign = "right", i.textBaseline = "middle", i.fillText(e.num + "人围观", n - this._cx(20), 75)
        }
        e.icon && this._drawImageCenter("res/observ分享.png", this._cx(35), 75, this._cx(14), this._cx(16), "bg"), e.wording && (i.fillStyle = "rgba(0,0,0,0.56)", i.font = this._cf(14), i.textAlign = "left", i.textBaseline = "middle", i.fillText("邀请围观", this._cx(55), 75)), this._updatePlane("bg")
      }
    }, {
      key: "_createPlane",
      value: function() {
        for (var e = 0; e < f.length; e++) this.canvas[f[e]] = document.createElement("canvas"), this.context[f[e]] = this.canvas[f[e]].getContext("2d"), this.canvas[f[e]].width = l, this.canvas[f[e]].height = this.cheight * s, this.texture[f[e]] = new i.Texture(this.canvas[f[e]]), this.material[f[e]] = new i.MeshBasicMaterial({
          map: this.texture[f[e]],
          transparent: !0
        }), this.geometry[f[e]] = new i.PlaneGeometry(d, this.cheight / h * u), this.obj[f[e]] = new i.Mesh(this.geometry[f[e]], this.material[f[e]]), this.material[f[e]].map.minFilter = i.LinearFilter, this.obj[f[e]].position.y = -(.5 - this.cheight / 2 / h) * u, this.obj[f[e]].position.x = 0, this.obj[f[e]].position.z = 9 - .001 * e
      }
    }, {
      key: "_updatePlane",
      value: function(e) {
        this.showState && (this.texture[e].needsUpdate = !0, this.obj[e].visible = !0, this.options.camera.add(this.obj[e]))
      }
    }, {
      key: "_drawImageCenter",
      value: function(e, t, i, n, r, a, s) {
        "/0" != e && "/96" != e && "/64" != e && e || (e = "res/ava.png");
        var o = new Image,
          h = this,
          c = this.context[a];
        o.onload = function() {
          c.drawImage(o, t - n / 2, i - r / 2, n, r), s && s(), h._updatePlane(a)
        }, o.onerror = function() {
          s && s()
        }, o.src = e
      }
    }, {
      key: "_cx",
      value: function(e) {
        return e * o / 414 * s
      }
    }, {
      key: "_cf",
      value: function(e) {
        return e * s * o / 414 + "px Helvetica"
      }
    }]), n
  }();
exports.default = g;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/three":70,"../scroll/scrollHandler":122,"../store/storage":128}],86:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../../@babel/runtime/helpers/createClass"),
  t = function() {
    function t(i) {
      e(this, t), this.game = i, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.name = "viewerGG"
    }
    return i(t, [{
      key: "show",
      value: function(e) {
        var i = this.model.observeInfo;
        this.full2D.showLookersPage({
          type: "gg",
          score: e,
          headimg: i.headimg,
          nickname: i.nick姓th
        }), this.UI.hide本次得分()
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), t
  }();
exports.default = t;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],87:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(t) {
      e(this, i), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.name = "viewerOut"
    }
    return t(i, [{
      key: "show",
      value: function() {
        var e = this.model.observeInfo;
        this.full2D.showLookersPage({
          type: "out",
          headimg: e.headimg,
          nickname: e.nick姓th
        }), this.UI.hide本次得分()
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), i
  }();
exports.default = i;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],88:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(t) {
      e(this, i), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.name = "viewerWaiting"
    }
    return t(i, [{
      key: "show",
      value: function() {
        var e = this.model.observeInfo;
        this.full2D.showLookersPage({
          type: "in",
          headimg: e.headimg,
          nickname: e.nick姓th
        }), this.UI.resetObservePos(), this.UI.scoreText.changeStyle({
          textAlign: "center"
        }), this.UI.show本次得分()
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D(), this.UI.hide本次得分(), this.UI.reset本次得分Pos(), this.UI.scoreText.changeStyle({
          textAlign: "left"
        })
      }
    }]), i
  }();
exports.default = i;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],89:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.WIDTH = exports.W = exports.ListLineHeight = exports.HEIGHT = exports.H = exports.Dpr = exports.DEBUGVIEW = exports.CANVASTYPE = void 0, exports.back = function(e, t) {
  return e.routesArr.pop(), e.routesArr.pop()
}, exports.cname = function(e, t) {
  t = t || 16, (e = e || "").replace(/[^\x00-\xff]/g, "**").length > t + 2 && (e = function e(t, n) {
    (t = t || "").replace(/[^\x00-\xff]/g, "**").length > n && (t = t.substring(0, t.length - 1), t = e(t, n));
    return t
  }(e, t) + "...");
  return e
}, exports.createPlane = function(t, n) {
  if (y(t, n), t.showState = !0, !!t.canvas.bg) return;
  0;
  for (var r = 0; r < c.length; r++) t.canvas[c[r]] = document.createElement("canvas"), t.context[c[r]] = t.canvas[c[r]].getContext("2d"), t.canvas[c[r]].width = l, "list1" == c[r] || "list2" == c[r] ? t.canvas[c[r]].height = x(720) : t.canvas[c[r]].height = i, t.texture[c[r]] = new e.Texture(t.canvas[c[r]]), t.material[c[r]] = new e.MeshBasicMaterial({
    map: t.texture[c[r]],
    transparent: !0
  }), "list1" == c[r] || "list2" == c[r] ? t.geometry[c[r]] = new e.PlaneBufferGeometry(g, x(720) / i * f) : t.geometry[c[r]] = new e.PlaneBufferGeometry(g, f), t.obj[c[r]] = new e.Mesh(t.geometry[c[r]], t.material[c[r]]), t.material[c[r]].map.minFilter = e.LinearFilter, t.obj[c[r]].position.y = 0, t.obj[c[r]].position.x = 0, t.obj[c[r]].position.z = 9 - .001 * r
}, exports.cwh = x, exports.cx = m, exports.cy = h, exports.drawHomeImg = function(e, t) {
  var n = new Image;
  n.onload = function() {
    if (wx.getMenuButtonBoundingClientRect) {
      var r = wx.getMenuButtonBoundingClientRect() || {};
      e.drawImage(n, 10 * o, (r.top || 10) * o, 104, 64)
    } else 1624 == i && 750 == l ? e.drawImage(n, 10 * o, 44 * o, 104, 64) : e.drawImage(n, 10 * o, 10 * o, 104, 64);
    w({
      self: t,
      type: "bg"
    })
  }, n.src = "res/2d/home.png"
}, exports.drawImageCenter = b, exports.drawLine = function(e, t, n, r, a, p, s) {
  s.beginPath(), s.lineWidth = p * o, s.strokeStyle = a, s.moveTo(m(e), h(t)), s.lineTo(m(n), h(r)), s.stroke(), s.closePath()
}, exports.drawReturnImg = function(e, t) {
  var n = new Image;
  n.onload = function() {
    if (wx.getMenuButtonBoundingClientRect) {
      var r = wx.getMenuButtonBoundingClientRect() || {};
      e.drawImage(n, 10 * o, (r.top || 10) * o, 86, 64)
    } else 1624 == i && 750 == l ? e.drawImage(n, 10 * o, 44 * o, 86, 64) : e.drawImage(n, 10 * o, 10 * o, 86, 64);
    w({
      self: t,
      type: "bg"
    })
  }, n.src = "res/2d/return.png"
}, exports.drawText = function(e) {
  var t = (e = Object.assign({}, {
      self: {},
      t: "",
      size: 17,
      pos: [0, 0],
      type: "bg",
      special: !1,
      align: "center",
      color: "#fff",
      bold: !1,
      italic: !1
    }, e)).self.context[e.type],
    n = function(e, t) {
      var n = e * o * p / 414;
      s / p < 736 / 414 && (n = e * o * s / 736);
      return t && d ? n + "px ".concat(d) : n + "px Helvetica"
    }(e.size, e.special);
  e.bold && (n = "bold " + n);
  e.italic && (n = "italic " + n);
  t.font = n, t.textBaseline = "middle", t.textAlign = e.align, t.fillStyle = e.color, "list1" == e.type || "list2" == e.type ? t.fillText(e.t, m(e.pos[0]), x(e.pos[1])) : t.fillText(e.t, m(e.pos[0]), h(e.pos[1]))
}, exports.findSelfIndex = function(e, t, n) {
  return e.nickname === this.my使用rInfo.nickname && e.week_best_score === this.my使用rInfo.week_best_score
}, exports.frustumSizeWidth = exports.frustumSizeHeight = void 0, exports.go = k, exports.gtAppVersion = function(e) {
  var n = (0, t.getSystemInfo)().version;
  e = e.split("."), n = n.split(".");
  for (var r = Math.min(e.length, n.length), o = 0; o < r; o++) {
    if (parseInt(e[o]) > parseInt(n[o])) return !1;
    if (parseInt(e[o]) < parseInt(n[o])) return !0
  }
  return !0
}, exports.gtVersion = function(e) {
  try {
    var n = (0, t.getSystemInfo)().SDKVersion;
    e = e.split("."), n = n.split(".");
    for (var r = Math.min(e.length, n.length), o = 0; o < r; o++) {
      if (parseInt(e[o]) > parseInt(n[o])) return !1;
      if (parseInt(e[o]) < parseInt(n[o])) return !0
    }
    return !0
  } catch (e) {
    return !1
  }
}, exports.hide = y, exports.realDpr = void 0, exports.relayRerank = function(e) {
  for (var t, n, r = 0, o = e.length; r < o; r++)
    for (t = 0; t < o; t++) e[r].rank < e[t].rank && (n = e[t], e[t] = e[r], e[r] = n);
  return e
}, exports.rerank = function(e) {
  for (var t, n, r = 0, o = e.length; r < o; r++)
    for (t = 0; t < o; t++) e[r].week_best_score > e[t].week_best_score && (n = e[t], e[t] = e[r], e[r] = n);
  return e
}, exports.roundedRect = T, exports.routeCanvas = function(e, t) {
  e.last2CanvasType = e.lastCanvasType, e.lastCanvasType = e.canvasType, e.canvasType = u[t], (0, n.changeCanvasType)(t), k(e, t), (0, n.hide使用rInfoButton)()
}, exports.updateClip = function(t) {
  var n = t.self;
  n.p0 || (n.p0 = new e.Vector3(0, 0, 9), n.p1 = new e.Vector3(-g * (.5 - m(30) / l), (.5 - h(157) / i) * f, 9), n.p2 = new e.Vector3(g * (.5 - m(30) / l), f * (.5 - h(157) / i), 9), n.p3 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(218) / i), 9), n.p4 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(218) / i), 9));
  n.p5 || (n.p5 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(299) / i), 9), n.p6 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(299) / i), 9), n.p7 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(104) / i), 9), n.p8 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(104) / i), 9));
  n.p9 || (n.p9 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(332) / i), 9), n.p10 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(332) / i), 9), n.p11 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(175) / i), 9), n.p12 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(175) / i), 9));
  n.p13 || (n.p13 = new e.Vector3(-g * (.5 - m(30) / l), (.5 - h(318) / i) * f, 9), n.p14 = new e.Vector3(g * (.5 - m(30) / l), f * (.5 - h(318) / i), 9), n.p15 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(176) / i), 9), n.p16 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(176) / i), 9));
  n.p17 || (n.p17 = new e.Vector3(-g * (.5 - m(30) / l), (.5 - h(136) / i) * f, 9), n.p18 = new e.Vector3(g * (.5 - m(30) / l), f * (.5 - h(136) / i), 9), n.p19 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(118) / i), 9), n.p20 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(118) / i), 9));
  n.p21 || (n.p21 = new e.Vector3(-g * (.5 - m(30) / l), (.5 - h(278) / i) * f, 9), n.p22 = new e.Vector3(g * (.5 - m(30) / l), f * (.5 - h(278) / i), 9), n.p23 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(157) / i), 9), n.p24 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(157) / i), 9));
  n.p25 || (n.p25 = new e.Vector3(-g * (.5 - m(30) / l), (.5 - h(225) / i) * f, 9), n.p26 = new e.Vector3(g * (.5 - m(30) / l), f * (.5 - h(225) / i), 9), n.p27 = new e.Vector3(g * (.5 - m(30) / l), -f * (.5 - h(225) / i), 9), n.p28 = new e.Vector3(-g * (.5 - m(30) / l), -f * (.5 - h(225) / i), 9));
  var r = n.p0.clone(),
    o = n.p1.clone(),
    a = n.p2.clone(),
    p = n.p3.clone(),
    s = n.p4.clone();
  n.canvasType == u.pk && (o = n.p5.clone(), a = n.p6.clone(), p = n.p7.clone(), s = n.p8.clone());
  n.canvasType == u.relay第&& (o = n.p9.clone(), a = n.p10.clone(), p = n.p11.clone(), s = n.p12.clone(), 1 != n.opt.my_rank && (o = n.p13.clone(), a = n.p14.clone(), p = n.p15.clone(), s = n.p16.clone()), n.opt.isOutDate && (o = n.p25.clone(), a = n.p26.clone(), p = n.p27.clone(), s = n.p28.clone()));
  n.canvasType == u.msgBox && (o = n.p17.clone(), a = n.p18.clone(), p = n.p19.clone(), s = n.p20.clone());
  n.canvasType == u.shareSkin && (o = n.p21.clone(), a = n.p22.clone(), p = n.p23.clone(), s = n.p24.clone());
  n.options.camera.updateMatrixWorld();
  var c = n.options.camera.matrixWorld;
  r.applyMatrix4(c), o.applyMatrix4(c), a.applyMatrix4(c), p.applyMatrix4(c), s.applyMatrix4(c);
  var d = new e.Triangle(a, o),
    w = d.plane();
  n.canvasType == u.relay第&& 1 == n.opt.my_rank || n.canvasType == u.pk ? v(w, r.clone(), !0) : v(w, r.clone());
  var y = (d = new e.Triangle(p, a)).plane();
  v(y, r.clone());
  var x = (d = new e.Triangle(s, p)).plane();
  v(x, r.clone());
  var b = (d = new e.Triangle(o, s)).plane();
  v(b, r.clone()), n.material.list1.clippingPlanes = [w, y, x, b], n.material.list1.needsUpdate = !0, n.material.list2.clippingPlanes = [w, y, x, b], n.material.list2.needsUpdate = !0
}, exports.updatePlane = w;
var e = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var n = r(t);
    if (n && n.has(e)) return n.get(e);
    var o = {},
      a = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var p in e)
      if ("default" !== p && Object.prototype.hasOwnProperty.call(e, p)) {
        var s = a ? Object.getOwnPropertyDescriptor(e, p) : null;
        s && (s.get || s.set) ? Object.defineProperty(o, p, s) : o[p] = e[p]
      } o.default = e, n && n.set(e, o);
    return o
  }(require("../../lib/three")),
  t = require("../../config"),
  n = require("../../network/getAuth");

function r(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    n = new WeakMap;
  return (r = function(e) {
    return e ? n : t
  })(e)
}
var o = window.devicePixelRatio > 2 ? 2 : window.devicePixelRatio;
exports.Dpr = o;
var a = window.devicePixelRatio;
exports.realDpr = a;
var p = window.innerHeight < window.innerWidth ? window.innerHeight : window.innerWidth;
exports.W = p;
var s = window.innerHeight > window.innerWidth ? window.innerHeight : window.innerWidth;
exports.H = s;
var i = s * o;
exports.HEIGHT = i;
var l = p * o;
exports.WIDTH = l;
var c = ["btn", "list1", "list2", "bg"],
  u = {
    friendRank: 0,
    groupRank: 1,
    gameOver: 2,
    start: 3,
    pk: 4,
    lookers: 5,
    gameOverNew: 6,
    gameOverHighest: 7,
    beginner: 8,
    verify: 9,
    relayRoom: 10,
    relayGG: 11,
    relayRank: 12,
    relayLookers: 13,
    record: 14,
    relayBeginner: 15,
    relayQr: 16,
    record分享: 17,
    profile: 18,
    msgBox: 19,
    shareSkin: 20,
    getNewSkin: 21,
    skinList: 22,
    jiliProp: 23,
    msgDetail5: 24,
    pkRule: 25
  };
exports.CANVASTYPE = u;
var f = t.FRUSTUMSIZE;
exports.frustumSizeHeight = f;
var g = l / i * f;
exports.frustumSizeWidth = g;
exports.DEBUGVIEW = !1;
exports.ListLineHeight = 60;
var d = wx.loadFont("res/num.ttf");

function w(e) {
  (e = Object.assign({}, {
    self: {},
    type: "bg"
  }, e)).self.showState && (e.self.canvasType == u.gameOver && "bg" != e.type && "btn" != e.type && "sample" != e.type || e.self.canvasType == u.start && "bg" != e.type && "btn" != e.type && "sample" != e.type || e.self.canvasType == u.record && "bg" != e.type || (e.self.texture[e.type].needsUpdate = !0, e.self.obj[e.type].visible = !0, e.self.options.camera.add(e.self.obj[e.type])))
}

function v(e, t, n) {
  if (e && t) {
    var r = e.distanceToPoint(t);
    r < 0 && !n && e.negate(), n && r > 0 && e.negate()
  }
}

function y(e, t) {
  e.showState = !1, e.bannerAd && e.bannerAd.hide(), e.bannerAd && e.bannerAd.destory(), e.bannerAd = null;
  for (var n = 0; n < c.length; n++) !e.obj[c[n]] || t && t.indexOf(c[n]) >= 0 || (e.obj[c[n]].visible = !1, e.options.camera.remove(e.obj[c[n]]));
  e.canvasType != u.getNewSkin && e.canvasType != u.gameOver && e.canvasType != u.jiliProp && e.sunGif && (e.options.camera.remove(e.sunGif.obj), e.sunGif.destroy()), t || (e.lastopt = void 0)
}

function x(e) {
  var t = e * p / 414;
  return s / p < 736 / 414 && (t = e * s / 736), t * o
}

function m(e) {
  var t = e * p / 414;
  return s / p < 736 / 414 && (t = e * s / 736 + (p - 414 * s / 736) / 2), t * o
}

function h(e) {
  return (s / p > 736 / 414 ? e * p / 414 + (s - 736 * p / 414) / 2 : e * s / 736) * o
}

function b(e) {
  "/0" != (e = Object.assign({}, {
    self: {},
    src: "",
    pos: [0, 0, 100, 100],
    type: "bg",
    cb: null,
    imgid: 0,
    noupdate: !1,
    round: !1,
    radius: 2,
    alpha: 1
  }, e)).src && "/96" != e.src && "/64" != e.src && e.src || (e.src = "res/ava.png");
  var t = new Image,
    n = e.self.context[e.type];
  t.onload = function() {
    if (e.self.imgid[e.type] == e.imgid) {
      var r;
      if (e.round) n.save(), r = "list1" == e.type || "list2" == e.type ? x(e.pos[1]) - x(e.pos[3]) / 2 : h(e.pos[1]) - x(e.pos[3]) / 2, T(m(e.pos[0]) - x(e.pos[2]) / 2, r, x(e.pos[2]), x(e.pos[3]), e.radius, n), n.clip(), n.globalAlpha = e.alpha, n.drawImage(t, m(e.pos[0]) - x(e.pos[2]) / 2, r, x(e.pos[2]), x(e.pos[3])), n.globalAlpha = 1, n.closePath(), n.restore();
      else n.globalAlpha = e.alpha, "list1" == e.type || "list2" == e.type ? n.drawImage(t, m(e.pos[0]) - x(e.pos[2]) / 2, x(e.pos[1]) - x(e.pos[3]) / 2, x(e.pos[2]), x(e.pos[3])) : n.drawImage(t, m(e.pos[0]) - x(e.pos[2]) / 2, h(e.pos[1]) - x(e.pos[3]) / 2, x(e.pos[2]), x(e.pos[3])), n.globalAlpha = 1;
      e.cb && e.cb(), e.noupdate || w({
        self: e.self,
        type: e.type
      })
    }
  }, t.onerror = function(t) {
    e.cb && e.cb()
  }, t.src = e.src
}

function T(e, t, n, r, o, a) {
  a.beginPath(), a.moveTo(e, t + o - 1), a.lineTo(e, t + r - o), a.quadraticCurveTo(e, t + r, e + o, t + r), a.lineTo(e + n - o, t + r), a.quadraticCurveTo(e + n, t + r, e + n, t + r - o), a.lineTo(e + n, t + o), a.quadraticCurveTo(e + n, t, e + n - o, t), a.lineTo(e + o, t), a.quadraticCurveTo(e, t, e, t + o), a.stroke(), a.closePath()
}

function k(e, t) {
  e.routesArr = e.routesArr || [], e.routesArr.push(t)
}
},{"../../config":37,"../../lib/three":70,"../../network/getAuth":72}],90:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawBeginnerPage = function(r) {
  var t = (r = Object.assign({}, {
    self: {}
  }, r)).self;
  (0, e.routeCanvas)(t, "beginner"), (0, e.createPlane)(t);
  var a = t.context.bg;
  a.clearRect(0, 0, e.WIDTH, e.HEIGHT), a.fillStyle = "rgba(255,255,255,0.3)", a.fillRect((0, e.cx)(103), (0, e.cy)(134), (0, e.cwh)(206), (0, e.cwh)(115)), (0, e.drawText)({
    t: "长按屏幕并释放",
    self: t,
    size: 17,
    pos: [207, 172],
    color: "black"
  }), (0, e.drawText)({
    t: "控制",
    self: t,
    size: 17,
    pos: [149, 213],
    color: "black",
    align: "left"
  }), (0, e.drawText)({
    t: "向前跳",
    self: t,
    size: 17,
    pos: [265, 213],
    color: "black",
    align: "right"
  }), (0, e.drawImageCenter)({
    self: t,
    src: "res/i.png",
    pos: [198, 211, 13.2, 35.6],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, e.updatePlane)({
    self: t,
    type: "bg"
  })
};
var e = require("./base");
},{"./base":89}],91:[function(require,module,exports){
(Object.defineProperty(exports, "__esModule", {
  value: !0,
}),
  (exports.drawGetNewSkin = function (t) {
    ((t.sunGif = new n.default(-0.5, 4, 8.998, 20, 20, "res/2d/sun.png")),
      t.sunGif.rotate(0.002),
      t.options.camera.add(t.sunGif.obj),
      (0, e.createPlane)(t),
      (0, e.routeCanvas)(t, "getNewSkin"),
      t.imgid.bg++,
      t.imgid.btn++);
    var r = t.context.btn;
    (r.clearRect(0, 0, e.WIDTH, e.HEIGHT),
      t.context.bg.clearRect(0, 0, e.WIDTH, e.HEIGHT),
      (r.fillStyle = "rgba(0,0,0, 0.45)"),
      r.fillRect(0, 0, e.WIDTH, e.HEIGHT));
    var o = t.opt;
    ((0, e.drawImageCenter)({
      self: t,
      src: "res/bl3.png",
      pos: [207, 304.5, 354, 401],
      type: "bg",
      imgid: t.imgid.bg,
      cb: function () {
        ((0, e.drawText)({
          self: t,
          size: 12,
          t: o.desc,
          pos: [207, 176],
          type: "btn",
          color: "rgba(255,255,255,0.6)",
        }),
          (function (t) {
            ((t.lineWidth = 1 * e.Dpr),
              (t.strokeStyle = "#fff"),
              (t.fillStyle = "#fff"),
              (0, e.roundedRect)(
                (0, e.cx)(144),
                (0, e.cy)(96),
                (0, e.cwh)(126),
                (0, e.cwh)(44),
                4 * e.Dpr,
                t,
              ),
              t.fill(),
              (t.lineWidth = 1 * e.Dpr),
              (t.strokeStyle = "#555"),
              (t.fillStyle = "#555"),
              (0, e.roundedRect)(
                (0, e.cx)(147),
                (0, e.cy)(99),
                (0, e.cwh)(120),
                (0, e.cwh)(38),
                2 * e.Dpr,
                t,
              ),
              t.fill(),
              (t.lineWidth = 1 * e.Dpr),
              (t.strokeStyle = "#D2A764"),
              (t.fillStyle = "#D2A764"),
              (0, e.roundedRect)(
                (0, e.cx)(147),
                (0, e.cy)(99),
                (0, e.cwh)(120),
                (0, e.cwh)(36),
                2 * e.Dpr,
                t,
              ),
              t.fill());
          })(r),
          (0, e.drawText)({
            self: t,
            size: 17,
            t: "获得新皮肤",
            pos: [207, 115],
            bold: !0,
            type: "btn",
          }),
          (0, e.drawImageCenter)({
            self: t,
            src: o.poster,
            pos: [207, 308, 50, 100],
            type: "btn",
            imgid: t.imgid.btn,
          }),
          (0, e.drawImageCenter)({
            self: t,
            src: "res/pure_share.png",
            pos: [207, 456, 18, 24],
            type: "btn",
            imgid: t.imgid.btn,
          }),
          (r.strokeStyle = "rgba(255,255,255,0.06)"));
      },
    }),
      (0, e.drawImageCenter)({
        self: t,
        src: "res/2d/new_return.png",
        pos: [54, 674, 70, 70],
        type: "btn",
        imgid: t.imgid.btn,
      }),
      (0, e.drawImageCenter)({
        self: t,
        src: "res/2d/iplay.png",
        pos: [322, 670, 160, 75],
        type: "btn",
        imgid: t.imgid.btn,
        cb: function () {
          ((0, e.drawImageCenter)({
            self: t,
            src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJDb9JwwmxHtnUrFjffD8F0VaaNDyic3X9Uy7Vsj4iaw3U2MyLcYv7gUcp0VgZRafjvhA/0?wx_fmt=png",
            pos: [265, 645, 54, 105],
            type: "btn",
            imgid: t.imgid.btn,
          }),
            (0, e.drawText)({
              self: t,
              size: 17,
              t: "分享",
              color: "#222",
              pos: [327, 670],
              type: "btn",
            }),
            (0, e.updatePlane)({
              self: t,
              type: "btn",
            }));
        },
      }));
  }),
  (exports.drawJiLiAdGetPropPage = function (t) {
    ((t.sunGif = new n.default(-0.5, 4, 8.998, 20, 20, "res/2d/sun.png")),
      t.sunGif.rotate(0.002),
      t.options.camera.add(t.sunGif.obj),
      (0, e.routeCanvas)(t, "jiliProp"),
      (0, e.createPlane)(t),
      t.imgid.bg++,
      t.imgid.btn++);
    var r = t.context.bg;
    (r.clearRect(0, 0, e.WIDTH, e.HEIGHT),
      t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT),
      (r.fillStyle = "rgba(0,0,0, 0.45)"),
      r.fillRect(0, 0, e.WIDTH, e.HEIGHT),
      (r.lineWidth = 1 * e.Dpr),
      (r.strokeStyle = "rgba(255,255,255,0.06)"),
      (0, e.roundedRect)(
        (0, e.cx)(30),
        (0, e.cy)(144),
        (0, e.cwh)(354),
        (0, e.cwh)(421),
        4 * e.Dpr,
        r,
      ),
      (r.strokeStyle = "rgba(255,255,255,0.06)"),
      (0, e.drawImageCenter)({
        round: !0,
        self: t,
        src: "res/bl3.png",
        pos: [207, 354.5, 354, 421],
        type: "bg",
        imgid: t.imgid.bg,
        radius: 4 * e.Dpr,
        cb: function () {
          ((0, e.drawImageCenter)({
            self: t,
            src: "res/2d/target.png",
            pos: [207, 314, 96, 96],
            type: "btn",
            imgid: t.imgid.btn,
          }),
            (r.lineWidth = 1 * e.Dpr),
            (r.strokeStyle = "#fff"),
            (r.fillStyle = "#fff"),
            (0, e.roundedRect)(
              (0, e.cx)(146),
              (0, e.cy)(128),
              (0, e.cwh)(122),
              (0, e.cwh)(40),
              4 * e.Dpr,
              r,
            ),
            r.fill(),
            (r.lineWidth = 1 * e.Dpr),
            (r.strokeStyle = "#999"),
            (r.fillStyle = "#999"),
            (0, e.roundedRect)(
              (0, e.cx)(149),
              (0, e.cy)(131),
              (0, e.cwh)(116),
              (0, e.cwh)(34),
              2 * e.Dpr,
              r,
            ),
            r.fill(),
            (r.lineWidth = 1 * e.Dpr),
            (r.strokeStyle = "#D2A764"),
            (r.fillStyle = "#D2A764"),
            (0, e.roundedRect)(
              (0, e.cx)(149),
              (0, e.cy)(131),
              (0, e.cwh)(116),
              (0, e.cwh)(32),
              2 * e.Dpr,
              r,
            ),
            r.fill(),
            (0, e.drawText)({
              self: t,
              size: 17,
              t: "获得道具",
              pos: [207, 147],
            }),
            (0, e.drawText)({
              self: t,
              size: 14,
              t: "在游戏中使用本道具可自动完",
              pos: [207, 453],
              color: "rgba(255,255,255,0.8)",
            }),
            (0, e.drawText)({
              self: t,
              size: 14,
              t: "成1次完美的跳跃",
              pos: [207, 475],
              color: "rgba(255,255,255,0.8)",
            }));
        },
      }),
      (0, e.drawImageCenter)({
        self: t,
        src: "res/2d/new_return.png",
        pos: [54, 674, 70, 70],
        type: "bg",
        imgid: t.imgid.bg,
      }),
      (0, e.updatePlane)({
        self: t,
        type: "bg",
      }));
  }),
  (exports.drawJiLiAdGetPropPageEve = function (e, t, r) {
    if (t > 42 && t < 110 && r > 640 && r < 720)
      return (
        e.options.camera.remove(e.sunGif.obj),
        e.sunGif.destroy(),
        e.opt.onReturn && e.opt.onReturn(),
        !1
      );
  }),
  (exports.gameOverEve = function (t, n, s) {
    console.log("gameOverEve", n, s);
    var a = t.opt.score >= o.REWARD_SCORE && o.CAN_USE_REWARD_CHALLENGE;
    "skin" != t.opt.type &&
      n > 42 &&
      n < 110 &&
      s > t.replayBtnPosy - 50 &&
      s < t.replayBtnPosy + 50 &&
      r.default.emitSync(o.EVENT.GOSTARTPAGE, {});
    if (
      "tired" != t.opt.type &&
      "skin" != t.opt.type &&
      n > 168 &&
      n < 340 &&
      s > t.replayBtnPosy - 50 &&
      s < t.replayBtnPosy + 50
    )
      return (
        (0, e.hide)(t),
        t.options.onClickReplay && t.options.onClickReplay(),
        !1
      );
    if (
      "tired" == t.opt.type &&
      t.noplay_time <= 0 &&
      n > 207 &&
      n < 360 &&
      s > 540 &&
      s < 660
    )
      return (t.options.onClickReplay && t.options.onClickReplay(), !1);
    if (
      "ban" == t.opt.type &&
      1 == t.opt.banType &&
      n > 150 &&
      n < 260 &&
      s > 430 &&
      s < 500
    )
      return ((0, i.routeVerify)(t), !1);
    if (
      ("week" == t.opt.type ||
        "history" == t.opt.type ||
        "skin" == t.opt.type) &&
      n > 128 &&
      n < 285 &&
      s > 310 &&
      s < 350 &&
      t.opt.score >= o.REWARD_SCORE
    )
      return (t.options.onClick分享 && t.options.onClick分享(!0), !1);
    if (
      ("week" == t.opt.type ||
        "history" == t.opt.type ||
        "skin" == t.opt.type) &&
      n > 198 &&
      n < 216 &&
      s > 315.5 &&
      s < 339.5 &&
      t.opt.score < o.REWARD_SCORE
    )
      return (
        t.options.onClickPure分享 && t.options.onClickPure分享(t.opt.type),
        !1
      );
    if (
      ("week" == t.opt.type ||
        "history" == t.opt.type ||
        "skin" == t.opt.type) &&
      n > 301 &&
      n < 319 &&
      s > 315.5 &&
      s < 339.5 &&
      t.opt.score >= o.REWARD_SCORE
    )
      return (
        t.options.onClickPure分享 && t.options.onClickPure分享(t.opt.type),
        !1
      );
    if (
      ("week" == t.opt.type ||
        "history" == t.opt.type ||
        "skin" == t.opt.type) &&
      t.changlleList.length > 5 &&
      n > 55 &&
      n < 115 &&
      s > 402 &&
      s < 422
    )
      return (p(t, -1), !1);
    if (
      ("week" == t.opt.type ||
        "history" == t.opt.type ||
        "skin" == t.opt.type) &&
      t.changlleList.length > 5 &&
      n > 297 &&
      n < 357 &&
      s > 402 &&
      s < 422
    )
      return (p(t, 1), !1);
    if (
      ("week" == t.opt.type ||
        "history" == t.opt.type ||
        "skin" == t.opt.type) &&
      0 == t.changlleList.length &&
      n > 31 &&
      n < 384 &&
      s > 406 &&
      s < 453
    )
      return (
        t.sunGif && (t.options.camera.remove(t.sunGif.obj), t.sunGif.destroy()),
        t.options.onClick第 && t.options.onClickRank(),
        !1
      );
    if (
      ("week" == t.opt.type ||
        "history" == t.opt.type ||
        "skin" == t.opt.type) &&
      t.changlleList.length > 0 &&
      n > 31 &&
      n < 384 &&
      s > 483 &&
      s < 530
    )
      return (
        t.sunGif && (t.options.camera.remove(t.sunGif.obj), t.sunGif.destroy()),
        t.options.onClick第 && t.options.onClickRank(),
        !1
      );
    if ("gg" == t.opt.type && n > 25 && n < 385 && s > 290 && s < 490)
      return (t.options.onClick第 && t.options.onClickRank(), !1);
    if ("skin" == t.opt.type && n > 150 && n < 260 && s < 720 && s > 500)
      return (
        t.sunGif && (t.options.camera.remove(t.sunGif.obj), t.sunGif.destroy()),
        t.opt.onClickBottleSkin && t.opt.onClickBottleSkin(),
        !1
      );
    if (
      "gg" == t.opt.type &&
      t.opt.advertise &&
      n > 250 &&
      n < 325 &&
      s > 155 &&
      s < 195
    )
      return (
        wx.openUrl &&
          wx.openUrl({
            url: t.opt.advertise.url,
          }),
        r.default.emit(o.EVENT.JUMP_AD_GG, {}),
        !1
      );
    if ("gg" == t.opt.type && n > 198 && n < 216 && s > 206 && s < 230)
      return (
        t.options.onClickPure分享 && t.options.onClickPure分享("shareBattle"),
        !1
      );
    if ("gg" == t.opt.type && n > 301 && n < 319 && s > 228 && s < 254 && a)
      return (
        t.options.onClickPure分享 && t.options.onClickPure分享("shareBattle"),
        !1
      );
    if (
      ("gg" == t.opt.type || "tired" == t.opt.type) &&
      n > 139 &&
      n < 275 &&
      s > 199 &&
      s < 260 &&
      t.opt.score < o.REWARD_SCORE
    )
      return (
        console.log("!!! onClick分享 gg or tired", t.options.onClickPkRule),
        t.options.onClick分享 && t.options.onClick分享(!0),
        !1
      );
    if (
      ("gg" == t.opt.type || "tired" == t.opt.type) &&
      n > 128 &&
      n < 286 &&
      s > 199 &&
      s < 260 &&
      t.opt.score >= o.REWARD_SCORE
    )
      return (
        console.log("!!! onClick分享 gg or tired", t.options.onClickPkRule),
        t.options.onClick分享 && t.options.onClick分享(!0),
        !1
      );
    if (
      "gg" == t.opt.type &&
      1 == t.opt.loadAdSuc &&
      n > 25 &&
      n < 385 &&
      s > 511 &&
      s < 531
    )
      return (t.opt.videoAd.show(), console.log("点击查看激励广告"), !1);
  }),
  (exports.getNewSkinEve = function (e, t, r) {
    if (t > 42 && t < 110 && r > 640 && r < 720)
      return (
        e.options.camera.remove(e.sunGif.obj),
        e.sunGif.destroy(),
        e.opt.onReturn && e.opt.onReturn(),
        !1
      );
    if (t > 220 && t < 440 && r > 640 && r < 720)
      return (e.opt.on分享Gift && e.opt.on分享Gift(), !1);
    if (t > 177 && t < 237 && r > 436 && r < 476)
      return (e.opt.on分享Skin && e.opt.on分享Skin(), !1);
  }),
  (exports.routeGameOver = function (i, n) {
    (0, e.createPlane)(i);
    var a = i.opt;
    ((i.my使用rInfo = t.default.getMy使用rInfo() || {
      headimg: "",
      nickname: "",
      week_best_score: 0,
      score_info: [
        {
          score: 0,
        },
      ],
    }),
      (i.my使用rInfo.last_week_best_score = a.week_best_score),
      (i.my使用rInfo.week_best_score =
        Math.max(a.week_best_score, a.score) || 0));
    var l = t.default.getFriends本次得分() || [];
    l.push(i.my使用rInfo);
    var p = (0, e.rerank)(l);
    if (
      ((i.sotedRankList = p),
      (i.myidx = p.findIndex(e.findSelfIndex.bind(i)) + 1),
      (i.changlleList = []),
      a.score >= a.highest_score ||
        a.score >= i.my使用rInfo.last_week_best_score)
    ) {
      (
        t.default.getMy使用rInfo() || {
          headimg: "",
          nickname: "",
          week_best_score: 0,
          score_info: [
            {
              score: 0,
            },
          ],
        }
      ).week_best_score = a.score;
      for (
        var h = t.default.getFriends本次得分() || [], b = 0;
        b < h.length;
        b++
      )
        h[b].week_best_score < a.score &&
          h[b].week_best_score > i.my使用rInfo.last_week_best_score &&
          i.changlleList.push(h[b]);
    }
    var w = !1;
    (a.game_cnt > 5 || a.score > 5) &&
      !i._has_show_tired &&
      +new Date() / 1e3 - a.start_time > 1800 &&
      ((w = !0), (i._has_show_tired = !0));
    ((0, e.routeCanvas)(i, "gameOver"),
      GameGlobal.matchType
        ? ((GameGlobal.matchType = 0),
          r.default.emitSync(o.EVENT.GOSTARTPAGE, {}))
        : i.opt.banType
          ? ((i.opt.type = "ban"),
            (function (t) {
              t.imgid.bg++;
              var r = t.opt,
                o = t.context.bg;
              (y(t, o, Math.max(r.highest_score, r.score)),
                g(t, r.score, o, 69),
                f(t),
                (0, e.drawText)({
                  self: t,
                  t: "游戏中存在可疑操作，该分数",
                  pos: [207, 373],
                  size: 17,
                }),
                (0, e.drawText)({
                  self: t,
                  t: "将不在排行榜中显示",
                  pos: [207, 399],
                  size: 17,
                }),
                (0, e.drawLine)(
                  0,
                  296,
                  414,
                  296,
                  "rgba(255,255,255,0.1)",
                  0.5,
                  o,
                ),
                (0, e.drawLine)(
                  0,
                  526,
                  414,
                  526,
                  "rgba(255,255,255,0.1)",
                  0.5,
                  o,
                ),
                1 == r.banType &&
                  ((0, e.drawImageCenter)({
                    self: t,
                    src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJNNcIVa8Pr2VajbZ52iaZX9Vlib0QAKEJGDIV8F9iaFeqXoawUbQkDP8zc6fbm95nKLgw/0?wx_fmt=png",
                    pos: [207, 459, 138, 44],
                    type: "bg",
                    imgid: t.imgid.bg,
                  }),
                  (0, e.drawText)({
                    self: t,
                    t: "我要申诉",
                    pos: [207, 459],
                    size: 17,
                  })));
              (0, e.updatePlane)({
                self: t,
                type: "bg",
              });
            })(i))
          : a.bottle_skin_icon
            ? ((i.opt.type = "skin"), c(i))
            : a.score > a.highest_score
              ? ((i.opt.type = "history"), c(i))
              : a.score > i.my使用rInfo.last_week_best_score
                ? ((i.opt.type = "week"), c(i))
                : w
                  ? ((i.opt.type = "tired"),
                    (function (t) {
                      t.imgid.bg++;
                      var r = t.opt,
                        o = t.context.bg;
                      (y(t, o, Math.max(r.highest_score, r.score)),
                        (0, e.drawImageCenter)({
                          self: t,
                          src: "res/2d/new_home.png",
                          pos: [76, 607, 74, 74],
                          type: "bg",
                          imgid: t.imgid.bg,
                        }),
                        d({
                          self: t,
                          score: r.score,
                        }),
                        g(t, r.score, o, 0),
                        (o.lineWidth = 4 * e.Dpr),
                        (o.strokeStyle = "#fff"),
                        (o.fillStyle = "#fff"),
                        (0, e.roundedRect)(
                          (0, e.cx)(31),
                          (0, e.cy)(298),
                          (0, e.cwh)(354),
                          (0, e.cwh)(210),
                          1 * e.Dpr,
                          o,
                        ),
                        o.fill(),
                        (0, e.drawText)({
                          self: t,
                          t: "玩了这么久",
                          pos: [80, 370],
                          size: 17,
                          color: "black",
                          align: "left",
                        }),
                        (0, e.drawText)({
                          self: t,
                          t: "休息1下吧",
                          pos: [80, 410],
                          size: 17,
                          color: "black",
                          align: "left",
                        }),
                        (0, e.drawImageCenter)({
                          self: t,
                          src: "res/tired.png",
                          pos: [297, 397, 179, 185],
                          type: "bg",
                          imgid: t.imgid.bg,
                        }));
                      var i = t.context.btn;
                      (i.clearRect(0, 0, e.WIDTH, e.HEIGHT),
                        (0, e.drawImageCenter)({
                          self: t,
                          src: "res/noplay.png",
                          pos: [257, 607, 212, 84],
                          type: "btn",
                          cb: function () {
                            ((t.noplay_time = 5),
                              (0, e.drawText)({
                                self: t,
                                type: "btn",
                                color: "#00C777",
                                size: 22,
                                t: t.noplay_time,
                                pos: [190, 607],
                              }),
                              (0, e.updatePlane)({
                                self: t,
                                type: "btn",
                              }),
                              (t.timer = setInterval(function () {
                                (t.noplay_time--,
                                  "tired" == t.opt.type
                                    ? t.noplay_time <= 0
                                      ? (clearInterval(t.timer),
                                        i.clearRect(0, 0, e.WIDTH, e.HEIGHT),
                                        (0, e.drawImageCenter)({
                                          self: t,
                                          src: "res/replay.png",
                                          pos: [257, 607, 212, 84],
                                          type: "btn",
                                          imgid: t.imgid.btn,
                                        }))
                                      : ((i.fillStyle = "white"),
                                        i.fillRect(
                                          (0, e.cx)(175),
                                          (0, e.cy)(590),
                                          (0, e.cwh)(30),
                                          (0, e.cwh)(30),
                                        ),
                                        (0, e.drawText)({
                                          self: t,
                                          color: "#00C777",
                                          size: 22,
                                          t: t.noplay_time,
                                          pos: [190, 607],
                                          type: "btn",
                                        }),
                                        (0, e.updatePlane)({
                                          self: t,
                                          type: "btn",
                                        }))
                                    : clearInterval(t.timer));
                              }, 1e3)));
                          },
                          imgid: t.imgid.btn,
                        }),
                        (0, e.updatePlane)({
                          self: t,
                          type: "bg",
                        }));
                    })(i))
                  : ((i.opt.type = "gg"),
                    (function (t) {
                      (t.imgid.bg++, t.imgid.btn++);
                      var r = t.opt,
                        i =
                          r.score >= o.REWARD_SCORE &&
                          o.CAN_USE_REWARD_CHALLENGE,
                        n = t.context.bg;
                      (y(t, n, Math.max(r.highest_score, r.score)),
                        r.advertise && r.advertise.score
                          ? (d({
                              self: t,
                              posy: 244,
                              score: r.score,
                            }),
                            (0, e.drawText)({
                              self: t,
                              size: 14,
                              t: "本次得分",
                              pos: [119, 118],
                            }),
                            (0, e.drawText)({
                              self: t,
                              size: 58,
                              special: !0,
                              t: r.score,
                              pos: [119, 166],
                            }),
                            (0, e.drawLine)(
                              227,
                              98,
                              227,
                              186,
                              "rgba(255,255,255,0.4)",
                              0.5,
                              n,
                            ),
                            (0, e.drawText)({
                              self: t,
                              t: "为你助力",
                              align: "left",
                              size: 17,
                              pos: [255, 149],
                            }),
                            (0, e.drawText)({
                              self: t,
                              t: "+ " + r.advertise.score,
                              align: "left",
                              special: !0,
                              size: 17,
                              pos: [325, 149],
                            }),
                            (0, e.drawText)({
                              self: t,
                              t: "查看详情",
                              align: "left",
                              size: 12,
                              pos: [256, 175],
                            }),
                            (0, e.drawImageCenter)({
                              self: t,
                              src: "res/r_arr.png",
                              pos: [315, 175, 6.6, 10],
                              type: "bg",
                              imgid: t.imgid.bg,
                            }),
                            (0, e.drawImageCenter)({
                              self: t,
                              src: r.advertise.icon_url,
                              pos: [269, 115, 24, 24],
                              type: "bg",
                              imgid: t.imgid.bg,
                            }))
                          : (d({
                              self: t,
                              score: r.score,
                            }),
                            g(t, r.score, n, 0)));
                      if ("gg" === r.type) {
                        var a = i ? 310 : 207,
                          l = i ? 240.5 : 218;
                        (0, e.drawImageCenter)({
                          self: t,
                          src: "res/pure_share.png",
                          pos: [a, l, 18, 24],
                          type: "bg",
                          imgid: t.imgid.bg,
                        });
                      }
                      ((n.lineWidth = 1 * e.Dpr),
                        (n.strokeStyle = "rgba(255,255,255,0.06)"),
                        (0, e.roundedRect)(
                          (0, e.cx)(30),
                          (0, e.cy)(297),
                          (0, e.cwh)(354),
                          (0, e.cwh)(192),
                          4 * e.Dpr,
                          n,
                        ),
                        (0, e.drawImageCenter)({
                          round: !0,
                          self: t,
                          src: "res/bl3.png",
                          pos: [207, 393, 354, 192],
                          type: "bg",
                          imgid: t.imgid.bg,
                          radius: 4 * e.Dpr,
                          cb: function () {
                            ((0, e.drawLine)(
                              30,
                              449,
                              384,
                              449,
                              "rgba(255,255,255,0.06)",
                              0.5,
                              n,
                            ),
                              (0, e.drawText)({
                                self: t,
                                t: "排行榜 · 每周1凌晨刷新",
                                color: "rgba(255,255,255,0.6)",
                                align: "left",
                                size: 12,
                                pos: [46, 468],
                              }),
                              (0, e.drawText)({
                                self: t,
                                t: "查看全部排行",
                                align: "left",
                                size: 12,
                                pos: [291, 468],
                              }),
                              (0, e.drawImageCenter)({
                                self: t,
                                src: "res/r_arr.png",
                                pos: [371, 468, 6.6, 10],
                                type: "bg",
                                imgid: t.imgid.bg,
                              }),
                              (0, s.getAuthWxFriendInteraction)(!1)
                                .then(function () {
                                  ((n.fillStyle = "rgba(255,255,255,0.06)"),
                                    n.fillRect(
                                      (0, e.cx)(150),
                                      (0, e.cy)(296),
                                      (0, e.cwh)(115),
                                      (0, e.cwh)(153),
                                    ));
                                  var r = t.myidx - 2,
                                    o = 0;
                                  1 == t.sotedRankList.length && (o = 1);
                                  for (
                                    var i = function () {
                                        if (
                                          (1 == t.myidx && 0 == s && r++,
                                          t.myidx == t.sotedRankList.length &&
                                            2 == s)
                                        )
                                          return "continue";
                                        var i = "";
                                        if (
                                          ((i =
                                            t.myidx == r + 1 + s
                                              ? "#41bf8c"
                                              : "#888"),
                                          t.sotedRankList[r + s])
                                        ) {
                                          ((0, e.drawText)({
                                            self: t,
                                            color: i,
                                            italic: !0,
                                            bold: !0,
                                            size: 16,
                                            t: r + 1 + s,
                                            pos: [90 + 118 * (s + o), 318],
                                          }),
                                            (0, e.drawText)({
                                              self: t,
                                              color: "#888",
                                              t: (0, e.cname)(
                                                t.sotedRankList[r + s].nickname,
                                                14,
                                              ),
                                              pos: [90 + 118 * (s + o), 394],
                                              size: 14,
                                            }),
                                            (0, e.drawText)({
                                              self: t,
                                              size: 22,
                                              special: !0,
                                              t:
                                                t.sotedRankList[r + s]
                                                  .week_best_score || 0,
                                              pos: [90 + 118 * (s + o), 426],
                                            }));
                                          var n = 90 + 118 * (s + o);
                                          (0, e.drawImageCenter)({
                                            self: t,
                                            round: !0,
                                            src: t.sotedRankList[r + s].headimg,
                                            pos: [n, 355, 42, 42],
                                            type: "bg",
                                            cb: function () {
                                              (0, e.drawImageCenter)({
                                                self: t,
                                                src: "res/ava_rank.png",
                                                pos: [n, 355, 58, 58],
                                                type: "bg",
                                                imgid: t.imgid.bg,
                                              });
                                            },
                                            imgid: t.imgid.bg,
                                            noupdate: !0,
                                          });
                                        }
                                      },
                                      s = 0;
                                    s < 3;
                                    s++
                                  )
                                    i();
                                })
                                .catch(function () {
                                  ((0, e.drawImageCenter)({
                                    self: t,
                                    src: "res/auth/rank_tip.png",
                                    pos: [205, 355, 254, 24],
                                    type: "bg",
                                    imgid: t.imgid.bg,
                                  }),
                                    (0, e.drawImageCenter)({
                                      self: t,
                                      src: "res/auth/refresh.png",
                                      pos: [205, 390, 45, 18],
                                      type: "bg",
                                      imgid: t.imgid.bg,
                                    }));
                                }));
                          },
                        }),
                        (0, e.updatePlane)({
                          self: t,
                          type: "bg",
                        }),
                        console.log(
                          t.opt.ad_type,
                          !!wx.createRewardedVideoAd,
                          "reward" == t.opt.ad_type,
                        ));
                      var c = (0, o.getSystemInfo)();
                      if (
                        wx.createRewardedVideoAd &&
                        "reward" == t.opt.ad_type &&
                        (("ios" == c.platform &&
                          (0, e.gtAppVersion)("6.7.0")) ||
                          ((0, e.gtVersion)("2.1.2") &&
                            "android" == c.platform &&
                            (0, e.gtAppVersion)("6.6.7")))
                      )
                        ((t.opt.videoAd = wx.createIncentiveVideoAd({
                          adUnitId: "adunit-d8b47b944fa90908",
                        })),
                          t.opt.videoAd
                            ? (t.opt.videoAd
                                .load()
                                .then(function () {
                                  (console.log("load reward ad succ"),
                                    (t.opt.loadAdSuc = !0),
                                    (t.hasAd = !0),
                                    (function (t) {
                                      if (t.canvasType != e.CANVASTYPE.gameOver)
                                        return;
                                      ((t.context.bg.strokeStyle =
                                        "rgba(255,255,255,0.06)"),
                                        (0, e.drawImageCenter)({
                                          round: !0,
                                          self: t,
                                          src: "res/bl3.png",
                                          pos: [207, 521, 354, 50],
                                          type: "bg",
                                          imgid: t.imgid.bg,
                                          radius: 4 * e.Dpr,
                                          cb: function () {
                                            ((0, e.drawText)({
                                              self: t,
                                              size: 14,
                                              t: "看广告拿道具",
                                              pos: [220, 521],
                                            }),
                                              (0, e.drawImageCenter)({
                                                self: t,
                                                src: "res/2d/target.png",
                                                pos: [154, 521, 24, 24],
                                                type: "bg",
                                                imgid: t.imgid.bg,
                                              }),
                                              (0, e.drawImageCenter)({
                                                self: t,
                                                src: "res/r_arr.png",
                                                pos: [276, 521, 6.6, 10],
                                                type: "bg",
                                                imgid: t.imgid.bg,
                                              }));
                                          },
                                        }));
                                    })(t),
                                    t.opt.onShowRewardAd &&
                                      t.opt.onShowRewardAd());
                                })
                                .catch(function (e) {
                                  ((t.opt.loadAdSuc = !1),
                                    console.log("reward ad err", e),
                                    console.log(e.message));
                                }),
                              t.hasAd ||
                                t.opt.videoAd.onClose(function (e) {
                                  ((e && e.isEnded) || void 0 === e) &&
                                    ((t.opt.loadAdSuc = !1),
                                    t.opt.onRewardAdGetProp &&
                                      t.opt.onRewardAdGetProp());
                                }),
                              console.log("load reward ? "))
                            : console.warn("!!! createRewardedVideoAd fail"));
                      else if (wx.createBannerAd && (0, e.gtVersion)("2.0.6")) {
                        var p = e.WIDTH / e.Dpr;
                        return (
                          e.HEIGHT / e.WIDTH < 736 / 414 &&
                            (p = Math.max((0, e.cx)(370) / e.Dpr, 300)),
                          t.bannerAd ||
                            (t.bannerAd = wx.createBannerAd({
                              adUnitId: "adunit-eed18d29ad7e511b",
                              style: {
                                left: 0,
                                top: e.HEIGHT / e.Dpr - 119,
                                width: p,
                              },
                            })),
                          void (t.bannerAd
                            ? (t.bannerAd.show(),
                              t.bannerAd.onError(function (e) {
                                (console.log("banner load err"), f(t));
                              }),
                              t.bannerAd.onLoad(function (r) {
                                (console.log(
                                  "23333? ",
                                  window.innerHeight,
                                  window.innerWidth,
                                  e.HEIGHT,
                                  e.WIDTH,
                                  e.HEIGHT / e.WIDTH > 736 / 414,
                                ),
                                  e.HEIGHT / e.WIDTH > 736 / 414 + 0.5
                                    ? f(t)
                                    : f(t, 548),
                                  t.opt.onShowBannerAd &&
                                    t.opt.onShowBannerAd(),
                                  console.log("banner ad load succ"));
                              }),
                              t.bannerAd.onResize(function (r) {
                                (console.log("on resize", r.width, r.height),
                                  t.bannerAd &&
                                    t.bannerAd.style &&
                                    (e.HEIGHT / e.WIDTH > 736 / 414
                                      ? (t.bannerAd.style.top =
                                          e.HEIGHT / e.Dpr - r.height - 20)
                                      : (t.bannerAd.style.top =
                                          e.HEIGHT / e.Dpr - r.height),
                                    r.height > 180
                                      ? t.bannerAd.hide()
                                      : e.HEIGHT / e.WIDTH < 736 / 414 &&
                                        ((t.bannerAd.style.width = p),
                                        (t.bannerAd.style.left =
                                          (e.WIDTH / e.Dpr - p) / 2))));
                              }))
                            : console.warn("!!! createBannerAd fail"))
                        );
                      }
                      f(t);
                    })(i)));
  }));
var e = require("./base"),
  t = l(require("../../store/storage")),
  r = l(require("../../lib/mue/eventcenter")),
  o = require("../../config"),
  i = require("./verify"),
  n = l(require("../threePage")),
  s = require("../../network/getAuth"),
  a = require("../../util/common");

function l(e) {
  return e && e.__esModule
    ? e
    : {
        default: e,
      };
}

function c(t) {
  (t.imgid.bg++, t.imgid.btn++);
  var r = t.opt,
    i = t.context.bg;
  (y(t, i, Math.max(r.highest_score, r.score)),
    t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT),
    (i.lineWidth = 1 * e.Dpr),
    (i.strokeStyle = "rgba(255,255,255,0.06)"));
  var s = 426;
  (0 == t.changlleList.length && (s = 349),
    (0, e.roundedRect)(
      (0, e.cx)(30),
      (0, e.cy)(104),
      (0, e.cwh)(354),
      (0, e.cwh)(s),
      4 * e.Dpr,
      i,
    ),
    (i.strokeStyle = "rgba(255,255,255,0.06)"),
    (0, e.drawImageCenter)({
      round: !0,
      self: t,
      src: "res/bl3.png",
      pos: [207, 104 + s / 2, 354, s],
      type: "bg",
      imgid: t.imgid.bg,
      radius: 4 * e.Dpr,
      cb: function () {
        (!(function (t, r) {
          var o = "新纪录",
            i = "#E11212";
          "history" == t.opt.type &&
            (t.opt.highest_score < 100 && t.opt.score >= 100
              ? ((o = "初窥门径"), (i = "#509FC9"))
              : t.opt.highest_score < 500 && t.opt.score >= 500
                ? ((o = "耐得寂寞"), (i = "#E67600"))
                : t.opt.highest_score < 1e3 && t.opt.score >= 1e3
                  ? ((o = "登堂入室"), (i = "#009D5E"))
                  : t.opt.highest_score < 2e3 && t.opt.score >= 2e3
                    ? ((o = "无聊大师"), (i = "#7A0096"))
                    : t.opt.highest_score < 3e3 &&
                      t.opt.score >= 3e3 &&
                      ((o = "1指禅"), (i = "#555555")));
          ((r.lineWidth = 1 * e.Dpr),
            (r.strokeStyle = "#fff"),
            (r.fillStyle = "#fff"),
            (0, e.roundedRect)(
              (0, e.cx)(166),
              (0, e.cy)(88),
              (0, e.cwh)(82),
              (0, e.cwh)(32),
              4 * e.Dpr,
              r,
            ),
            r.fill(),
            (r.lineWidth = 1 * e.Dpr),
            (r.strokeStyle = "#800000"),
            (r.fillStyle = "#800000"),
            (0, e.roundedRect)(
              (0, e.cx)(169),
              (0, e.cy)(91),
              (0, e.cwh)(76),
              (0, e.cwh)(26),
              2 * e.Dpr,
              r,
            ),
            r.fill(),
            (r.lineWidth = 1 * e.Dpr),
            (r.strokeStyle = i),
            (r.fillStyle = i),
            (0, e.roundedRect)(
              (0, e.cx)(169),
              (0, e.cy)(91),
              (0, e.cwh)(76),
              (0, e.cwh)(24),
              2 * e.Dpr,
              r,
            ),
            r.fill(),
            (0, e.drawText)({
              self: t,
              bold: !0,
              size: 14,
              t: o,
              pos: [207, 104],
            }));
        })(t, i),
          (i.fillStyle = "rgba(255,255,255,0.2)"),
          i.fillRect(
            (0, e.cx)(155),
            (0, e.cy)(157),
            (0, e.cwh)(9),
            (0, e.cwh)(3),
          ),
          i.fillRect(
            (0, e.cx)(155),
            (0, e.cy)(162),
            (0, e.cwh)(9),
            (0, e.cwh)(3),
          ),
          i.fillRect(
            (0, e.cx)(248),
            (0, e.cy)(157),
            (0, e.cwh)(9),
            (0, e.cwh)(3),
          ),
          i.fillRect(
            (0, e.cx)(248),
            (0, e.cy)(162),
            (0, e.cwh)(9),
            (0, e.cwh)(3),
          ),
          (0, e.drawText)({
            self: t,
            size: 14,
            t: "history" == t.opt.type ? "历史最高分" : "本周最高分",
            pos: [207, 160],
          }),
          (0, e.drawText)({
            self: t,
            size: 86,
            special: !0,
            t: r.score,
            pos: [207, 244.5],
            color: "#00c777",
          }),
          (0, e.drawImageCenter)({
            self: t,
            src: "res/flower.png",
            pos: [207, 220, 260, 141],
            type: "bg",
            imgid: t.imgid.bg,
          }));
        var n = r.score >= o.REWARD_SCORE && o.CAN_USE_REWARD_CHALLENGE;
        d({
          self: t,
          posy: 305,
          score: r.score,
          type: "white",
        });
        var s = n ? 310 : 207;
        ((0, e.drawImageCenter)({
          self: t,
          src: "res/pure_share.png",
          pos: [s, 327.5, 18, 24],
          type: "bg",
          imgid: t.imgid.bg,
        }),
          (i.lineWidth = 2 * e.Dpr),
          (i.strokeStyle = "rgba(255,255,255,0.04)"),
          (i.fillStyle = "rgba(255,255,255,0.04)"));
        var a = 0;
        (0 != t.changlleList.length && (a = 77),
          i.fillRect(
            (0, e.cx)(30),
            (0, e.cy)(406 + a),
            (0, e.cwh)(354),
            (0, e.cwh)(46),
          ),
          (0, e.drawText)({
            self: t,
            size: 12,
            t: "查看全部排行",
            pos: [166, 428.5 + a],
            align: "left",
          }),
          (0, e.drawImageCenter)({
            self: t,
            src: "res/r_arr.png",
            pos: [247, 428.5 + a, 6.6, 10],
            type: "bg",
            imgid: t.imgid.bg,
          }));
      },
    }),
    t.changlleList.length > 0 && ((t.changlleListStart = 0), p(t, 0)),
    t.context.btn.clearRect(
      (0, e.cx)(91),
      (0, e.cy)(490),
      (0, e.cwh)(232),
      (0, e.cwh)(94),
    ),
    "skin" == t.opt.type
      ? ((t.sunGif = new n.default(0, -20, 8.998, 20, 20, "res/2d/sun.png")),
        t.sunGif.rotate(0.005),
        t.options.camera.add(t.sunGif.obj),
        (0, e.drawImageCenter)({
          self: t,
          src: r.bottle_skin_icon,
          pos: [207, 607, 80, 80],
          type: "btn",
          imgid: t.imgid.btn,
        }))
      : f(t),
    t.changlleList.length > 0 &&
      (0, e.drawText)({
        self: t,
        size: 14,
        t: "排th新超越" + t.changlleList.length + "位好友",
        pos: [207, 406],
        type: "btn",
        color: "rgba(255,255,255,0.8)",
      }),
    (0, e.updatePlane)({
      self: t,
      type: "bg",
    }));
}

function p(t, r) {
  if (
    (t.imgid.btn++,
    !(
      t.changlleListStart + 5 * r < 0 ||
      t.changlleListStart + 5 * r >= t.changlleList.length
    ))
  ) {
    t.changlleListStart = t.changlleListStart + 5 * r;
    var o = t.changlleList.slice(t.changlleListStart, t.changlleListStart + 5),
      i = o.length,
      n = 32,
      s = 207 - (32 * i + 10 * (i - 1)) / 2;
    t.context.btn.clearRect(
      (0, e.cx)(30),
      (0, e.cy)(421),
      (0, e.cwh)(354),
      (0, e.cwh)(55),
    );
    for (
      var a = function () {
          var r = s + 16 + 42 * l;
          (0, e.drawImageCenter)({
            self: t,
            round: !0,
            src: o[l].headimg,
            pos: [r, 443, n, n],
            type: "btn",
            cb: function () {
              (0, e.drawImageCenter)({
                self: t,
                src: "res/ava_rank.png",
                pos: [r, 443, 46, 46],
                type: "btn",
                imgid: t.imgid.btn,
              });
            },
            imgid: t.imgid.btn,
            noupdate: !0,
          });
        },
        l = 0;
      l < i;
      l++
    )
      a();
    (t.changlleList.length > 5 &&
      t.changlleListStart + 5 < t.changlleList.length &&
      (0, e.drawImageCenter)({
        self: t,
        src: "res/r_arr1.png",
        pos: [339, 443, 6, 8],
        type: "btn",
        imgid: t.imgid.btn,
      }),
      t.changlleList.length > 5 &&
        0 != t.changlleListStart &&
        (0, e.drawImageCenter)({
          self: t,
          src: "res/l_arr.png",
          pos: [69, 443, 6, 8],
          type: "btn",
          imgid: t.imgid.btn,
        }));
  }
}

function d(t) {
  if (!a.inQQ) {
    var r,
      i,
      n = t.self,
      s = t.posy,
      l = void 0 === s ? 218 : s,
      c = t.type,
      p = void 0 === c ? "green" : c;
    switch (
      (t.score >= o.REWARD_SCORE &&
        o.CAN_USE_REWARD_CHALLENGE &&
        (p = "rewards"),
      p)
    ) {
      case "rewards":
        ((r = 157.02), (i = 45));
        break;
      case "white":
        ((r = 130),
          (i = 45),
          (0, e.drawText)({
            self: n,
            size: 14,
            t: o.REWARD_CHALLENGE_TEXT,
            pos: [207, l + 70],
            color: "#FFFFFFCC",
          }));
        break;
      default:
        ((r = 136),
          (i = 45),
          (0, e.drawText)({
            self: n,
            size: 12,
            t: o.REWARD_CHALLENGE_TEXT,
            pos: [207, l + 40],
            color: "#FFFFFF99",
          }));
    }
    "green" !== p &&
      "white" !== p &&
      (0, e.drawImageCenter)({
        self: n,
        src: "res/btn_pk_".concat(p, ".png"),
        pos: [207, l + i / 2, r, i],
        type: "bg",
        imgid: n.imgid.bg,
      });
  }
}

function g(t, r, o, i) {
  ((i = i || 0),
    (0, e.drawText)({
      self: t,
      size: 14,
      t: "本次得分",
      pos: [207, 84 + i],
    }),
    (0, e.drawText)({
      self: t,
      size: 88,
      special: !0,
      t: r,
      pos: [212, 150 + i],
    }),
    (o.fillStyle = "rgba(255,255,255,0.2)"),
    o.fillRect((0, e.cx)(162), (0, e.cy)(78 + i), (0, e.cwh)(9), (0, e.cwh)(3)),
    o.fillRect((0, e.cx)(162), (0, e.cy)(84 + i), (0, e.cwh)(9), (0, e.cwh)(3)),
    o.fillRect((0, e.cx)(241), (0, e.cy)(78 + i), (0, e.cwh)(9), (0, e.cwh)(3)),
    o.fillRect(
      (0, e.cx)(241),
      (0, e.cy)(84 + i),
      (0, e.cwh)(9),
      (0, e.cwh)(3),
    ));
}

function f(t, r) {
  t.canvasType == e.CANVASTYPE.gameOver &&
    ((r = r || 607),
    (t.replayBtnPosy = r),
    (0, e.drawImageCenter)({
      self: t,
      src: "res/2d/new_home.png",
      pos: [76, r, 74, 74],
      type: "bg",
      imgid: t.imgid.bg,
    }),
    t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT),
    (0, e.drawImageCenter)({
      self: t,
      src: "res/replay.png",
      pos: [256, r, 212, 84],
      type: "btn",
      imgid: t.imgid.btn,
    }),
    console.log("draw home and replay succ"));
}

function y(t, r, i) {
  i >= o.REWARD_SCORE && o.CAN_USE_REWARD_CHALLENGE;
  (r.clearRect(0, 0, e.WIDTH, e.HEIGHT),
    (r.fillStyle = "rgba(0,0,0, 0.45)"),
    r.fillRect(0, 0, e.WIDTH, e.HEIGHT),
    (0, e.drawText)({
      self: t,
      t: "历史最高分：" + i,
      size: 14,
      pos: [207, 706],
    }));
}

},{"../../config":37,"../../lib/mue/eventcenter":67,"../../network/getAuth":72,"../../store/storage":128,"../../util/common":136,"../threePage":117,"./base":89,"./verify":102}],92:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawLookersPage = function(t) {
  var r = t.self;
  (0, e.routeCanvas)(r, "lookers"), (0, e.createPlane)(r);
  var i = r.context.bg;
  i.clearRect(0, 0, e.WIDTH, e.HEIGHT);
  var g = r.opt,
    s = g.score || 0,
    a = g.nickname || "";
  "in" == g.type ? ((0, e.drawImageCenter)({
    self: r,
    src: g.headimg,
    pos: [207, 91, 50, 50],
    type: "bg",
    cb: function() {
      (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/ava_square.png",
        pos: [207, 91, 53, 53],
        type: "bg",
        imgid: r.imgid.bg
      })
    },
    imgid: r.imgid.bg,
    noupdate: !0,
    round: !0
  }), (0, e.drawText)({
    self: r,
    t: a + " 正在游戏中",
    size: 17,
    pos: [207, 144],
    type: "bg",
    color: "black"
  })) : "gg" == g.type ? (i.fillStyle = "rgba(0,0,0, 0.4)", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawImageCenter)({
    self: r,
    src: g.headimg,
    pos: [207, 91, 50, 50],
    type: "bg",
    cb: function() {
      (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/ava_square.png",
        pos: [207, 91, 53, 53],
        type: "bg",
        imgid: r.imgid.bg
      })
    },
    imgid: r.imgid.bg,
    noupdate: !0,
    round: !0
  }), (0, e.drawText)({
    self: r,
    t: a + " 游戏已结束",
    size: 17,
    pos: [207, 144],
    type: "bg"
  }), (0, e.drawText)({
    self: r,
    t: "游戏得分",
    size: 14,
    pos: [207, 207],
    type: "bg"
  }), (0, e.drawText)({
    self: r,
    t: s,
    size: 80,
    pos: [212, 267],
    type: "bg",
    special: !0
  }), (0, e.drawLine)(157, 176, 257, 176, "rgba(255,255,255,0.5)", .5, i), i.fillStyle = "rgba(255,255,255,0.2)", i.fillRect((0, e.cx)(156), (0, e.cy)(203), (0, e.cwh)(9), (0, e.cwh)(3)), i.fillRect((0, e.cx)(156), (0, e.cy)(209), (0, e.cwh)(9), (0, e.cwh)(3)), i.fillRect((0, e.cx)(243), (0, e.cy)(203), (0, e.cwh)(9), (0, e.cwh)(3)), i.fillRect((0, e.cx)(243), (0, e.cy)(209), (0, e.cwh)(9), (0, e.cwh)(3))) : "out" == g.type ? (i.fillStyle = "rgba(0,0,0, 0.4)", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawImageCenter)({
    self: r,
    src: g.headimg,
    pos: [207, 221, 50, 50],
    type: "bg",
    cb: function() {
      (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/ava_square.png",
        pos: [207, 221, 53, 53],
        type: "bg",
        imgid: r.imgid.bg
      })
    },
    imgid: r.imgid.bg,
    noupdate: !0,
    round: !0
  }), (0, e.drawText)({
    self: r,
    t: a + " 游戏已结束",
    size: 17,
    pos: [207, 278],
    type: "bg"
  })) : "record" == g.type && (0, e.drawImageCenter)({
    self: r,
    src: g.headimg,
    pos: [71, 91, 42, 42],
    type: "bg",
    cb: function() {
      (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/ava_square.png",
        pos: [71, 91, 43, 43],
        type: "bg",
        imgid: r.imgid.bg
      })
    },
    imgid: r.imgid.bg,
    noupdate: !0,
    round: !0
  });
  "record" != g.type ? (0, e.drawImageCenter)({
    self: r,
    src: "res/btn_iplay.png",
    pos: [207, 663, 131, 54],
    type: "bg",
    imgid: r.imgid.bg
  }) : (0, e.drawImageCenter)({
    self: r,
    src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJBEN0IEbib1Cef1vsVKvSKGJkU5R4HlfLFrnficcs7hc7VlYRRu523WotJ9QselXVaHQ/0?wx_fmt=png",
    pos: [207, 665, 131, 64],
    type: "bg",
    imgid: r.imgid.bg
  });
  (0, e.updatePlane)({
    self: r,
    type: "bg"
  })
}, exports.lookersEve = function(e, t, r) {
  if (t > 130 && t < 280 && r > 650 && r < 720) return e.options.onLookersStart && e.options.onLookersStart(), !1
};
var e = require("./base");
},{"./base":89}],93:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawMsgBox = function(e) {
  (0, t.routeCanvas)(e, "msgBox"), (0, t.createPlane)(e),
  function(e) {
    e.imgid.bg++, e.imgid.btn++;
    var s = e.context.bg;
    s.clearRect(0, 0, t.WIDTH, t.HEIGHT), s.fillStyle = "rgba(0,0,0, 0.45)", s.fillRect(0, 0, t.WIDTH, t.HEIGHT), s.lineWidth = 2 * t.Dpr, s.strokeStyle = "rgba(255,255,255,0.06)", (0, t.drawText)({
      self: e,
      size: 22,
      t: "消息盒子",
      pos: [207, 89],
      bold: !0,
      type: "bg"
    }), (0, t.drawImageCenter)({
      self: e,
      src: "res/bl3.png",
      pos: [207, 372, 354, 492],
      type: "bg",
      imgid: e.imgid.bg,
      round: !0,
      radius: 2 * t.Dpr,
      cb: function() {
        0 == e.opt.msg_list.length && (0, t.drawText)({
          self: e,
          size: 17,
          t: "暂无消息",
          pos: [207, 318],
          type: "bg"
        }), (0, t.drawImageCenter)({
          self: e,
          src: "res/2d/new_return.png",
          pos: [54, 674, 70, 70],
          type: "bg",
          imgid: e.imgid.bg
        })
      }
    }), (0, t.updatePlane)({
      self: e,
      type: "bg"
    })
  }(e), (0, t.updateClip)({
    self: e
  }),
  function(e) {
    var l = e.opt.msg_list.length * (0, t.cwh)(90) / t.Dpr,
      o = (0, t.cwh)(482) / t.Dpr;
    e.scrollHandler = new s.default({
      innerOffsetHeight: l,
      outterOffsetHeight: o,
      updatePosition: e.updatePosition.bind(e)
    }), i(e, 0, "list1"), i(e, 10, "list2")
  }(e)
}, exports.drawMsgDetailType5 = function(e) {
  (0, t.routeCanvas)(e, "msgDetail5"), (0, t.createPlane)(e), e.imgid.bg++;
  var s = e.context.bg;
  s.clearRect(0, 0, t.WIDTH, t.HEIGHT), s.fillStyle = "rgba(0,0,0, 0.45)", s.fillRect(0, 0, t.WIDTH, t.HEIGHT), (0, t.drawImageCenter)({
    self: e,
    src: "res/bl3.png",
    pos: [207, 372, 354, 492],
    type: "bg",
    imgid: e.imgid.bg,
    round: !0,
    radius: 2 * t.Dpr,
    cb: function() {
      s.fillStyle = "#111619", s.fillRect((0, t.cx)(30), (0, t.cy)(126), (0, t.cwh)(354), (0, t.cwh)(160)), (0, t.drawText)({
        self: e,
        size: 20,
        t: "banner位置",
        pos: [207, 212],
        color: "rgba(255,255,255,0.2)"
      }), s.lineWidth = .5, (0, t.drawImageCenter)({
        self: e,
        src: e.opt.banner_icon || "aaa",
        pos: [207, 206, 354, 160],
        type: "bg",
        imgid: e.imgid.bg,
        round: !0
      }), (0, t.drawText)({
        self: e,
        size: 20,
        t: e.opt.title,
        pos: [60, 330],
        align: "left"
      });
      for (var i = e.opt.content.split("\\n"), l = 0, o = 0; o < i.length; o++) {
        for (var r = i[o].replace(/[^\x00-\xff]/g, "**").length, n = Math.ceil(r / 22 / 2), a = 0; a < n; a++) {
          var g = 364 + 28 * l;
          l++, (0, t.drawText)({
            self: e,
            size: 14,
            t: i[o].slice(22 * a, 22 * a + 22),
            pos: [60, g],
            align: "left",
            color: "#BEBEBE"
          })
        }
        0 == r && l++
      }(0, t.drawImageCenter)({
        self: e,
        src: "res/2d/new_return.png",
        pos: [54, 674, 70, 70],
        type: "bg",
        imgid: e.imgid.bg
      })
    }
  }), s.lineWidth = 2 * t.Dpr, s.strokeStyle = "rgba(255, 255, 255, 0.06)", (0, t.updatePlane)({
    self: e,
    type: "bg"
  })
}, exports.drawMsgDetailType5Eve = function(e, t, s) {
  if (t > 30 && t < 95 && s > 640 && s < 720) return e.opt.onReturn && e.opt.onReturn(), !1
}, exports.drawMsgList = i, exports.msgBoxEve = function(e, t, s, i) {
  if (t > 30 && t < 95 && s > 640 && s < 720) return e.opt.onReturn && e.opt.onReturn(), !1;
  if (t > 30 && t < 384 && s > 106 && s < 618) {
    var l = Math.floor((i - 136) / 90);
    return console.log(e.opt.msg_list[l]), e.opt.msg_list[l] && 2 == e.opt.msg_list[l].sub_type ? e.opt.onGoSkin && e.opt.onGoSkin() : e.opt.msg_list[l] && 1 == e.opt.msg_list[l].sub_type ? e.opt.onGoProfile && e.opt.onGoProfile(e.opt.msg_list[l]) : e.opt.msg_list[l] && 4 == e.opt.msg_list[l].sub_type ? e.opt.onGoMyProfile && e.opt.onGoMyProfile() : e.opt.msg_list[l] && 5 == e.opt.msg_list[l].sub_type && e.opt.onGoMsgDetail5 && e.opt.onGoMsgDetail5(e.opt.msg_list[l]), !1
  }
}, exports.updateMsgBox = function(e) {
  e.scrollHandler.setInnerHeight(e.opt.msg_list.length * (0, t.cwh)(90) / t.Dpr, e.lastScrollY), i(e, e.scrolloffset, e.scrolltype), e.pending = void 0, console.log("END finish")
};
var e, t = require("./base"),
  s = (e = require("../../scroll/scrollHandler")) && e.__esModule ? e : {
    default: e
  };
require("../../network/getAuth");

function i(e, s, i) {
  e.scrolloffset = s, e.scrolltype = i, "list1" == i ? e.imgid.list1++ : "list2" == i && e.imgid.list2++;
  var l = e.opt.msg_list.slice(s, s + 8),
    o = e.context[i];
  if (o.clearRect(0, 0, t.WIDTH, (0, t.cwh)(720)), 0 == s || 0 != l.length) {
    if (!(s < 0)) {
      for (var r = l.length, n = function() {
          a % 2 == 1 && (o.fillStyle = "rgba(255,255,255, 0.03)", o.fillRect(0, a * (0, t.cwh)(90), (0, t.cwh)(414), (0, t.cwh)(90))), g = new Date(1e3 * l[a].timestamp), p = g.getMonth() + 1 + "月" + g.getDate() + "日";
          var s = 90 * a;
          o.textAlign = "center", d = "res/2d/msg_default.png", l[a].icon && (d = l[a].icon), 1 == l[a].sub_type ? ((0, t.drawImageCenter)({
            round: !0,
            self: e,
            src: d,
            pos: [69, s + 34, 34, 34],
            type: i,
            cb: function() {
              (0, t.drawImageCenter)({
                self: e,
                src: "res/ava_rank.png",
                pos: [69, s + 34, 47, 47],
                type: i,
                imgid: e.imgid[i]
              })
            },
            imgid: e.imgid[i],
            noupdate: !0
          }), (0, t.drawText)({
            self: e,
            align: "left",
            size: 14,
            t: (0, t.cname)(l[a].title || "", 30),
            pos: [106, s + 23],
            type: i
          }), (0, t.drawText)({
            self: e,
            align: "left",
            size: 14,
            t: (0, t.cname)(l[a].content || "", 30),
            pos: [106, s + 45],
            type: i
          }), (0, t.drawText)({
            self: e,
            align: "left",
            size: 12,
            t: p,
            pos: [106, s + 67],
            type: i,
            color: "rgba(255,255,255,0.6)"
          }), (0, t.drawImageCenter)({
            self: e,
            src: "res/2d/zan.png",
            pos: [353, s + 35, 18, 25],
            type: i,
            imgid: e.imgid[i]
          })) : 5 == l[a].sub_type ? ((0, t.drawImageCenter)({
            self: e,
            src: d,
            pos: [69, s + 45, 34, 34],
            type: i,
            imgid: e.imgid[i]
          }), (0, t.drawText)({
            self: e,
            align: "left",
            size: 14,
            t: (0, t.cname)(l[a].title || "", 30),
            pos: [106, s + 34],
            type: i
          }), (0, t.drawText)({
            self: e,
            align: "left",
            size: 14,
            t: p,
            pos: [106, s + 56],
            type: i,
            color: "rgba(255,255,255,0.6)"
          })) : ((0, t.drawImageCenter)({
            self: e,
            src: d,
            pos: [69, s + 45, 34, 34],
            type: i,
            imgid: e.imgid[i]
          }), (0, t.drawText)({
            self: e,
            align: "left",
            size: 14,
            t: (0, t.cname)(l[a].content || "", 30),
            pos: [106, s + 34],
            type: i
          }), (0, t.drawText)({
            self: e,
            align: "left",
            size: 14,
            t: p,
            pos: [106, s + 56],
            type: i,
            color: "rgba(255,255,255,0.6)"
          }))
        }, a = 0; a < r; a++) {
        var g, p, d;
        n()
      }(0, t.updatePlane)({
        self: e,
        type: i
      })
    }
  } else(0, t.updatePlane)({
    self: e,
    type: i
  })
}
},{"../../network/getAuth":72,"../../scroll/scrollHandler":122,"./base":89}],94:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawPkList = g, exports.drawPkPage = function(e) {
  return a.apply(this, arguments)
}, exports.drawPkRulePage = function(e) {
  console.log("!!! drawPkRulePage", e);
  var t = e.self,
    s = t.opt;
  (0, r.routeCanvas)(t, "pkRule"), (0, r.createPlane)(t), (0, r.updateClip)({
    self: t
  });
  var i = t.context.bg;
  i.clearRect(0, 0, r.WIDTH, r.HEIGHT), i.fillStyle = "rgba(0,0,0, 0.8)", i.fillRect(0, 0, r.WIDTH, r.HEIGHT), i.fillStyle = "#3B3A3B", i.fillRect((0, r.cx)(31), (0, r.cy)(105), (0, r.cwh)(354), (0, r.cwh)(489)), i.lineWidth = 2 * r.Dpr, i.strokeStyle = "#fff", (0, r.roundedRect)((0, r.cx)(30), (0, r.cy)(104), (0, r.cwh)(354), (0, r.cwh)(489), 1 * r.Dpr, i), (0, r.drawText)({
    self: t,
    t: "擂台挑战赛",
    color: "rgba(255,255,255,1)",
    size: 19,
    pos: [207, 149.5],
    bold: !0
  });
  var n = o.default.getMy使用rInfo();
  return console.log("!!! my使用rInfo", n), (0, r.drawImageCenter)({
    self: t,
    src: n.headimg,
    pos: [207, 223, 56, 56],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, r.drawText)({
    self: t,
    t: "我的得分",
    color: "rgba(255,255,255,0.9)",
    size: 14,
    pos: [207, 277]
  }), (0, r.drawText)({
    self: t,
    t: (null == s ? void 0 : s.score) || 0,
    color: "rgba(255,255,255,0.9)",
    size: 56,
    pos: [207, 331],
    special: !0
  }), (0, r.drawText)({
    self: t,
    t: "你将以擂主身份，向朋友发起挑战",
    color: "rgba(255,255,255,0.9)",
    size: 16,
    pos: [207, 387]
  }), (0, r.drawText)({
    self: t,
    t: "挑战赛时长：".concat((null == s ? void 0 : s.duration) || 30, "分钟"),
    color: "rgba(255,255,255,0.9)",
    size: 14,
    pos: [197.5, 469.5]
  }), (0, r.drawImageCenter)({
    self: t,
    src: "res/r_arr.png",
    pos: [276, 469, 6.5, 12.5],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, r.drawImageCenter)({
    self: t,
    src: "res/btn_back.png",
    pos: [53.5, 630.5, 43, 43],
    type: "bg",
    imgid: t.imgid.bg
  }), void(0, r.updatePlane)({
    self: t,
    type: "bg"
  })
}, exports.pkEve = function(e, t, r) {
  return f.apply(this, arguments)
}, exports.pkRuleEve = function(e, t, r) {
  if (t > 131 && t < 281 && r > 503 && r < 551) return console.log("发起挑战"), e.options.onClick分享 && e.options.onClick分享(!0), !1;
  if (t > 32 && t < 75 && r > 609 && r < 652) return console.log("关闭挑战规则页"), e.options.onClosePkRule && e.options.onClosePkRule(), !1;
  if (t > 133 && t < 279 && r > 459 && r < 479) return console.log("设置挑战赛时间"), e.options.onClickSetPkDuration && e.options.onClickSetPkDuration(), !1
};
var e = require("../../../@babel/runtime/helpers/regeneratorRuntime"),
  t = require("../../../@babel/runtime/helpers/asyncToGenerator"),
  r = require("./base"),
  o = l(require("../../store/storage")),
  s = l(require("../../scroll/scrollHandler")),
  i = require("../../config"),
  n = l(require("../../lib/mue/eventcenter"));

function l(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

function a() {
  return (a = t(e().mark((function t(s) {
    var n, l, a, g, f, d, u, b, w, m, x, y;
    return e().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          return n = s.self, console.log("!!! drawPkPage", n.opt, n.options), (0, r.routeCanvas)(n, "pk"), (0, r.createPlane)(n), (0, r.updateClip)({
            self: n
          }), n.myidx = n.opt.pkListInfo.findIndex(p) + 1, n.my使用rInfo = n.opt.pkListInfo[n.myidx - 1] || o.default.getMy使用rInfo() || {
            headimg: "",
            nickname: "",
            week_best_score: 0,
            score_info: [{
              score: 0
            }]
          }, c({
            self: n,
            list: n.opt.pkListInfo
          }), (l = n.context.bg).clearRect(0, 0, r.WIDTH, r.HEIGHT), l.fillStyle = "rgba(0,0,0, 0.8)", l.fillRect(0, 0, r.WIDTH, r.HEIGHT), l.fillStyle = "rgb(250,250,250)", l.fillRect((0, r.cx)(31), (0, r.cy)(103), (0, r.cwh)(354), (0, r.cwh)(335)), l.lineWidth = 2 * r.Dpr, l.strokeStyle = "#fff", (0, r.roundedRect)((0, r.cx)(30), (0, r.cy)(102), (0, r.cwh)(354), (0, r.cwh)(530), 1 * r.Dpr, l), null == n.opt.gg_score ? ((0, r.drawImageCenter)({
            self: n,
            src: n.opt.organizerInfo.headimg,
            pos: [207, 158, 50, 50],
            type: "bg",
            imgid: n.imgid.bg
          }), (0, r.drawText)({
            self: n,
            t: n.opt.organizerInfo.nickname,
            color: "rgba(0,0,0,0.8)",
            size: 14,
            pos: [207, 195]
          }), (0, r.drawText)({
            self: n,
            t: "擂主得分",
            color: "rgba(0,0,0,0.8)",
            size: 14,
            pos: [207, 242]
          }), (0, r.drawLine)(160, 217, 254, 217, "rgba(0,0,0,0.06)", .5, l), l.fillStyle = "rgba(0,0,0,0.2)", l.fillRect((0, r.cx)(162), (0, r.cy)(239), (0, r.cwh)(9), (0, r.cwh)(3)), l.fillRect((0, r.cx)(162), (0, r.cy)(244), (0, r.cwh)(9), (0, r.cwh)(3)), l.fillRect((0, r.cx)(241), (0, r.cy)(239), (0, r.cwh)(9), (0, r.cwh)(3)), l.fillRect((0, r.cx)(241), (0, r.cy)(244), (0, r.cwh)(9), (0, r.cwh)(3)), (0, r.drawText)({
            self: n,
            t: n.opt.organizerInfo.score_info[0].score,
            color: "#000",
            size: 66,
            pos: [207, 298],
            special: !0
          })) : (n.opt.gg_score > n.opt.organizerInfo.score_info[0].score ? (a = "res/suc.png", g = "挑战成功", f = "rgba(0,0,0,1)", d = "rgba(0,0,0,0.3)", (0, r.drawImageCenter)({
            self: n,
            src: "res/flower_small.png",
            pos: [207, 175, 140, 53],
            type: "bg",
            imgis: n.imgid.bg
          })) : (a = "res/fail.png", g = "挑战失败", f = "rgba(0,0,0,0.3)", d = "rgba(0,0,0,1)"), (0, r.drawImageCenter)({
            self: n,
            src: a,
            pos: [207, 135, 20, 15],
            type: "bg",
            imgid: n.imgid.bg
          }), (0, r.drawText)({
            self: n,
            color: "#000",
            bold: !0,
            size: 30,
            t: g,
            pos: [207, 178]
          }), (0, r.drawImageCenter)({
            self: n,
            src: n.my使用rInfo.headimg,
            pos: [158, 289, 26, 26],
            type: "bg",
            imgid: n.imgid.bg
          }), (0, r.drawImageCenter)({
            self: n,
            src: n.opt.organizerInfo.headimg,
            pos: [260, 289, 26, 26],
            type: "bg",
            imgid: n.imgid.bg
          }), (0, r.drawText)({
            self: n,
            color: "rgba(0,0,0,0.8)",
            size: 11,
            t: (0, r.cname)(n.my使用rInfo.nickname),
            pos: [158, 318]
          }), (0, r.drawText)({
            self: n,
            color: "rgba(0,0,0,0.8)",
            size: 11,
            t: (0, r.cname)(n.opt.organizerInfo.nickname),
            pos: [260, 318]
          }), n.opt.gg_score > 999 ? (0, r.drawText)({
            self: n,
            color: f,
            size: 44,
            special: !0,
            t: n.opt.gg_score,
            align: "right",
            pos: [190, 253]
          }) : (0, r.drawText)({
            self: n,
            color: f,
            size: 44,
            special: !0,
            t: n.opt.gg_score,
            align: "center",
            pos: [158, 253]
          }), l.fillStyle = "rgba(0,0,0,0.3)", l.fillRect((0, r.cx)(202), (0, r.cy)(242), (0, r.cwh)(10), (0, r.cwh)(4)), n.opt.organizerInfo.score_info[0].score > 999 ? (0, r.drawText)({
            self: n,
            color: d,
            size: 44,
            special: !0,
            t: n.opt.organizerInfo.score_info[0].score,
            align: "left",
            pos: [231, 253]
          }) : (0, r.drawText)({
            self: n,
            color: d,
            size: 44,
            special: !0,
            t: n.opt.organizerInfo.score_info[0].score,
            pos: [260, 253]
          })), (0, r.drawLine)(30, 437, 384, 437, "rgba(0,0,0,0.06)", .5, l), n.opt.organizerInfo.left_time <= 0 ? ((0, r.drawImageCenter)({
            self: n,
            src: "res/btn_bg_h.png",
            pos: [207, 368, 130, 63],
            type: "bg",
            cb: function() {
              (0, r.drawText)({
                self: n,
                size: 14,
                color: "rgba(0,0,0,0.3)",
                t: "挑战结束",
                pos: [207, 368]
              }), (0, r.updatePlane)({
                self: n,
                type: "bg"
              })
            },
            imgid: n.imgid.bg
          }), (0, r.drawText)({
            self: n,
            size: 14,
            color: "#888",
            t: "已失效",
            pos: [207, 403.5]
          })) : 0 == n.opt.organizerInfo.is_self ? (u = "挑战", n.myidx > 0 && (u = "再次挑战"), (0, r.drawImageCenter)({
            self: n,
            src: "res/btn_bg_g.png",
            pos: [207, 368, 130, 63],
            type: "bg",
            cb: function() {
              (0, r.drawText)({
                self: n,
                size: 14,
                t: u,
                pos: [207, 368]
              }), (0, r.updatePlane)({
                self: n,
                type: "bg"
              })
            },
            imgid: n.imgid.bg
          }), (0, r.drawText)({
            self: n,
            size: 12,
            align: "right",
            color: "#000",
            t: "有效时间至",
            pos: [223, 403.5]
          }), b = +new Date, w = b + 1e3 * n.opt.organizerInfo.left_time, b = new Date(w), m = (m = b.getHours()) < 10 ? "0" + m : m, x = (x = b.getMinutes()) < 10 ? "0" + x : x, (0, r.drawText)({
            self: n,
            size: 12,
            align: "left",
            color: "#fc4814",
            t: m + ":" + x,
            pos: [225, 403.5]
          })) : 1 == n.opt.organizerInfo.is_self && ((0, r.drawImageCenter)({
            self: n,
            src: "res/btn_bg_g.png",
            pos: [207, 368, 130, 63],
            type: "bg",
            cb: function() {
              (0, r.drawText)({
                self: n,
                size: 14,
                t: "分享",
                pos: [207, 368]
              }), (0, r.updatePlane)({
                self: n,
                type: "bg"
              })
            },
            imgid: n.imgid.bg
          }), (0, r.drawText)({
            self: n,
            size: 14,
            align: "right",
            color: "#000",
            t: "有效时间至",
            pos: [223, 403.5]
          }), b = +new Date, w = b + 1e3 * n.opt.organizerInfo.left_time, b = new Date(w), m = (m = b.getHours()) < 10 ? "0" + m : m, x = (x = b.getMinutes()) < 10 ? "0" + x : x, (0, r.drawText)({
            self: n,
            size: 14,
            align: "left",
            color: "#fc4814",
            t: m + ":" + x,
            pos: [225, 403.5]
          })), e.next = 22, (0, i.getSetting)();
        case 22:
          return y = e.sent, 1 === n.opt.organizerInfo.is_self || n.opt.pkListInfo && n.opt.pkListInfo.some((function(e) {
            return 1 === e.is_self
          })) ? (console.log("!!! drawPkPage setting.subscriptionsSetting", y.subscriptionsSetting), wx.getStorageSync(n.model.getPkId()) && wx.getStorageSync(n.model.getPkId()) !== i.SUBSCRIPTION_SETTING_TYPE.REJECT || 1 !== n.opt.organizerInfo.is_self ? (0, r.drawText)({
            self: n,
            size: 17,
            t: "回到首页",
            pos: [207, 688]
          }) : ((0, r.drawImageCenter)({
            self: n,
            src: "res/ring.png",
            pos: [94, 688, 20, 20],
            type: "bg",
            imgid: n.imgid.bg
          }), (0, r.drawText)({
            self: n,
            size: 17,
            t: "被超过时提醒我",
            pos: [167.5, 688]
          }), (0, r.drawLine)(244, 680, 244, 694, "rgba(255,255,255,1)", .5, l), (0, r.drawText)({
            self: n,
            size: 17,
            t: "回到首页",
            pos: [295, 688]
          }))) : ((0, r.drawText)({
            self: n,
            size: 17,
            t: "不挑战，直接开始",
            pos: [199, 688]
          }), (0, r.drawImageCenter)({
            self: n,
            src: "res/r_arr.png",
            pos: [280, 688, 6.5, 12.5],
            type: "bg",
            imgid: n.imgid.bg
          })), (0, r.updatePlane)({
            self: n,
            type: "bg"
          }), e.abrupt("return");
        case 26:
        case "end":
          return e.stop()
      }
    }), t)
  })))).apply(this, arguments)
}

function c(e) {
  var t = e.self;
  e.list;
  t.sotedRankList = e.list;
  var o = t.sotedRankList.length * (0, r.cwh)(r.ListLineHeight) / r.Dpr,
    i = (0, r.cwh)(194) / r.Dpr;
  t.scrollHandler = new s.default({
    innerOffsetHeight: o,
    outterOffsetHeight: i,
    updatePosition: t.updatePosition.bind(t)
  }), g(t, 0, "list1")
}

function g(e, t, o) {
  "list1" == o ? e.imgid.list1++ : "list2" == o && e.imgid.list2++;
  var s = e.sotedRankList.slice(t, t + 12),
    i = e.context[o];
  if (i.clearRect(0, 0, r.WIDTH, 12 * (0, r.cwh)(r.ListLineHeight)), i.fillStyle = "white", i.textBaseline = "middle", i.fillRect(0, 0, r.WIDTH, 12 * (0, r.cwh)(r.ListLineHeight)), 0 == t || 0 != s.length) {
    if (!(t < 0)) {
      for (var n = s.length, l = function() {
          var i = (a + .5) * r.ListLineHeight,
            n = a + 1 + t,
            l = "";
          l = 1 == n ? "rgb(250,126,0)" : 2 == n ? "rgb(254,193,30)" : 3 == n ? "rgb(251,212,19)" : "#aaa", (0, r.drawText)({
            self: e,
            bold: !0,
            italic: !0,
            size: 17,
            t: n,
            pos: [58.5, i],
            type: o,
            color: l
          });
          s[a].grade;
          (0, r.drawImageCenter)({
            self: e,
            src: s[a].headimg,
            pos: [107, i, 34, 34],
            type: o,
            cb: function() {
              (0, r.drawImageCenter)({
                self: e,
                src: "res/2d/ava_square.png",
                pos: [107, i, 37, 37],
                type: o,
                imgid: e.imgid[o]
              })
            },
            round: !0,
            imgid: e.imgid[o],
            noupdate: !0
          }), (0, r.drawText)({
            self: e,
            align: "left",
            color: "#000",
            size: 17,
            bold: !0,
            t: (0, r.cname)(s[a].nickname, 14),
            pos: [144, i - 10],
            type: o
          }), s[a].score_info[0].score > e.opt.organizerInfo.score_info[0].score ? (0, r.drawText)({
            self: e,
            color: "#FC4814",
            size: 12,
            t: "挑战成功",
            pos: [144, i + 12],
            type: o,
            align: "left"
          }) : (0, r.drawText)({
            self: e,
            color: "#888",
            size: 12,
            t: "挑战失败",
            pos: [144, i + 12],
            type: o,
            align: "left"
          }), (0, r.drawText)({
            self: e,
            color: "#888",
            size: 22,
            special: !0,
            t: s[a].score_info[0].score || 0,
            pos: [364, i],
            type: o,
            align: "right"
          })
        }, a = 0; a < n; a++) l();
      0 == n && (0, r.drawText)({
        self: e,
        color: "#ccc",
        size: 14,
        t: "暂无人应战",
        pos: [207, 100],
        type: o
      }), (0, r.updatePlane)({
        self: e,
        type: o
      })
    }
  } else(0, r.updatePlane)({
    self: e,
    type: o
  })
}

function p(e, t, r) {
  return 1 === e.is_self
}

function f() {
  return (f = t(e().mark((function t(r, o, s) {
    return e().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          return console.log("!!! pkEve", r, r.opt, r.options, o, s), e.next = 3, (0, i.getSetting)();
        case 3:
          if (e.sent, !(1 === r.opt.organizerInfo.is_self || r.opt.pkListInfo && r.opt.pkListInfo.some((function(e) {
              return 1 === e.is_self
            })))) {
            e.next = 22;
            break
          }
          if (!(wx.getStorageSync(r.model.getPkId()) && wx.getStorageSync(r.model.getPkId()) !== i.SUBSCRIPTION_SETTING_TYPE.REJECT || 1 !== r.opt.organizerInfo.is_self)) {
            e.next = 12;
            break
          }
          if (!(o > 173 && o < 241 && s > 650 && s < 730)) {
            e.next = 10;
            break
          }
          return console.log("回到首页"), n.default.emitSync(i.EVENT.GOSTARTPAGE, {}), e.abrupt("return", !1);
        case 10:
          e.next = 20;
          break;
        case 12:
          if (!(o > 77 && o < 220 && s > 650 && s < 730)) {
            e.next = 16;
            break
          }
          return console.log("被超过时提醒我"), r.options.onSubscribePk && r.options.onSubscribePk(), e.abrupt("return", !1);
        case 16:
          if (!(o > 261 && o < 329 && s > 650 && s < 730)) {
            e.next = 20;
            break
          }
          return console.log("回到首页"), n.default.emitSync(i.EVENT.GOSTARTPAGE, {}), e.abrupt("return", !1);
        case 20:
          e.next = 26;
          break;
        case 22:
          if (!(o > 110 && o < 310 && s > 650 && s < 730)) {
            e.next = 26;
            break
          }
          return console.log("不挑战 直接开始"), r.options.onBattlePlay && r.options.onBattlePlay(""), e.abrupt("return", !1);
        case 26:
          if (!(o > 140 && o < 280 && s > 325 && s < 405 && r.opt.organizerInfo.left_time > 0)) {
            e.next = 37;
            break
          }
          if (0 != r.opt.organizerInfo.is_self) {
            e.next = 33;
            break
          }
          return console.log("挑战/再次挑战"), r.options.onBattlePlay && r.options.onBattlePlay("pk"), e.abrupt("return", !1);
        case 33:
          if (1 != r.opt.organizerInfo.is_self) {
            e.next = 37;
            break
          }
          return console.log("分享"), r.options.onClick分享 && r.options.onClick分享(!1), e.abrupt("return", !1);
        case 37:
        case "end":
          return e.stop()
      }
    }), t)
  })))).apply(this, arguments)
}
},{"../../../@babel/runtime/helpers/asyncToGenerator":6,"../../../@babel/runtime/helpers/regeneratorRuntime":22,"../../config":37,"../../lib/mue/eventcenter":67,"../../scroll/scrollHandler":122,"../../store/storage":128,"./base":89}],95:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawProfile = function(t) {
  t.imgid.bg++, t.imgid.btn++, t.imgid.list1++, t.imgid.list2++, t.showDialog = !1, (0, e.routeCanvas)(t, "profile"), (0, e.createPlane)(t);
  var i = t.context.bg;
  i.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "rgba(0,0,0, 0.45)", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT);
  var s = t.opt,
    n = 430,
    a = 0;
  s.is_self && (n = 520, a = -30);
  i.strokeStyle = "rgba(255, 255, 255, 0.06)", (0, e.drawImageCenter)({
    round: !0,
    radius: 2 * e.Dpr,
    self: t,
    src: "res/bl3.png",
    pos: [207, 123 + n / 2 + a, 354, n],
    type: "bg",
    imgid: t.imgid.bg,
    cb: function() {
      i.strokeStyle = "rgba(255,255,255,0.1)", (0, e.roundedRect)((0, e.cx)(30), (0, e.cy)(123 + a), (0, e.cwh)(354), (0, e.cwh)(n), 2 * e.Dpr, i), (0, e.drawText)({
        self: t,
        t: "本周最高分",
        size: 14,
        pos: [186, 160 + a],
        type: "bg"
      }), (0, e.drawText)({
        self: t,
        t: s.week_best_score || 0,
        size: 28,
        pos: [186, 191 + a],
        type: "bg",
        special: !0
      }), (0, e.drawText)({
        self: t,
        t: "历史最高分",
        size: 14,
        pos: [307, 160 + a],
        type: "bg"
      }), (0, e.drawText)({
        self: t,
        t: s.highest_score || 0,
        size: 28,
        pos: [307, 191 + a],
        type: "bg",
        special: !0
      }), (0, e.drawLine)(30, 233 + a, 384, 233 + a, "rgba(255,255,255,0.1)", .5, i), (0, e.drawText)({
        self: t,
        t: "本周精彩回放",
        size: 12,
        pos: [87, 272 + a],
        type: "bg"
      }), (0, e.drawImageCenter)({
        self: t,
        round: !0,
        src: s.playback_poster || "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJHSzlW8rkRicx6ppKtmCKMC9a5Qmdm5l19UJguw969rjWV43K3OECytHQ07XPsscjKw/0?wx_fmt=png",
        pos: [207, 362.5 + a, 314, 141],
        type: "bg",
        imgid: t.imgid.bg,
        radius: 2 * e.Dpr,
        cb: function() {
          i.fillStyle = "rgba(0,0,0, 0.4)", (0, e.roundedRect)((0, e.cx)(50), (0, e.cy)(292 + a), (0, e.cwh)(314), (0, e.cwh)(141), 2 * e.Dpr, i), i.fill(), 0 == s.week_best_score ? (0, e.drawText)({
            self: t,
            t: "暂无回放",
            size: 17,
            pos: [207, 362.5 + a],
            type: "bg"
          }) : (0, e.drawImageCenter)({
            self: t,
            src: "res/2d/record.png",
            pos: [207, 362.5 + a, 40, 40],
            type: "bg",
            imgid: t.imgid.bg
          })
        }
      }), console.log(s.praise_info), r(t), (0, e.drawImageCenter)({
        self: t,
        round: !0,
        src: s.headimg,
        pos: [80, 173 + a, 60, 60],
        type: "bg",
        cb: function() {
          (0, e.drawImageCenter)({
            self: t,
            src: "res/2d/ava_square.png",
            pos: [80, 173 + a, 61, 61],
            type: "bg",
            imgid: t.imgid.bg
          })
        },
        imgid: t.imgid.bg,
        noupdate: !0
      }), (0, e.drawImageCenter)({
        self: t,
        src: "res/2d/new_return.png",
        pos: [54, 674, 70, 70],
        type: "bg",
        imgid: t.imgid.bg
      }), s.is_self || (0, e.drawImageCenter)({
        self: t,
        src: "res/2d/target.png",
        pos: [354, 499, 32, 32],
        type: "btn",
        imgid: t.imgid.btn
      });
      var o = 0;
      s.is_self && (o = -57), i.fillStyle = "rgba(255,255,255,0.1)", i.strokeStyle = "rgba(255,255,255,0.1)", i.fillRect((0, e.cx)(50), (0, e.cy)(485 + o), (0, e.cwh)(314), (0, e.cwh)(28)), i.fill();
      for (var p = 314 / s.praise_info.reward_count, g = 0; g < s.praise_info.reward_count - 1; g++)(0, e.drawLine)(82 + p * g, 485 + o, 82 + p * g, 513 + o, "rgba(255,255,255,0.1)", .5, i)
    }
  }), (0, e.updatePlane)({
    self: t,
    type: "bg"
  })
}, exports.drawProfileUpdate = r, exports.profileEve = function(r, t, i) {
  if (t > 30 && t < 95 && i > 640 && i < 720) return "friendRank" == r.routesArr[r.routesArr.length - 2] && (r.setScroll = !0), (0, e.back)(r), r.opt.onReturn && r.opt.onReturn(), !1;
  if (r.opt.week_best_score > 0 && t > 50 && t < 350 && i > 290 && i < 430) return r.opt.onRecord && r.opt.onRecord(r.routesArr), !1;
  if (t > 310 && t < 390 && i > 640 && i < 700) return r.opt.onLike && r.opt.onLike(r.routesArr), !1;
  if (!r.opt.is_self && t > 330 && t < 380 && i > 476 && i < 516) return function(r) {
    var t = r.context.btn;
    if (r.timer) return;
    (0, e.drawImageCenter)({
      self: r,
      src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJFHiaWIxfyWrESuKDicrZJNaicFibAB2deJFicf7ahrv9LzA5gf90icrPhLk45Pw2dDNA12Q/0?wx_fmt=png",
      pos: [320, 446.5, 150, 69],
      type: "btn",
      imgid: r.imgid.btn,
      cb: function() {
        r.showDialog = !0, (0, e.drawText)({
          self: r,
          t: "在游戏中使用本道具可",
          size: 12,
          pos: [260, 432],
          type: "btn",
          align: "left",
          color: "#000"
        }), (0, e.drawText)({
          self: r,
          t: "自动完成1次完美跳跃",
          size: 12,
          pos: [260, 448],
          type: "btn",
          align: "left",
          color: "#000"
        }), r.timer = setTimeout((function() {
          r.timer = null, r.canvasType == e.CANVASTYPE.profile && (t.clearRect((0, e.cx)(245), (0, e.cy)(415), (0, e.cwh)(150), (0, e.cwh)(66)), (0, e.updatePlane)({
            self: r,
            type: "btn"
          }))
        }), 2e3)
      }
    })
  }(r), !1
};
var e = require("./base");

function r(r) {
  var t = r.context.btn,
    i = r.opt;
  console.log("profile data", i), i.is_self && t.clearRect((0, e.cx)(35), (0, e.cy)(485), (0, e.cwh)(345), (0, e.cwh)(125));
  var s = 0;
  if (i.is_self && (s = -57), i.praise_info.praise_count > 0) {
    var n = 314 / i.praise_info.reward_count,
      a = r.context.bg;
    a.fillStyle = "#FFD240", a.strokeStyle = "rgba(255,255,255,0.1)", (0, e.roundedRect)((0, e.cx)(50), (0, e.cy)(485 + s), (0, e.cwh)(n * i.praise_info.praise_count), (0, e.cwh)(28), (0, e.cwh)(.5), a);
    for (var o = 0; o < i.praise_info.praise_count; o++)(0, e.drawImageCenter)({
      self: r,
      src: "res/2d/shade.png",
      pos: [52 + o * n + .5 * n, 497 + s, n, 28],
      type: "bg",
      imgid: r.imgid.bg
    });
    a.fill()
  }
  if (i.is_self) {
    if ((0, e.drawLine)(30, 480, 384, 480, "rgba(255,255,255,0.1)", .5, t), (0, e.drawLine)(30, 541, 384, 541, "rgba(255,255,255,0.1)", .5, t), i.praise_info.total_praise_count > 0) {
      (0, e.drawText)({
        self: r,
        t: "共 " + i.praise_info.total_praise_count + " 个赞",
        size: 14,
        pos: [364, 511],
        align: "right",
        type: "btn"
      });
      var p = i.praise_info.headimg_list;
      (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/profile_zan_icon.png",
        pos: [54, 511, 16, 24],
        type: "btn",
        imgid: r.imgid.btn
      });
      var g = p.length;
      g > 6 && (g = 5, (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/profile_zan.png",
        pos: [258, 511, 24, 24],
        type: "btn",
        imgid: r.imgid.btn
      }));
      for (var l = function(t) {
          (0, e.drawImageCenter)({
            self: r,
            round: !0,
            src: p[t],
            pos: [88 + 34 * t, 511, 23, 23],
            type: "btn",
            cb: function() {
              (0, e.drawImageCenter)({
                self: r,
                src: "res/2d/ava_square.png",
                pos: [88 + 34 * t, 511, 24, 24],
                type: "btn",
                imgid: r.imgid.btn
              })
            },
            imgid: r.imgid.btn,
            noupdate: !0
          })
        }, c = 0; c < g; c++) l(c)
    } else(0, e.drawText)({
      self: r,
      t: "暂无人点赞",
      size: 14,
      pos: [207, 511],
      type: "btn",
      color: "rgba(255,255,255,0.6)"
    });
    var d = i.propsData.property_list || [];
    if (0 == d.length)(0, e.drawText)({
      self: r,
      t: "暂无道具",
      size: 14,
      pos: [207, 577],
      type: "btn",
      color: "rgba(255,255,255,0.6)"
    });
    else {
      (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/profile_prop_icon.png",
        pos: [54, 576, 16, 24],
        type: "btn",
        imgid: r.imgid.btn
      }), (g = d.length) > 6 && (g = 5, (0, e.drawImageCenter)({
        self: r,
        src: "res/2d/profile_prop.png",
        pos: [258, 576, 24, 24],
        type: "btn",
        imgid: r.imgid.btn
      }));
      for (var f = 0; f < g; f++)(0, e.drawImageCenter)({
        self: r,
        src: "res/2d/target.png",
        pos: [88 + 34 * f, 576, 24, 24],
        type: "btn",
        imgid: r.imgid.btn
      });
      (0, e.drawText)({
        self: r,
        t: "共 " + d.length + " 个道具",
        size: 14,
        pos: [364, 576],
        type: "btn",
        align: "right"
      })
    }
  } else t.clearRect((0, e.cx)(48), (0, e.cy)(455), (0, e.cwh)(100), (0, e.cwh)(20)), (0, e.drawText)({
    self: r,
    t: "还差" + (i.praise_info.reward_count - i.praise_info.praise_count) + "个好友的赞",
    size: 12,
    pos: [50, 465],
    type: "btn",
    align: "left"
  });
  var b = "res/2d/like.png";
  i.praise_info.is_already_praise && (b = "res/2d/like1.png"), (0, e.drawImageCenter)({
    self: r,
    src: b,
    pos: [354, 671, 82, 76],
    type: "btn",
    imgid: r.imgid.btn
  })
}
},{"./base":89}],96:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawFriendRankList = function(n) {
  var r = n.self,
    i = r.last2CanvasType;
  (0, e.routeCanvas)(r, "friendRank"), r.lastCanvasType == e.CANVASTYPE.record && (r.lastCanvasType = i);
  r.my使用rInfo = t.default.getMy使用rInfo() || {}, r.my使用rInfo.week_best_score = r.opt.week_best_score || 0, l(r)
}, exports.drawGroupRankList = function(t, n, r) {
  (0, e.routeCanvas)(t, "groupRank"), t.my使用rInfo = r || {
      headimg: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJBaI5ibAEtVLsv4KfFrRhad6VWuvvibKOkib8ibibWxsOFXWEUlhp3fo0NAwticZFicevpx1A/0?wx_fmt=png",
      nickname: "",
      week_best_score: 0,
      grade: 1
    },
    function(t, n, r) {
      (0, e.createPlane)(t), (0, e.updateClip)({
        self: t
      }), d({
        self: t
      }), r ? (f({
        self: t
      }), c({
        self: t,
        list: n
      })) : (0, s.getAuthWxFriendInteraction)().then((function() {
        f({
          self: t
        }), c({
          self: t,
          list: n
        })
      })).catch((function() {
        ! function(t) {
          (0, e.drawImageCenter)({
            self: t,
            src: "res/auth/rank_tip.png",
            pos: [205, 305, 254, 24],
            type: "bg",
            imgid: t.imgid.bg
          }), (0, e.drawImageCenter)({
            self: t,
            src: "res/auth/refresh.png",
            pos: [205, 340, 45, 18],
            type: "bg",
            imgid: t.imgid.bg
          })
        }()
      }))
    }(t, n)
}, exports.drawRankList = p, exports.friendRankEve = function(t, n, r, i) {
  if (console.log(n, r), n > 230 && n < 340 && r > 640 && r < 720) {
    if (o.inQQ) return;
    return t.options.onGroup分享 && t.options.onGroup分享(), !1
  }
  if (n > 30 && n < 95 && r > 640 && r < 720) return (0, e.back)(t), t.options.friendRankReturn && t.options.friendRankReturn(""), !1;
  if (n > 30 && n < 379 && r > 140 && r < 518 && t.sotedRankList && s.scope.WxFriendInteraction) {
    var a = Math.round((i - 171) / e.ListLineHeight);
    return t.opt.onProfile && t.sotedRankList[a] && t.opt.onProfile({
      user_data: t.sotedRankList[a],
      scene: "位好友",
      routesArr: t.routesArr
    }), !1
  }
  if (n > 30 && n < 379 && r > 528 && r < 618 && t.sotedRankList && s.scope.WxFriendInteraction) return t.opt.onProfile && t.sotedRankList[t.myidx - 1] && t.opt.onProfile({
    user_data: t.sotedRankList[t.myidx - 1],
    scene: "位好友",
    routesArr: t.routesArr
  }), !1;
  n > 80 && n < 320 && r > 300 && r < 360 && !s.scope.WxFriendInteraction && (0, s.getAuthWxFriendInteraction)(!1).then((function() {
    l(t, !0)
  }))
}, exports.groupRankEve = function(t, n, o) {
  if (n > 260 && n < 390 && o > 640 && o < 720) return (0, e.hide)(t), t.options.groupPlayGame && t.options.groupPlayGame(), !1;
  if (n > 30 && n < 110 && o > 640 && o < 720) return r.default.emitSync(i.EVENT.GOSTARTPAGE, {}), !1;
  n > 80 && n < 320 && o > 300 && o < 360 && !s.scope.WxFriendInteraction && console.log("点击刷新")
};
var e = require("./base"),
  t = a(require("../../store/storage")),
  n = a(require("../../scroll/scrollHandler")),
  r = a(require("../../lib/mue/eventcenter")),
  i = require("../../config"),
  s = require("../../network/getAuth"),
  o = require("../../util/common");

function a(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

function l(n, r) {
  (0, e.createPlane)(n), (0, e.updateClip)({
    self: n
  }), d({
    self: n
  }), f({
    self: n
  }), c({
    self: n,
    list: t.default.getFriends本次得分()
  })
}

function d(t) {
  var n = t.self;
  n.imgid.bg++, n.imgid.btn++;
  var r = n.context.btn;
  r.clearRect(0, 0, e.WIDTH, e.HEIGHT), r.lineWidth = 1 * e.Dpr, r.strokeStyle = "rgba(255,255,255,0.1)", (0, e.roundedRect)((0, e.cx)(30), (0, e.cy)(126), (0, e.cwh)(354), (0, e.cwh)(392), 2 * e.Dpr, r);
  var i = n.context.bg;
  i.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "rgba(0,0,0, 0.45)", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawText)({
    self: n,
    size: 22,
    t: n.canvasType == e.CANVASTYPE.group第? "群排行榜" : "好友排行榜",
    pos: [207, 89],
    bold: !0,
    type: "btn"
  }), (0, e.updatePlane)({
    self: n,
    type: "bg"
  }), (0, e.drawImageCenter)({
    round: !0,
    radius: 2 * e.Dpr,
    self: n,
    src: "res/bl3.png",
    pos: [207, 322, 354, 392],
    type: "bg",
    imgid: n.imgid.bg,
    cb: function() {
      (0, e.drawText)({
        self: n,
        size: 12,
        t: "每周1凌晨刷新",
        pos: [54, 141],
        type: "btn",
        color: "rgba(255,255,255,0.6)",
        align: "left"
      }), r.strokeStyle = "rgba(255,255,255,0.06)"
    }
  }), n.canvasType == e.CANVASTYPE.friend第? o.inQQ || (0, e.drawImageCenter)({
    self: n,
    src: "res/2d/see_group.png",
    pos: [304, 674, 176, 75],
    type: "btn",
    imgid: n.imgid.btn
  }) : (0, e.drawImageCenter)({
    self: n,
    src: "res/2d/iplay.png",
    pos: [327, 670, 130, 75],
    type: "btn",
    imgid: n.imgid.btn,
    cb: function() {
      (0, e.drawText)({
        self: n,
        size: 17,
        t: "我也要玩",
        color: "#222",
        pos: [327, 670],
        type: "btn"
      }), (0, e.updatePlane)({
        self: n,
        type: "btn"
      })
    }
  }), (0, e.drawImageCenter)({
    self: n,
    src: "res/2d/new_return.png",
    pos: [54, 674, 70, 70],
    type: "btn",
    imgid: n.imgid.btn
  })
}

function f(t) {
  var n = t.self;
  (0, e.drawImageCenter)({
    round: !0,
    self: n,
    src: "res/bl3.png",
    pos: [207, 573, 354, 90],
    type: "btn",
    imgid: n.imgid.btn,
    radius: 2 * e.Dpr,
    cb: function() {
      void 0 === n.myidx || (0, e.drawText)({
        self: n,
        size: 17,
        italic: !0,
        bold: !0,
        t: n.myidx,
        pos: [64, 574],
        type: "btn"
      }), (0, e.drawImageCenter)({
        round: !0,
        self: n,
        src: n.my使用rInfo.headimg,
        pos: [107, 573, 34, 34],
        type: "btn",
        cb: function() {
          (0, e.drawImageCenter)({
            self: n,
            src: "res/ava_rank.png",
            pos: [107, 573, 36, 36],
            type: "btn",
            imgid: n.imgid.btn
          })
        },
        imgid: n.imgid.btn,
        noupdate: !0
      }), (0, e.drawText)({
        self: n,
        align: "left",
        size: 17,
        t: (0, e.cname)(n.my使用rInfo.nickname, 16),
        pos: [144, 573],
        type: "btn"
      }), (0, e.drawText)({
        self: n,
        align: "right",
        size: 22,
        special: !0,
        t: n.my使用rInfo.week_best_score || 0,
        pos: [339, 575],
        type: "btn"
      }), n.my使用rInfo.bottle_skin && (0, e.drawImageCenter)({
        self: n,
        src: n.my使用rInfo.bottle_skin,
        pos: [362, 571, 15, 30],
        type: "btn",
        imgid: n.imgid.btn
      }), (0, e.updatePlane)({
        self: n,
        type: "btn"
      })
    }
  })
}

function c(t) {
  var r = t.self,
    i = t.list,
    s = [];
  r.my使用rInfo = r.my使用rInfo || {
    headimg: "",
    nickname: "",
    week_best_score: 0,
    score_info: [{
      score: 0
    }]
  }, r.my使用rInfo.is_self = !0, (i = i || []).push(r.my使用rInfo), s = (0, e.rerank)(i), r.sotedRankList = s;
  var o, a = r.sotedRankList.length * (0, e.cwh)(e.ListLineHeight) / e.Dpr;
  r.myidx = s.findIndex(e.findSelfIndex.bind(r)) + 1, o = (0, e.cwh)(361) / e.Dpr;
  var l = 0,
    d = 0,
    f = 0;
  console.log(r.routesArr, r.lastScrollY), r.setScroll && (l = r.lastScrollY || 0, d = r.lastOffset1 || 0, f = r.lastOffset2 || 0), r.setScroll = !1, r.scrollHandler = new n.default({
    innerOffsetHeight: a,
    outterOffsetHeight: o,
    updatePosition: r.updatePosition.bind(r),
    position: l
  }), p(r, d, "list1"), p(r, f, "list2")
}

function p(t, n, r) {
  "list1" == r ? (t.imgid.list1++, t.lastOffset1 = n) : "list2" == r && (t.imgid.list2++, t.lastOffset2 = n);
  var i = t.sotedRankList.slice(n, n + 12),
    s = t.context[r];
  if (s.clearRect(0, 0, e.WIDTH, 12 * (0, e.cwh)(e.ListLineHeight)), 0 == n || 0 != i.length) {
    if (!(n < 0)) {
      for (var o = i.length, a = function() {
          l % 2 == 1 && (s.fillStyle = "rgba(255,255,255, 0.03)", s.fillRect(0, l * (0, e.cwh)(e.ListLineHeight), (0, e.cwh)(414), (0, e.cwh)(e.ListLineHeight)));
          var o = (l + .5) * e.ListLineHeight;
          s.textAlign = "center", f = "", f = 1 == (d = l + 1 + n) ? "rgb(250,126,0)" : 2 == d ? "rgb(254,193,30)" : 3 == d ? "rgb(251,212,19)" : "#aaa", (0, e.drawText)({
            self: t,
            color: f,
            size: 17,
            italic: !0,
            bold: !0,
            t: d,
            pos: [58.5, o],
            type: r
          });
          i[l].grade;
          s.beginPath(), s.strokeStyle = "rgba(255,255,255, 0.1)", s.fillStyle = "rgba(255,255,255, 0.1)", (0, e.roundedRect)((0, e.cx)(90), (0, e.cwh)(o - 17), (0, e.cwh)(34), (0, e.cwh)(34), 4 * e.Dpr, s), s.fill(), s.closePath(), (0, e.drawImageCenter)({
            round: !0,
            self: t,
            src: i[l].headimg,
            pos: [107, o, 34, 34],
            type: r,
            cb: function() {
              (0, e.drawImageCenter)({
                self: t,
                src: "res/ava_rank.png",
                pos: [107, o, 47, 47],
                type: r,
                imgid: t.imgid[r]
              })
            },
            imgid: t.imgid[r],
            noupdate: !0
          }), (0, e.drawText)({
            self: t,
            align: "left",
            size: 17,
            t: (0, e.cname)(i[l].nickname, 12),
            pos: [144, o],
            type: r
          }), 0, i[l].bottle_skin && (0, e.drawImageCenter)({
            self: t,
            src: i[l].bottle_skin,
            pos: [362, o, 15, 30],
            type: r,
            imgid: t.imgid[r]
          }), 23, (0, e.drawText)({
            self: t,
            align: "right",
            size: 22,
            special: !0,
            t: i[l].week_best_score || 0,
            pos: [339, o + 2],
            type: r
          })
        }, l = 0; l < o; l++) {
        var d, f;
        a()
      }(0, e.updatePlane)({
        self: t,
        type: r
      })
    }
  } else(0, e.updatePlane)({
    self: t,
    type: r
  })
}
},{"../../config":37,"../../lib/mue/eventcenter":67,"../../network/getAuth":72,"../../scroll/scrollHandler":122,"../../store/storage":128,"../../util/common":136,"./base":89}],97:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawRecordPage = function(t) {
  var i = t.self;
  i.imgid.bg++, (0, e.routeCanvas)(i, "record"), (0, e.createPlane)(i), i.context.bg.clearRect(0, 0, e.WIDTH, e.HEIGHT);
  var r = i.opt;
  (0, e.drawImageCenter)({
    self: i,
    src: r.headimg,
    pos: [61, 128, 42, 42],
    type: "bg",
    cb: function() {
      (0, e.drawImageCenter)({
        self: i,
        src: "res/2d/ava_square.png",
        pos: [61, 128, 43, 43],
        type: "bg",
        imgid: i.imgid.bg
      })
    },
    imgid: i.imgid.bg,
    noupdate: !0,
    round: !0
  }), (0, e.drawImageCenter)({
    self: i,
    src: "res/2d/new_return.png",
    pos: [54, 674, 70, 70],
    type: "bg",
    imgid: i.imgid.bg
  }), r.is_self && (0, e.drawImageCenter)({
    self: i,
    src: "res/2d/iplay.png",
    pos: [317, 670, 166, 75],
    type: "bg",
    imgid: i.imgid.bg,
    cb: function() {
      (0, e.drawImageCenter)({
        self: i,
        src: "res/2d/share_black.png",
        pos: [275, 670, 16, 20],
        type: "bg",
        imgid: i.imgid.bg
      }), (0, e.drawText)({
        self: i,
        size: 17,
        t: "立即分享",
        pos: [294, 670],
        align: "left",
        type: "bg",
        color: "#222"
      })
    }
  });
  (0, e.updatePlane)({
    self: i,
    type: "bg"
  })
}, exports.drawRecord分享Page = function(t) {
  (0, e.routeCanvas)(t, "record分享"), (0, e.createPlane)(t), t.imgid.bg++;
  var i = t.context.bg;
  i.clearRect(0, 0, e.WIDTH, e.HEIGHT), t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "rgba(0,0,0, 0.8)", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "white", i.fillRect((0, e.cx)(46), (0, e.cy)(95), (0, e.cwh)(322), (0, e.cwh)(524));
  var r = t.opt;
  (0, e.drawText)({
    self: t,
    size: 14,
    align: "left",
    t: "游戏得分",
    pos: [70, 412],
    color: "#000"
  }), (0, e.drawText)({
    self: t,
    bold: !0,
    size: 60,
    align: "left",
    t: r.score || 0,
    pos: [70, 458],
    special: !0,
    color: "#00c777"
  }), (0, e.drawText)({
    self: t,
    size: 17,
    align: "left",
    t: "游戏最高连击",
    pos: [111, 541],
    color: "#000"
  }), (0, e.drawText)({
    self: t,
    bold: !0,
    size: 23,
    align: "left",
    t: r.combo || 0,
    pos: [220, 541],
    special: !0,
    color: "#00c777"
  }), (0, e.drawText)({
    self: t,
    size: 17,
    align: "left",
    t: "跳跃基座总数",
    pos: [111, 584],
    color: "#000"
  }), (0, e.drawText)({
    self: t,
    bold: !0,
    size: 23,
    align: "left",
    t: r.blocks || 0,
    pos: [222, 584],
    special: !0,
    color: "#00c777"
  }), (0, e.drawImageCenter)({
    self: t,
    src: "res/2d/new_return.png",
    pos: [54, 674, 70, 70],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, e.drawImageCenter)({
    self: t,
    src: "http://mmbiz.qpic.cn/mmbiz_jpg/icTdbqWNOwNTTiaKet81gQJM5kF68vSvHb8fGUK7Gxet3cpo27XHdThFxDKxa9udIrIRrfib6iceCbdOmMIA8ia6nrQ/0?wx_fmt=jpeg",
    pos: [207, 237, 314, 274],
    type: "bg",
    imgid: t.imgid.bg,
    cb: function() {
      if (t.opt.qrcode) {
        var a = "data:image/jpeg;base64," + t.opt.qrcode,
          g = new Image;
        g.onload = function() {
          i.save(), i.beginPath(), i.arc((0, e.cx)(207), (0, e.cy)(237), (0, e.cwh)(75), 0, 2 * Math.PI), i.clip(), i.drawImage(g, (0, e.cx)(137), (0, e.cy)(167), (0, e.cwh)(140), (0, e.cwh)(140)), i.closePath(), i.restore(), (0, e.updatePlane)({
            self: t,
            type: "bg"
          })
        }, t.opt.qrcode && (g.src = a)
      }(0, e.drawImageCenter)({
        self: t,
        src: r.headimg,
        pos: [91, 365, 42, 42],
        type: "bg",
        cb: function() {
          (0, e.drawImageCenter)({
            self: t,
            src: "res/2d/ava_square.png",
            pos: [91, 365, 44, 44],
            type: "bg",
            imgid: t.imgid.bg
          })
        },
        imgid: t.imgid.bg,
        noupdate: !0,
        round: !0
      })
    }
  }), (0, e.drawImageCenter)({
    self: t,
    src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJM5kF68vSvHbGCBbdgOO38RUykCLXfxY4AqvbpYlicNty1spYAodBn0VaIlUTmUWZPA/0?wx_fmt=png",
    pos: [83, 541, 30, 30],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, e.drawImageCenter)({
    self: t,
    src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJM5kF68vSvHbIzzKuHlGd6VRrYJDvWRW8ualJGGNUAjAsqqexE8oqPpmME0FwHa5qg/0?wx_fmt=png",
    pos: [83, 584, 30, 30],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, e.drawImageCenter)({
    self: t,
    src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJM5kF68vSvHbfc7nDtrYImbjUnlqZ4koWibPibgYJVxlg8StI6Q9VuxaIwicLkFtOrhzQ/0?wx_fmt=png",
    pos: [282.5, 674, 47, 47],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, e.drawImageCenter)({
    self: t,
    src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJM5kF68vSvHbbwRXvZtMDn4vIzraOmfMnic8R4qMMQgEV0XLG3unlM2fpHFG9FSBaSg/0?wx_fmt=png",
    pos: [359.5, 674, 47, 47],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, e.updatePlane)({
    self: t,
    type: "bg"
  })
}, exports.getRecordSavePhoto = t, exports.recordEve = function(t, i, r) {
  if (i > 30 && i < 95 && r > 640 && r < 720) return (0, e.back)(t), t.options.quitRecord && t.options.quitRecord(), !1;
  if (t.opt.is_self && i > 270 && i < 340 && r > 640 && r < 720) return t.opt.on分享 && t.opt.on分享(), !1
}, exports.record分享Eve = function(i, r, a) {
  if (r > 30 && r < 95 && a > 640 && a < 720)(0, e.back)(i), i.opt.onClose && i.opt.onClose();
  else if (r > 259 && r < 306 && a > 640 && a < 720) {
    var g = t(i);
    i.opt.onSave && i.opt.onSave(g)
  } else r > 336 && r < 383 && a > 640 && a < 720 && i.opt.on分享 && i.opt.on分享()
};
var e = require("./base");

function t(e) {
  return e.canvas.bg
}
},{"./base":89}],98:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawRelayBeginner = function(t) {
  (0, e.routeCanvas)(t, "relayBeginner"), (0, e.createPlane)(t), t.imgid.bg++, t.imgid.btn++;
  var a = t.context.bg;
  a.clearRect(0, 0, e.WIDTH, e.HEIGHT), t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT), a.beginPath(), a.fillStyle = "rgba(132,111,126,0.8)", a.fillRect(0, (0, e.cy)(547), e.WIDTH, (0, e.cwh)(189)), a.fill(), a.closePath(), (0, e.drawImageCenter)({
    self: t,
    src: "res/2d/skip.png",
    pos: [357, 547, 80, 48],
    type: "bg",
    imgid: t.imgid.bg
  }), (0, e.drawText)({
    self: t,
    t: "玩法说明",
    size: 17,
    pos: [207, 599]
  }), (0, e.drawText)({
    self: t,
    t: "邀请好友进入游戏，轮流操作。每个人在规定时间内",
    size: 14,
    pos: [207, 631]
  }), (0, e.drawText)({
    self: t,
    t: "完成1次操作。掉落者则被淘汰，坚持到最后的玩",
    size: 14,
    pos: [207, 653]
  }), (0, e.drawText)({
    self: t,
    t: "家即为胜利。",
    size: 14,
    pos: [207, 675]
  }), (0, e.updatePlane)({
    self: t,
    type: "bg"
  })
}, exports.drawRelayGG = function(t) {
  if (t.canvasType != e.CANVASTYPE.relayRoom && !e.DEBUGVIEW) return;
  (0, e.createPlane)(t);
  var a = t.context.bg;
  a.clearRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.routeCanvas)(t, "relayGG");
  var o = t.opt;
  (0, e.drawHomeImg)(a, t), (0, e.drawImageCenter)({
    self: t,
    src: "res/bl3.png",
    pos: [207, 342.5, 354, 417],
    imgid: t.imgid.bg,
    type: "bg",
    round: !0,
    cb: function() {
      (0, e.drawImageCenter)({
        self: t,
        src: "res/2d/555.png",
        pos: [207, 214, 37.4, 27],
        type: "bg",
        imgid: t.imgid.bg
      }), (0, e.drawText)({
        self: t,
        t: "游戏结束",
        size: 36,
        pos: [207, 298]
      }), (0, e.drawText)({
        self: t,
        t: "第" + o.my_rank + "th",
        size: 30,
        pos: [207, 358],
        color: "#E3B857"
      }), (0, e.drawText)({
        self: t,
        t: "共" + o.all_player + "th玩家",
        size: 17,
        pos: [207, 398],
        color: "#888"
      }), a.lineWidth = 2 * e.Dpr, a.strokeStyle = "rgba(255,255,255,0.06)", a.fillStyle = "rgba(0,0,0,0.3)", c((0, e.cx)(30), (0, e.cy)(460), (0, e.cwh)(354), (0, e.cwh)(91), 4 * e.Dpr, a), a.fill(), (0, e.drawText)({
        self: t,
        t: "继续观战",
        size: 22,
        pos: [207, 506]
      })
    }
  }), (0, e.updatePlane)({
    self: t,
    type: "bg"
  })
}, exports.drawRelayList = f, exports.drawRelayLookers = function(t) {
  t.opt;
  (0, e.createPlane)(t), (0, e.routeCanvas)(t, "relayLookers"), t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawImageCenter)({
    self: t,
    src: "res/relay_return.png",
    pos: [207, 678, 140, 54],
    imgid: t.imgid.bg,
    type: "bg",
    cb: function() {
      (0, e.drawText)({
        self: t,
        t: "我也要玩",
        size: 17,
        pos: [207, 678],
        color: "#555"
      }), (0, e.updatePlane)({
        self: t,
        type: "bg"
      })
    }
  })
}, exports.drawRelayQr = function(t) {
  t.opt;
  (0, e.createPlane)(t), (0, e.routeCanvas)(t, "relayQr");
  var a = t.context.bg;
  a.clearRect(0, 0, e.WIDTH, e.HEIGHT);
  var o = a.createLinearGradient(0, 0, 0, e.HEIGHT);
  o.addColorStop(0, "#D6F1F1"), o.addColorStop(1, "#D3EDE6"), a.fillStyle = o, a.fillRect(0, 0, e.WIDTH, e.HEIGHT), a.fillStyle = "rgba(0,0,0, 0.3)", a.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawText)({
      self: t,
      t: "扫码即可进入房间",
      size: 17,
      pos: [207, 180]
    }),
    function(t) {
      var a = "data:image/jpeg;base64," + t.opt.room_wxa_code,
        o = t.context.bg;
      (0, e.drawImageCenter)({
        self: t,
        src: "res/qr.png",
        pos: [207, 368, 390, 390],
        type: "bg",
        imgid: t.imgid.bg,
        cb: function() {
          var r = new Image;
          r.onload = function() {
            o.save(), o.beginPath(), o.arc((0, e.cx)(207), (0, e.cy)(368), (0, e.cwh)(150), 0, 2 * Math.PI), o.clip(), o.drawImage(r, (0, e.cx)(67), (0, e.cy)(228), (0, e.cwh)(280), (0, e.cwh)(280)), o.closePath(), o.restore(), (0, e.updatePlane)({
              self: t,
              type: "bg"
            })
          }, t.opt.room_wxa_code && (r.src = a)
        }
      })
    }(t), (0, e.drawReturnImg)(a, t), (0, e.updatePlane)({
      self: t,
      type: "bg"
    })
}, exports.drawRelay第= function(t) {
  console.log("!!! drawRelayRank", t), t.opt.th玩家 = (0, e.relayRerank)(t.opt.th玩家);
  var a = t.opt.isLive,
    o = t.opt.my_seat_no == t.opt.room_owner_seat;
  if (t.opt.isLiveMember = a && !o, (0, e.createPlane)(t), t.context["bg"].clearRect(0, 0, e.WIDTH, e.HEIGHT), 1 == t.opt.my_rank)(0, e.drawImageCenter)({
    round: !0,
    self: t,
    src: "res/bl3.png",
    pos: [207, 382.5, 354, 537],
    type: "bg",
    imgid: t.imgid.bg,
    cb: function() {
      ! function(t) {
        (0, e.routeCanvas)(t, "relayRank"), (0, e.createPlane)(t), (0, e.updateClip)({
          self: t
        });
        var a = t.context.bg;
        (0, e.drawHomeImg)(a, t), a.fillStyle = "rgba(255,255,255,0.04)", a.fillRect((0, e.cx)(30), (0, e.cy)(177), (0, e.cwh)(354), (0, e.cwh)(227)), a.fillStyle = "rgba(0,0,0,0.3)", a.lineWidth = .5 * e.Dpr, a.strokeStyle = "rgba(0,0,0,0.2)", c((0, e.cx)(30), (0, e.cy)(561), (0, e.cwh)(354), (0, e.cwh)(90), 2 * e.Dpr, a), a.fill();
        var o = t.opt.th玩家 || [];
        console.log("排行榜的 th玩家: ", o), (0, e.drawText)({
          self: t,
          t: o.length + "共本次得分：" + t.opt.total_score,
          size: 17,
          pos: [207, 145]
        }), (0, e.drawImageCenter)({
          self: t,
          src: o[0].headimg,
          pos: [207, 247, 48, 48],
          type: "bg",
          imgid: t.imgid.bg,
          cb: function() {
            (0, e.drawImageCenter)({
              self: t,
              src: "res/2d/ava_square.png",
              pos: [207, 247, 50, 50],
              imgid: t.imgid.bg
            })
          }
        }), (0, e.drawText)({
          self: t,
          t: "第" + t.opt.my_rank + "th",
          size: 30,
          pos: [207, 316],
          color: "#E3B857"
        }), (0, e.drawText)({
          self: t,
          t: "共" + o.length + "th玩家",
          size: 15,
          pos: [207, 356],
          color: "#888"
        }), (0, e.drawText)({
          self: t,
          t: t.opt.isLiveMember ? "回到首页" : "再来1局",
          size: 22,
          pos: [207, 606]
        }), (0, e.updatePlane)({
          self: t,
          type: "bg"
        }), d(t, o)
      }(t)
    }
  });
  else {
    var r = !1,
      l = 0;
    0 == t.opt.my_seat_no && (r = !0), l = r ? 446 : 537, (0, e.drawImageCenter)({
      round: !0,
      self: t,
      src: "res/bl3.png",
      pos: [207, 114 + l / 2, 354, l],
      type: "bg",
      imgid: t.imgid.bg,
      cb: function() {
        ! function(t) {
          (0, e.routeCanvas)(t, "relayRank"), (0, e.updateClip)({
            self: t
          });
          var a = t.context.bg;
          (0, e.drawHomeImg)(a, t), a.fillStyle = "rgba(255,255,255,0.04)", a.fillRect((0, e.cx)(30), (0, e.cy)(177), (0, e.cwh)(354), (0, e.cwh)(141)), a.fill();
          var o = t.opt.th玩家,
            r = !1;
          0 == t.opt.my_seat_no && (r = !0);
          r ? (0, e.drawText)({
            self: t,
            t: "游戏结束",
            size: 30,
            pos: [207, 243]
          }) : (a.fillStyle = "rgba(0,0,0,0.3)", a.strokeStyle = "rgba(0,0,0,0.2)", a.lineWidth = .5 * e.Dpr, c((0, e.cx)(30), (0, e.cy)(560), (0, e.cwh)(354), (0, e.cwh)(90), 2 * e.Dpr, a), a.fill(), (0, e.drawText)({
            self: t,
            t: "第" + t.opt.my_rank + "th",
            size: 30,
            pos: [207, 237],
            color: "#E3B857"
          }), (0, e.drawText)({
            self: t,
            t: "共" + o.length + "th玩家",
            size: 17,
            pos: [207, 275]
          }), (0, e.drawText)({
            self: t,
            t: t.opt.isLiveMember ? "回到首页" : "再来1局",
            size: 22,
            pos: [207, 606]
          }));
          (0, e.drawText)({
            self: t,
            t: o.length + "共本次得分：" + t.opt.total_score,
            size: 17,
            pos: [207, 145]
          }), (0, e.updatePlane)({
            self: t,
            type: "bg"
          }), d(t, o)
        }(t)
      }
    })
  }
}, exports.drawRelayRoomPage = function(t) {
  var a = t.opt;
  (0, e.createPlane)(t, ["bg", "btn"]), (0, e.routeCanvas)(t, "relayRoom"), 1 == a.game_level ? a.game_level_s = "中" : 2 == a.game_level ? a.game_level_s = "高" : a.game_level_s = "低";
  if (2 == a.game_status)(0, e.createPlane)(t),
    function(t) {
      console.log("drawOutDateRoom", t);
      var a = t.context.bg;
      a.clearRect(0, 0, e.WIDTH, e.HEIGHT);
      var o = a.createLinearGradient(0, 0, 0, e.HEIGHT);
      o.addColorStop(0, "#D6F1F1"), o.addColorStop(1, "#D3EDE6"), a.fillStyle = o, a.fillRect(0, 0, e.WIDTH, e.HEIGHT), a.fillStyle = "rgba(0,0,0, 0.3)", a.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawImageCenter)({
        self: t,
        src: "res/2d/555.png",
        pos: [207, 64, 37.4, 27],
        type: "bg",
        imgid: t.imgid.bg
      }), (0, e.drawText)({
        self: t,
        size: 24,
        t: "该局游戏已结束",
        pos: [207, 136]
      }), (0, e.drawHomeImg)(a, t), (0, e.drawImageCenter)({
        self: t,
        src: "res/lookers_btn.png",
        pos: [207, 588, 162, 78],
        type: "bg",
        imgid: t.imgid.bg,
        cb: function() {
          (0, e.drawText)({
            self: t,
            t: "我也要玩",
            size: 18,
            pos: [207, 588],
            color: "#000"
          })
        }
      });
      setTimeout((function() {
        (0, e.drawImageCenter)({
          round: !0,
          self: t,
          src: "res/bl3.png",
          pos: [207, 350, 300, 350],
          type: "bg",
          imgid: t.imgid.bg,
          cb: function() {
            ! function(t) {
              t.opt.isOutDate = !0, (0, e.routeCanvas)(t, "relayRank"), (0, e.updateClip)({
                self: t
              });
              var a = t.context.bg;
              (0, e.drawHomeImg)(a, t);
              var o = t.opt.th玩家;
              console.log("!!! 共本次得分 self", t), (0, e.drawText)({
                self: t,
                t: "共" + o.length + "人参与",
                size: 17,
                pos: [207, 200]
              }), (0, e.updatePlane)({
                self: t,
                type: "bg"
              }), d(t, o)
            }(t)
          }
        })
      }), 100), (0, e.updatePlane)({
        self: t,
        type: "bg"
      })
    }(t);
  else if (1 == a.game_status)(0, e.createPlane)(t),
    function(t) {
      t.imgid.bg++;
      var a = t.context.bg;
      a.clearRect(0, 0, e.WIDTH, e.HEIGHT);
      var o = a.createLinearGradient(0, 0, 0, e.HEIGHT);
      o.addColorStop(0, "#D6F1F1"), o.addColorStop(1, "#D3EDE6"), a.fillStyle = o, a.fillRect(0, 0, e.WIDTH, e.HEIGHT), a.fillStyle = "rgba(0,0,0, 0.3)", a.fillRect(0, 0, e.WIDTH, e.HEIGHT);
      var r = t.opt.th玩家,
        l = t.opt;
      (0, e.drawHomeImg)(a, t);
      var n = [];
      r.length < 6 ? g(t, n = r, 299) : (n = r.slice(0, Math.ceil(r.length / 2)), g(t, n, 299), n = r.slice(Math.ceil(r.length / 2), r.length), g(t, n, 402));
      (0, e.drawText)({
        self: t,
        size: 24,
        t: "游戏已开始",
        pos: [207, 141]
      }), (0, e.drawText)({
        self: t,
        size: 17,
        t: "游戏难度 : " + l.game_level_s,
        pos: [207, 167],
        color: "#FCBA4B"
      }), (0, e.drawImageCenter)({
        self: t,
        src: "res/lookers_btn.png",
        pos: [207, 588, 152, 78],
        type: "bg",
        imgid: t.imgid.bg,
        cb: function() {
          (0, e.drawText)({
            self: t,
            t: "观战",
            size: 22,
            pos: [207, 588],
            color: "#000"
          })
        }
      }), (0, e.updatePlane)({
        self: t,
        type: "bg"
      })
    }(t);
  else if (0 == a.game_status)
    if (a.my_seat_no == a.room_owner_seat) {
      if (function(e, t, a) {
          if (!t) return !1;
          if ((t = JSON.parse(t)).my_seat_no != t.room_owner_seat && e.my_seat_no == e.room_owner_seat) return !1;
          if (e.isLive !== t.isLive) return !1;
          var o, r, i;
          if (e.th玩家.length == t.th玩家.length)
            for (var p = 0; p < e.th玩家.length; p++) e.th玩家[p].headimg == t.th玩家[p].headimg && e.th玩家[p].name == t.th玩家[p].name || (o = !0);
          else o = !0;
          o && n(a);
          e.game_level != t.game_level && (r = !0, l(a));
          (e.th玩家.length > 1 && 1 == t.th玩家.length || t.th玩家.length > 1 && 1 == e.th玩家.length) && (i = !0, s(a));
          return !!(o || r || i) || null == o && null == r && null == i
        }(t.opt, t.lastopt, t)) return void(t.lastopt = JSON.stringify(t.opt));
      t.lastopt = JSON.stringify(t.opt),
        function(t) {
          t.imgid.btn++, t.imgid.bg++, t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT);
          var a = t.context.bg;
          a.clearRect(0, 0, e.WIDTH, e.HEIGHT);
          var o = a.createLinearGradient(0, 0, 0, e.HEIGHT);
          o.addColorStop(0, "#D6F1F1"), o.addColorStop(1, "#D3EDE6"), a.fillStyle = o, a.fillRect(0, 0, e.WIDTH, e.HEIGHT), a.fillStyle = "rgba(0,0,0, 0.5)", a.fillRect(0, 0, e.WIDTH, (0, e.cy)(247)), a.fillStyle = "rgba(0,0,0, 0.3)", a.fillRect(0, (0, e.cy)(247), e.WIDTH, (0, e.cy)(489)), n(t), (0, e.drawText)({
            self: t,
            t: "通过房间码邀请",
            size: 17,
            pos: [198, 181],
            color: "rgba(255,255,255,0.7)"
          }), (0, e.drawImageCenter)({
            self: t,
            src: "res/r_arr.png",
            pos: [273, 181, 6.5, 12.5],
            type: "btn",
            imgid: t.imgid.btn
          }), l(t);
          var r = "function" == typeof wx.getGameLiveState && wx.getGameLiveState().isLive;
          (r = r && "function" == typeof wx.shareInvitationToLiveRoom) ? ((0, e.drawImageCenter)({
            self: t,
            src: "res/2d/inviteGray.png",
            pos: [120, 119, 128, 37],
            type: "bg",
            imgid: t.imgid.bg
          }), (0, e.drawImageCenter)({
            self: t,
            src: "res/2d/inviteWhite.png",
            pos: [272, 119, 128, 37],
            type: "bg",
            imgid: t.imgid.bg
          })) : ((0, e.drawText)({
            self: t,
            t: "+  邀请好友",
            size: 17,
            pos: [207, 119]
          }), (0, e.drawImageCenter)({
            self: t,
            src: "res/btn_invite_fri.png",
            pos: [207, 119, 152, 37],
            type: "bg",
            imgid: t.imgid.bg
          }));
          s(t), (0, e.drawHomeImg)(a, t), (0, e.updatePlane)({
            self: t,
            type: "bg"
          })
        }(t)
    } else {
      if (function(e, t, a) {
          if (!t) return !1;
          if (t.my_seat_no != t.room_owner_seat && e.my_seat_no == e.room_owner_seat) return !1;
          var o, r;
          if (t = JSON.parse(t), e.th玩家.length == t.th玩家.length)
            for (var l = 0; l < e.th玩家.length; l++) e.th玩家[l].headimg == t.th玩家[l].headimg && e.th玩家[l].name == t.th玩家[l].name || (o = !0);
          else o = !0;
          o && i(a);
          (t.th玩家.length < 10 && e.th玩家.length >= 10 || t.game_level != e.game_level) && (r = !0, p(a));
          if (o || r) return !0;
          return !1
        }(t.opt, t.lastopt, t)) return void(t.lastopt = JSON.stringify(t.opt));
      t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT), t.lastopt = JSON.stringify(t.opt),
        function(t) {
          var a = t.context.bg;
          a.clearRect(0, 0, e.WIDTH, e.HEIGHT);
          var o = a.createLinearGradient(0, 0, 0, e.HEIGHT);
          o.addColorStop(0, "#D6F1F1"), o.addColorStop(1, "#D3EDE6"), a.fillStyle = o, a.fillRect(0, 0, e.WIDTH, e.HEIGHT), a.fillStyle = "rgba(0,0,0, 0.3)", a.fillRect(0, 0, e.WIDTH, e.HEIGHT);
          t.opt.th玩家, t.opt;
          (0, e.drawHomeImg)(a, t);
          for (var r = 0; r < 10; r++) {
            var l = 59 + r % 5 * 74,
              n = 299 + 103 * Math.floor(r / 5);
            a.lineWidth = 1 * e.Dpr, a.strokeStyle = "rgba(0,0,0,0.06)", a.fillStyle = "rgba(0,0,0,0.06)", (0, e.roundedRect)((0, e.cx)(l - 27), (0, e.cy)(n - 27), (0, e.cwh)(54), (0, e.cwh)(54), 4 * e.Dpr, a), a.fill()
          }
          i(t), p(t), (0, e.drawText)({
            self: t,
            size: 14,
            t: "仅房主可开始游戏以及设置游戏难度",
            pos: [207, 214]
          }), (0, e.drawText)({
            self: t,
            t: "+  邀请好友",
            size: 17,
            pos: [207, 608]
          }), (0, e.drawImageCenter)({
            self: t,
            src: "res/btn_invite_fri.png",
            pos: [207, 608, 152, 37],
            type: "bg",
            imgid: t.imgid.bg
          }), (0, e.updatePlane)({
            self: t,
            type: "bg"
          })
        }(t)
    }
}, exports.drawRelaying = function(t) {
  var a = t.opt;
  (0, e.createPlane)(t), (0, e.routeCanvas)(t, "relayRoom"), t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawText)({
    self: t,
    t: a.text,
    size: 26,
    pos: [34, 220],
    align: "left",
    type: "btn",
    color: "#403A5B"
  }), (0, e.updatePlane)({
    self: t,
    type: "btn"
  })
}, exports.relayBeginnerEve = function(e, t, a) {
  if (t > 310 && t < 397 && a > 530 && a < 560) return e.options.skipRelayBeginner && e.options.skipRelayBeginner(), !1
}, exports.relayGGEve = function(e, t, a) {
  if (t > 30 && t < 384 && a > 460 && a < 550) return e.hide2D(), !1;
  if (t < 100 && a < 70) return e.relayHeadImg && e.relayHeadImg.obj && e.options.camera.remove(e.relayHeadImg.obj), e.relayText && e.options.camera.remove(e.relayText), e.options.outRelay1 && e.options.outRelay1(), !1
}, exports.relayQrEve = function(e, t, a) {
  if (t < 100 && a < 70) return e.showRelayRoom(e.relayOpt, !0), !1
}, exports.relayRankEve = function(e, t, r) {
  if (t < 100 && r < 70 || e.opt.isLiveMember) return e.options.outRelay1 && e.options.outRelay1(), !1;
  if (0 != e.opt.my_seat_no && t > 30 && t < 380 && r > 561 && r < 651) return a.default.emit(o.EVENT.REPLAYAGAIN, {}), !1
}, exports.relayRoomEve = function(e, t, r) {
  var l = "function" == typeof wx.getGameLiveState && wx.getGameLiveState().isLive;
  if (l = l && "function" == typeof wx.shareInvitationToLiveRoom, 0 == e.opt.game_status && e.opt.my_seat_no == e.opt.room_owner_seat && e.opt.th玩家.length > 1 && t > 160 && t < 260 && r > 627 && r < 677) return e.opt.game_level = e.opt.game_level || 0, e.options.startRelay && e.options.startRelay(e.opt.game_level), !1;
  if (0 == e.opt.game_status && e.opt.my_seat_no == e.opt.room_owner_seat && t > 160 && t < 260 && r > 555 && r < 595) return wx.showActionSheet({
    itemList: ["低", "中", "高"],
    success: function(t) {
      e.opt.game_level = t.tapIndex, e.showRelayRoom(e.opt), a.default.emit(o.EVENT.CHANGEGAMELEVEL, t.tapIndex)
    }
  }), !1;
  if (0 == e.opt.game_status && t < 100 && r < 70) return e.relayHeadImg && e.relayHeadImg.obj && e.options.camera.remove(e.relayHeadImg.obj), e.relayText && e.options.camera.remove(e.relayText), e.options.outRelay1 && e.options.outRelay1(), !1;
  if (0 == e.opt.game_status && e.opt.my_seat_no == e.opt.room_owner_seat && !l && t > 120 && t < 280 && r > 99 && r < 140) return e.options.shareRelay && e.options.shareRelay(), !1;
  if (0 == e.opt.game_status && e.opt.my_seat_no == e.opt.room_owner_seat && l && t > 56 && t < 180 && r > 99 && r < 140) return e.options.shareRelay && e.options.shareRelay(), !1;
  if (0 == e.opt.game_status && e.opt.my_seat_no == e.opt.room_owner_seat && l && t > 205 && t < 336 && r > 99 && r < 140) {
    var n, s, i;
    e.options.shareRelayLive && e.options.shareRelayLive({
      game_level: e.opt.game_level,
      game_level_s: e.opt.game_level_s,
      member_count: null !== (n = null === (s = e.opt) || void 0 === s || null === (i = s.th玩家) || void 0 === i ? void 0 : i.length) && void 0 !== n ? n : 1
    })
  } else {
    if (0 == e.opt.game_status && e.opt.my_seat_no != e.opt.room_owner_seat && t > 160 && t < 260 && r > 598 && r < 618) return e.options.shareRelay && e.options.shareRelay(), !1;
    if ((1 == e.opt.game_status || 2 == e.opt.game_status) && t < 100 && r < 70) return e.relayHeadImg && e.relayHeadImg.obj && e.options.camera.remove(e.relayHeadImg.obj), e.relayText && e.options.camera.remove(e.relayText), e.options.outRelay2 && e.options.outRelay2(), !1;
    if (1 == e.opt.game_status && t > 160 && t < 260 && r > 568 && r < 608) return e.options.watchRelay && e.options.watchRelay(), !1;
    if (0 == e.opt.game_status && e.opt.my_seat_no == e.opt.room_owner_seat && t > 160 && t < 260 && r > 161 && r < 201) return a.default.emit(o.EVENT.GETRELAYQR), e.options.getRelayQr && e.options.getRelayQr(), e.showRelayQr({}), !1;
    if (2 == e.opt.game_status && t > 160 && t < 260 && r > 568 && r < 608) return e.options.newRelay && e.options.newRelay(), !1
  }
  if (e.needAuth && t > 207 && t < 369 && r > 375 && r < 425) e.options.skipRelayBeginner && e.options.skipRelayBeginner();
  else if (e.needAuth && t > 45 && t < 207 && r > 375 && r < 425) return e.relayHeadImg && e.relayHeadImg.obj && e.options.camera.remove(e.relayHeadImg.obj), e.relayText && e.options.camera.remove(e.relayText), e.options.outRelay1 && e.options.outRelay1(), !1
};
var e = require("./base"),
  t = r(require("../../scroll/scrollHandler")),
  a = r(require("../../lib/mue/eventcenter")),
  o = require("../../config");

function r(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

function l(t) {
  t.context.btn.clearRect((0, e.cx)(100), (0, e.cy)(555), (0, e.cwh)(200), (0, e.cwh)(40)), (0, e.drawText)({
    self: t,
    t: "游戏难度  :   " + t.opt.game_level_s,
    size: 17,
    pos: [138, 575],
    align: "left",
    type: "btn"
  }), (0, e.drawImageCenter)({
    self: t,
    src: "res/r_arr.png",
    pos: [273, 575, 6.5, 12.5],
    type: "btn",
    imgid: t.imgid.btn
  }), (0, e.updatePlane)({
    self: t,
    type: "btn"
  })
}

function n(t) {
  var a = t.context.btn;
  a.clearRect((0, e.cx)(20), (0, e.cy)(270), (0, e.cwh)(370), (0, e.cwh)(210));
  for (var o = t.opt.th玩家, r = function(r) {
      var l = 59 + r % 5 * 74,
        n = 314 + 103 * Math.floor(r / 5);
      o[r] ? ((0, e.drawImageCenter)({
        self: t,
        src: o[r].headimg,
        pos: [l, n, 51, 51],
        type: "btn",
        imgid: t.imgid.btn,
        round: !0,
        noupdate: !0,
        cb: function() {
          (0, e.drawImageCenter)({
            self: t,
            src: "res/2d/ava_square.png",
            pos: [l, n, 53, 53],
            type: "btn",
            imgid: t.imgid.btn,
            cb: function() {
              console.log(o[r].seat_no, t.opt.room_owner_seat), o[r].seat_no == t.opt.room_owner_seat && (0, e.drawImageCenter)({
                self: t,
                src: "res/2d/owner.png",
                pos: [l, n - 27, 40, 18],
                imgid: t.imgid.btn,
                type: "btn",
                cb: function() {
                  (0, e.updatePlane)({
                    self: t,
                    type: "btn"
                  })
                }
              })
            }
          })
        }
      }), (0, e.drawText)({
        self: t,
        t: (0, e.cname)(o[r].name, 6),
        size: 14,
        pos: [l, n + 45],
        type: "btn"
      })) : (a.lineWidth = 1 * e.Dpr, a.strokeStyle = "rgba(0,0,0,0.06)", a.fillStyle = "rgba(0,0,0,0.06)", (0, e.roundedRect)((0, e.cx)(l - 27), (0, e.cy)(n - 27), (0, e.cwh)(53), (0, e.cwh)(53), 4 * e.Dpr, a), a.fill())
    }, l = 0; l < 10; l++) r(l)
}

function s(t) {
  t.context.btn.clearRect((0, e.cx)(100), (0, e.cy)(620), (0, e.cwh)(220), (0, e.cwh)(80)), t.opt.th玩家.length > 1 && (0, e.drawImageCenter)({
    self: t,
    src: "res/play.png",
    pos: [207, 657, 208, 78],
    type: "btn",
    imgid: t.imgid.btn
  })
}

function i(t) {
  console.log("diff player");
  var a = t.context.btn,
    o = t.opt.th玩家;
  a.clearRect((0, e.cx)(20), (0, e.cy)(260), (0, e.cwh)(370), (0, e.cwh)(210));
  for (var r = function(a) {
      var r = 59 + a % 5 * 74,
        l = 299 + 103 * Math.floor(a / 5);
      o[a] && ((0, e.drawImageCenter)({
        self: t,
        src: o[a].headimg,
        pos: [r, l, 52, 52],
        type: "btn",
        imgid: t.imgid.btn,
        round: !0,
        noupdate: !0,
        cb: function() {
          (0, e.drawImageCenter)({
            self: t,
            src: "res/2d/ava_square.png",
            pos: [r, l, 54, 54],
            imgid: t.imgid.btn,
            type: "btn",
            cb: function() {
              o[a].seat_no == t.opt.room_owner_seat && (0, e.drawImageCenter)({
                self: t,
                src: "res/2d/owner.png",
                pos: [r, l - 27, 40, 18],
                imgid: t.imgid.btn,
                type: "btn",
                cb: function() {
                  (0, e.updatePlane)({
                    self: t,
                    type: "btn"
                  })
                }
              })
            }
          })
        }
      }), (0, e.drawText)({
        self: t,
        t: (0, e.cname)(o[a].name, 6),
        size: 14,
        pos: [r, l + 45],
        type: "btn"
      }))
    }, l = 0; l < 10; l++) r(l)
}

function p(t) {
  t.context.btn.clearRect((0, e.cx)(120), (0, e.cy)(111), (0, e.cwh)(170), (0, e.cwh)(90)), 10 == t.opt.th玩家.length ? (0, e.drawText)({
    self: t,
    size: 24,
    t: "房间人数已满",
    pos: [207, 131.5],
    type: "btn"
  }) : (0, e.drawText)({
    self: t,
    size: 24,
    t: "等待开始游戏",
    pos: [207, 131.5],
    type: "btn"
  }), (0, e.drawText)({
    self: t,
    size: 17,
    t: "游戏难度 : " + t.opt.game_level_s,
    pos: [207, 167],
    color: "#FCBA4B",
    type: "btn"
  }), (0, e.updatePlane)({
    self: t,
    type: "btn"
  })
}

function g(t, a, o) {
  for (var r = a.length, l = 54, n = 207 - (r * l + 20 * (r - 1)) / 2, s = (t.context.bg, function() {
      var r = n + 27 + 74 * i;
      (0, e.drawImageCenter)({
        self: t,
        round: !0,
        src: a[i].headimg,
        pos: [r, o, l, l],
        type: "bg",
        cb: function() {
          (0, e.drawImageCenter)({
            self: t,
            src: "res/2d/ava_square.png",
            pos: [r, o, 56, 56],
            type: "bg",
            imgid: t.imgid.bg
          })
        },
        imgid: t.imgid.bg,
        noupdate: !0
      }), (0, e.drawText)({
        self: t,
        t: (0, e.cname)(a[i].name, 6),
        size: 14,
        pos: [r, o + 45]
      })
    }), i = 0; i < r; i++) s()
}

function c(e, t, a, o, r, l) {
  l.beginPath(), l.moveTo(e, t + r - 1), l.lineTo(e, t + o - r), l.quadraticCurveTo(e, t + o, e + r, t + o), l.lineTo(e + a - r, t + o), l.quadraticCurveTo(e + a, t + o, e + a, t + o - r), l.lineTo(e + a, t), l.lineTo(e, t), l.stroke(), l.closePath()
}

function d(a, o) {
  console.log("renderRelayRankList :: ");
  a.sotedRankList = o;
  var r = a.sotedRankList.length * (0, e.cwh)(e.ListLineHeight) / e.Dpr,
    l = (0, e.cwh)(157) / e.Dpr;
  1 != a.opt.my_rank && (l = (0, e.cwh)(242) / e.Dpr), a.opt.isOutDate && (console.log("!!! isOutDate RankList"), l = (0, e.cwh)(300) / e.Dpr), console.log("!!! innerOffsetHeight: ", r, "outterOffsetHeight: ", l, "updatePosition: ", a.updatePosition.bind(a)), a.scrollHandler = new t.default({
    innerOffsetHeight: r,
    outterOffsetHeight: l,
    updatePosition: a.updatePosition.bind(a)
  }), f(a, 0, "list1")
}

function f(t, a, o) {
  var r = t.opt.isOutDate ? 20 : 0;
  "list1" == o ? t.imgid.list1++ : "list2" == o && t.imgid.list2++;
  var l = t.sotedRankList.slice(a, a + 10),
    n = t.context[o];
  if (n.clearRect(0, 0, e.WIDTH, 10 * (0, e.cwh)(e.ListLineHeight)), n.textBaseline = "middle", 0 == a || 0 != l.length) {
    if (!(a < 0)) {
      for (var s = l.length, i = function() {
          console.log(p);
          var n = (p + .5) * e.ListLineHeight,
            s = p + 1 + a,
            i = "";
          i = 1 == s ? "#ffd800" : "#888", (0, e.drawText)({
            self: t,
            bold: !0,
            italic: !0,
            size: 17,
            t: s,
            pos: [58.5 + r, n],
            type: o,
            color: i
          }), (0, e.drawImageCenter)({
            self: t,
            src: l[p].headimg,
            pos: [107 + r, n, 36, 36],
            type: o,
            cb: function() {
              (0, e.drawImageCenter)({
                self: t,
                src: "res/2d/ava_square.png",
                pos: [107 + r, n, 37, 37],
                type: o,
                imgid: t.imgid[o]
              })
            },
            round: !0,
            imgid: t.imgid[o],
            noupdate: !0
          }), (0, e.drawText)({
            self: t,
            align: "left",
            size: 17,
            bold: !0,
            t: (0, e.cname)(l[p].name, 14),
            pos: [144 + r, n],
            type: o
          })
        }, p = 0; p < s; p++) i();
      (0, e.updatePlane)({
        self: t,
        type: o
      })
    }
  } else(0, e.updatePlane)({
    self: t,
    type: o
  })
}
},{"../../config":37,"../../lib/mue/eventcenter":67,"../../scroll/scrollHandler":122,"./base":89}],99:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.draw分享Skin = function(i) {
  (0, e.routeCanvas)(i, "shareSkin"), (0, e.createPlane)(i),
  function(t) {
    t.imgid.bg++;
    var i = t.context.bg;
    i.clearRect(0, 0, e.WIDTH, e.HEIGHT), t.imgid.btn++, t.context.btn.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "rgba(0,0,0, 0.45)", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), i.lineWidth = 2 * e.Dpr, i.strokeStyle = "rgba(255,255,255,0.1)";
    var r = t.opt;
    (0, e.drawImageCenter)({
      self: t,
      src: "res/bl3.png",
      pos: [207, 154, 354, 124],
      type: "bg",
      imgid: t.imgid.bg,
      round: !0,
      radius: 2 * e.Dpr,
      cb: function() {
        var i = t.opt.gift_list.findIndex(n.bind(t)),
          r = t.opt.gift_list[i];
        (0, e.drawText)({
          self: t,
          size: 17,
          t: t.opt.nickname,
          pos: [62, 154],
          align: "left",
          type: "bg"
        }), r ? (0, e.drawText)({
          self: t,
          size: 17,
          t: "送出的 " + r.gift_name,
          pos: [62, 178],
          align: "left",
          type: "bg"
        }) : (0, e.drawText)({
          self: t,
          size: 17,
          t: "送出的礼包已被抢光",
          pos: [62, 178],
          align: "left",
          type: "bg"
        }), (0, e.drawImageCenter)({
          self: t,
          src: t.opt.headimg,
          pos: [86, 98, 47, 47],
          type: "bg",
          cb: function() {
            (0, e.drawImageCenter)({
              self: t,
              src: "res/2d/ava_square.png",
              pos: [86, 98, 48, 48],
              type: "bg",
              imgid: t.imgid.bg
            })
          },
          imgid: t.imgid.bg,
          noupdate: !0,
          round: !0
        })
      }
    }), (0, e.drawImageCenter)({
      self: t,
      src: "res/bl3.png",
      pos: [207, 407.5, 354, 343],
      type: "bg",
      imgid: t.imgid.bg,
      round: !0,
      radius: 2 * e.Dpr,
      cb: function() {
        (0, e.drawText)({
          self: t,
          size: 12,
          t: "共有" + r.total_gift + "份礼物，" + r.gift_list.length + "位好友领取",
          pos: [62, 260],
          align: "left",
          type: "bg"
        }), (0, e.drawLine)(30, 278, 384, 278, "rgba(255,255,255,0.1)", .5, i)
      }
    }), (0, e.drawImageCenter)({
      self: t,
      src: "res/2d/new_return.png",
      pos: [54, 674, 70, 70],
      type: "btn",
      imgid: t.imgid.btn
    }), (0, e.updatePlane)({
      self: t,
      type: "bg"
    })
  }(i), (0, e.updateClip)({
    self: i
  }),
  function(i) {
    var n, s = i.opt.gift_list.length * (0, e.cwh)(e.ListLineHeight) / e.Dpr;
    n = (0, e.cwh)(301) / e.Dpr, i.scrollHandler = new t.default({
      innerOffsetHeight: s,
      outterOffsetHeight: n,
      updatePosition: i.updatePosition.bind(i)
    }), r(i, 0, "list1")
  }(i)
}, exports.draw分享SkinList = r, exports.shareSkinEve = function(e, t, i) {
  if (t > 30 && t < 95 && i > 640 && i < 720) return e.opt.onReturn && e.opt.onReturn(), !1
};
var e = require("./base"),
  t = (i(require("../../store/storage")), i(require("../../scroll/scrollHandler")));

function i(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}

function r(t, i, r) {
  "list1" == r ? t.imgid.list1++ : "list2" == r && t.imgid.list2++;
  var n = t.opt.gift_list.slice(i, i + 12),
    s = t.context[r];
  if (s.clearRect(0, 0, e.WIDTH, 12 * (0, e.cwh)(e.ListLineHeight)), 0 == i || 0 != n.length) {
    if (!(i < 0)) {
      var a = n.length;
      console.log(n);
      for (var g = function() {
          l % 2 == 1 && (s.fillStyle = "rgba(255,255,255, 0.03)", s.fillRect(0, l * (0, e.cwh)(e.ListLineHeight), (0, e.cwh)(414), (0, e.cwh)(e.ListLineHeight)));
          var i = (l + .5) * e.ListLineHeight;
          (0, e.drawImageCenter)({
            round: !0,
            self: t,
            src: n[l].headimg,
            pos: [77, i, 34, 34],
            type: r,
            cb: function() {
              (0, e.drawImageCenter)({
                self: t,
                src: "res/ava_rank.png",
                pos: [77, i, 47, 47],
                type: r,
                imgid: t.imgid[r]
              })
            },
            imgid: t.imgid[r],
            noupdate: !0
          }), (0, e.drawText)({
            self: t,
            align: "left",
            size: 17,
            t: (0, e.cname)(n[l].nickname, 10),
            pos: [114, i],
            type: r
          }), (0, e.drawText)({
            self: t,
            size: 14,
            align: "right",
            t: "获得" + n[l].gift_name,
            pos: [320, i],
            type: r
          }), n[l].gift_icon && (0, e.drawImageCenter)({
            self: t,
            src: n[l].gift_icon,
            pos: [348, i, 28, 28],
            type: r,
            imgid: t.imgid[r]
          })
        }, l = 0; l < a; l++) g();
      (0, e.updatePlane)({
        self: t,
        type: r
      })
    }
  } else(0, e.updatePlane)({
    self: t,
    type: r
  })
}

function n(e, t, i) {
  return !0 === e.received
}
},{"../../scroll/scrollHandler":122,"../../store/storage":128,"./base":89}],100:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.drawSkin = function(t) {
  (0, e.routeCanvas)(t, "skinList"), (0, e.createPlane)(t),
  function(t) {
    t.imgid.btn++, t.imgid.bg++;
    var s = t.context.bg;
    s.clearRect(0, 0, e.WIDTH, e.HEIGHT);
    var i = t.context.btn;
    i.clearRect(0, 0, e.WIDTH, e.HEIGHT), s.fillStyle = "rgba(0,0,0, 0.45)", s.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.updatePlane)({
      self: t,
      type: "bg"
    }), (0, e.drawText)({
      self: t,
      size: 22,
      t: "皮肤中心",
      pos: [207, 89],
      type: "bg",
      bold: !0
    }), (0, e.drawImageCenter)({
      round: !0,
      radius: 2 * e.Dpr,
      self: t,
      src: "res/bl3.png",
      pos: [207, 372, 354, 492],
      type: "bg",
      imgid: t.imgid.bg,
      cb: function() {
        for (var s = t.opt.skin_list, r = function(r) {
            var n = Math.floor(r / 2),
              o = r % 2,
              l = 1;
            s[r].id == t.opt.id ? i.fillStyle = "#F7E6FF" : 0 == s[r].use_status ? (i.fillStyle = "#D1D1D1", l = .5) : 1 == s[r].use_status && (i.fillStyle = "#F7E6FF"), i.strokeStyle = "#ccc", (0, e.roundedRect)((0, e.cx)(50 + 167 * o), (0, e.cy)(157 + 187 * n), (0, e.cwh)(147), (0, e.cwh)(167), 2 * e.Dpr, i), i.fill(), (0, e.drawImageCenter)({
              self: t,
              src: s[r].img,
              pos: [124 + 167 * o, 220 + 187 * n, 33, 66],
              type: "btn",
              imgid: t.imgid.btn,
              alpha: l,
              cb: function() {
                0 == s[r].use_status && (0, e.drawText)({
                  self: t,
                  size: 17,
                  t: s[r].unlock_wording,
                  pos: [123 + 167 * o, 226 + 187 * n],
                  type: "btn"
                })
              }
            }), i.beginPath(), i.lineWidth = .5 * e.Dpr, i.strokeStyle = "rgba(0,0,0,0.1)", i.moveTo((0, e.cx)(50 + 167 * o), (0, e.cy)(271 + 187 * n)), i.lineTo((0, e.cx)(197 + 167 * o), (0, e.cy)(271 + 187 * n)), i.stroke(), s[r].id == t.opt.id ? (0, e.drawImageCenter)({
              self: t,
              src: "res/2d/sel.png",
              pos: [123 + 167 * o, 296 + 187 * n, 50, 42],
              type: "btn",
              imgid: t.imgid.btn
            }) : 0 == s[r].use_status ? (0, e.drawText)({
              self: t,
              size: 17,
              t: "待解锁",
              pos: [123 + 167 * o, 296 + 187 * n],
              type: "btn",
              color: "#3A3743"
            }) : 1 == s[r].use_status && (0, e.drawText)({
              self: t,
              size: 17,
              t: "使用",
              pos: [123 + 167 * o, 296 + 187 * n],
              type: "btn",
              color: "#3A3743"
            }), s[r].left_time && (0, e.drawText)({
              self: t,
              size: 10,
              t: "有效期" + Math.ceil(s[r].left_time / 3600 / 24) + "天",
              pos: [123 + 167 * o, 166 + 187 * n],
              type: "btn",
              color: "#888"
            })
          }, n = 0; n < s.length; n++) r(n)
      }
    }), (0, e.drawImageCenter)({
      self: t,
      src: "res/2d/new_return.png",
      pos: [54, 674, 70, 70],
      type: "btn",
      imgid: t.imgid.btn
    })
  }(t)
}, exports.skinListEve = function(t, e, s, i) {
  if (e > 30 && e < 95 && s > 640 && s < 720) return t.opt.onReturn && t.opt.onReturn(), !1;
  if (e > 30 && e < 384 && s > 86 && s < 618) {
    0;
    var r = Math.floor((s + 0 - 157) / 177),
      n = Math.floor(e / 207),
      o = 2 * r + n;
    return t.opt.skin_list[o] && t.opt.onClick使用 && t.opt.onClick使用(t.opt.skin_list[o]), !1
  }
}, exports.updateSkin使用Status = function(t) {
  for (var i = t.opt.skin_list, r = i.findIndex(s.bind(t)), n = 0; n < i.length; n++) {
    var o = Math.floor(n / 2),
      l = n % 2,
      a = t.context.btn;
    1 == i[n].use_status && (a.fillStyle = "#F7E6FF", a.fillRect((0, e.cx)(90 + 167 * l), (0, e.cy)(276 + 187 * o), (0, e.cwh)(80), (0, e.cwh)(45)), n == r ? (0, e.drawImageCenter)({
      self: t,
      src: "res/2d/sel.png",
      pos: [123 + 167 * l, 296 + 187 * o, 50, 42],
      type: "btn",
      imgid: t.imgid.btn
    }) : (0, e.drawText)({
      self: t,
      size: 17,
      t: "使用",
      pos: [123 + 167 * l, 296 + 187 * o],
      type: "btn",
      color: "#555"
    }))
  }
};
var t, e = require("./base");
(t = require("../../scroll/scrollHandler")) && t.__esModule;

function s(t, e, s) {
  return t.id === this.opt.new_id
}
},{"../../scroll/scrollHandler":122,"./base":89}],101:[function(require,module,exports){
(Object.defineProperty(exports, "__esModule", {
  value: !0,
}),
  (exports.drawStartPage = function (e) {
    (e.imgid.btn++,
      e.imgid.bg++,
      (0, r.routeCanvas)(e, "start"),
      (0, r.createPlane)(e));
    var o = e.context.bg;
    (o.clearRect(0, 0, r.WIDTH, r.HEIGHT),
      (o.fillStyle = "rgba(0,0,0, 0.3)"),
      o.fillRect(0, 0, r.WIDTH, r.HEIGHT),
      (0, r.drawImageCenter)({
        self: e,
        src: "res/title.png",
        pos: [204, 168, 207, 52],
        type: "bg",
        imgid: e.imgid.bg,
      }),
      e.context["btn"].clearRect(0, 0, r.WIDTH, r.HEIGHT),
      (0, r.drawImageCenter)({
        self: e,
        src: "res/play.png",
        pos: [207, 505, 212, 84],
        type: "btn",
        imgid: e.imgid.btn,
      }),
      e.opt.hideRank ||
        (
        //   (0, r.drawText)({
        //   t: "多人游戏",
        //   self: e,
        //   size: 17,
        //   pos: [163, 571],
        //   align: "left",
        // }),
        // (0, r.drawImageCenter)({
        //   self: e,
        //   src: "res/r_arr.png",
        //   pos: [247, 571, 6.6, 10],
        //   type: "bg",
        //   imgid: e.imgid.bg,
        // }),
        (o.fillStyle = "rgba(0,0,0, 0.15)"),
        o.fillRect(0, (0, r.cy)(617), r.WIDTH, (0, r.cwh)(250)),
        // (0, r.drawImageCenter)({
        //   self: e,
        //   src: "res/2d/rank.png",
        //   pos: [111.5, 671, 74, 74],
        //   type: "btn",
        //   imgid: e.imgid.btn,
        // }),
        // (0, r.drawImageCenter)({
        //   self: e,
        //   src: "res/2d/msg.png",
        //   pos: [207.5, 671, 74, 74],
        //   type: "btn",
        //   imgid: e.imgid.btn,
        // }),
        // (0, r.drawImageCenter)({
        //   self: e,
        //   src: "res/2d/skin.png",
        //   pos: [303.5, 671, 74, 74],
        //   type: "btn",
        //   imgid: e.imgid.btn,
        // }),
        // (0, r.drawText)({
        //   t: "排行榜",
        //   self: e,
        //   size: 12,
        //   pos: [111.5, 711.5],
        // }),
        // (0, r.drawText)({
        //   t: "消息",
        //   self: e,
        //   size: 12,
        //   pos: [207.5, 711.5],
        // }),
        // (0, r.drawText)({
        //   t: "皮肤中心",
        //   self: e,
        //   size: 12,
        //   pos: [303.5, 711.5],
        // }),
        t.default.on(n.EVENT.INIT_SETTING_COMPLETE, function () {
          ((0, i.create使用rInfoButton)(
            "多人游戏",
            0,
            {
              x: 207,
              y: 571,
              width: 140,
              height: 40,
            },
            function () {
              e.options.newRelay && e.options.newRelay();
            },
          ),
            (0, i.create使用rInfoButton)(
              "消息",
              0,
              {
                x: 207,
                y: 680,
                width: 74,
                height: 94,
              },
              function () {
                e.opt.onMsgBox && e.opt.onMsgBox();
              },
            ));
        })));
    1 == e.opt.banType &&
      ((o.lineWidth = 1),
      (o.strokeStyle = "rgba(0,0,0,0.7)"),
      (o.fillStyle = "rgba(0,0,0,0.7)"),
      (0, r.roundedRect)(
        (0, r.cx)(30),
        (0, r.cy)(258),
        (0, r.cwh)(354),
        (0, r.cwh)(196),
        4,
        o,
      ),
      o.fill(),
      (0, r.drawText)({
        t: "游戏中存在可疑操作，存疑分数",
        self: e,
        size: 17,
        pos: [207, 310],
      }),
      (0, r.drawText)({
        t: "将不在排行榜中显示。",
        self: e,
        size: 17,
        pos: [207, 336],
      }),
      (0, r.drawImageCenter)({
        self: e,
        src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJNNcIVa8Pr2VajbZ52iaZX9Vlib0QAKEJGDIV8F9iaFeqXoawUbQkDP8zc6fbm95nKLgw/0?wx_fmt=png",
        pos: [207, 401, 138, 44],
        type: "bg",
        imgid: e.imgid.bg,
      }),
      (0, r.drawText)({
        t: "我要申诉",
        self: e,
        size: 15,
        pos: [207, 401],
      }));
    (0, r.updatePlane)({
      self: e,
      type: "bg",
    });
  }),
  (exports.drawStartUpdate = function (e) {
    var t = e.context.btn;
    ((t.fillStyle = "red"),
      t.beginPath(),
      t.arc((0, r.cx)(230), (0, r.cy)(650), (0, r.cwh)(5), 0, 2 * Math.PI),
      t.stroke(),
      t.fill(),
      (0, r.updatePlane)({
        self: e,
        type: "btn",
      }));
  }),
  (exports.startEve = function (e, t, i) {
    if ((console.log(t, i), t > 86 && t < 318 && i > 458 && i < 552))
      return (e.options.onClickStart && e.options.onClickStart(), !1);
    if (!e.opt.hideRank && t > 83 && t < 139 && i > 643 && i < 726)
      return (e.options.onShowFriend第 && e.options.onShowFriendRank(), !1);
    if (!e.opt.hideRank && t > 157 && t < 257 && i > 552 && i < 591)
      return (e.options.newRelay && e.options.newRelay(), !1);
    if (1 == e.opt.banType && t > 128 && t < 286 && i > 369 && i < 433)
      return ((0, o.routeVerify)(e), !1);
    if (!e.opt.hideRank && t > 179 && t < 235 && i > 643 && i < 726)
      return (e.opt.onMsgBox && e.opt.onMsgBox(), !1);
    if (!e.opt.hideRank && t > 275 && t < 331 && i > 643 && i < 726)
      return (e.opt.onBottleSkin && e.opt.onBottleSkin(), !1);
  }));
var e,
  t =
    (e = require("../../lib/mue/eventcenter")) && e.__esModule
      ? e
      : {
          default: e,
        },
  i = require("../../network/getAuth"),
  n = require("../../config"),
  r = require("./base"),
  o = require("./verify");

},{"../../config":37,"../../lib/mue/eventcenter":67,"../../network/getAuth":72,"./base":89,"./verify":102}],102:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.clickVerifyForm = o, exports.routeVerify = i, exports.verifyEve = function(t, a, r) {
  if (a > 130 && a < 280 && r > 607 && r < 640) return t.opt.verify_step >= 4 ? (t.opt.banType = 2, t.lastCanvasType == e.CANVASTYPE.gameOver ? t.showGameOverPage(t.opt) : t.showStartPage(t.opt)) : i(t), !1;
  if (a > 130 && a < 280 && r > 670 && r < 720) return t.opt.verify_step = 0, back(this) == e.CANVASTYPE.gameOver ? t.showGameOverPage(t.opt) : t.showStartPage(t.opt), !1;
  if (3 == t.opt.verify_step && a > 130 && a < 370 && r > 240 && r < 300) return o(t, "name"), !1;
  if (3 == t.opt.verify_step && a > 130 && a < 370 && r > 300 && r < 360) return o(t, "mobile"), !1
};
var e = require("./base"),
  t = require("../../network/network");

function i(i) {
  i.opt.verify_step = i.opt.verify_step || 0;
  var o = i.opt.verify_step;
  0 == o ? ((0, e.createPlane)(i), (0, e.routeCanvas)(i, "verify"), function(t) {
    t.imgid.bg++;
    var i = t.context.bg;
    i.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "#555", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawText)({
      self: t,
      t: "游戏申诉",
      size: 30,
      pos: [207, 153]
    }), (0, e.drawText)({
      self: t,
      t: "我们需要验证你的玩家身份",
      size: 16,
      pos: [207, 496],
      color: "rgba(255,255,255,0.4)"
    }), (0, e.drawText)({
      self: t,
      t: "将会有专人与你联系",
      size: 16,
      pos: [207, 518],
      color: "rgba(255,255,255,0.4)"
    }), (0, e.drawText)({
      self: t,
      t: "第一步：Submit11份自拍照片",
      size: 20,
      pos: [207, 450],
      color: "white"
    }), (0, e.drawImageCenter)({
      self: t,
      src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJNNcIVa8Pr2VeiaWDZj6rCViaLsuSCWtnyo1mvNqBR05HxPZ5oXTzl0ODXjWiakTvq6yw/0?wx_fmt=png",
      pos: [207, 329, 139, 139],
      type: "bg",
      imgid: t.imgid.bg
    }), (0, e.drawImageCenter)({
      self: t,
      src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJNNcIVa8Pr2VajbZ52iaZX9Vlib0QAKEJGDIV8F9iaFeqXoawUbQkDP8zc6fbm95nKLgw/0?wx_fmt=png",
      pos: [207, 621, 138, 44],
      type: "bg",
      imgid: t.imgid.bg
    }), (0, e.drawText)({
      self: t,
      t: "提交自拍",
      size: 15,
      pos: [207, 621]
    }), (0, e.drawText)({
      self: t,
      t: "退出申诉",
      size: 17,
      pos: [197, 690]
    }), (0, e.drawImageCenter)({
      self: t,
      src: "res/r_arr.png",
      pos: [247, 690, 6.5, 12.5],
      type: "bg",
      imgid: t.imgid.bg
    }), (0, e.updatePlane)({
      self: t,
      type: "bg"
    })
  }(i), i.opt.verify_step++) : 1 == o ? (! function(t) {
    wx.chooseImage({
      count: 1,
      sizeType: ["original", "compressed"],
      sourceType: ["album", "camera"],
      success: function(i) {
        t.opt.path = i.tempFilePaths[0],
          function(t) {
            var i = t.context.bg;
            i.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "#555", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawText)({
              self: t,
              t: "拍摄完成",
              size: 30,
              pos: [207, 117]
            }), (0, e.drawText)({
              self: t,
              t: "照片已存档，仅供身份识别",
              size: 14,
              pos: [207, 158]
            }), (0, e.drawImageCenter)({
              self: t,
              src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJNNcIVa8Pr2VajbZ52iaZX9Vlib0QAKEJGDIV8F9iaFeqXoawUbQkDP8zc6fbm95nKLgw/0?wx_fmt=png",
              pos: [207, 621, 138, 44],
              type: "bg",
              imgid: t.imgid.bg
            }), (0, e.drawText)({
              self: t,
              t: "下第一步",
              size: 15,
              pos: [207, 621]
            }), (0, e.drawText)({
              self: t,
              t: "退出申诉",
              size: 17,
              pos: [197, 690]
            }), (0, e.drawImageCenter)({
              self: t,
              src: "res/r_arr.png",
              pos: [247, 690, 6.5, 12.5],
              type: "bg",
              imgid: t.imgid.bg
            });
            var o = new Image;
            o.onload = function() {
              console.log(o.width, o.height);
              var i = 240,
                a = 320;
              o.width / o.height > .75 ? a = o.height / o.width * i : i = o.width / o.height * a, console.log(i, a), (0, e.drawImageCenter)({
                self: t,
                src: t.opt.path,
                pos: [207, 388, i, a],
                type: "bg",
                imgid: t.imgid.bg
              })
            }, o.src = t.opt.path, (0, e.updatePlane)({
              self: t,
              type: "bg"
            })
          }(t)
      },
      fail: function(e) {
        t.opt.verify_step = 0
      }
    })
  }(i), i.opt.verify_step++) : 2 == o ? function(i) {
    if (i.opt.loading) return;
    i.opt.loading = !0, wx.show加载中({
      title: "上传中..."
    }), (0, t.upLoadVerifyPic)({
      path: i.opt.path,
      succ: function(t) {
        i.opt.fileid = t, i.opt.verify_step++,
          function(t) {
            var i = t.context.bg;
            i.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "#555", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "#888", i.fillRect(0, (0, e.cy)(206), (0, e.cwh)(414), (0, e.cwh)(215)), (0, e.drawText)({
              self: t,
              t: "第二步：请填写联系方式",
              size: 20,
              pos: [207, 117]
            }), (0, e.drawLine)(30, 299, 384, 299, "rgba(255,255,255,0.4)", .5, i), (0, e.drawLine)(30, 364, 384, 364, "rgba(255,255,255,0.4)", .5, i), (0, e.drawText)({
              self: t,
              t: "姓th",
              align: "left",
              size: 17,
              pos: [30, 277],
              color: "rgba(255,255,255,1)"
            }), (0, e.drawText)({
              self: t,
              t: "手机号码",
              align: "left",
              size: 17,
              pos: [30, 342],
              color: "rgba(255,255,255,1)"
            }), (0, e.drawText)({
              self: t,
              t: "请填写",
              align: "left",
              size: 17,
              pos: [138, 277],
              color: "rgba(255,255,255,0.3)"
            }), (0, e.drawText)({
              self: t,
              t: "请填写",
              align: "left",
              size: 17,
              pos: [138, 342],
              color: "rgba(255,255,255,0.3)"
            }), (0, e.drawImageCenter)({
              self: t,
              src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJNNcIVa8Pr2VajbZ52iaZX9Vlib0QAKEJGDIV8F9iaFeqXoawUbQkDP8zc6fbm95nKLgw/0?wx_fmt=png",
              pos: [207, 621, 138, 44],
              type: "bg",
              imgid: t.imgid.bg
            }), (0, e.drawText)({
              self: t,
              t: "下第一步",
              size: 15,
              pos: [207, 621]
            }), (0, e.drawText)({
              self: t,
              t: "退出申诉",
              size: 17,
              pos: [197, 690]
            }), (0, e.drawImageCenter)({
              self: t,
              src: "res/r_arr.png",
              pos: [247, 690, 6.5, 12.5],
              type: "bg",
              imgid: t.imgid.bg
            }), (0, e.updatePlane)({
              self: t,
              type: "bg"
            })
          }(i)
      },
      complete: function() {
        i.opt.loading = !1, wx.hide加载中()
      }
    })
  }(i) : 3 == o && function(i) {
    if (!i.opt.mobile || !i.opt.name) return void wx.showToast({
      title: "请填写完整信息",
      icon: "none"
    });
    if (i.opt.loading) return;
    i.opt.loading = !0, (0, t.upLoadVerifySubmit)({
      name: i.opt.name,
      mobile: i.opt.mobile,
      fileid: i.opt.fileid,
      is_async: i.lastCanvasType == e.CANVASTYPE.start ? 1 : 0,
      succ: function() {
        ! function(t) {
          var i = t.context.bg;
          i.clearRect(0, 0, e.WIDTH, e.HEIGHT), i.fillStyle = "#555", i.fillRect(0, 0, e.WIDTH, e.HEIGHT), (0, e.drawText)({
            self: t,
            t: "提交成功",
            size: 30,
            pos: [207, 237]
          }), (0, e.drawText)({
            self: t,
            t: "请耐心等待客服与你联系",
            size: 14,
            pos: [207, 278],
            color: "rgba(255,255,255,0.4)"
          }), (0, e.drawText)({
            self: t,
            t: "如有疑问，可关注“微信小游戏”官方公众号进行咨询",
            size: 14,
            pos: [207, 298],
            color: "rgba(255,255,255,0.4)"
          }), (0, e.drawImageCenter)({
            self: t,
            src: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJNNcIVa8Pr2VajbZ52iaZX9Vlib0QAKEJGDIV8F9iaFeqXoawUbQkDP8zc6fbm95nKLgw/0?wx_fmt=png",
            pos: [207, 621, 138, 44],
            type: "bg",
            imgid: t.imgid.bg
          }), (0, e.drawText)({
            self: t,
            t: "完成",
            size: 15,
            pos: [207, 621]
          }), (0, e.updatePlane)({
            self: t,
            type: "bg"
          })
        }(i), i.opt.verify_step++
      },
      complete: function() {
        i.opt.loading = !1
      }
    })
  }(i)
}

function o(t, i) {
  console.log(t.opt.showkey), t.opt.showkey || (t.opt.showkey = !0, wx.showKeyboard({
    defaultValue: t.opt[i] || "",
    maxLength: 20,
    multiple: !1,
    confirmType: "done",
    complete: function() {}
  }), wx.onKeyboardComplete((function(o) {
    t.opt.showkey = !1, t.opt[i] = o.value;
    var a = t.context.bg;
    a.fillStyle = "#888", "name" == i ? (a.fillRect((0, e.cx)(135), (0, e.cy)(262), (0, e.cwh)(250), (0, e.cwh)(30)), (0, e.drawText)({
      self: t,
      t: (0, e.cname)(t.opt.name || "请填写", 20),
      align: "left",
      size: 17,
      pos: [138, 277],
      color: t.opt.name ? "#fff" : "rgba(255,255,255,0.3)"
    })) : (a.fillRect((0, e.cx)(135), (0, e.cy)(327), (0, e.cwh)(250), (0, e.cwh)(30)), (0, e.drawText)({
      self: t,
      t: (0, e.cname)(t.opt.mobile || "请填写", 20),
      align: "left",
      size: 17,
      pos: [138, 342],
      color: t.opt.mobile ? "#fff" : "rgba(255,255,255,0.3)"
    })), (0, e.updatePlane)({
      self: t,
      type: "bg"
    }), wx.offKeyboardComplete()
  })))
}
},{"../../network/network":73,"./base":89}],103:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(t) {
      e(this, i), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.viewer = this.game.viewer, this.name = "game"
    }
    return t(i, [{
      key: "show",
      value: function(e) {
        this.UI.show本次得分(), this.UI.reset本次得分Pos(), this.UI.scoreText.changeStyle({
          textAlign: "left"
        }), this.viewer.open(), e && e.usingProp && this.UI.showProp(e.usingProp)
      }
    }, {
      key: "hide",
      value: function() {
        this.viewer.close(), this.UI.hideProp(), this.UI.hideAdAvator(), this.UI.hide本次得分()
      }
    }]), i
  }();
exports.default = i;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],104:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../../../@babel/runtime/helpers/toArray"),
  r = require("../../../@babel/runtime/helpers/objectSpread2"),
  i = require("../../../@babel/runtime/helpers/toConsumableArray"),
  a = require("../../../@babel/runtime/helpers/classCallCheck"),
  o = require("../../../@babel/runtime/helpers/createClass"),
  s = (require("../../lib/animation"), function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var r = n(t);
    if (r && r.has(e)) return r.get(e);
    var i = {},
      a = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var o in e)
      if ("default" !== o && Object.prototype.hasOwnProperty.call(e, o)) {
        var s = a ? Object.getOwnPropertyDescriptor(e, o) : null;
        s && (s.get || s.set) ? Object.defineProperty(i, o, s) : i[o] = e[o]
      } i.default = e, r && r.set(e, i)
  }(require("../../lib/three")), (e = require("../../control/propertyCtrl")) && e.__esModule ? e : {
    default: e
  });

function n(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    r = new WeakMap;
  return (n = function(e) {
    return e ? r : t
  })(e)
}
var u = function() {
  function e(t) {
    var r = t.game,
      i = t.onGoRecord,
      o = t.onReturn,
      s = t.onLike;
    a(this, e), this.game = r, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.onGoRecord = i, this.onReturn = o, this.onLike = s
  }
  return o(e, [{
    key: "updateProfilePraiseStatus",
    value: function(e) {
      var a = this,
        o = i(this.data.praise_info.headimg_list);
      o.findIndex((function(e) {
        return e == a.data.headimg
      })) < 0 && o.push(this.data.headimg);
      var n = {
        praise_info: r(r({}, this.data.praise_info), {}, {
          is_already_praise: e,
          praise_count: this.data.praise_info.praise_count + 1,
          total_praise_count: this.data.praise_info.total_praise_count + 1,
          headimg_list: o
        })
      };
      if (this.data && this.data.is_self && 10 == n.praise_info.praise_count) {
        var u = s.default.getPropsData() || [];
        u.push({
          property_id: "fake",
          item_id: 1
        }), n.propsData = {
          property_list: u
        }, setTimeout((function() {
          s.default.getProps()
        }), 1e3)
      } else n.propsData = {
        property_list: s.default.getPropsData()
      };
      if (n.propsData && Array.isArray(n.propsData.property_list)) {
        var l = t(n.propsData.property_list).slice(0);
        n.propsData.property_list = l.filter((function(e) {
          return 1 == e.item_id
        }))
      }
      this.full2D.updateProfilePraise && this.full2D.updateProfilePraise(n)
    }
  }, {
    key: "show",
    value: function(e) {
      this.game.full2D.hide2D(), this.data = e, this.full2D.showProfile(r(r({}, e), {}, {
        onReturn: this.onReturn,
        onRecord: this.onGoRecord,
        onLike: this.onLike
      }))
    }
  }, {
    key: "onClickHide",
    value: function() {
      this.onReturn()
    }
  }, {
    key: "hide",
    value: function() {
      this.game.full2D.hide2D()
    }
  }]), e
}();
exports.default = u;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../../@babel/runtime/helpers/objectSpread2":20,"../../../@babel/runtime/helpers/toArray":26,"../../../@babel/runtime/helpers/toConsumableArray":27,"../../control/propertyCtrl":51,"../../lib/animation":66,"../../lib/three":70}],105:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  s = function() {
    function s(t) {
      e(this, s), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "loading"
    }
    return t(s, [{
      key: "show",
      value: function(e) {
        this.full2D.showRelayRoom({
          th玩家: [],
          imgdata: "",
          game_status: 0,
          my_seat_no: e ? 1 : 0,
          room_owner_seat: 1,
          is_fake: 1
        })
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), s
  }();
exports.default = s;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],106:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  s = function() {
    function s(t) {
      e(this, s), this.game = t, this.name = "game", this.full2D = this.game.full2D, this.UI = this.game.UI
    }
    return t(s, [{
      key: "show",
      value: function() {
        this.UI.resetRelayPos(), this.UI.scoreText.changeStyle({
          textAlign: "left"
        }), this.UI.show本次得分()
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D(), this.UI.hide本次得分(), this.UI.reset本次得分Pos(), this.UI.scoreText.obj.scale.set(1, 1, 1), this.UI.scoreText.changeStyle({
          textAlign: "left"
        })
      }
    }, {
      key: "hide本次得分",
      value: function() {
        this.UI.hide本次得分(), this.UI.reset本次得分Pos(), this.UI.scoreText.changeStyle({
          textAlign: "left"
        })
      }
    }]), s
  }();
exports.default = s;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],107:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  a = function() {
    function a(t) {
      e(this, a), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "relayRoom"
    }
    return t(a, [{
      key: "show",
      value: function(e) {
        var t = {
          th玩家: e.playerlist,
          imgdata: e.room_wxa_code || "",
          game_status: e.game_status || 0,
          my_seat_no: e.my_seat_no,
          room_owner_seat: e.room_owner_seat,
          game_level: e.game_level || 0
        };
        console.log("显示房间数据"), this.full2D.showRelayRoom(t)
      }
    }, {
      key: "hide",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
          t = e.hide2D || !1;
        t && this.full2D.hide2D()
      }
    }]), a
  }();
exports.default = a;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],108:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../../@babel/runtime/helpers/createClass"),
  t = require("../pages2d/base"),
  s = require("../../lib/animation"),
  o = (require("../../config"), function(e, i) {
    if (!i && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var t = r(i);
    if (t && t.has(e)) return t.get(e);
    var s = {},
      o = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var n in e)
      if ("default" !== n && Object.prototype.hasOwnProperty.call(e, n)) {
        var a = o ? Object.getOwnPropertyDescriptor(e, n) : null;
        a && (a.get || a.set) ? Object.defineProperty(s, n, a) : s[n] = e[n]
      } s.default = e, t && t.set(e, s);
    return s
  }(require("../../lib/three")));

function r(e) {
  if ("function" != typeof WeakMap) return null;
  var i = new WeakMap,
    t = new WeakMap;
  return (r = function(e) {
    return e ? t : i
  })(e)
}
var n = function() {
  function r(i) {
    var t = i.game,
      s = i.onChangeProgress,
      o = i.onHide,
      n = i.on分享,
      a = i.week_best_score,
      h = i.onSave,
      c = i.is_self,
      u = i.is_from_share,
      g = i.onOpen分享Page,
      l = i.onClose分享Page,
      d = i.maxBonus本次得分,
      p = void 0 === d ? 1 : d,
      P = i.succeedTime,
      f = void 0 === P ? 0 : P;
    e(this, r), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.onHide = o, this.on分享 = n, this.onSave = h, this.onChangeProgress = s, this.week_best_score = a, this.is_self = c, this.is_from_share = u, this.onOpen分享Page = g, this.onClose分享Page = l, this.name = "reviewPage", this.maxBonus本次得分 = p, this.succeedTime = f;
    var m = this.changePositionPixel2DTo3D(31, 610);
    this.progressY = m.y, this.leftPositionStartX = m.x, this.rightPositionEndX = -m.x, this.barPositionCenter = this.leftPositionStartX + (Math.abs(this.leftPositionStartX) + this.rightPositionEndX) / 2, this.PositionRange = this.rightPositionEndX + Math.abs(this.leftPositionStartX)
  }
  return i(r, [{
    key: "changePositionPixel2DTo3D",
    value: function(e, i) {
      var s = (0, t.cx)(e),
        o = (0, t.cy)(i);
      return {
        x: (s - t.WIDTH / 2) / t.WIDTH * t.frustumSizeWidth,
        y: (t.HEIGHT / 2 - o) / t.HEIGHT * t.frustumSizeHeight
      }
    }
  }, {
    key: "changePositionCSS2DTo3D",
    value: function(e, i) {
      return {
        x: (e - t.W / 2) / t.W * t.frustumSizeWidth,
        y: (t.H / 2 - i) / t.H * t.frustumSizeHeight
      }
    }
  }, {
    key: "set本次得分Postion",
    value: function() {
      var e = this.changePositionPixel2DTo3D(40, 201);
      this.UI.scoreText.obj.position.x = e.x, this.UI.scoreText.obj.position.y = e.y, this.UI.scoreText.changeStyle({
        textAlign: "left"
      }), this.UI.show本次得分()
    }
  }, {
    key: "addProgressBar",
    value: function() {
      var e = new o.PlaneBufferGeometry(this.PositionRange, .3, 30);
      this.progress = new o.Object3D;
      var i = new o.CircleGeometry(.6, 40, 0, 2 * Math.PI),
        t = new o.CircleGeometry(.15, 15, 0, Math.PI);
      this.roundCircle = new o.Mesh(i, new o.MeshBasicMaterial({})), this.roundCircleBack = new o.Mesh(t, new o.MeshBasicMaterial({
        transparent: !0,
        opacity: .25,
        color: 16777215
      })), this.secondRoundCircle = new o.Mesh(t, new o.MeshBasicMaterial({})), this.secondRoundCircleBack = this.roundCircleBack.clone(), this.backgroundBar = new o.Mesh(e, new o.MeshBasicMaterial({
        transparent: !0,
        opacity: .15,
        color: 16777215
      })), this.progressBar = new o.Object3D, this.progressBar.add(new o.Mesh(e, new o.MeshBasicMaterial({
        transparent: !0
      }))), this.progressShadow = new o.Mesh(new o.PlaneGeometry(this.PositionRange, .15), new o.MeshBasicMaterial({
        transparent: !0,
        color: 16777215,
        opacity: .08
      })), this.progressShadow.position.set(0, .19, .1), this.progressBar.add(this.progressShadow), this.progress.add(this.roundCircleBack), this.secondRoundCircleBack.position.z = this.roundCircleBack.position.z = this.backgroundBar.position.z = -.1, this.progress.add(this.secondRoundCircleBack), this.progress.add(this.backgroundBar), this.progress.add(this.progressBar), this.roundCircle.rotation.z = this.roundCircleBack.rotation.z = -Math.PI / 2, this.roundCircleBack.position.x = this.rightPositionEndX, this.roundCircle.position.x = this.leftPositionStartX, this.secondRoundCircle.rotation.z = this.secondRoundCircleBack.rotation.z = Math.PI / 2, this.secondRoundCircle.position.x = this.secondRoundCircleBack.position.x = this.leftPositionStartX, this.progress.add(this.roundCircle), this.progress.add(this.secondRoundCircle), this.progress.position.set(0, this.progressY, 0), this.progressBar.scale.x = .01, this.progressBar.position.x = this.leftPositionStartX, this.backgroundBar.position.x = this.barPositionCenter, this.secondRoundCircle.position.x = this.leftPositionStartX, this.game.camera.add(this.progress)
    }
  }, {
    key: "getDataByPercent",
    value: function(e) {
      var i = this.totalGameTime,
        t = .01,
        s = this.leftPositionStartX,
        o = i,
        r = this.leftPositionStartX;
      return i && (o = i - i * e, t = e, s += this.PositionRange * e / 2, r = this.PositionRange * e + this.leftPositionStartX), {
        restTime: o,
        roundPositionX: r,
        scaleX: t,
        positionX: s
      }
    }
  }, {
    key: "startProgressBarFrom",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : .01,
        i = this.getDataByPercent(e),
        t = i.restTime,
        o = i.scaleX,
        r = i.positionX,
        n = i.roundPositionX;
      this.progressBar.scale.x = o, this.progressBar.position.x = r, this.roundCircle.position.x = n, this.stopAnimation(), s.customAnimation.to(this.progressBar.scale, t / 1e3, {
        x: 1,
        name: "progress",
        onComplete: function() {}
      }), s.customAnimation.to(this.progressBar.position, t / 1e3, {
        x: this.barPositionCenter,
        name: "progress"
      }), s.customAnimation.to(this.roundCircle.position, t / 1e3, {
        x: this.rightPositionEndX,
        name: "progress"
      })
    }
  }, {
    key: "setProgressBarPostionByPercent",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : .01,
        i = this.getDataByPercent(e),
        t = (i.restTime, i.scaleX),
        s = i.positionX,
        o = i.roundPositionX;
      this.progressBar.scale.x = t, this.progressBar.position.x = s, this.roundCircle.position.x = o
    }
  }, {
    key: "stopAnimation",
    value: function() {
      s.TweenAnimation.kill("progress")
    }
  }, {
    key: "inPositionRange",
    value: function(e, i, t, s) {
      return t - 3 < e && e < t + 3 && s - 3 < i && i < s + 3
    }
  }, {
    key: "onStartChangeProgress",
    value: function() {
      this.stopAnimation(), this.isChangingProgress = !0
    }
  }, {
    key: "onMoveProgress",
    value: function(e) {
      if (this.isChangingProgress) {
        var i = e.changedTouches[0].pageX,
          t = e.changedTouches[0].pageY,
          s = this.changePositionCSS2DTo3D(i, t);
        this.leftPositionStartX < s.x && s.x < this.rightPositionEndX && this.setProgressBarPostionByPercent((s.x + Math.abs(this.leftPositionStartX)) / this.PositionRange)
      }
    }
  }, {
    key: "onEndChangeProgress",
    value: function() {
      if (this.isChangingProgress) {
        this.isChangingProgress = !1;
        var e = (this.roundCircle.position.x + Math.abs(this.leftPositionStartX)) / this.PositionRange;
        this.onChangeProgress(e)
      }
    }
  }, {
    key: "doTouchStartEvent",
    value: function(e) {
      var i = e.changedTouches[0].pageX,
        t = e.changedTouches[0].pageY,
        s = this.changePositionCSS2DTo3D(i, t);
      this.inPositionRange(s.x, s.y, this.roundCircle.position.x, this.roundCircle.position.y + this.progressY) && this.onStartChangeProgress(), this.full2D.doTouchStartEvent(e)
    }
  }, {
    key: "doTouchMoveEvent",
    value: function(e) {
      this.isChangingProgress && this.onMoveProgress(e)
    }
  }, {
    key: "doTouchEndEvent",
    value: function(e) {
      this.onEndChangeProgress(), this.isChangingProgress = !1, this.full2D.doTouchEndEvent(e)
    }
  }, {
    key: "show",
    value: function(e, i) {
      var t = this,
        s = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : .01,
        o = this;
      this.totalGameTime = i, this.set本次得分Postion(), this.showRecordPage = function() {
        t.game.full2D.showRecordPage({
          headimg: e.headimg,
          is_self: o.is_self,
          is_from_share: o.is_from_share,
          on分享: function() {
            o.onOpen分享Page()
          }
        })
      }, this.showRecordPage(), this.addProgressBar(), this.startProgressBarFrom(s)
    }
  }, {
    key: "onClickHide",
    value: function() {
      this.onHide()
    }
  }, {
    key: "pause",
    value: function() {
      this.game.full2D.hide2D(), this.hide3D()
    }
  }, {
    key: "continue",
    value: function() {
      this.showRecordPage(), this.addProgressBar(), this.set本次得分Postion()
    }
  }, {
    key: "hide3D",
    value: function() {
      this.game.UI.hide本次得分(), this.game.UI.scoreText.obj.position.y = 21, this.game.UI.scoreText.obj.position.x = this.leftPositionStartX, this.game.camera.remove(this.progress)
    }
  }, {
    key: "hide",
    value: function() {
      this.stopAnimation(), this.game.full2D.hide2D(), this.hide3D()
    }
  }]), r
}();
exports.default = n;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../config":37,"../../lib/animation":66,"../../lib/three":70,"../pages2d/base":89}],109:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass");
require("../pages2d/base"), require("../../lib/animation"), require("../../config"),
  function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = r(t);
    if (i && i.has(e)) return i.get(e);
    var o = {},
      a = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var n in e)
      if ("default" !== n && Object.prototype.hasOwnProperty.call(e, n)) {
        var s = a ? Object.getOwnPropertyDescriptor(e, n) : null;
        s && (s.get || s.set) ? Object.defineProperty(o, n, s) : o[n] = e[n]
      } o.default = e, i && i.set(e, o)
  }(require("../../lib/three"));

function r(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (r = function(e) {
    return e ? i : t
  })(e)
}
var i = function() {
  function r(t) {
    var i = t.game,
      o = t.on分享,
      a = t.week_best_score,
      n = t.onSave,
      s = t.headimg,
      u = t.onClose分享Page,
      h = t.maxBonus本次得分,
      c = void 0 === h ? 1 : h,
      l = t.succeedTime,
      f = void 0 === l ? 0 : l;
    e(this, r), this.game = i, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.on分享 = o, this.onSave = n, this.week_best_score = a, this.headimg = s, this.name = "review分享Page", this.maxBonus本次得分 = c, this.succeedTime = f, this.onClose分享Page = u
  }
  return t(r, [{
    key: "show",
    value: function(e) {
      var t = this,
        r = e.qrcode,
        i = void 0 === r ? "" : r,
        o = e.open_playback_id,
        a = void 0 === o ? "" : o;
      this.game.full2D.showRecord分享Page({
        headimg: this.headimg,
        score: this.week_best_score,
        combo: this.maxBonus本次得分,
        blocks: this.succeedTime,
        qrcode: i,
        onClose: function() {
          t.game.full2D.hide2D(), t.onClose分享Page()
        },
        onSave: function(e) {
          t.onSave(e)
        },
        on分享: function() {
          t.on分享(a)
        }
      })
    }
  }, {
    key: "hide",
    value: function() {
      this.stopAnimation(), this.game.full2D.hide2D(), this.hide3D()
    }
  }]), r
}();
exports.default = i;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../config":37,"../../lib/animation":66,"../../lib/three":70,"../pages2d/base":89}],110:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../../@babel/runtime/helpers/classCallCheck"),
  n = require("../../@babel/runtime/helpers/createClass");
(e = require("../store/storage")) && e.__esModule;
var i = window.devicePixelRatio > 2 ? 2 : window.devicePixelRatio,
  a = (window.innerHeight < window.innerWidth ? window.innerHeight : window.innerWidth, window.innerHeight > window.innerWidth ? window.innerHeight : window.innerWidth, wx.loadFont("res/num.ttf")),
  r = function() {
    function e(n) {
      t(this, e), this.texture = {}, this.material = {}
    }
    return n(e, [{
      key: "get分享Card",
      value: function(e, t) {
        e = e || {};
        this.canvas || (this.canvas = document.createElement("canvas"), this.context = this.canvas.getContext("2d"), this.canvas.width = 693, this.canvas.height = 558);
        var n = this.context;
        if ("shareBattle" == e.type) {
          n.fillStyle = "white", n.fillRect(0, 0, 693, 558);
          var i = this;
          this._drawImageCanvas1("res/changlle_share.png", 0, 0, 693, 558, "share", (function() {
            n.fillStyle = "rgba(0,0,0,0.8)", n.font = "180px ".concat(a), n.textBaseline = "middle", n.textAlign = "center", n.fillText(e.score || 0, 356.5, 334.8), t && t(i.canvas)
          }))
        }
        if ("history" == e.type) {
          n.fillStyle = "white", n.fillRect(0, 0, 693, 558);
          i = this;
          this._drawImageCanvas1("res/high_score.png", 0, 0, 693, 558, "share", (function() {
            n.fillStyle = "#00c777", n.font = "180px ".concat(a), n.textBaseline = "middle", n.textAlign = "center", n.fillText(e.score || 0, 356.5, .68 * 558), t && t(i.canvas)
          }))
        }
        if ("week" == e.type || "skin" == e.type) {
          n.fillStyle = "white", n.fillRect(0, 0, 693, 558);
          i = this;
          this._drawImageCanvas1("res/high_score_week.png", 0, 0, 693, 558, "share", (function() {
            n.fillStyle = "#00c777", n.font = "180px ".concat(a), n.textBaseline = "middle", n.textAlign = "center", n.fillText(e.score || 0, 356.5, .68 * 558), t && t(i.canvas)
          }))
        }
      }
    }, {
      key: "_smallReat",
      value: function() {
        for (var e = this.context, t = ["red", "blue", "green", "yellow", "skyblue"], n = 0; n < t.length; n++) {
          e.fillStyle = t[n];
          for (var i = 0; i < 5; i++) e.fillRect(553 * Math.random(), 691 * Math.random(), 15, 15)
        }
      }
    }, {
      key: "_drawImageCanvas",
      value: function(e, t, n, i, a, r, l) {
        var s = new Image,
          o = this;
        s.onload = function() {
          o.context.drawImage(s, t - i / 2, n - a / 2, i, a), l && l(o.canvas)
        }, s.onerror = function() {
          l && l(o.canvas)
        }, s.src = e
      }
    }, {
      key: "_drawImageCanvas1",
      value: function(e, t, n, i, a, r, l) {
        "/0" != e && "/96" != e && "/64" != e && e || (e = "res/ava.png");
        var s = new Image,
          o = this;
        s.onload = function() {
          o.context.drawImage(s, t, n, i, a), l && l(o.canvas)
        }, s.onerror = function() {
          l && l(o.canvas)
        }, s.src = e
      }
    }]), e
  }();
exports.default = r;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../store/storage":128}],111:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(t) {
      var s = t.game,
        n = t.onReturn,
        h = t.on分享,
        o = t.on分享Skin,
        r = t.bottle_skin,
        a = void 0 === r ? {} : r;
      e(this, i), this.game = s, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.on分享 = h, this.onReturn = n, this.bottle_skin = a, this.on分享Skin = o
    }
    return t(i, [{
      key: "show",
      value: function(e, t) {
        this.full2D.showGetNewSkin({
          poster: this.bottle_skin.poster,
          desc: this.bottle_skin.desc,
          onReturn: this.onReturn,
          on分享Gift: this.on分享,
          on分享Skin: this.on分享Skin
        })
      }
    }, {
      key: "hide",
      value: function() {
        this.game.full2D.hide2D()
      }
    }]), i
  }();
exports.default = i;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],112:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../../../@babel/runtime/helpers/classCallCheck"),
  l = require("../../../@babel/runtime/helpers/createClass"),
  i = (e = require("../../lib/mue/eventcenter")) && e.__esModule ? e : {
    default: e
  },
  r = require("../../config");
var u = function() {
  function e(l) {
    t(this, e), this.game = l, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "startPage"
  }
  return l(e, [{
    key: "show",
    value: function(e) {
      this.full2D.showRelayBeginner()
    }
  }, {
    key: "hide",
    value: function() {
      i.default.emitSync(r.EVENT.SKIP_RELAY_GUIDE), this.full2D.hide2D()
    }
  }]), e
}();
exports.default = u;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../config":37,"../../lib/mue/eventcenter":67}],113:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(t, s) {
      e(this, i), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.onProfile = s, this.name = "friendRankList"
    }
    return t(i, [{
      key: "show",
      value: function() {
        this.full2D.showFriendRankList({
          week_best_score: this.model.weekBest本次得分,
          onProfile: this.onProfile
        })
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), i
  }();
exports.default = i;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],114:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../../@babel/runtime/helpers/createClass"),
  o = function() {
    function o(t) {
      e(this, o), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "singleSettlementPgae"
    }
    return t(o, [{
      key: "show",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
          t = 0,
          o = "",
          a = function() {},
          n = null,
          i = null,
          r = function() {};
        e && e.banType && (t = e.banType || 0), e.bottle_skin && e.bottle_skin.icon && (o = e.bottle_skin.icon, this.game.reporter.rpGetSkinSettle()), e.onClickBottleSkin && (a = e.onClickBottleSkin), e.onRewardAdGetProp && (n = e.onRewardAdGetProp, i = e.onShowRewardAd), e.onShowBannerAd && (r = e.onShowBannerAd), this.data = e;
        var s = this.model.current本次得分,
          l = this.model.getHighest本次得分(),
          d = this.model.startTime,
          h = this.model.weekBest本次得分,
          g = this.game.historyTimes.getTimes(),
          u = wx.getStorageSync("ad") || {};
        console.log("ad :", u);
        var m = "";
        if (u.t && n) {
          var c = new Date(u.t),
            f = new Date;
          !e.no_ad && u.ad_reward_quota && c.getMonth() == f.getMonth() && c.getDate() == f.getDate() ? m = "reward" : !e.no_ad && u.ad_banner_quota && c.getMonth() == f.getMonth() && c.getDate() == f.getDate() && (m = "banner")
        }
        if (this.full2D || this.game.handleWxOnError({
            message: "can not find full 2D gameOverPage",
            stack: ""
          }), this.full2D) {
          var w = {
            score: s,
            highest_score: l,
            start_time: d,
            week_best_score: h,
            game_cnt: g,
            banType: t,
            bottle_skin_icon: o,
            ad_type: m,
            onClickBottleSkin: a,
            onRewardAdGetProp: n,
            onShowBannerAd: r,
            onShowRewardAd: i
          };
          this.model.adInfo && this.model.adInfo.advertisingInfo && this.model.adInfo.advertisingInfo.isShowing && (w.advertise = {
            score: this.model.adInfo.advertisingInfo.score,
            icon_url: this.model.adInfo.advertisingInfo.trademark_url,
            url: this.model.adInfo.advertisingInfo.ad_url
          }, this.game.reporter.rpAdGameOver()), this.full2D.showGameOverPage(w), GameGlobal.matchType || (s > l ? this.game.reporter.historyBest() : s > h && this.game.reporter.weekBest())
        }
      }
    }, {
      key: "showAdReward",
      value: function(e) {
        var t = this;
        this.full2D.showJiLiAdGetPropPage({
          icon: e,
          onReturn: function() {
            t.data.no_ad = !0, t.show(t.data)
          }
        })
      }
    }, {
      key: "hide",
      value: function() {
        this.full2D.hide2D()
      }
    }]), o
  }();
exports.default = o;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8}],115:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../../@babel/runtime/helpers/createClass"),
  t = require("../../chat"),
  o = require("../../network/getAuth"),
  r = window.innerHeight < window.innerWidth ? window.innerHeight : window.innerWidth,
  s = window.innerHeight > window.innerWidth ? window.innerHeight : window.innerWidth,
  h = function() {
    function h(i) {
      e(this, h), this.game = i, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.UI = this.game.UI, this.viewer = this.game.viewer, this.name = "game"
    }
    return i(h, [{
      key: "show",
      value: function(e) {
        var i = this;
        console.log("!!! show", e);
        var h = this.model.is_from_wn,
          n = this.model.firstBlood;
        h || this.game.guider || (n ? this.viewer.lookers.showLookers({
          avaImg: !1,
          icon: !0,
          wording: !0
        }) : this.viewer.open(), (0, o.create使用rInfoButton)("邀请围观", 1, {
          x: 0,
          y: .88 * s,
          width: .13 * r,
          height: .12 * s
        }, (function() {
          i.game.gameCtrl.shareObservCard()
        }))), this.UI.show本次得分(), this.UI.reset本次得分Pos(), this.UI.scoreText.changeStyle({
          textAlign: "left"
        }), e && e.usingProp && this.UI.showProp(e.usingProp), GameGlobal.matchType ? (0, t.showMiniGameCenter)() : (0, t.hideMiniGameCenter)()
      }
    }, {
      key: "hide",
      value: function() {
        this.viewer.close(), this.UI.hide本次得分(), this.UI.hideChampion本次得分(), this.UI.hideProp(), this.UI.hideAdAvator()
      }
    }, {
      key: "hideLookers分享",
      value: function() {
        this.model.firstBlood && (this.model.setFirstBlood(!1), this.viewer.open())
      }
    }]), h
  }();
exports.default = h;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../chat":35,"../../network/getAuth":72}],116:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../../../@babel/runtime/helpers/objectSpread2"),
  i = require("../../../@babel/runtime/helpers/classCallCheck"),
  s = require("../../../@babel/runtime/helpers/createClass"),
  l = (e = require("../../lib/mue/eventcenter")) && e.__esModule ? e : {
    default: e
  },
  r = require("../../config"),
  a = require("../../chat");
var n = function() {
  function e(t, s, l) {
    i(this, e), this.game = t, this.model = this.game.gameModel, this.full2D = this.game.full2D, this.name = "startPage", this.onMsg = s, this.onSkin = l
  }
  return s(e, [{
    key: "show",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
      e.hideRank= this.model.firstBlood, this.full2D && this.full2D.showStartPage(t(t({}, e), {}, {
        onBottleSkin: this.onSkin.bind(this),
        onMsgBox: this.onMsg.bind(this)
      })), this.model.firstBlood = !1, l.default.emit(r.EVENT.AFTER_SHOWN_START_PAGE, {}), (0, a.showMiniGameCenter)()
    }
  }, {
    key: "upDateRedPot",
    value: function() {
      this.full2D.updateStartPage()
    }
  }, {
    key: "hide",
    value: function() {
      (0, a.hideMiniGameCenter)(), this.full2D.hide2D()
    }
  }]), e
}();
exports.default = n;
},{"../../../@babel/runtime/helpers/classCallCheck":7,"../../../@babel/runtime/helpers/createClass":8,"../../../@babel/runtime/helpers/objectSpread2":20,"../../chat":35,"../../config":37,"../../lib/mue/eventcenter":67}],117:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  r = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var r = n(t);
    if (r && r.has(e)) return r.get(e);
    var i = {},
      o = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var a in e)
      if ("default" !== a && Object.prototype.hasOwnProperty.call(e, a)) {
        var s = o ? Object.getOwnPropertyDescriptor(e, a) : null;
        s && (s.get || s.set) ? Object.defineProperty(i, a, s) : i[a] = e[a]
      } i.default = e, r && r.set(e, i);
    return i
  }(require("../lib/three")),
  i = require("../config");

function n(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    r = new WeakMap;
  return (n = function(e) {
    return e ? r : t
  })(e)
}
var o = function() {
  function n(t, o, a, s, u, l) {
    e(this, n);
    var f = new r.PlaneBufferGeometry(s, u),
      c = new r.MeshBasicMaterial({
        map: i.loader.load(l),
        transparent: !0
      });
    this.obj = new r.Mesh(f, c), this.obj.visible = !0, this.obj.position.y = o || 0, this.obj.position.z = a || 0, this.obj.position.x = t || 0
  }
  return t(n, [{
    key: "rotate",
    value: function() {
      var e = this,
        t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0;
      this.timer || (this.timer = setInterval((function() {
        e.obj.rotation.z += t
      }), 20))
    }
  }, {
    key: "destroy",
    value: function() {
      this.timer && (clearInterval(this.timer), this.timer = null)
    }
  }]), n
}();
exports.default = o;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/three":70}],118:[function(require,module,exports){
var e;
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.setRandomSeed = exports.random = void 0;
exports.setRandomSeed = function(r) {
  e = r
};
var r = function() {
  return e = (9301 * e + 49297) % 233280, Math.floor(e / 233280 * 100) / 100
};
exports.random = function() {
  if (0 === arguments.length) return r();
  if (1 === arguments.length) {
    var e = arguments[0];
    return Math.floor(r() * e)
  }
  var t = arguments[0],
    o = arguments[1];
  return Math.floor(r() * (o - t)) + t
};
},{}],119:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t, e = require("../@babel/runtime/helpers/classCallCheck"),
  i = require("../@babel/runtime/helpers/createClass"),
  a = function(t, e) {
    if (!e && t && t.__esModule) return t;
    if (null === t || "object" != typeof t && "function" != typeof t) return {
      default: t
    };
    var i = n(e);
    if (i && i.has(t)) return i.get(t);
    var a = {},
      r = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var o in t)
      if ("default" !== o && Object.prototype.hasOwnProperty.call(t, o)) {
        var s = r ? Object.getOwnPropertyDescriptor(t, o) : null;
        s && (s.get || s.set) ? Object.defineProperty(a, o, s) : a[o] = t[o]
      } a.default = t, i && i.set(t, a);
    return a
  }(require("./lib/three")),
  r = (require("./config"), (t = require("./text")) && t.__esModule ? t : {
    default: t
  }),
  o = require("./lib/animation"),
  s = require("./network/getAuth");

function n(t) {
  if ("function" != typeof WeakMap) return null;
  var e = new WeakMap,
    i = new WeakMap;
  return (n = function(t) {
    return t ? i : e
  })(t)
}

function h(t, e, i, a, r, o) {
  return t.moveTo(e, i + o), t.lineTo(e, i + r - o), t.quadraticCurveTo(e, i + r, e + o, i + r), t.lineTo(e + a - o, i + r), t.quadraticCurveTo(e + a, i + r, e + a, i + r - o), t.lineTo(e + a, i + o), t.quadraticCurveTo(e + a, i, e + a - o, i), t.lineTo(e + o, i), t.quadraticCurveTo(e, i, e, i + o), t
}
var u = function() {
  function t(i) {
    e(this, t), this.game = i, this.seed = 0, this.startDist = 0, this.hitPoint = {
      uuid: "",
      ready: !1,
      texture: null
    }, this.loader = new a.TextureLoader, this.text = new r.default("超越！", {
      fillStyle: 2434341,
      chinese: !0,
      textAlign: "center"
    });
    var o = new a.Shape;
    o = h(o, -1.365, -1.365, 2.73, 2.73, .5);
    var s = new a.Shape;
    s = h(s, -1.3, -1.3, 2.6, 2.6, .5);
    var n = new a.ShapeGeometry(s);
    ! function(t) {
      t.computeBoundingBox();
      var e = t.boundingBox.max,
        i = t.boundingBox.min,
        r = new a.Vector2(0 - i.x, 0 - i.y),
        o = new a.Vector2(e.x - i.x, e.y - i.y),
        s = t.faces;
      t.faceVertexUvs[0] = [];
      for (var n = 0; n < s.length; n++) {
        var h = t.vertices[s[n].a],
          u = t.vertices[s[n].b],
          c = t.vertices[s[n].c];
        t.faceVertexUvs[0].push([new a.Vector2((h.x + r.x) / o.x, (h.y + r.y) / o.y), new a.Vector2((u.x + r.x) / o.x, (u.y + r.y) / o.y), new a.Vector2((c.x + r.x) / o.x, (c.y + r.y) / o.y)])
      }
      t.uvsNeedUpdate = !0
    }(n), this.avatorFrame = new a.Mesh(n, new a.MeshBasicMaterial({
      transparent: !0,
      opacity: 1
    })), this.avatorOuter = new a.Mesh(new a.ShapeGeometry(o), new a.MeshBasicMaterial({
      color: 16777215,
      transparent: !0,
      opacity: 1
    })), this.text.obj.scale.set(.8, .8, .8), this.text.obj.position.set(0, 2.2, .1), this.avatorFrame.position.set(0, 0, .1), this.avatorFrame.material.opacity = 0, this.avatorOuter.position.set(0, 0, 0), this.avatorOuter.material.opacity = 0, this.text.material.opacity = 0, this.obj = new a.Object3D, this.text.obj.visible = !1, this.obj.add(this.avatorOuter), this.obj.add(this.avatorFrame), this.obj.add(this.text.obj), this.obj.rotateY(-Math.PI / 4), this.obj.rotateX(-Math.PI / 16 * 3), this.game.scene.add(this.obj), this.obj.visible = !1
  }
  return i(t, [{
    key: "update",
    value: function() {
      s.scope.wxFriendInteraction && this.game.gameModel.位好友本次得分 && this.game.gameModel.位好友本次得分.length && (this.seed++, this.hitPoint.uuid == this.game.currentBlock.obj.uuid && this.hitPoint.ready && this.hitPoint.texture && (this.startDist < 2 && (this.startDist++, this.text.obj.visible = !0), this.playAnimate(), this.seed = 0), this.seed >= 5 && this.check本次得分())
    }
  }, {
    key: "check本次得分",
    value: function() {
      var t = this.game.UI.score,
        e = this.game.gameModel.位好友本次得分;
      try {
        for (var i = 0; i < e.length; i++)
          if (e[i].week_best_score == t) {
            this.hitPoint.uuid = this.game.nextBlock.obj.uuid, this.hitPoint.ready = !1, this.animateAvator(e[i]);
            break
          }
      } catch (t) {
        console.log("RankSystem check本次得分 err:", t)
      }
    }
  }, {
    key: "animateAvator",
    value: function(t) {
      var e = this;
      this.loader.load(t.headimg, (function(t) {
        e.hitPoint.uuid == e.game.nextBlock.obj.uuid && (e.hitPoint.ready = !0, t.minFilter = a.LinearFilter, e.hitPoint.texture = t)
      }))
    }
  }, {
    key: "playAnimate",
    value: function() {
      var t = this;
      this.game.bottle.change本次得分Pos(3);
      var e = this.game.bottle.obj.position.clone(),
        i = e.x,
        a = e.z;
      this.obj.position.set(i, 10, a), this.avatorFrame.material.map = this.hitPoint.texture, this.obj.visible = !0, o.customAnimation.to(this.obj.position, .4, {
        y: 13
      }), o.customAnimation.to(this.text.material, .4, {
        opacity: 1
      }), o.customAnimation.to(this.avatorOuter.material, .4, {
        opacity: 1
      }), o.customAnimation.to(this.avatorFrame.material, .4, {
        opacity: 1
      }), o.customAnimation.to(this.text.material, .4, {
        opacity: 0,
        delay: .6,
        onComplete: function() {
          t.resetAvator(), t.game.bottle.change本次得分Pos(0)
        }
      }), o.customAnimation.to(this.avatorOuter.material, .4, {
        opacity: 0,
        delay: .6
      }), o.customAnimation.to(this.avatorFrame.material, .4, {
        opacity: 0,
        delay: .6
      }), this.hitPoint.uuid = "", this.hitPoint.ready = !1, this.hitPoint.texture = null
    }
  }, {
    key: "resetAvator",
    value: function() {
      this.obj.visible = !1, this.text.obj.visible = !1, this.avatorFrame.material.opacity = 0, this.avatorFrame.material.map && this.avatorFrame.material.map.dispose(), this.avatorFrame.material.map = "", this.avatorOuter.material.opacity = 0, this.text.material.opacity = 0
    }
  }, {
    key: "reset",
    value: function() {
      this.seed = 0, this.seed = 0, this.startDist = 0, this.startDist = 0, this.hitPoint = {
        uuid: "",
        ready: !1,
        texture: null
      }, this.obj.visible = !1
    }
  }]), t
}();
exports.default = u;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./config":37,"./lib/animation":66,"./lib/three":70,"./network/getAuth":72,"./text":130}],120:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../../@babel/runtime/helpers/classCallCheck"),
  e = require("../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i(e) {
      t(this, i), this._drag = e, this._dragLog = Math.log(e), this._x = 0, this._v = 0, this._startTime = 0
    }
    return e(i, [{
      key: "set",
      value: function(t, e) {
        this._x = t, this._v = e, this._startTime = (new Date).getTime()
      }
    }, {
      key: "x",
      value: function(t) {
        var e;
        return void 0 === t && (t = ((new Date).getTime() - this._startTime) / 1e3), e = t === this._dt && this._powDragDt ? this._powDragDt : this._powDragDt = Math.pow(this._drag, t), this._dt = t, this._x + this._v * e / this._dragLog - this._v / this._dragLog
      }
    }, {
      key: "dx",
      value: function(t) {
        var e;
        return void 0 === t && (t = ((new Date).getTime() - this._startTime) / 1e3), e = t === this._dt && this._powDragDt ? this._powDragDt : this._powDragDt = Math.pow(this._drag, t), this._dt = t, this._v * e
      }
    }, {
      key: "done",
      value: function() {
        return Math.abs(this.dx()) < 3
      }
    }]), i
  }();
exports.default = i;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8}],121:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../@babel/runtime/helpers/createClass"),
  s = n(require("./friction")),
  e = n(require("./spring"));

function n(t) {
  return t && t.__esModule ? t : {
    default: t
  }
}
var r = function() {
  function n(i) {
    t(this, n), this._extent = i, this._friction = new s.default(.01), this._spring = new e.default(1, 90, 20), this._startTime = 0, this._springing = !1, this._springOffset = 0
  }
  return i(n, [{
    key: "set",
    value: function(t, i) {
      this._friction.set(t, i), t > 0 && i >= 0 ? (this._springOffset = 0, this._springing = !0, this._spring.snap(t), this._spring.setEnd(0)) : t < -this._extent && i <= 0 ? (this._springOffset = 0, this._springing = !0, this._spring.snap(t), this._spring.setEnd(-this._extent)) : this._springing = !1, this._startTime = (new Date).getTime()
    }
  }, {
    key: "x",
    value: function(t) {
      if (!this._startTime) return 0;
      if (t || (t = ((new Date).getTime() - this._startTime) / 1e3), this._springing) return this._spring.x() + this._springOffset;
      var i = this._friction.x(t),
        s = this.dx(t);
      return i < -this._extent && s <= 0 && (this._springing = !0, this._spring.setEnd(0, s), i < -this._extent ? this._springOffset = -this._extent : this._springOffset = 0, i = this._spring.x() + this._springOffset), i
    }
  }, {
    key: "dx",
    value: function(t) {
      var i = 0;
      return i = this._lastTime === t ? this._lastDx : this._springing ? this._spring.dx(t) : this._friction.dx(t), this._lastTime = t, this._lastDx = i, i
    }
  }, {
    key: "done",
    value: function() {
      return this._springing ? this._spring.done() : this._friction.done()
    }
  }, {
    key: "setExtent",
    value: function(t) {
      this._extent = t
    }
  }]), n
}();
exports.default = r;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"./friction":120,"./spring":123}],122:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t, i = require("../../@babel/runtime/helpers/classCallCheck"),
  e = require("../../@babel/runtime/helpers/createClass"),
  s = (t = require("./scroll")) && t.__esModule ? t : {
    default: t
  };
var n = function() {
  function t(e) {
    i(this, t), e = e || {}, this._options = e, this._itemSize = e.itemSize || 0, this._innerOffsetHeight = e.innerOffsetHeight || 0, this._outterOffsetHeight = e.outterOffsetHeight || 0, this._extent = this._innerOffsetHeight - this._outterOffsetHeight, this._position = e.position || 0, this._scroll = new s.default(this._extent), this.updatePosition()
  }
  return e(t, [{
    key: "onTouchStart",
    value: function() {
      this._startPosition = this._position, this._lastChangePos = this._startPosition, this._startPosition > 0 ? this._startPosition /= .5 : this._startPosition < -this._extent && (this._startPosition = (this._startPosition + this._extent) / .5 - this._extent), this._animation && (this._animation.cancel(), this._scrolling = !1), this.updatePosition()
    }
  }, {
    key: "onTouchMove",
    value: function(t, i) {
      var e = this._startPosition;
      (e += i) > 0 ? e *= .5 : e < -this._extent && (e = .5 * (e + this._extent) - this._extent), this._position = e, this.updatePosition()
    }
  }, {
    key: "onTouchEnd",
    value: function(t, i, e) {
      var s = this;
      this._scroll.set(this._position, e.y), this._scrolling = !0, this._lastChangePos = this._position, this._animation = this.animation(this._scroll, (function() {
        var t = (Date.now() - s._scroll._startTime) / 1e3,
          i = s._scroll.x(t);
        i > 0 && s._extent < 0 && (i = 0), s._position = i, s.updatePosition()
      }), (function() {
        s._scrolling = !1
      }))
    }
  }, {
    key: "scrollTo",
    value: function(t) {
      this._animation && (this._animation.cancel(), this._scrolling = !1), "number" == typeof t && (this._position = -t), this._position < -this._extent ? this._position = -this._extent : this._position > 0 && (this._position = 0), this.updatePosition()
    }
  }, {
    key: "updatePosition",
    value: function() {
      this._options.updatePosition(this._position)
    }
  }, {
    key: "animation",
    value: function(t, i, e) {
      var s = {
        id: 0,
        cancelled: !1
      };
      return function i(e, s, n, o) {
        if (!e || !e.cancelled) {
          n(s);
          var h = t.done();
          h || e.cancelled || (e.id = requestAnimationFrame(i.bind(null, e, s, n, o))), h && o && o(s)
        }
      }(s, t, i, e), {
        cancel: function(t) {
          t && t.id && cancelAnimationFrame(t.id), t && (t.cancelled = !0)
        }.bind(null, s),
        model: t
      }
    }
  }, {
    key: "setInnerHeight",
    value: function(t, i) {
      this._innerOffsetHeight = t, this._extent = this._innerOffsetHeight - this._outterOffsetHeight, this._scroll.setExtent(this._extent)
    }
  }]), t
}();
exports.default = n;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"./scroll":121}],123:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../../@babel/runtime/helpers/classCallCheck"),
  i = require("../../@babel/runtime/helpers/createClass"),
  s = function() {
    function s(i, e, o) {
      t(this, s), this._m = i, this._k = e, this._c = o, this._solution = null, this._endPosition = 0, this._startTime = 0
    }
    return i(s, [{
      key: "_solve",
      value: function(t, i) {
        var s = this._c,
          e = this._m,
          o = this._k,
          n = s * s - 4 * e * o;
        if (0 == n) {
          var h = t,
            a = i / ((l = -s / (2 * e)) * t);
          return {
            x: function(t) {
              return (h + a * t) * Math.pow(Math.E, l * t)
            },
            dx: function(t) {
              var i = Math.pow(Math.E, l * t);
              return l * (h + a * t) * i + a * i
            }
          }
        }
        if (n > 0) {
          var r = (-s - Math.sqrt(n)) / (2 * e),
            u = (-s + Math.sqrt(n)) / (2 * e);
          h = t - (a = (i - r * t) / (u - r));
          return {
            x: function(t) {
              var i, s;
              return t === this._t && (i = this._powER1T, s = this._powER2T), this._t = t, i || (i = this._powER1T = Math.pow(Math.E, r * t)), s || (s = this._powER2T = Math.pow(Math.E, u * t)), h * i + a * s
            },
            dx: function(t) {
              var i, s;
              return t === this._t && (i = this._powER1T, s = this._powER2T), this._t = t, i || (i = this._powER1T = Math.pow(Math.E, r * t)), s || (s = this._powER2T = Math.pow(Math.E, u * t)), h * r * i + a * u * s
            }
          }
        }
        var l, _ = Math.sqrt(4 * e * o - s * s) / (2 * e);
        h = t, a = (i - (l = -s / 2 * e) * t) / _;
        return {
          x: function(t) {
            return Math.pow(Math.E, l * t) * (h * Math.cos(_ * t) + a * Math.sin(_ * t))
          },
          dx: function(t) {
            var i = Math.pow(Math.E, l * t),
              s = Math.cos(_ * t),
              e = Math.sin(_ * t);
            return i * (a * _ * s - h * _ * e) + l * i * (a * e + h * s)
          }
        }
      }
    }, {
      key: "x",
      value: function(t) {
        return null == t && (t = ((new Date).getTime() - this._startTime) / 1e3), this._solution ? this._endPosition + this._solution.x(t) : 0
      }
    }, {
      key: "dx",
      value: function(t) {
        return null == t && (t = ((new Date).getTime() - this._startTime) / 1e3), this._solution ? this._solution.dx(t) : 0
      }
    }, {
      key: "setEnd",
      value: function(t, i, s) {
        if (s || (s = (new Date).getTime()), t != this._endPosition || !this.almostZero(i, .4)) {
          i = i || 0;
          var e = this._endPosition;
          this._solution && (this.almostZero(i, .4) && (i = this._solution.dx((s - this._startTime) / 1e3)), e = this._solution.x((s - this._startTime) / 1e3), this.almostZero(i, .4) && (i = 0), this.almostZero(e, .4) && (e = 0), e += this._endPosition), this._solution && this.almostZero(e - t, .4) && this.almostZero(i, .4) || (this._endPosition = t, this._solution = this._solve(e - this._endPosition, i), this._startTime = s)
        }
      }
    }, {
      key: "snap",
      value: function(t) {
        this._startTime = (new Date).getTime(), this._endPosition = t, this._solution = {
          x: function() {
            return 0
          },
          dx: function() {
            return 0
          }
        }
      }
    }, {
      key: "done",
      value: function(t) {
        return t || (t = (new Date).getTime()), this.almostEqual(this.x(), this._endPosition, .4) && this.almostZero(this.dx(), .4)
      }
    }, {
      key: "almostEqual",
      value: function(t, i, s) {
        return t > i - s && t < i + s
      }
    }, {
      key: "almostZero",
      value: function(t, i) {
        return this.almostEqual(t, 0, i)
      }
    }]), s
  }();
exports.default = s;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8}],124:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.分享RelayCard = function(e) {
  return u.apply(this, arguments)
}, exports.分享RelayLiveCard = function(e) {
  return l.apply(this, arguments)
}, exports.分享ReviewCard = function(e) {
  var t = e.open_playback_id,
    a = e.headimg,
    r = e.cb;
  e.playback_poster;
  wx.update分享Menu({
    with分享Ticket: !0,
    success: function() {
      wx.shareAppMessage({
        title: "快来看看我的精彩回放！",
        query: "mode=reviewPage&open_playback_id=".concat(t, "&headimg=").concat(a),
        imageUrl: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJD1yfAwp8hgmBhTVR0ZoYKwhfUCTo3oOUpibmSNogexQs3IvzE5kTnfT2PR53VwR6tw/0?wx_fmt=png",
        success: function(e) {
          r(!0, 1)
        },
        fail: function(e) {
          r(!1)
        }
      })
    }
  })
}, exports.pure分享 = function(e, t) {
  s.get分享Card({
    type: e,
    score: t
  }, (function(t) {
    var a = "";
    try {
      a = t.toTempFilePathSync()
    } catch (e) {
      console.log("pure分享: ", e)
    }
    var r = "";
    r = "rank" == e ? "跳遍天下，已无敌手" : "shareBattle" == e ? "快来挑战我的战绩" : "不好意思，又破纪录了", wx.shareAppMessage({
      title: r,
      imageUrl: a,
      success: function(e) {},
      fail: function(e) {}
    })
  }))
}, exports.shareBattle = function(a, r) {
  var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : function() {},
    c = arguments.length > 3 ? arguments[3] : void 0,
    u = arguments.length > 4 ? arguments[4] : void 0;
  s.get分享Card({
    score: r,
    type: "shareBattle"
  }, function() {
    var r = t(e().mark((function t(r) {
      var s, l, p, f, h, d;
      return e().wrap((function(e) {
        for (;;) switch (e.prev = e.next) {
          case 0:
            s = "";
            try {
              s = r.toTempFilePathSync()
            } catch (e) {
              console.log("shareBattle: ", e)
            }
            if (a) {
              e.next = 4;
              break
            }
            return e.abrupt("return");
          case 4:
            if (l = (0, o.getSystemInfo)(), p = function() {
                wx.update分享Menu({
                  with分享Ticket: !0,
                  success: function() {
                    console.log("mode=battle&pkId=" + a), n(!0, a, 1), wx.shareAppMessage({
                      title: "小试牛刀，不服来战",
                      query: "mode=battle&pkId=" + a,
                      imageUrl: s
                    })
                  },
                  fail: function(e) {
                    console.error("shareBattle update分享Menu fail:", e), n(!1, a)
                  }
                })
              }, !wx.shareAppMessageToGroup || "ios" !== l.platform && "android" !== l.platform) {
              e.next = 24;
              break
            }
            return f = "", e.prev = 8, e.next = 11, (0, i.getChatToolInfo)(a, 2, (function(e) {
              console.log("!!! shareBattle getChatToolInfo success", e), "battle" !== c.mode && u.changeMode("battleCtrl", {
                query: {
                  pkId: a
                }
              })
            }));
          case 11:
            h = e.sent, f = h.activity_id, e.next = 20;
            break;
          case 15:
            return e.prev = 15, e.t0 = e.catch(8), console.error("!!! shareBattle getChatToolInfo fail", e.t0), null !== e.t0 && void 0 !== e.t0 && null !== (d = e.t0.errMsg) && void 0 !== d && d.includes("fail cancel") ? console.log("!!! 用户主动取消分享") : p(), e.abrupt("return");
          case 20:
            console.log("activity_id", f), wx.update分享Menu({
              with分享Ticket: !0,
              isUpdatableMessage: !0,
              activityId: f,
              useForChatTool: !0,
              chooseType: 2,
              templateInfo: {
                templateId: "2A84254B945674A2F88CE4970782C402795EB607"
              },
              success: function() {
                console.log("mode=battle&pkId=" + a), wx.shareAppMessageToGroup({
                  title: "擂台挑战赛",
                  imageUrl: s,
                  path: "?mode=battle&pkId=" + a,
                  success: function(e) {
                    console.log("shareAppMessageToGroup success", e), n(!0, a, 1)
                  },
                  fail: function(e) {
                    console.error("shareAppMessageToGroup fail:", e), n(!1, a)
                  }
                })
              },
              fail: function(e) {
                console.error("shareBattle update分享Menu fail:", e), n(!1, a)
              }
            }), e.next = 25;
            break;
          case 24:
            p();
          case 25:
          case "end":
            return e.stop()
        }
      }), t, null, [
        [8, 15]
      ])
    })));
    return function(e) {
      return r.apply(this, arguments)
    }
  }())
}, exports.shareGiftCard = function(e) {
  wx.shareAppMessage({
    title: "领取皮肤",
    query: "mode=getGiftPage&id=" + e,
    imageUrl: "http://mmbiz.qpic.cn/mmbiz_jpg/icTdbqWNOwNTTiaKet81gQJF2kbzlGb8r41QlLdiacISXtmPusJQKVhWuK2MuCaWUgroa8iaruibAI6XGR0iaheoHEibA/0?wx_fmt=jpeg",
    success: function() {}
  })
}, exports.shareGroup第= function() {
  var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : function() {};
  wx.getNetworkType({
    success: function(t) {
      "none" !== t.networkType ? wx.update分享Menu({
        with分享Ticket: !0,
        success: function() {
          wx.shareAppMessage({
            title: "群雄逐鹿，看看你第几",
            query: "mode=group分享",
            imageUrl: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNQ0ia79enzYJBrAavqMRykpovYxSA9RRTwIjde6a68ZCczLMBBd8eSoOyTRyp2Codc5IObdeqZVFyw/0?wx_fmt=png",
            success: function(t) {
              e(!0, 1)
            },
            fail: function(t) {
              e(!1)
            }
          })
        }
      }) : (e(!1), wx.showModal({
        title: "提示",
        content: "网络状态异常",
        show取消: !1
      }))
    }
  })
}, exports.shareObserve = function() {
  var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
    t = e.bottle_skin_id,
    n = void 0 === t ? "" : t,
    i = e.skin_id,
    c = void 0 === i ? "" : i,
    s = e.skin_sn,
    u = void 0 === s ? "" : s,
    l = e.cb,
    p = void 0 === l ? function() {} : l,
    f = r.default.getMy使用rInfo();
  f || (f = {
    nickname: "",
    headimg: ""
  });
  var h = "gameId=".concat(a.default.gameId, "&mode=observe&version=").concat(o.VERSION, "&skin_id=").concat(c, "&skin_sn=").concat(u, "&bottle_skin_id=").concat(n, "&nick姓th=").concat(f.nickname, "&headimg=").concat(f.headimg);
  console.log(h), wx.update分享Menu({
    with分享Ticket: !0,
    success: function() {
      p(!0, 1), wx.shareAppMessage({
        title: "即刻起跳，速来围观",
        query: h,
        imageUrl: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNQ0ia79enzYJBiaBtXsYrvBsYBdBdDtKE7y638J84JKPckcOtFMp4QunIWFGc7pibQLm13s9fKZ9ic9ew/0?wx_fmt=png"
      })
    },
    fail: function() {
      p(!1)
    }
  })
}, exports.shareSkin = function() {
  var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
  wx.shareAppMessage({
    title: "我获得了新皮肤",
    imageUrl: e || "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJFHiaWIxfyWrEDAehVqPgyVM4pia5WLiaH3pqhlibn3N8rJibl9LMibEZbSJX6MdjFnHxMdg/0?wx_fmt=png",
    success: function() {}
  })
}, require("../@babel/runtime/helpers/Arrayincludes");
var e = require("../@babel/runtime/helpers/regeneratorRuntime"),
  t = require("../@babel/runtime/helpers/asyncToGenerator"),
  a = c(require("./store/session")),
  r = c(require("./store/storage")),
  n = c(require("./pages/shareCard")),
  o = require("./config"),
  i = require("./chattool");

function c(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var s = new n.default({});

function u() {
  return (u = t(e().mark((function t(a) {
    var r, n, c, s, u, l, p, f, h, d;
    return e().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          if (r = a.room_id, n = a.router_id, c = a.version, s = a.cb, r && n && c) {
            e.next = 4;
            break
          }
          return console.log("shareRelay", r, n, c), e.abrupt("return");
        case 4:
          if (u = "room_id=".concat(r, "&mode=relay&router_id=").concat(encodeURIComponent(n), "&version=").concat(c), console.log(u), l = (0, o.getSystemInfo)(), p = function() {
              wx.update分享Menu({
                with分享Ticket: !0,
                success: function() {
                  wx.shareAppMessage({
                    title: "房已开好，就差你了！",
                    query: u,
                    imageUrl: "http://mmbiz.qpic.cn/mmbiz_png/icTdbqWNOwNTTiaKet81gQJN1hYNSmzE0JHB0FicpvibX9tgX8mb3MxbrtpgVxR9ZJaez7Uys56ckP57EU9ib1365Ng/0?wx_fmt=png",
                    success: function(e) {
                      var t = "";
                      e.shareTickets && (t = e.shareTickets[0]), wx.get分享Info({
                        shareTicket: t,
                        success: function(e) {
                          console.log("!!! get分享Info success", e), s(u, e.rawData || e.encryptedData)
                        },
                        fail: function(e) {
                          console.error("!!! get分享Info fail: ", e)
                        }
                      })
                    },
                    fail: function(e) {}
                  })
                },
                fail: function() {
                  s(!1)
                }
              })
            }, !wx.shareAppMessageToGroup || "ios" !== l.platform && "android" !== l.platform) {
            e.next = 26;
            break
          }
          return f = "", e.prev = 10, e.next = 13, (0, i.getChatToolInfo)(r);
        case 13:
          h = e.sent, f = h.activity_id, e.next = 22;
          break;
        case 17:
          return e.prev = 17, e.t0 = e.catch(10), console.error("!!! 分享RelayCard getChatToolInfo fail", e.t0), null !== e.t0 && void 0 !== e.t0 && null !== (d = e.t0.errMsg) && void 0 !== d && d.includes("fail cancel") ? console.log("!!! 用户主动取消分享") : p(), e.abrupt("return");
        case 22:
          console.log("activity_id", f), wx.update分享Menu({
            with分享Ticket: !0,
            isUpdatableMessage: !0,
            activityId: f,
            useForChatTool: !0,
            chooseType: 2,
            templateInfo: {
              templateId: "2A84254B945674A2F88CE4970782C402795EB607"
            },
            success: function() {
              wx.shareAppMessageToGroup({
                title: "多人接力赛",
                imageUrl: "https://mmgame.qpic.cn/image/b758595e64b5ba425ccb767b14c804d078f06ebc5f119976503c44a6b3ae034d/0",
                path: "?" + u,
                success: function(e) {
                  var t = "";
                  e.shareTickets && (t = e.shareTickets[0]), wx.get分享Info({
                    shareTicket: t,
                    success: function(e) {
                      console.log("!!! get分享Info success", e), s(u, e.rawData || e.encryptedData, f)
                    },
                    fail: function(e) {
                      console.error("!!! get分享Info fail: ", e), s(u, !1, f)
                    }
                  })
                },
                fail: function(e) {
                  console.error("shareAppMessageToGroup fail: ", e)
                }
              })
            },
            fail: function(e) {
              console.error("update分享Menu fail: ", e), s(!1)
            }
          }), e.next = 27;
          break;
        case 26:
          p();
        case 27:
        case "end":
          return e.stop()
      }
    }), t, null, [
      [10, 17]
    ])
  })))).apply(this, arguments)
}

function l() {
  return (l = t(e().mark((function t(a) {
    var r, n, i, c, s, u, l;
    return e().wrap((function(e) {
      for (;;) switch (e.prev = e.next) {
        case 0:
          if (r = a.room_id, n = a.router_id, i = a.version, c = a.activity_id, a.game_level, s = a.game_level_s, u = a.member_count, r && n && i) {
            e.next = 4;
            break
          }
          return console.log("shareRelayLive", r, n, i), e.abrupt("return");
        case 4:
          l = "is_live=true&room_id=".concat(r, "&mode=relay&router_id=").concat(encodeURIComponent(n), "&version=").concat(i, "&activity_id=").concat(c), wx.shareInvitationToLiveRoom({
            title: "来跳1跳接龙",
            query: l,
            activityId: c,
            templateInfo: {
              parameterList: [{
                name: "member_count",
                value: "".concat(u)
              }, {
                name: "room_limit",
                value: o.ROOM_LIMIT
              }]
            },
            subTitle: "".concat(s, "难度"),
            fail: function(e) {
              console.error("shareInvitationToLiveRoom fail: ", e)
            }
          });
        case 6:
        case "end":
          return e.stop()
      }
    }), t)
  })))).apply(this, arguments)
}
},{"../@babel/runtime/helpers/Arrayincludes":1,"../@babel/runtime/helpers/asyncToGenerator":6,"../@babel/runtime/helpers/regeneratorRuntime":22,"./chattool":36,"./config":37,"./pages/shareCard":110,"./store/session":127,"./store/storage":128}],125:[function(require,module,exports){
(Object.defineProperty(exports, "__esModule", {
  value: !0,
}),
  (exports.default = void 0),
  require("../@babel/runtime/helpers/Arrayincludes"));
var n = require("../@babel/runtime/helpers/toConsumableArray"),
  e = require("../@babel/runtime/helpers/classCallCheck"),
  t = require("../@babel/runtime/helpers/createClass"),
  i = require("./util/util"),
  o = require("./config"),
  s = r(require("./lib/mue/eventcenter")),
  l = r(require("./network/network"));

function r(n) {
  return n && n.__esModule
    ? n
    : {
        default: n,
      };
}
console.log("utildadsasdad", i.Util);
var c = "返回码错了",
  a = "wx.request fail",
  u = (function () {
    function r(n) {
      (e(this, r),
        (this.currentSkin = null),
        (this.firstInit = !0),
        this.bindEvent(),
        (this.skinSn = {}));
    }
    return (
      t(r, [
        {
          key: "bindEvent",
          value: function () {
            var n = this;
            s.default.on(o.EVENT.INITRESPONSE, function (e, t) {
              var i = [];
              console.log("data", t);
              // for (var o = 0; o < t.skin_list.length; ++o)
              //   (i.push(t.skin_list[o].skin_id),
              //     (n.skinSn[t.skin_list[o].skin_id] = t.skin_list[o].sn));
              // (t.current_skin ||
              //   wx.setStorage({
              //     key: "current_skin",
              //     data: null,
              //   }),
              //   n.update(t.current_skin && t.current_skin.skin_id, i));
            });
          },
        },
        {
          key: "loadSkinForOtherMode",
          value: function (n, e) {
            var t = this;
            return (
              (this.skinSn[n] = e),
              console.log("??????? zaizhelile", n, e),
              new Promise(function (e, i) {
                n
                  ? t
                      .loadSkin([n])
                      .then(t.loadSkinBlockInfo)
                      .then(t.loadBlockRes)
                      .then(function () {
                        e();
                      })
                      .catch(function (n) {
                        (console.log("???????????????????? reject", n), i());
                      })
                  : e();
              })
            );
          },
        },
        {
          key: "pipe",
          value: function (n, e) {
            var t = this;
            void 0 !== n
              ? this.loadSkin([n])
                  .then(this.loadSkinBlockInfo)
                  .then(this.loadBlockRes)
                  .then(function () {
                    return new Promise(function (e, t) {
                      (console.log("currentSkin??????", n),
                        wx.setStorage({
                          key: "current_skin",
                          data: n,
                          success: e,
                          fail: t,
                        }));
                    });
                  })
                  .then(function () {
                    return (
                      console.log("wow load skinIdlIstdasdasdasd", e),
                      t.loadSkin(e)
                    );
                  })
                  .then(function (n) {
                    var e = n.blockId;
                    return new Promise(function (o, s) {
                      if (
                        (console.log("wowowowoowowowowowo??????", t.firstInit),
                        t.firstInit)
                      ) {
                        for (var l = [], r = 0; r < e.length; ++r)
                          l.push("block_" + e[r]);
                        (console.log("????dirs", l),
                          i.Util.removeDirsNotInList(l));
                      } else t.firstInit = !1;
                      (console.log("resolve-----------------------", n), o(n));
                    });
                  })
                  .then(this.loadSkinBlockInfo)
                  .then(this.loadBlockRes)
                  .catch(function (n) {})
              : void 0 !== e &&
                e.length > 0 &&
                this.loadSkin(e)
                  .then(this.loadSkinBlockInfo)
                  .then(this.loadBlockRes);
          },
        },
        {
          key: "reset",
          value: function () {},
        },
        {
          key: "loadSkin",
          value: function (e) {
            var t = this;
            return new Promise(function (i, o) {
              var s = wx.getStorageSync("skins") || {};
              console.log("skins", s, s[1], e);
              for (var r = [], u = {}, k = [], d = e.length - 1; d >= 0; --d)
                s[e[d]]
                  ? ((r = r.concat(s[e[d]].object_id_list)),
                    console.log("ttttttt", s[e[d]]),
                    e.splice(d, 1),
                    Object.assign(u, u, s[e[d]]))
                  : k.push({
                      skin_id: e[d],
                      sn: t.skinSn[e[d]],
                    });
              (console.log("hahahahahahha", e),
                e.length > 0
                  ? l.default
                      .getSkin({
                        item_list: k,
                      })
                      .then(function (e) {
                        if (
                          (console.log("loadSkin response", e),
                          e && e.skin_list)
                        ) {
                          console.log("response getskin", e, e.skin_list);
                          for (var l = 0; l < e.skin_list.length; ++l) {
                            var a = {
                              object_id_list: [],
                            };
                            a.skin_sn = t.skinSn[e.skin_list[l].skin_id];
                            for (
                              var k = 0;
                              k < e.skin_list[l].item_list.length;
                              ++k
                            )
                              (a.object_id_list.push(
                                e.skin_list[l].item_list[k].object_id,
                              ),
                                (a[e.skin_list[l].item_list[k].object_id] =
                                  e.skin_list[l].item_list[k].sn),
                                (u[e.skin_list[l].item_list[k].object_id] =
                                  e.skin_list[l].item_list[k].sn));
                            ((s[e.skin_list[l].skin_id] = a),
                              (s.block_sn = s.block_sn || {}),
                              Object.assign(s.block_sn, s.block_sn, u),
                              (r = r.concat(a.object_id_list)));
                          }
                          ((r = n(new Set(r))),
                            wx.setStorageSync("skins", s),
                            i({
                              blockId: r,
                              blockSn: u,
                            }));
                        } else o(c);
                      })
                      .catch(function () {
                        o(a);
                      })
                  : ((r = n(new Set(r))),
                    (u = s.block_sn),
                    console.log("blockidlist", r),
                    i({
                      blockId: r,
                      blockSn: u,
                    })));
            });
          },
        },
        {
          key: "loadSkinBlockInfo",
          value: function (n) {
            var e = n.blockId,
              t = n.blockSn;
            return new Promise(function (n, i) {
              var s = e.concat(o.LOCALBLOCK).filter(function (n) {
                  return !o.LOCALBLOCK.includes(n);
                }),
                r = (
                  wx.getStorageSync("blocks") || {
                    array: [],
                  }
                ).array;
              if (
                ((s = s.concat(r).filter(function (n) {
                  return !r.includes(n);
                })),
                console.log("wtf not in local", s),
                0 != s.length)
              ) {
                console.log("??????", e, t);
                for (var c = [], u = 0; u < s.length; ++u)
                  c.push({
                    object_id: s[u],
                    sn: t[s[u]],
                  });
                (console.log("postDtaa", c),
                  l.default
                    .getBlock({
                      item_list: c,
                    })
                    .then(function (e) {
                      n(e.object_json_list);
                    })
                    .catch(function () {
                      i(a);
                    }));
              } else n();
            });
          },
        },
        {
          key: "loadBlockRes",
          value: function (n) {
            var e = this;
            return new Promise(function (t, o) {
              if ((console.log("wowowoowowo loadBlockres", n), n)) {
                for (var s = [], l = 0; l < n.length; ++l) {
                  var r = new Promise(function (t, o) {
                    var s = 0;
                    n[l] = JSON.parse(n[l]);
                    var r = void 0 !== n[l].ad,
                      c = n[l].block_res_list.length + (r ? 1 : 0),
                      a = n[l].block_res_list.slice(0);
                    r &&
                      a.push({
                        path: "block_".concat(n[l].id, "/trade"),
                        cdn_url: n[l].ad.trademark_url,
                      });
                    for (var u = 0; u < a.length; ++u)
                      i.Util.downloadSaveFile({
                        filePath: a[u].path,
                        url: a[u].cdn_url,
                        success: function (n) {
                          (++s, console.log("count", s), s == c && t());
                        }.bind(e, l, u),
                        fail: function () {
                          o();
                        },
                      });
                  }).then(
                    function (e) {
                      var t = wx.getStorageSync("blocks") || {
                        array: [],
                      };
                      (t.array.push(n[e].id),
                        (t[n[e].id] = n[e]),
                        wx.setStorageSync("blocks", t));
                    }.bind(e, l),
                  );
                  s.push(r);
                }
                Promise.all(s)
                  .then(function () {
                    t();
                  })
                  .catch(function () {
                    o();
                  });
              } else t();
            });
          },
        },
        {
          key: "update",
          value: function (n, e) {
            this.pipe(n, e);
          },
        },
      ]),
      r
    );
  })();
exports.default = u;

},{"../@babel/runtime/helpers/Arrayincludes":1,"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"../@babel/runtime/helpers/toConsumableArray":27,"./config":37,"./lib/mue/eventcenter":67,"./network/network":73,"./util/util":140}],126:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = u(require("./storage")),
  s = u(require("../network/network"));

function u(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var r = function() {
  function u(t) {
    e(this, u), this.times = i.default.getHistoryTimes(), this.times || (this.times = {
      accurate: 0,
      bonus: 0
    }), this.game = t, this.limit本次得分 = 5
  }
  return t(u, [{
    key: "verify本次得分",
    value: function(e) {
      e >= this.times.accurate ? (this.times.accurate = e, this.times.bonus >= this.limit本次得分 ? this.upLoadHistoryTimes() : i.default.saveHistoryTimes(this.times)) : this.upLoadHistoryTimes()
    }
  }, {
    key: "addOne",
    value: function() {
      this.times.bonus++
    }
  }, {
    key: "checkUp",
    value: function() {
      this.times.bonus >= this.limit本次得分 ? this.upLoadHistoryTimes() : i.default.saveHistoryTimes(this.times)
    }
  }, {
    key: "upLoadHistoryTimes",
    value: function() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0,
        t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
        i = this.times.accurate + this.times.bonus;
      s.default.requestSettlement(e, i, this.afterUpload.bind(this), t)
    }
  }, {
    key: "afterUpload",
    value: function(e) {
      e && (this.times.accurate += this.times.bonus, this.times.bonus = 0), i.default.saveHistoryTimes(this.times)
    }
  }, {
    key: "getTimes",
    value: function() {
      return this.times.accurate + this.times.bonus
    }
  }]), u
}();
exports.default = r;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../network/network":73,"./storage":128}],127:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = function() {
    function i() {
      e(this, i)
    }
    return t(i, null, [{
      key: "init",
      value: function() {
        this.sessionId = "", this.gameId = "", this.gameTicket = "", this.serverConfig = "", this.shareTicket = "", this.pkId = "", this.serverConfig = ""
      }
    }, {
      key: "setLoginState",
      value: function(e) {
        this.sessionId = e
      }
    }, {
      key: "setGameId",
      value: function(e) {
        this.gameId = e
      }
    }, {
      key: "setGameTicket",
      value: function(e) {
        this.gameTicket = e
      }
    }, {
      key: "setServerConfig",
      value: function(e) {
        this.serverConfig = e
      }
    }, {
      key: "set分享Ticket",
      value: function(e) {
        console.warn("!!! set分享Ticket", e), this.shareTicket = e
      }
    }, {
      key: "setPkId",
      value: function(e) {
        this.pkId = e
      }
    }, {
      key: "clearPkId",
      value: function() {
        this.pkId = ""
      }
    }, {
      key: "clearGameId",
      value: function() {
        this.gameId = ""
      }
    }, {
      key: "clear分享Ticket",
      value: function() {
        this.分享Ticket = ""
      }
    }, {
      key: "clearGameTicket",
      value: function() {
        this.gameTicket = ""
      }
    }]), i
  }();
exports.default = i;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8}],128:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  n = require("./../config"),
  s = function() {
    function s() {
      e(this, s), this.mmpayStatus = null
    }
    return t(s, null, [{
      key: "getFriends本次得分",
      value: function() {
        try {
          var e = wx.getStorageSync("位好友_score") || [];
          return e = e && e.ts ? e.ts < Date.now() ? [] : e.data : []
        } catch (e) {
          return []
        }
      }
    }, {
      key: "saveFriends本次得分",
      value: function(e) {
        wx.setStorage({
          key: "位好友_score",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "saveMy使用rInfo",
      value: function() {
        var e, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
          n = s.getMy使用rInfo() || {};
        e = Object.assign({}, n, t), wx.setStorage({
          key: "my_user_info",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "saveHeighest本次得分",
      value: function(e) {
        wx.setStorage({
          key: "my_heighest_score",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getHeighest本次得分",
      value: function() {
        try {
          return wx.getStorageSync("my_heighest_score") || !1
        } catch (e) {
          return !1
        }
      }
    }, {
      key: "getMy使用rInfo",
      value: function() {
        try {
          return wx.getStorageSync("my_user_info") || !1
        } catch (e) {
          return null
        }
      }
    }, {
      key: "saveSessionId",
      value: function(e) {
        wx.setStorage({
          key: "session_id",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getSessionId",
      value: function(e) {
        try {
          return wx.getStorageSync("session_id") || ""
        } catch (e) {
          return ""
        }
      }
    }, {
      key: "clearSessionId",
      value: function() {
        wx.removeStorage({
          key: "session_id",
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "saveServerConfig",
      value: function(e) {
        wx.setStorage({
          key: "server_config",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getServerConfig",
      value: function() {
        try {
          return wx.getStorageSync("server_config") || 0
        } catch (e) {
          return 0
        }
      }
    }, {
      key: "getFirstBlood",
      value: function() {
        try {
          return wx.getStorageSync("first_blood") || 0
        } catch (e) {
          return 0
        }
      }
    }, {
      key: "saveFirstBlood",
      value: function() {
        wx.setStorage({
          key: "first_blood",
          data: 1,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getHistoryTimes",
      value: function() {
        try {
          return wx.getStorageSync("history_Times2") || !1
        } catch (e) {
          return !1
        }
      }
    }, {
      key: "saveHistoryTimes",
      value: function(e) {
        wx.setStorage({
          key: "history_Times2",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "saveActionData",
      value: function(e) {
        wx.setStorage({
          key: "action_data0",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getActionData",
      value: function() {
        try {
          return wx.getStorageSync("action_data0") || !1
        } catch (e) {
          return !1
        }
      }
    }, {
      key: "saveAdTag",
      value: function(e) {
        wx.setStorage({
          key: "ad_tag0",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getAdTag",
      value: function() {
        try {
          return wx.getStorageSync("ad_tag0") || !1
        } catch (e) {
          return !1
        }
      }
    }, {
      key: "saveWeekBest本次得分",
      value: function(e) {
        wx.setStorage({
          key: "weeek_best_score0",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getWeekBest本次得分",
      value: function() {
        try {
          var e = wx.getStorageSync("weeek_best_score0") || 0;
          return e && e.ts && (e = e.ts < Date.now() ? 0 : e.data), e
        } catch (e) {
          return 0
        }
      }
    }, {
      key: "setRelayNewBie",
      value: function() {
        wx.setStorage({
          key: "relay_newbie",
          data: 1,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getRelayNewBie",
      value: function() {
        try {
          return wx.getStorageSync("relay_newbie") || 0
        } catch (e) {
          return 0
        }
      }
    }, {
      key: "getWangZheBaseStatus",
      value: function() {
        return n.USEWANGZHEBASE
      }
    }, {
      key: "getMmpayBaseStatus",
      value: function() {
        return n.USEMMPAYBASE
      }
    }, {
      key: "getMmpayBonusStatus",
      value: function() {
        var e, t = {
          status: 0,
          expire_time: !1
        };
        if (this.mmpayStatus) e = this.mmpayStatus;
        else try {
          e = wx.getStorageSync("mmpayStatus") || {}
        } catch (n) {
          e = t
        }
        if (1 == e.status) {
          var n = Math.round(new Date / 1e3);
          return e.expire_time + e.svr_time < n ? t : e
        }
        return 0 == e.status ? e : t
      }
    }, {
      key: "setMmpayBonusStatus",
      value: function(e, t) {
        this.mmpayStatus = Object.assign(e, {
          svr_time: t
        }), wx.setStorage({
          key: "mmpayStatus",
          data: this.mmpayStatus
        })
      }
    }, {
      key: "getBottleSkinData",
      value: function(e) {
        return this.getBottleSkinShopList().find((function(t) {
          return t.id == e
        }))
      }
    }, {
      key: "getBottleSkinShopList",
      value: function() {
        return void 0 !== this.BottleSkinShopList ? this.BottleSkinShopList : wx.getStorageSync("bottleSkin_shopList") || []
      }
    }, {
      key: "setBottleSkinShopList",
      value: function(e) {
        this.BottleSkinShopList = e, wx.setStorage({
          key: "bottleSkin_shopList",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getSkinResources",
      value: function() {
        return void 0 !== this.BottleSkinResources ? this.BottleSkinResources : wx.getStorageSync("bottleSkin_skinResources") || {}
      }
    }, {
      key: "setSkinResources",
      value: function(e) {
        this.BottleSkinResources = e, wx.setStorage({
          key: "bottleSkin_skinResources",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getCan使用BottleSkinIdList",
      value: function() {
        return void 0 !== this.can使用BottleSkinList ? this.can使用BottleSkinList : wx.getStorageSync("bottleSkin_can使用List") || []
      }
    }, {
      key: "setCan使用BottleSkinIdList",
      value: function(e) {
        this.can使用BottleSkinList = e, wx.setStorage({
          key: "bottleSkin_can使用List",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "setSelectBottleSkinId",
      value: function(e) {
        this.bottleSkinId = e, wx.setStorage({
          key: "bottleSkin_skinId",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getSelectBottleSkinId",
      value: function() {
        return void 0 !== this.bottleSkinId ? this.bottleSkinId : wx.getStorageSync("bottleSkin_skinId")
      }
    }, {
      key: "saveMsgBoxData",
      value: function(e) {
        wx.setStorage({
          key: "msg_box_data_0",
          data: e,
          success: function(e) {},
          fail: function(e) {}
        })
      }
    }, {
      key: "getMsgBoxData",
      value: function() {
        try {
          return wx.getStorageSync("msg_box_data_0") || null
        } catch (e) {
          return null
        }
      }
    }, {
      key: "setSyncBottleSkinFailFlag",
      value: function() {
        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1;
        this.syncBottleSkinFailFlag = e
      }
    }, {
      key: "getSyncBottleSkinFailFlag",
      value: function() {
        return this.syncBottleSkinFailFlag || 0
      }
    }]), s
  }();
exports.default = s;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"./../config":37}],129:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var t = require("../@babel/runtime/helpers/classCallCheck"),
  e = require("../@babel/runtime/helpers/createClass"),
  i = function(t, e) {
    if (!e && t && t.__esModule) return t;
    if (null === t || "object" != typeof t && "function" != typeof t) return {
      default: t
    };
    var i = s(e);
    if (i && i.has(t)) return i.get(t);
    var o = {},
      n = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var l in t)
      if ("default" !== l && Object.prototype.hasOwnProperty.call(t, l)) {
        var a = n ? Object.getOwnPropertyDescriptor(t, l) : null;
        a && (a.get || a.set) ? Object.defineProperty(o, l, a) : o[l] = t[l]
      } o.default = t, i && i.set(t, o);
    return o
  }(require("./lib/three.js"));

function s(t) {
  if ("function" != typeof WeakMap) return null;
  var e = new WeakMap,
    i = new WeakMap;
  return (s = function(t) {
    return t ? i : e
  })(t)
}
var o = 100,
  n = 2,
  l = .5,
  a = .5,
  r = function() {
    function s(e, i) {
      t(this, s), this.scene = e, this.bottle = i, this.tailsRemainPool = [], this.tailsUsingPool = [], this.lastDotPosition = this.bottle.obj.position.clone(), this.nowPosition = this.bottle.obj.position.clone(), this.distance = a, this.init()
    }
    return e(s, [{
      key: "init",
      value: function() {
        var t = l,
          e = n;
        this.geometry = new i.PlaneBufferGeometry(t, e), this.material = new i.MeshBasicMaterial({
          color: 16777215,
          side: i.DoubleSide,
          transparent: !0,
          opacity: .3
        });
        for (var s = 0; s < 20; s++) {
          var o = new h(this.geometry, this.material);
          this.scene.add(o.mesh), this.tailsRemainPool.push(o)
        }
      }
    }, {
      key: "update",
      value: function(t) {
        var e;
        if (this.updateActiveCell(t), "prepare" == this.bottle.status && (this.nowPosition = this.bottle.obj.position.clone(), this.lastDotPosition = this.bottle.obj.position.clone()), "jump" == this.bottle.status)
          if (this.nowPosition = this.bottle.obj.position.clone(), (e = this.nowPosition.clone().distanceTo(this.lastDotPosition.clone())) < 5) {
            if (e >= this.distance)
              for (var i = e / this.distance, s = Math.floor(i), n = this.lastDotPosition.clone(), l = this.nowPosition.clone(), a = t / o, r = 1; r <= s; r++) {
                l = this.lastDotPosition.clone().lerp(this.nowPosition.clone(), r / i);
                var h = 1 + a * (r / i - 1);
                h = h <= 0 ? 0 : h, this.layEgg(n.clone(), l.clone(), h), n = l.clone(), r == s && (this.lastDotPosition = l.clone())
              }
          } else this.lastDotPosition = this.nowPosition.clone()
      }
    }, {
      key: "updateActiveCell",
      value: function(t) {
        for (var e = this.tailsUsingPool, i = 1 / o, s = 0; s < e.length; s++) {
          e[s].tickTime += t;
          var n = e[s].mesh.scale.y - i * t;
          if (n > 0) {
            if (e[s].mesh.scale.y = n > 0 ? n : 0, e[s].tickTime >= o) {
              e[s].reset();
              var l = e.shift();
              this.tailsRemainPool.push(l), s--
            }
          } else {
            e[s].reset();
            var a = e.shift();
            this.tailsRemainPool.push(a), s--
          }
        }
      }
    }, {
      key: "correctPosition",
      value: function() {
        this.lastDotPosition = this.bottle.obj.position.clone()
      }
    }, {
      key: "layEgg",
      value: function(t, e) {
        var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 1,
          s = this.getMesh();
        this.tailsUsingPool.push(s), s.mesh.position.set(e.x, e.y, e.z), s.mesh.scale.y = i, s.mesh.lookAt(t), s.mesh.rotateY(Math.PI / 2), s.mesh.visible = !0
      }
    }, {
      key: "getMesh",
      value: function() {
        var t = this.tailsRemainPool.shift();
        return t || (t = new h(this.geometry, this.material), this.scene.add(t.mesh)), t
      }
    }, {
      key: "allReset",
      value: function() {
        this.tailsRemainPool.forEach((function(t) {
          t.reset()
        }))
      }
    }]), s
  }();
exports.default = r;
var h = function() {
  function s(e, o) {
    t(this, s), this.tickTime = 0, this.mesh = new i.Mesh(e, o), this.mesh.visible = !1, this.mesh.name = "tail"
  }
  return e(s, [{
    key: "reset",
    value: function() {
      this.tickTime = 0, this.mesh.scale.set(1, 1, 1), this.mesh.visible = !1
    }
  }]), s
}();
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./lib/three.js":70}],130:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../@babel/runtime/helpers/toConsumableArray"),
  i = require("../@babel/runtime/helpers/classCallCheck"),
  r = require("../@babel/runtime/helpers/createClass"),
  s = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = n(t);
    if (i && i.has(e)) return i.get(e);
    var r = {},
      s = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var a in e)
      if ("default" !== a && Object.prototype.hasOwnProperty.call(e, a)) {
        var o = s ? Object.getOwnPropertyDescriptor(e, a) : null;
        o && (o.get || o.set) ? Object.defineProperty(r, a, o) : r[a] = e[a]
      } r.default = e, i && i.set(e, r);
    return r
  }(require("./lib/three")),
  a = (e = require("./font")) && e.__esModule ? e : {
    default: e
  };

function n(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (n = function(e) {
    return e ? i : t
  })(e)
}
var o = function() {
    function e(t) {
      var r = t.number,
        s = t.geometry,
        a = t.material;
      i(this, e), this.number = r, this.geometry = s, this.material = a, this.avaliable = [], this.used = []
    }
    return r(e, [{
      key: "get",
      value: function() {
        var e = 0 === this.avaliable.length ? new s.Mesh(this.geometry, this.material) : this.avaliable.pop();
        return this.used.push(e), e
      }
    }, {
      key: "clear",
      value: function() {
        this.avaliable = [].concat(t(this.avaliable), t(this.used)), this.used = []
      }
    }]), e
  }(),
  l = function() {
    function e(t, r) {
      var n = this;
      if (i(this, e), void 0 === r.fillStyle && (r.fillStyle = 16777215), this.material = new s.MeshBasicMaterial({
          color: r.fillStyle,
          transparent: !0
        }), r.opacity && (this.material.opacity = r.opacity), this.options = r || {}, this.obj = new s.Object3D, this.obj.name = "text", r.chinese) {
        var l = new s.Mesh(new s.TextBufferGeometry(t, {
          font: a.default,
          size: 1,
          height: .1
        }), this.material);
        this.obj.add(l), "center" == r.textAlign && (l.position.x = 1.1 * t.length / -2)
      } else this.plus = new s.Mesh(new s.TextBufferGeometry("+", {
        font: a.default,
        size: 3,
        height: .1
      }), this.material), this.sub = new s.Mesh(new s.TextBufferGeometry("-", {
        font: a.default,
        size: 3,
        height: .1
      }), this.material), this.pools = Array.from({
        length: 10
      }).map((function(e, t) {
        return new o({
          number: t,
          material: n.material,
          geometry: new s.TextBufferGeometry(t, {
            font: a.default,
            size: 3,
            height: .1
          })
        })
      })), this.set本次得分(t)
    }
    return r(e, [{
      key: "set本次得分",
      value: function(e) {
        var t = this;
        this.sub.visible = !1, this.plus.visible = !1;
        var i = !1;
        e < 0 && (i = !0, e = Math.abs(e));
        var r = 2.5 * (e = e.toString()).length,
          s = "center" == this.options.textAlign ? -r / 2 : 0;
        this.options.plus本次得分 && (s = -(r + 2.5) / 2, i || (this.plus.position.x = s, this.obj.add(this.plus), this.plus.visible = !0), s += 2.5), i && (this.sub.position.x = s, this.obj.add(this.sub), this.sub.visible = !0, s += 2.5), this.pools.forEach((function(e) {
          e.used.forEach((function(e) {
            return t.obj.remove(e)
          })), e.clear()
        }));
        for (var a = 0, n = e.length; a < n; ++a) {
          var o = this.pools[e[a]].get();
          o.position.x = s, this.obj.add(o), s += 2.5
        }
      }
    }, {
      key: "changeStyle",
      value: function(e) {
        Object.assign(this.options, e), this.obj.updateMatrix()
      }
    }]), e
  }();
exports.default = l;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"../@babel/runtime/helpers/toConsumableArray":27,"./font":58,"./lib/three":70}],131:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../@babel/runtime/helpers/classCallCheck"),
  t = require("../@babel/runtime/helpers/createClass"),
  o = require("./config"),
  i = h(require("./text")),
  a = h(require("./ui/adBoard")),
  s = h(require("./ui/propBoard")),
  r = h(require("./ui/propAniManager"));

function h(e) {
  return e && e.__esModule ? e : {
    default: e
  }
}
var c = window.innerHeight > window.innerWidth ? window.innerHeight : window.innerWidth,
  n = (window.innerHeight < window.innerWidth ? window.innerHeight : window.innerWidth, function() {
    function h(t, a, s, r) {
      e(this, h);
      this.game = r, this.full2D = s, this.scene = t, this.camera = a, this.score = 0, this.double = 1, this.scoreText = new i.default("0", {
        fillStyle: 2434341,
        sum本次得分: !0,
        opacity: .8
      }), this.reset本次得分Pos(), this.scoreText.obj.matrixAutoUpdate = !1, this.camera.add(this.scoreText.obj), this.championText = new i.default("擂主得分", {
        fillStyle: 0,
        opacity: .3,
        chinese: !0
      }), this.championText.obj.position.set(o.PK_TEXT_POS.x, o.PK_TEXT_POS.y, -10), this.championText.obj.updateMatrix(), this.championText.obj.matrixAutoUpdate = !1, this.championText.obj.visible = !1, this.camera.add(this.championText.obj), this.champion本次得分Text = new i.default("0", {
        fillStyle: 0,
        opacity: .3
      }), this.champion本次得分Text.obj.matrixAutoUpdate = !1, this.champion本次得分Text.obj.visible = !1, this.camera.add(this.champion本次得分Text.obj)
    }
    return t(h, [{
      key: "reset本次得分Pos",
      value: function() {
        this.scoreText.obj.position.set(o.GAME_SCORE_POS.x, o.GAME_SCORE_POS.y, -10), this.scoreText.obj.scale.set(1, 1, 1), this.scoreText.obj.updateMatrix()
      }
    }, {
      key: "resetObservePos",
      value: function() {
        this.scoreText.obj.position.set(o.OBSERVE_SCORE_POS.x, o.OBSERVE_SCORE_POS.y, -10), this.scoreText.obj.scale.set(1, 1, 1), this.scoreText.obj.updateMatrix()
      }
    }, {
      key: "resetRelayPos",
      value: function() {
        this.scoreText.obj.position.x = o.RELAY_SCORE_POS.x, this.scoreText.obj.position.y = o.RELAY_SCORE_POS.y, this.scoreText.obj.scale.set(.8, .8, .8), this.scoreText.obj.updateMatrix()
      }
    }, {
      key: "reset",
      value: function() {
        console.log("!!! reset"), GameGlobal.matchType ? (this.scoreText.set本次得分(GameGlobal.cache本次得分), this.score = GameGlobal.cache本次得分) : (this.scoreText.set本次得分(0), this.score = 0), this.double = 1
      }
    }, {
      key: "update",
      value: function() {}
    }, {
      key: "hide本次得分",
      value: function() {
        this.scoreText.obj.visible = !1
      }
    }, {
      key: "show本次得分",
      value: function() {
        this.scoreText.obj.visible = !0
      }
    }, {
      key: "hideChampion本次得分",
      value: function() {
        console.log("!!! hideChampion本次得分"), this.championText.obj.visible = !1, this.champion本次得分Text.obj.visible = !1
      }
    }, {
      key: "showChampion本次得分",
      value: function(e) {
        console.log("!!! showChampion本次得分", e), this.championText.obj.visible = !0, this.champion本次得分Text.set本次得分(e);
        var t = (0, o.getPK本次得分Pos)(e);
        this.champion本次得分Text.obj.position.set(t.x, t.y, -10), this.champion本次得分Text.obj.updateMatrix(), this.champion本次得分Text.obj.visible = !0
      }
    }, {
      key: "add本次得分",
      value: function(e, t, o, i) {
        return i ? (this.score += e, void this.set本次得分(this.score)) : (t ? 1 === this.double ? this.double = 2 : this.double += 2 : this.double = 1, o && this.double <= 2 && (this.double *= 2), this.double = Math.min(32, this.double), e *= this.double, this.score += e, this.set本次得分(this.score), e)
      }
    }, {
      key: "showAdAvator",
      value: function(e, t, o, i) {
        this.adBoard && this.adBoard.destroy && (console.error("Already exist adBoard"), this.adBoard.destroy()), this.adBoard = new a.default({
          camera: e,
          trademark_url: t,
          ad_url: o,
          navigateToMiniProgramData: i
        }), this.game.reporter.rpShowAdCard()
      }
    }, {
      key: "hideAdAvator",
      value: function() {
        this.adBoard && this.adBoard.destroy && this.adBoard.destroy(), this.adBoard = null
      }
    }, {
      key: "showProp",
      value: function() {
        var e = this,
          t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1;
        this.propBoard && this.adBoard.destroy && this.propBoard.destroy(), this.propBoard = new s.default({
          camera: this.camera,
          game: this.game,
          usingId: t,
          destroyCb: function() {
            e.hideProp()
          }
        })
      }
    }, {
      key: "hideProp",
      value: function() {
        this.propBoard && this.propBoard.destroy && this.propBoard.destroy(), this.propBoard = null
      }
    }, {
      key: "audienceWatchPropAni",
      value: function(e) {
        this.propAniManager || (this.propAniManager = new r.default({
          camera: this.camera,
          game: this.game
        })), this.propAniManager.show(e)
      }
    }, {
      key: "set本次得分",
      value: function(e) {
        GameGlobal.minigameCenter && GameGlobal.matchType && GameGlobal.minigameCenter.reportMatch本次得分(this.score, GameGlobal.gameID), this.scoreText.set本次得分(e), o.BLOCK.minRadiusScale -= .005, o.BLOCK.minRadiusScale = Math.max(.25, o.BLOCK.minRadiusScale), o.BLOCK.maxRadiusScale -= .005, o.BLOCK.maxRadiusScale = Math.max(o.BLOCK.maxRadiusScale, .6), o.BLOCK.maxDistance += .03, o.BLOCK.maxDistance = Math.min(22, o.BLOCK.maxDistance)
      }
    }]), h
  }());
exports.default = n;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./config":37,"./text":130,"./ui/adBoard":132,"./ui/propAniManager":134,"./ui/propBoard":135}],132:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../../@babel/runtime/helpers/toConsumableArray"),
  i = require("../../@babel/runtime/helpers/classCallCheck"),
  a = require("../../@babel/runtime/helpers/createClass"),
  r = require("../config"),
  o = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = l(t);
    if (i && i.has(e)) return i.get(e);
    var a = {},
      r = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var o in e)
      if ("default" !== o && Object.prototype.hasOwnProperty.call(e, o)) {
        var n = r ? Object.getOwnPropertyDescriptor(e, o) : null;
        n && (n.get || n.set) ? Object.defineProperty(a, o, n) : a[o] = e[o]
      } a.default = e, i && i.set(e, a);
    return a
  }(require("../lib/three")),
  n = require("../lib/animation"),
  s = (e = require("../lib/mue/eventcenter")) && e.__esModule ? e : {
    default: e
  };

function l(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (l = function(e) {
    return e ? i : t
  })(e)
}
var u = r.AD_BOARD.RADIUS,
  h = r.AD_BOARD.x,
  m = function() {
    function e(t) {
      var a = this;
      i(this, e), this.camera = t.camera;
      var n = t.trademark_url;
      this.ad_url = t.ad_url, this.navigateToMiniProgramData = t.navigateToMiniProgramData;
      var l = new o.MeshBasicMaterial({
          map: r.loader.load(r.BASE_TRADE_MARK_RUL),
          transparent: !0,
          opacity: 0
        }),
        m = new o.CircleGeometry(u, 32);
      this.mesh = new o.Mesh(m, l), this.ePosition = [h, 22, 10], this.sPosition = [h, 20, 10], this.mesh.visible = !1, this.camera.add(this.mesh), s.default.on(r.EVENT.TRIGGER_AD_JUMP, this.jumpToH5.bind(this)), n ? r.loader.load(n, (function(e) {
        a.mesh.material.map = e, a.mesh.material.needsUpdate = !0, a.show()
      }), (function() {}), (function(e) {
        console.error("load AD texture error:" + e), a.show()
      })) : this.show()
    }
    return a(e, [{
      key: "show",
      value: function() {
        var e;
        (e = this.mesh.position).set.apply(e, t(this.sPosition)), this.mesh.material.opacity = 0, this.mesh.visible = !0, n.customAnimation.to(this.mesh.position, .4, {
          y: this.ePosition[1]
        }), n.customAnimation.to(this.mesh.material, .4, {
          opacity: 1
        })
      }
    }, {
      key: "jumpToH5",
      value: function() {
        if (this.mesh.visible) {
          if (this.ad_url && wx.openUrl && wx.openUrl({
              url: this.ad_url
            }), this.navigateToMiniProgramData) {
            var e = this.navigateToMiniProgramData,
              t = e.appId,
              i = void 0 === t ? "" : t,
              a = e.path,
              o = void 0 === a ? "" : a,
              n = e.extraData,
              l = void 0 === n ? "" : n;
            wx.navigateToMiniProgram && wx.navigateToMiniProgram({
              appId: i,
              path: o,
              extraData: l,
              success: function() {
                console.log("--navigateToMiniProgram")
              },
              fail: function(e) {
                console.log("--navigateToMiniProgram fail", e)
              }
            })
          }
          this.mesh.visible = !1, s.default.emit(r.EVENT.JUMP_AD, {})
        }
      }
    }, {
      key: "destroy",
      value: function() {
        this.camera.remove(this.mesh), s.default.off(r.EVENT.TRIGGER_AD_JUMP, this.jumpToH5.bind(this))
      }
    }]), e
  }();
exports.default = m;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../../@babel/runtime/helpers/toConsumableArray":27,"../config":37,"../lib/animation":66,"../lib/mue/eventcenter":67,"../lib/three":70}],133:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  o = require("../../@babel/runtime/helpers/createClass"),
  t = require("../config"),
  i = function() {
    function i(o) {
      var n = this;
      e(this, i), this.game = o, this.musicPool = ["success", "combo1", "combo2", "combo3", "combo4", "combo5", "combo6", "combo7", "combo8", "scale_intro", "scale_loop", "restart", "fall", "fall_2", "pop", "icon", "sing", "pay", "luban", "relax"];
      var a = 0;
      this.musicPool.forEach((function(e, o) {
        setTimeout(function(e) {
          this[e] = wx.createInnerAudioContext(), this[e].src = t.AUDIO[e], (a += 1) === this.musicPool.length && (n.scale_loop.loop = !0, n.icon.onEnded((function() {
            n.icon.destroy()
          })), n.pay.onPlay((function() {
            n.pay.before && n.pay.before()
          })), n.pay.onEnded((function() {
            n.pay.after && n.pay.after(), n.timer = setTimeout((function() {
              n.canTimer && (n.pay.seek(0), n.pay.play())
            }), 3e3)
          })), n.sing.onEnded((function() {
            n.timer = setTimeout((function() {
              n.canTimer && (n.sing.seek(0), n.sing.play())
            }), 3e3)
          })), n.luban.onEnded((function() {
            n.timer = setTimeout((function() {
              n.canTimer && (n.luban.seek(0), n.luban.play())
            }), 3e3)
          })), n.scale_intro.onEnded((function() {
            "prepare" == n.game.bottle.status && n.scale_loop.play()
          })))
        }.bind(n, e), 2 * o)
      }))
    }
    return o(i, [{
      key: "resetAudio",
      value: function() {
        var e = this;
        this.musicPool.forEach((function(o) {
          e[o].stop()
        }))
      }
    }, {
      key: "register",
      value: function(e, o, t) {
        console.log("ley", e), this[e].before = o, this[e].after = t
      }
    }, {
      key: "setTimerFlag",
      value: function(e) {
        this.canTimer = e
      }
    }, {
      key: "clearTimer",
      value: function() {
        this.timer && (clearTimeout(this.timer), this.timer = null)
      }
    }, {
      key: "replay",
      value: function(e) {
        var o = this[e];
        o ? (o.stop(), o.play()) : console.warn("there is no music", e)
      }
    }]), i
  }();
exports.default = i;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37}],134:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../../@babel/runtime/helpers/classCallCheck"),
  t = require("../../@babel/runtime/helpers/createClass"),
  i = require("../config"),
  a = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = n(t);
    if (i && i.has(e)) return i.get(e);
    var a = {},
      r = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var s in e)
      if ("default" !== s && Object.prototype.hasOwnProperty.call(e, s)) {
        var o = r ? Object.getOwnPropertyDescriptor(e, s) : null;
        o && (o.get || o.set) ? Object.defineProperty(a, s, o) : a[s] = e[s]
      } a.default = e, i && i.set(e, a);
    return a
  }(require("../lib/three")),
  r = require("../lib/animation");

function n(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (n = function(e) {
    return e ? i : t
  })(e)
}
var s = function() {
  function n(t) {
    var i = t.camera,
      r = t.game;
    e(this, n), this.game = r, this.camera = i;
    var s = new a.CircleGeometry(1.5, 32),
      o = new a.MeshBasicMaterial({
        color: 16777215,
        transparent: !0,
        opacity: 1
      });
    this.bg = new a.Mesh(s, o);
    var m = new a.CircleGeometry(1.3, 32),
      h = new a.MeshBasicMaterial({
        transparent: !0,
        opacity: 1
      });
    this.main = new a.Mesh(m, h), this.main.position.set(0, 0, .1), this.mesh = new a.Object3D, this.mesh.add(this.bg), this.mesh.add(this.main), this.mesh.rotateY(-Math.PI / 4), this.mesh.rotateX(-Math.PI / 16 * 3), this.mesh.visible = !1
  }
  return t(n, [{
    key: "show",
    value: function() {
      var e = this,
        t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1,
        a = i.PROP_BOARD.skin["s" + t];
      i.loader.load(a, (function(t) {
        e.main.material.map = t, e.main.material.needsUpdate = !0, e.mesh.visible = !0
      }));
      var n = this.game.bottle.obj.position.clone(),
        s = n.x,
        o = n.z;
      this.mesh.position.set(s, 10, o), this.bg.material.opacity = 0, this.main.material.opacity = 0, this.game.scene.add(this.mesh), r.customAnimation.to(this.mesh.position, .4, {
        y: 13
      }), r.customAnimation.to(this.bg.material, .4, {
        opacity: 1
      }), r.customAnimation.to(this.main.material, .4, {
        opacity: 1
      }), r.customAnimation.to(this.bg.material, .4, {
        opacity: 0,
        delay: .6
      }), r.customAnimation.to(this.main.material, .4, {
        opacity: 0,
        delay: .6,
        onComplete: function() {
          e.game.scene.remove(e.mesh), e.mesh.visible = !1
        }
      })
    }
  }]), n
}();
exports.default = s;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/animation":66,"../lib/three":70}],135:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../../@babel/runtime/helpers/classCallCheck"),
  r = require("../../@babel/runtime/helpers/createClass"),
  i = require("../config"),
  s = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var r = n(t);
    if (r && r.has(e)) return r.get(e);
    var i = {},
      s = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var a in e)
      if ("default" !== a && Object.prototype.hasOwnProperty.call(e, a)) {
        var o = s ? Object.getOwnPropertyDescriptor(e, a) : null;
        o && (o.get || o.set) ? Object.defineProperty(i, a, o) : i[a] = e[a]
      } i.default = e, r && r.set(e, i);
    return i
  }(require("../lib/three")),
  a = (require("../lib/animation"), (e = require("../lib/mue/eventcenter")) && e.__esModule ? e : {
    default: e
  });

function n(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    r = new WeakMap;
  return (n = function(e) {
    return e ? r : t
  })(e)
}
var o = i.PROP_BOARD.p.RADIUS,
  u = function() {
    function e(r) {
      var n = this;
      t(this, e), this.camera = r.camera, this.usingId = r.usingId, this.destroyCb = r.destroyCb, this.game = r.game;
      var u = i.PROP_BOARD.skin["s" + r.usingId],
        h = new s.MeshBasicMaterial({
          transparent: !0
        }),
        l = new s.CircleGeometry(o, 32);
      this.mesh = new s.Mesh(l, h), this.mesh.position.set(i.PROP_BOARD.p.x, i.PROP_BOARD.p.y, -1), this.mesh.visible = !1, this.mesh.material.depthTest = !1, this.camera.add(this.mesh), a.default.on(i.EVENT.TRIGGER_PROP, this.touch.bind(this)), i.loader.load(u, (function(e) {
        n.mesh.material.map = e, n.mesh.visible = !0, n.mesh.material.needsUpdate = !0
      }))
    }
    return r(e, [{
      key: "touch",
      value: function() {
        this.mesh.visible && this.game.gameCtrl.touchProp({
          id: this.usingId,
          cb: this.afterUsingPorp.bind(this),
          seed: this.game.randomSeed
        })
      }
    }, {
      key: "afterUsingPorp",
      value: function(e) {
        e && this.destroyCb()
      }
    }, {
      key: "destroy",
      value: function() {
        this.camera.remove(this.mesh), a.default.off(i.EVENT.TRIGGER_PROP, this.touch.bind(this))
      }
    }]), e
  }();
exports.default = u;
},{"../../@babel/runtime/helpers/classCallCheck":7,"../../@babel/runtime/helpers/createClass":8,"../config":37,"../lib/animation":66,"../lib/mue/eventcenter":67,"../lib/three":70}],136:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.inQQ = exports.checkUpdate = void 0, exports.throttleEvent = function(e) {
  var o = e.event姓th,
    t = e.callback,
    a = e.args,
    n = e.throttleTime,
    d = void 0 === n ? 1e3 : n;
  if (c.has(o)) return void console.log("[throttleEvent] event姓th:", o);
  c.set(o, t), t(a), setTimeout((function() {
    c.delete(o)
  }), d)
};
var e, o, t = require("./../config"),
  a = wx.getAppBaseInfo ? wx.getAppBaseInfo() : null,
  n = a ? null === (e = a.host) || void 0 === e ? void 0 : e.appId : "",
  d = "wxf0a80d0ac2e82aa7" === n || "wxf14070172bb44e41" === n || "wxdd5cdc32195da4fc" === n;
exports.inQQ = d, "function" == typeof wx.getUpdateManager && (o = wx.getUpdateManager());
exports.checkUpdate = function() {
  var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0];
  return new Promise((function(a, n) {
    if (0 == e && n(), o) try {
      console.log("can use updateManager"), o.onCheckForUpdate((function(e) {
        console.log("onCheckForUpdate"), e.hasUpdate ? (console.log("hasUpdate"), wx.show加载中({
          mask: !0,
          title: "正在努力更新中～"
        })) : (console.log("dontHasUpdate"), n())
      })), o.onUpdateReady((function() {
        console.log("updateReady"), wx.hide加载中(), o.applyUpdate()
      })), o.onUpdateFailed((function() {
        console.log("updateFail"), wx.hide加载中(), n()
      }))
    } catch (e) {
      d()
    } else d();

    function d() {
      e == t.VERSION ? a() : n()
    }
  }))
};
var c = new Map;
},{"./../config":37}],137:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.encrypt = function(e, r) {
  r = r.slice(0, 16);
  var a = t.default.enc.Utf8.parse(r),
    n = t.default.enc.Utf8.parse(r),
    u = e;
  u = JSON.stringify(u);
  var d = t.default.AES.encrypt(u, a, {
    iv: n,
    mode: t.default.mode.CBC,
    padding: t.default.pad.Pkcs7
  });
  return d = d.toString()
}, exports.encryptSeed = function(e, r) {
  var a = t.default.enc.Utf8.parse(r + "_" + e),
    n = t.default.SHA256(a).toString();
  return n = n.substr(0, 12), n = parseInt(n, 16), n += 46704096e5
};
var e, t = (e = require("../lib/aes")) && e.__esModule ? e : {
  default: e
};
},{"../lib/aes":65}],138:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.compareMyVersion = function(e) {
  if (e === n.VERSION) return 0;
  if (e > n.VERSION) return 1;
  if (e < n.VERSION) return -1;
  return
}, exports.forceUpdate = function(e, n) {
  if (void 0 === wx.getUpdateManager) e();
  else {
    var o = function n() {
      new Promise((function(e, n) {
        var t = wx.getUpdateManager();
        Promise.race([new Promise((function(e, n) {
          wx.show加载中({
            content: "正在下载",
            mask: !0
          })
        })), Promise.race([new Promise((function(e, n) {
          setTimeout((function() {
            n()
          }), 1e3)
        })), new Promise((function(e, n) {
          t.onCheckForUpdate((function(t) {
            t.hasUpdate ? e() : n()
          }))
        }))]).then((function() {
          return new Promise((function(e, n) {
            t.onUpdateReady((function() {
              e()
            })), t.onUpdateFailed((function() {
              n()
            }))
          }))
        }), (function() {
          return Promise.reject()
        }))]).then((function() {
          t.applyUpdate(), e()
        }), (function() {
          n()
        }))
      })).then((function() {}), (function() {
        wx.hide加载中(), wx.showModal({
          content: "请在检查网络状况后重试",
          confirmText: "重试",
          cancelText: "取消",
          success: function(t) {
            t.confirm ? n() : e()
          },
          fail: function() {
            e()
          }
        }), t.default.sendServerError(10)
      }))
    };
    wx.showModal({
      content: n || "点击确定，进行版本更新后重试",
      success: function(n) {
        n.confirm ? o() : e()
      },
      fail: function() {
        e()
      }
    })
  }
};
var e, n = require("./../config"),
  t = (e = require("../network/network")) && e.__esModule ? e : {
    default: e
  };
},{"../network/network":73,"./../config":37}],139:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.realTimeLogManager = void 0;
var e = wx.getRealtimeLogManager ? wx.getRealtimeLogManager() : null,
  t = {
    debug: function() {
      e && e.debug.apply(e, arguments)
    },
    info: function() {
      e && e.info.apply(e, arguments)
    },
    warn: function() {
      e && e.warn.apply(e, arguments)
    },
    error: function() {
      e && e.error.apply(e, arguments)
    },
    setFilterMsg: function(t) {
      e && e.setFilterMsg && "string" == typeof t && e.setFilterMsg(t)
    },
    addFilterMsg: function(t) {
      e && e.addFilterMsg && "string" == typeof t && e.addFilterMsg(t)
    }
  };
exports.realTimeLogManager = t;
},{}],140:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.Util = void 0;
var e = {};
exports.Util = e;
var o = wx.getFileSystemManager();
window.fileManager = o;
var c = function(e) {
  o.saveFile({
    tempFilePath: e.tempFilePath,
    filePath: "".concat(wx.env.USER_DATA_PATH, "/").concat(e.filePath),
    success: function() {
      e.success && e.success()
    },
    fail: function() {
      e.fail && e.fail()
    }
  })
};
e.saveFile = function(e) {
  console.log("saveFile", e);
  var l = e.filePath.split("/");
  l.length >= 2 && o.access({
    path: "".concat(wx.env.USER_DATA_PATH, "/").concat(l[0]),
    success: function() {
      console.log("success, access dir"), c(e)
    },
    fail: function(n) {
      o.mkdir({
        dirPath: "".concat(wx.env.USER_DATA_PATH, "/").concat(l[0]),
        success: function() {
          console.log("mrk dir ok", e), c(e)
        },
        fail: function(o) {
          console.log("fail mrk dir"), c(e)
        }
      })
    }
  })
}, e.deleteFiles = function(e) {
  for (var c = 0, l = e.length; c < l; ++c) o.unlinkSync("".concat(wx.env.USER_DATA_PATH, "/").concat(e[c]))
}, e.removeDirsNotInList = function(e) {
  console.log("remove list", e), e && o.readdir({
    dirPath: wx.env.USER_DATA_PATH,
    success: function(c) {
      for (var l = c.files, n = 0, i = l.length; n < i; ++n) e.indexOf(l[n]) < 0 && "block_" == l[n].substr(0, 6) && (console.log("remove dirs", l[n]), o.rmdir({
        filePath: "".concat(wx.env.USER_DATA_PATH, "/").concat(l[n]),
        success: function() {
          console.log("remove dir ok")
        }
      }))
    },
    fail: function(e) {
      console.log("faile", e)
    }
  })
}, e.downloadSaveFile = function(o) {
  console.log("downloadSaveFile", o), wx.downloadFile({
    url: o.url,
    header: o.header || "",
    success: function(c) {
      console.log("download okkkkkk", c.tempFilePath), e.saveFile({
        filePath: o.filePath,
        tempFilePath: c.tempFilePath,
        success: o.success,
        fail: o.fail
      })
    },
    fail: function(e) {
      console.log("fail download", e), o.fail && o.fail()
    }
  })
};
},{}],141:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e, t = require("../@babel/runtime/helpers/classCallCheck"),
  i = require("../@babel/runtime/helpers/createClass"),
  n = (function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var i = s(t);
    if (i && i.has(e)) return i.get(e);
    var n = {},
      r = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var o in e)
      if ("default" !== o && Object.prototype.hasOwnProperty.call(e, o)) {
        var u = r ? Object.getOwnPropertyDescriptor(e, o) : null;
        u && (u.get || u.set) ? Object.defineProperty(n, o, u) : n[o] = e[o]
      } n.default = e, i && i.set(e, n)
  }(require("./lib/three")), (e = require("./pages/lookers")) && e.__esModule ? e : {
    default: e
  });

function s(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    i = new WeakMap;
  return (s = function(e) {
    return e ? i : t
  })(e)
}
var r = function() {
  function e(i) {
    t(this, e), this.num = 0, this.list = [], this.imgPlanes = [], this.camera = i, this.lookers = new n.default({
      camera: i
    }), this.isOpen = !1
  }
  return i(e, [{
    key: "peopleCome",
    value: function(e) {
      this.list.findIndex((function(t) {
        return !!t && t.audience_openid == e.audience_openid
      })) > -1 || (this.list.push(e), this.num++, this.isOpen && this.showAvatar())
    }
  }, {
    key: "peopleOut",
    value: function(e) {
      var t = this.list.findIndex((function(t) {
        return !!t && t.audience_openid == e.audience_openid
      }));
      t < 0 || (this.num = this.num - 1 < 0 ? 0 : this.num - 1, this.list.splice(t, 1), this.isOpen && this.showAvatar())
    }
  }, {
    key: "showAvatar",
    value: function() {
      if (this.num > 0) {
        for (var e = [], t = 1; t < 4; t++) this.list.length - t >= 0 && e.unshift(this.list[this.list.length - t].audience_headimg);
        this.lookers.showLookers({
          avaImg: !0,
          icon: !0,
          wording: !1,
          num: this.num,
          avatar: e
        })
      } else this.lookers.showLookers({
        avaImg: !1,
        icon: !0,
        wording: !1
      })
    }
  }, {
    key: "open",
    value: function() {
      this.isOpen = !0, this.showAvatar()
    }
  }, {
    key: "close",
    value: function() {
      this.isOpen = !1, this.hideAll()
    }
  }, {
    key: "reset",
    value: function() {
      this.num = 0, this.list = [], this.lookers.hideLookers()
    }
  }, {
    key: "hideAll",
    value: function() {
      this.lookers.hideLookers()
    }
  }]), e
}();
exports.default = r;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./lib/three":70,"./pages/lookers":85}],142:[function(require,module,exports){
Object.defineProperty(exports, "__esModule", {
  value: !0
}), exports.default = void 0;
var e = require("../@babel/runtime/helpers/classCallCheck"),
  t = require("../@babel/runtime/helpers/createClass"),
  r = function(e, t) {
    if (!t && e && e.__esModule) return e;
    if (null === e || "object" != typeof e && "function" != typeof e) return {
      default: e
    };
    var r = i(t);
    if (r && r.has(e)) return r.get(e);
    var n = {},
      a = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var o in e)
      if ("default" !== o && Object.prototype.hasOwnProperty.call(e, o)) {
        var u = a ? Object.getOwnPropertyDescriptor(e, o) : null;
        u && (u.get || u.set) ? Object.defineProperty(n, o, u) : n[o] = e[o]
      } n.default = e, r && r.set(e, n);
    return n
  }(require("./lib/three")),
  n = require("./config");

function i(e) {
  if ("function" != typeof WeakMap) return null;
  var t = new WeakMap,
    r = new WeakMap;
  return (i = function(e) {
    return e ? r : t
  })(e)
}
var a = new r.RingBufferGeometry(n.WAVE.innerRadius, n.WAVE.outerRadius, n.WAVE.thetaSeg),
  o = function() {
    function i() {
      e(this, i);
      var t = new r.MeshBasicMaterial({
        color: n.COLORS.pureWhite,
        transparent: !0
      });
      this.obj = new r.Mesh(a, t), this.obj.rotation.x = -Math.PI / 2, this.obj.name = "wave"
    }
    return t(i, [{
      key: "reset",
      value: function() {
        this.obj.scale.set(1, 1, 1), this.obj.material.opacity = 1, this.obj.visible = !1
      }
    }]), i
  }();
exports.default = o;
},{"../@babel/runtime/helpers/classCallCheck":7,"../@babel/runtime/helpers/createClass":8,"./config":37,"./lib/three":70}],143:[function(require,module,exports){
var e = require("../@babel/runtime/helpers/typeof");
! function(e) {
  var t = {};

  function n(o) {
    if (t[o]) return t[o].exports;
    var r = t[o] = {
      exports: {},
      id: o,
      loaded: !1
    };
    return e[o].call(r.exports, r, r.exports, n), r.loaded = !0, r.exports
  }
  n.m = e, n.c = t, n.p = "", n(0)
}([function(e, t, n) {
  var o = function(e) {
    if (e && e.__esModule) return e;
    var t = {};
    if (null != e)
      for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]);
    return t.default = e, t
  }(n(1));
  var r = GameGlobal;
  GameGlobal.__isAdapterInjected || (GameGlobal.__isAdapterInjected = !0, function() {
    o.addEventListener = o.canvas.addEventListener = function(e, t) {
      o.document.addEventListener(e, t)
    }, o.removeEventListener = o.canvas.removeEventListener = function(e, t) {
      o.document.removeEventListener(e, t)
    };
    var e = wx.getSystemInfoSync().platform;
    if ("undefined" == typeof __devtoolssubcontext && "devtools" === e) {
      for (var t in o) {
        var n = Object.getOwnPropertyDescriptor(r, t);
        n && !0 !== n.configurable || Object.defineProperty(window, t, {
          value: o[t]
        })
      }
      for (var a in o.document) {
        var i = Object.getOwnPropertyDescriptor(r.document, a);
        i && !0 !== i.configurable || Object.defineProperty(r.document, a, {
          value: o.document[a]
        })
      }
      window.parent = window
    } else {
      for (var u in o) r[u] = o[u];
      r.window = o, window = r, window.top = window.parent = window
    }
  }())
}, function(e, t, n) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  }), t.cancelAnimationFrame = t.requestAnimationFrame = t.clearInterval = t.clearTimeout = t.setInterval = t.setTimeout = t.canvas = t.location = t.localStorage = t.HTMLElement = t.FileReader = t.Audio = t.Image = t.WebSocket = t.XMLHttpRequest = t.navigator = t.document = void 0;
  var o = n(2);
  Object.keys(o).forEach((function(e) {
    "default" !== e && "__esModule" !== e && Object.defineProperty(t, e, {
      enumerable: !0,
      get: function() {
        return o[e]
      }
    })
  }));
  var r = n(3);
  Object.keys(r).forEach((function(e) {
    "default" !== e && "__esModule" !== e && Object.defineProperty(t, e, {
      enumerable: !0,
      get: function() {
        return r[e]
      }
    })
  }));
  var a = v(n(9)),
    i = v(n(10)),
    u = v(n(17)),
    c = v(n(18)),
    l = v(n(19)),
    s = v(n(11)),
    f = v(n(12)),
    d = v(n(20)),
    p = v(n(4)),
    h = v(n(21)),
    y = v(n(22));

  function v(e) {
    return e && e.__esModule ? e : {
      default: e
    }
  }
  t.document = i.default, t.navigator = u.default, t.XMLHttpRequest = c.default, t.WebSocket = l.default, t.Image = s.default, t.Audio = f.default, t.FileReader = d.default, t.HTMLElement = p.default, t.localStorage = h.default, t.location = y.default;
  var b = new a.default;
  t.canvas = b, t.setTimeout = setTimeout, t.setInterval = setInterval, t.clearTimeout = clearTimeout, t.clearInterval = clearInterval, t.requestAnimationFrame = requestAnimationFrame, t.cancelAnimationFrame = cancelAnimationFrame
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  var n = wx.getSystemInfoSync(),
    o = n.screenWidth,
    r = n.screenHeight,
    a = n.devicePixelRatio,
    i = t.innerWidth = o,
    u = t.innerHeight = r;
  t.devicePixelRatio = a;
  t.screen = {
    availWidth: i,
    availHeight: u
  }, t.performance = {
    now: function() {
      return Date.now() / 1e3
    }
  }, t.ontouchstart = null, t.ontouchmove = null, t.ontouchend = null
}, function(t, n, o) {
  Object.defineProperty(n, "__esModule", {
    value: !0
  }), n.HTMLCanvasElement = n.HTMLImageElement = void 0;
  var r, a = o(4),
    i = (r = a) && r.__esModule ? r : {
      default: r
    };

  function u(e, t) {
    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
  }

  function c(t, n) {
    if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    return !n || "object" !== e(n) && "function" != typeof n ? t : n
  }

  function l(t, n) {
    if ("function" != typeof n && null !== n) throw new TypeError("Super expression must either be null or a function, not " + e(n));
    t.prototype = Object.create(n && n.prototype, {
      constructor: {
        value: t,
        enumerable: !1,
        writable: !0,
        configurable: !0
      }
    }), n && (Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : t.__proto__ = n)
  }
  n.HTMLImageElement = function(e) {
    function t() {
      return u(this, t), c(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, "img"))
    }
    return l(t, e), t
  }(i.default), n.HTMLCanvasElement = function(e) {
    function t() {
      return u(this, t), c(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, "canvas"))
    }
    return l(t, e), t
  }(i.default)
}, function(t, n, o) {
  Object.defineProperty(n, "__esModule", {
    value: !0
  });
  var r, a = function() {
      function e(e, t) {
        for (var n = 0; n < t.length; n++) {
          var o = t[n];
          o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
        }
      }
      return function(t, n, o) {
        return n && e(t.prototype, n), o && e(t, o), t
      }
    }(),
    i = o(5),
    u = (r = i) && r.__esModule ? r : {
      default: r
    },
    c = o(8),
    l = o(2);

  function s(e, t) {
    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
  }

  function f(t, n) {
    if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    return !n || "object" !== e(n) && "function" != typeof n ? t : n
  }
  var d = function(t) {
    function n() {
      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
      s(this, n);
      var t = f(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this));
      return t.className = "", t.childern = [], t.style = {
        width: l.innerWidth + "px",
        height: l.innerHeight + "px"
      }, t.insertBefore = c.noop, t.innerHTML = "", t.tagName = e.toUpperCase(), t
    }
    return function(t, n) {
      if ("function" != typeof n && null !== n) throw new TypeError("Super expression must either be null or a function, not " + e(n));
      t.prototype = Object.create(n && n.prototype, {
        constructor: {
          value: t,
          enumerable: !1,
          writable: !0,
          configurable: !0
        }
      }), n && (Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : t.__proto__ = n)
    }(n, t), a(n, [{
      key: "setAttribute",
      value: function(e, t) {
        this[e] = t
      }
    }, {
      key: "getAttribute",
      value: function(e) {
        return this[e]
      }
    }, {
      key: "getBoundingClientRect",
      value: function() {
        return {
          top: 0,
          left: 0,
          width: l.innerWidth,
          height: l.innerHeight
        }
      }
    }, {
      key: "focus",
      value: function() {}
    }, {
      key: "clientWidth",
      get: function() {
        var e = parseInt(this.style.fontSize, 10) * this.innerHTML.length;
        return Number.isNaN(e) ? 0 : e
      }
    }, {
      key: "clientHeight",
      get: function() {
        var e = parseInt(this.style.fontSize, 10);
        return Number.isNaN(e) ? 0 : e
      }
    }]), n
  }(u.default);
  n.default = d
}, function(t, n, o) {
  Object.defineProperty(n, "__esModule", {
    value: !0
  });
  var r, a = o(6);
  var i = function(t) {
    function n() {
      ! function(e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
      }(this, n);
      var t = function(t, n) {
        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !n || "object" !== e(n) && "function" != typeof n ? t : n
      }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this));
      return t.className = "", t.children = [], t
    }
    return function(t, n) {
      if ("function" != typeof n && null !== n) throw new TypeError("Super expression must either be null or a function, not " + e(n));
      t.prototype = Object.create(n && n.prototype, {
        constructor: {
          value: t,
          enumerable: !1,
          writable: !0,
          configurable: !0
        }
      }), n && (Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : t.__proto__ = n)
    }(n, t), n
  }(((r = a) && r.__esModule ? r : {
    default: r
  }).default);
  n.default = i
}, function(t, n, o) {
  Object.defineProperty(n, "__esModule", {
    value: !0
  });
  var r, a = function() {
      function e(e, t) {
        for (var n = 0; n < t.length; n++) {
          var o = t[n];
          o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
        }
      }
      return function(t, n, o) {
        return n && e(t.prototype, n), o && e(t, o), t
      }
    }(),
    i = o(7);
  var u = function(t) {
    function n() {
      ! function(e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
      }(this, n);
      var t = function(t, n) {
        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        return !n || "object" !== e(n) && "function" != typeof n ? t : n
      }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this));
      return t.childNodes = [], t
    }
    return function(t, n) {
      if ("function" != typeof n && null !== n) throw new TypeError("Super expression must either be null or a function, not " + e(n));
      t.prototype = Object.create(n && n.prototype, {
        constructor: {
          value: t,
          enumerable: !1,
          writable: !0,
          configurable: !0
        }
      }), n && (Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : t.__proto__ = n)
    }(n, t), a(n, [{
      key: "appendChild",
      value: function(e) {
        if (!(e instanceof n)) throw new TypeError("Failed to executed 'appendChild' on 'Node': parameter 1 is not of type 'Node'.");
        this.childNodes.push(e)
      }
    }, {
      key: "cloneNode",
      value: function() {
        var e = Object.create(this);
        return Object.assign(e, this), e
      }
    }, {
      key: "removeChild",
      value: function(e) {
        var t = this.childNodes.findIndex((function(t) {
          return t === e
        }));
        return t > -1 ? this.childNodes.splice(t, 1) : null
      }
    }]), n
  }(((r = i) && r.__esModule ? r : {
    default: r
  }).default);
  n.default = u
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  var n = function() {
    function e(e, t) {
      for (var n = 0; n < t.length; n++) {
        var o = t[n];
        o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
      }
    }
    return function(t, n, o) {
      return n && e(t.prototype, n), o && e(t, o), t
    }
  }();
  var o = new WeakMap,
    r = function() {
      function e() {
        ! function(e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }(this, e), o.set(this, {})
      }
      return n(e, [{
        key: "addEventListener",
        value: function(e, t) {
          var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},
            r = o.get(this);
          r || (r = {}, o.set(this, r)), r[e] || (r[e] = []), r[e].push(t), n.capture && console.warn("EventTarget.addEventListener: options.capture is not implemented."), n.once && console.warn("EventTarget.addEventListener: options.once is not implemented."), n.passive && console.warn("EventTarget.addEventListener: options.passive is not implemented.")
        }
      }, {
        key: "removeEventListener",
        value: function(e, t) {
          var n = o.get(this)[e];
          if (n && n.length > 0)
            for (var r = n.length; r--; r > 0)
              if (n[r] === t) {
                n.splice(r, 1);
                break
              }
        }
      }, {
        key: "dispatchEvent",
        value: function() {
          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
            t = o.get(this)[e.type];
          if (t)
            for (var n = 0; n < t.length; n++) t[n](e)
        }
      }]), e
    }();
  t.default = r
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  }), t.noop = function() {}
}, function(e, t, n) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  }), t.default = function() {
    var e = wx.createCanvas();
    e.type = "canvas", e.__proto__.__proto__ = new o.default("canvas");
    e.getContext;
    return e.getBoundingClientRect = function() {
      return {
        top: 0,
        left: 0,
        width: window.innerWidth,
        height: window.innerHeight
      }
    }, e
  };
  n(3);
  var o = r(n(4));
  r(n(10));

  function r(e) {
    return e && e.__esModule ? e : {
      default: e
    }
  }
}, function(e, t, n) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  var o = function(e) {
      if (e && e.__esModule) return e;
      var t = {};
      if (null != e)
        for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]);
      return t.default = e, t
    }(n(1)),
    r = c(n(4)),
    a = c(n(11)),
    i = c(n(12)),
    u = c(n(9));

  function c(e) {
    return e && e.__esModule ? e : {
      default: e
    }
  }
  n(15);
  var l = {},
    s = {
      readyState: "complete",
      visibilityState: "visible",
      documentElement: o,
      hidden: !1,
      style: {},
      location: o.location,
      ontouchstart: null,
      ontouchmove: null,
      ontouchend: null,
      head: new r.default("head"),
      body: new r.default("body"),
      createElement: function(e) {
        return "canvas" === e ? new u.default : "audio" === e ? new i.default : "img" === e ? new a.default : new r.default(e)
      },
      getElementById: function(e) {
        return e === o.canvas.id ? o.canvas : null
      },
      getElementsByTagName: function(e) {
        return "head" === e ? [s.head] : "body" === e ? [s.body] : "canvas" === e ? [o.canvas] : []
      },
      querySelector: function(e) {
        return "head" === e ? s.head : "body" === e ? s.body : "canvas" === e || e === "#" + o.canvas.id ? o.canvas : null
      },
      querySelectorAll: function(e) {
        return "head" === e ? [s.head] : "body" === e ? [s.body] : "canvas" === e ? [o.canvas] : []
      },
      addEventListener: function(e, t) {
        l[e] || (l[e] = []), l[e].push(t)
      },
      removeEventListener: function(e, t) {
        var n = l[e];
        if (n && n.length > 0)
          for (var o = n.length; o--; o > 0)
            if (n[o] === t) {
              n.splice(o, 1);
              break
            }
      },
      dispatchEvent: function(e) {
        var t = l[e.type];
        if (t)
          for (var n = 0; n < t.length; n++) t[n](e)
      }
    };
  t.default = s
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  }), t.default = function() {
    return wx.createImage()
  }
}, function(t, n, o) {
  Object.defineProperty(n, "__esModule", {
    value: !0
  });
  var r, a = function() {
      function e(e, t) {
        for (var n = 0; n < t.length; n++) {
          var o = t[n];
          o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
        }
      }
      return function(t, n, o) {
        return n && e(t.prototype, n), o && e(t, o), t
      }
    }(),
    i = o(13),
    u = (r = i) && r.__esModule ? r : {
      default: r
    };
  var c = new WeakMap,
    l = new WeakMap,
    s = (new WeakMap, new WeakMap, function(t) {
      function n(t) {
        ! function(e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }(this, n);
        var o = function(t, n) {
          if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
          return !n || "object" !== e(n) && "function" != typeof n ? t : n
        }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this));
        o.HAVE_NOTHING = 0, o.HAVE_METADATA = 1, o.HAVE_CURRENT_DATA = 2, o.HAVE_FUTURE_DATA = 3, o.HAVE_ENOUGH_DATA = 4, o.readyState = 0, l.set(o, "");
        var r = wx.createInnerAudioContext();
        return c.set(o, r), r.onCanplay((function() {
          o.dispatchEvent({
            type: "load"
          }), o.dispatchEvent({
            type: "loadend"
          }), o.dispatchEvent({
            type: "canplay"
          }), o.dispatchEvent({
            type: "canplaythrough"
          }), o.dispatchEvent({
            type: "loadedmetadata"
          }), o.readyState = 2
        })), r.onPlay((function() {
          o.dispatchEvent({
            type: "play"
          })
        })), r.onPause((function() {
          o.dispatchEvent({
            type: "pause"
          })
        })), r.onEnded((function() {
          o.dispatchEvent({
            type: "ended"
          }), o.readyState = 4
        })), r.onError((function() {
          o.dispatchEvent({
            type: "error"
          })
        })), t && (c.get(o).src = t), o
      }
      return function(t, n) {
        if ("function" != typeof n && null !== n) throw new TypeError("Super expression must either be null or a function, not " + e(n));
        t.prototype = Object.create(n && n.prototype, {
          constructor: {
            value: t,
            enumerable: !1,
            writable: !0,
            configurable: !0
          }
        }), n && (Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : t.__proto__ = n)
      }(n, t), a(n, [{
        key: "load",
        value: function() {
          console.warn("HTMLAudioElement.load() is not implemented.")
        }
      }, {
        key: "play",
        value: function() {
          c.get(this).play()
        }
      }, {
        key: "pause",
        value: function() {
          c.get(this).pause()
        }
      }, {
        key: "canPlayType",
        value: function() {
          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
          return "string" != typeof e ? "" : e.indexOf("audio/mpeg") > -1 || e.indexOf("audio/mp4") ? "probably" : ""
        }
      }, {
        key: "cloneNode",
        value: function() {
          var e = new n;
          return e.loop = c.get(this).loop, e.autoplay = c.get(this).loop, e.src = this.src, e
        }
      }, {
        key: "currentTime",
        get: function() {
          return c.get(this).currentTime
        },
        set: function(e) {
          c.get(this).seek(e)
        }
      }, {
        key: "src",
        get: function() {
          return l.get(this)
        },
        set: function(e) {
          l.set(this, e), c.get(this).src = e
        }
      }, {
        key: "loop",
        get: function() {
          return c.get(this).loop
        },
        set: function(e) {
          c.get(this).loop = e
        }
      }, {
        key: "autoplay",
        get: function() {
          return c.get(this).autoplay
        },
        set: function(e) {
          c.get(this).autoplay = e
        }
      }, {
        key: "paused",
        get: function() {
          return c.get(this).paused
        }
      }]), n
    }(u.default));
  n.default = s
}, function(t, n, o) {
  Object.defineProperty(n, "__esModule", {
    value: !0
  });
  var r, a = o(14);
  var i = function(t) {
    function n() {
      return function(e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }(this, n),
        function(t, n) {
          if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
          return !n || "object" !== e(n) && "function" != typeof n ? t : n
        }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, "audio"))
    }
    return function(t, n) {
      if ("function" != typeof n && null !== n) throw new TypeError("Super expression must either be null or a function, not " + e(n));
      t.prototype = Object.create(n && n.prototype, {
        constructor: {
          value: t,
          enumerable: !1,
          writable: !0,
          configurable: !0
        }
      }), n && (Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : t.__proto__ = n)
    }(n, t), n
  }(((r = a) && r.__esModule ? r : {
    default: r
  }).default);
  n.default = i
}, function(t, n, o) {
  Object.defineProperty(n, "__esModule", {
    value: !0
  });
  var r, a = function() {
      function e(e, t) {
        for (var n = 0; n < t.length; n++) {
          var o = t[n];
          o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
        }
      }
      return function(t, n, o) {
        return n && e(t.prototype, n), o && e(t, o), t
      }
    }(),
    i = o(4);
  var u = function(t) {
    function n(t) {
      return function(e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }(this, n),
        function(t, n) {
          if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
          return !n || "object" !== e(n) && "function" != typeof n ? t : n
        }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, t))
    }
    return function(t, n) {
      if ("function" != typeof n && null !== n) throw new TypeError("Super expression must either be null or a function, not " + e(n));
      t.prototype = Object.create(n && n.prototype, {
        constructor: {
          value: t,
          enumerable: !1,
          writable: !0,
          configurable: !0
        }
      }), n && (Object.setPrototypeOf ? Object.setPrototypeOf(t, n) : t.__proto__ = n)
    }(n, t), a(n, [{
      key: "addTextTrack",
      value: function() {}
    }, {
      key: "captureStream",
      value: function() {}
    }, {
      key: "fastSeek",
      value: function() {}
    }, {
      key: "load",
      value: function() {}
    }, {
      key: "pause",
      value: function() {}
    }, {
      key: "play",
      value: function() {}
    }]), n
  }(((r = i) && r.__esModule ? r : {
    default: r
  }).default);
  n.default = u
}, function(e, t, n) {
  n(16)
}, function(e, t, n) {
  var o, r = function(e) {
      if (e && e.__esModule) return e;
      var t = {};
      if (null != e)
        for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]);
      return t.default = e, t
    }(n(1)),
    a = n(10),
    i = (o = a) && o.__esModule ? o : {
      default: o
    },
    u = n(8);
  var c = function e(t) {
    ! function(e, t) {
      if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
    }(this, e), this.target = r.canvas, this.currentTarget = r.canvas, this.touches = [], this.targetTouches = [], this.changedTouches = [], this.preventDefault = u.noop, this.stopPropagation = u.noop, this.type = t
  };

  function l(e) {
    return function(t) {
      var n = new c(e);
      n.touches = t.touches, n.targetTouches = Array.prototype.slice.call(t.touches), n.changedTouches = t.changedTouches, n.timeStamp = t.timeStamp, i.default.dispatchEvent(n)
    }
  }
  wx.onTouchStart(l("touchstart")), wx.onTouchMove(l("touchmove")), wx.onTouchEnd(l("touchend")), wx.onTouchCancel(l("touchcancel"))
}, function(e, t, n) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  var o = n(8),
    r = {
      platform: wx.getSystemInfoSync().platform,
      language: "zh-cn",
      appVersion: "5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1",
      userAgent: "Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/zh_CN",
      onLine: !0,
      geolocation: {
        getCurrentPosition: o.noop,
        watchPosition: o.noop,
        clearWatch: o.noop
      }
    };
  t.default = r
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  var n = function() {
    function e(e, t) {
      for (var n = 0; n < t.length; n++) {
        var o = t[n];
        o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
      }
    }
    return function(t, n, o) {
      return n && e(t.prototype, n), o && e(t, o), t
    }
  }();
  var o = new WeakMap,
    r = new WeakMap,
    a = new WeakMap,
    i = new WeakMap,
    u = new WeakMap;

  function c(e) {
    if ("function" == typeof this["on" + e]) {
      for (var t = arguments.length, n = Array(t > 1 ? t - 1 : 0), o = 1; o < t; o++) n[o - 1] = arguments[o];
      this["on" + e].apply(this, n)
    }
  }

  function l(e) {
    this.readyState = e, c.call(this, "readystatechange")
  }
  var s = function() {
    function e() {
      ! function(e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
      }(this, e), this.onabort = null, this.onerror = null, this.onload = null, this.onloadstart = null, this.onprogress = null, this.ontimeout = null, this.onloadend = null, this.onreadystatechange = null, this.readyState = 0, this.response = null, this.responseText = null, this.responseType = "", this.responseXML = null, this.status = 0, this.statusText = "", this.upload = {}, this.withCredentials = !1, a.set(this, {
        "content-type": "application/x-www-form-urlencoded"
      }), i.set(this, {})
    }
    return n(e, [{
      key: "abort",
      value: function() {
        var e = u.get(this);
        e && e.abort()
      }
    }, {
      key: "getAllResponseHeaders",
      value: function() {
        var e = i.get(this);
        return Object.keys(e).map((function(t) {
          return t + ": " + e[t]
        })).join("\n")
      }
    }, {
      key: "getResponseHeader",
      value: function(e) {
        return i.get(this)[e]
      }
    }, {
      key: "open",
      value: function(t, n) {
        r.set(this, t), o.set(this, n), l.call(this, e.OPENED)
      }
    }, {
      key: "overrideMimeType",
      value: function() {}
    }, {
      key: "send",
      value: function() {
        var t = this,
          n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "";
        if (this.readyState !== e.OPENED) throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");
        wx.request({
          data: n,
          url: o.get(this),
          method: r.get(this),
          header: a.get(this),
          responseType: this.responseType,
          success: function(n) {
            var o = n.data,
              r = n.statusCode,
              a = n.header;
            if ("string" != typeof o && !(o instanceof ArrayBuffer)) try {
              o = JSON.stringify(o)
            } catch (e) {
              o = o
            }
            if (t.status = r, i.set(t, a), c.call(t, "loadstart"), l.call(t, e.HEADERS_RECEIVED), l.call(t, e.LOADING), t.response = o, o instanceof ArrayBuffer) {
              t.responseText = "";
              for (var u = new Uint8Array(o), s = u.byteLength, f = 0; f < s; f++) t.responseText += String.fromCharCode(u[f])
            } else t.responseText = o;
            l.call(t, e.DONE), c.call(t, "load"), c.call(t, "loadend")
          },
          fail: function(e) {
            var n = e.errMsg; - 1 !== n.indexOf("abort") ? c.call(t, "abort") : c.call(t, "error", n), c.call(t, "loadend")
          }
        })
      }
    }, {
      key: "setRequestHeader",
      value: function(e, t) {
        var n = a.get(this);
        n[e] = t, a.set(this, n)
      }
    }]), e
  }();
  s.UNSEND = 0, s.OPENED = 1, s.HEADERS_RECEIVED = 2, s.LOADING = 3, s.DONE = 4, t.default = s
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  var n = function() {
    function e(e, t) {
      for (var n = 0; n < t.length; n++) {
        var o = t[n];
        o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o)
      }
    }
    return function(t, n, o) {
      return n && e(t.prototype, n), o && e(t, o), t
    }
  }();

  function o(e, t) {
    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
  }
  var r = new WeakMap,
    a = function() {
      function e(t) {
        var n = this,
          a = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [];
        if (o(this, e), this.binaryType = "", this.bufferedAmount = 0, this.extensions = "", this.onclose = null, this.onerror = null, this.onmessage = null, this.onopen = null, this.protocol = "", this.readyState = 3, "string" != typeof t || !/(^ws:\/\/)|(^wss:\/\/)/.test(t)) throw new TypeError("Failed to construct 'WebSocket': The URL '" + t + "' is invalid");
        this.url = t, this.readyState = e.CONNECTING;
        var i = wx.connectSocket({
          url: t,
          protocols: Array.isArray(a) ? a : [a]
        });
        return r.set(this, i), i.onClose((function(t) {
          n.readyState = e.CLOSED, "function" == typeof n.onclose && n.onclose(t)
        })), i.onMessage((function(e) {
          "function" == typeof n.onmessage && n.onmessage(e)
        })), i.onOpen((function() {
          n.readyState = e.OPEN, "function" == typeof n.onopen && n.onopen()
        })), i.onError((function(e) {
          "function" == typeof n.onerror && n.onerror(new Error(e.errMsg))
        })), this
      }
      return n(e, [{
        key: "close",
        value: function(t, n) {
          this.readyState = e.CLOSING, r.get(this).close({
            code: t,
            reason: n
          })
        }
      }, {
        key: "send",
        value: function(e) {
          if ("string" != typeof e && !(e instanceof ArrayBuffer)) throw new TypeError("Failed to send message: The data " + e + " is invalid");
          r.get(this).send({
            data: e
          })
        }
      }]), e
    }();
  a.CONNECTING = 0, a.OPEN = 1, a.CLOSING = 2, a.CLOSED = 3, t.default = a
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  t.default = function e() {
    ! function(e, t) {
      if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
    }(this, e)
  }
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  var n = {
    get length() {
      return wx.getStorageInfoSync().keys.length
    },
    key: function(e) {
      return wx.getStorageInfoSync().keys[e]
    },
    getItem: function(e) {
      return wx.getStorageSync(e)
    },
    setItem: function(e, t) {
      return wx.setStorageSync(e, t)
    },
    removeItem: function(e) {
      wx.removeStorageSync(e)
    },
    clear: function() {
      wx.clearStorageSync()
    }
  };
  t.default = n
}, function(e, t) {
  Object.defineProperty(t, "__esModule", {
    value: !0
  });
  t.default = {
    href: "game.js",
    reload: function() {}
  }
}]);
},{"../@babel/runtime/helpers/typeof":30}]},{},[32]);
